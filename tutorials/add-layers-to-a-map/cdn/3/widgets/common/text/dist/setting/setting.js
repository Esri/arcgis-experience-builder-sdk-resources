System.register(["jimu-core","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/rich-text-editor","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder"],(function(e,t){var o={},a={},r={},n={},l={},i={},s={};return{setters:[function(e){o.AllDataSourceTypes=e.AllDataSourceTypes,o.Immutable=e.Immutable,o.React=e.React,o.ReactRedux=e.ReactRedux,o.classNames=e.classNames,o.css=e.css,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jsx=e.jsx},function(e){a.builderAppSync=e.builderAppSync},function(e){r.SettingRow=e.SettingRow,r.SettingSection=e.SettingSection},function(e){n.RichTextFormatKeys=e.RichTextFormatKeys,n.RichTextFormats=e.RichTextFormats,n.richTextEditorUtils=e.richTextEditorUtils,n.useEditorSelectionFormats=e.useEditorSelectionFormats},function(e){l.Button=e.Button,l.Switch=e.Switch,l.TextArea=e.TextArea,l.defaultMessages=e.defaultMessages,l.richTextUtils=e.richTextUtils},function(e){i.DataSourceSelector=e.DataSourceSelector},function(e){s.ExpressionInput=e.ExpressionInput,s.ExpressionInputType=e.ExpressionInputType}],execute:function(){e((()=>{var e={9759:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.5 2a.5.5 0 0 0 0 1H7l-1.868 8.406a.488.488 0 0 0 .953.212L8 3h3.5a.5.5 0 0 0 0-1zm-1 11a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm6.64-3.86a.477.477 0 0 1 .674 0l1.686 1.686 1.686-1.686a.477.477 0 1 1 .674.674L12.174 11.5l1.686 1.686a.477.477 0 1 1-.674.674L11.5 12.174 9.814 13.86a.477.477 0 1 1-.674-.674l1.686-1.686L9.14 9.814a.477.477 0 0 1 0-.674" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=o},4108:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=l},13089:e=>{"use strict";e.exports=i},84845:e=>{"use strict";e.exports=s},33949:e=>{"use strict";e.exports=n},79298:e=>{"use strict";e.exports=r}},t={};function c(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,c),r.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{__set_webpack_public_path__:()=>T,default:()=>R});var e=c(79244),t=c(4108),o=c(79298),a=c(33949);const r=(0,e.Immutable)({text:"<p></p>",placeholder:"Double click to edit text",style:{wrap:!0}});var n=c(14321),l=c(13089);const i={verticalAlignment:"Vertical alignment"};var s=c(84845);var p=c(9759),d=c.n(p),m=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(o[a[r]]=e[a[r]])}return o};const g=t=>{const o=window.SVG,{className:a}=t,r=m(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",a);return o?e.React.createElement(o,Object.assign({className:n,src:d()},r)):e.React.createElement("svg",Object.assign({className:n},r))};var S=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(o[a[r]]=e[a[r]])}return o};const b=e.css`
  > * {
    user-select: none;
  }
`,y=t=>{const{editor:o,onChange:r}=t,l=S(t,["editor","onChange"]),[,i]=(0,a.useEditorSelectionFormats)(o,!0),s=e.hooks.useTranslation(n.defaultMessages);return(0,e.jsx)(n.Button,Object.assign({css:b},l,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{a.richTextEditorUtils.clearFormats(o,i),null==r||r(null==o?void 0:o.root.innerHTML)},title:s("clearAllFormats"),"aria-label":s("clearAllFormats")}),(0,e.jsx)(g,null))};var x=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(o[a[r]]=e[a[r]])}return o};const f=t=>{const{editor:o,defaultColor:r}=t,n=x(t,["editor","defaultColor"]),[l,i]=(0,a.useEditorSelectionFormats)(o,!0),s=e.React.useMemo((()=>{var e;let t=l;return null!=(null===(e=null==t?void 0:t.link)||void 0===e?void 0:e.link)&&(t=Object.assign(Object.assign({},t),{link:t.link.link})),!t.color&&r&&(t=Object.assign(Object.assign({},t),{color:r})),t}),[l,r]);return e.React.createElement(a.RichTextFormats,Object.assign({editor:o,formats:s,selection:i},n))},v=(0,e.Immutable)([e.AllDataSourceTypes.FeatureLayer,e.AllDataSourceTypes.SceneLayer,e.AllDataSourceTypes.BuildingComponentSubLayer,e.AllDataSourceTypes.OrientedImageryLayer,e.AllDataSourceTypes.ImageryLayer,e.AllDataSourceTypes.SubtypeGroupLayer,e.AllDataSourceTypes.SubtypeSublayer]),h=(0,e.Immutable)([s.ExpressionInputType.Static,s.ExpressionInputType.Attribute,s.ExpressionInputType.Statistics,s.ExpressionInputType.Expression]),w=(0,e.Immutable)([]),E=r=>{var c,u,p,d,m,g;const{id:S,config:b,savedConfig:x,useDataSources:E,useDataSourcesEnabled:R,onSettingChange:T}=r,O="Web Experience Template"===(null===(u=null===(c=(0,e.getAppStore)().getState().appStateInBuilder)||void 0===c?void 0:c.appInfo)||void 0===u?void 0:u.type),j=b.style.wrap,I=b.text,A=b.placeholder,D=e.React.useMemo((()=>{var e;return null!==(e=n.richTextUtils.getHTMLTextContent(A))&&void 0!==e?e:""}),[A]),C=b.tooltip,F=e.ReactRedux.useSelector((e=>e.appStateInBuilder)),M=null===(d=null===(p=null==F?void 0:F.widgetsMutableStateVersion)||void 0===p?void 0:p[S])||void 0===d?void 0:d.editor,P=null===(g=null===(m=null==F?void 0:F.widgetsRuntimeInfo)||void 0===m?void 0:m[S])||void 0===g?void 0:g.isInlineEditing,k=R&&(null==E?void 0:E.length)>0,[L,_]=e.React.useState(null),[U,N]=e.React.useState(!1);e.React.useEffect((()=>{var e;const t=window._appWindow._mutableStoreManager,o=null!==(e=null==t?void 0:t.getStateValue([S,"editor"]))&&void 0!==e?e:null;_(o)}),[M,S]);const B=e.hooks.useTranslation(i,n.defaultMessages),V=(e,t,o)=>{const r=n.richTextUtils.isBlankRichText(I)&&!!A,l=!P&&r?"placeholder":"text";let i=x.set(l,e);P||t!==a.RichTextFormatKeys.Color||(i=i.setIn(["style","color"],o)),T({id:S,config:i})},H=e.React.useMemo((()=>k?h:(0,e.Immutable)([s.ExpressionInputType.Static])),[k]);return e.React.createElement("div",{className:"widget-setting-text jimu-widget-setting"},e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,null,e.React.createElement(l.DataSourceSelector,{isMultiple:!0,types:v,useDataSources:E,useDataSourcesEnabled:R,onToggleUseDataEnabled:()=>{t.builderAppSync.publishWidgetToolbarStateChangeToApp(S,["text-expression"]);const e=!R;T(C&&!e?{id:S,config:x.without("tooltip"),useDataSourcesEnabled:e}:{id:S,useDataSourcesEnabled:e})},onChange:e=>{t.builderAppSync.publishWidgetToolbarStateChangeToApp(S,["text-expression"]),null!=e&&T({id:S,useDataSources:e})},widgetId:S}))),e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,{flow:"no-wrap",label:B("wrap")},e.React.createElement(n.Switch,{checked:j,onChange:()=>{T({id:S,config:x.setIn(["style","wrap"],!j)})},"aria-label":B("wrap")})),e.React.createElement(o.SettingRow,{label:B("tooltip"),flow:"wrap",role:"group","aria-label":B("tooltip")},e.React.createElement("div",{className:"w-100"},e.React.createElement(s.ExpressionInput,{"aria-label":B("tooltip"),autoHide:!0,useDataSources:k?E:w,onChange:e=>{null!=e&&(T({id:S,config:x.set("tooltip",e)}),N(!1))},openExpPopup:()=>{N(!0)},expression:"object"==typeof C?C:null,isExpPopupOpen:U,closeExpPopup:()=>{N(!1)},types:H,widgetId:S}))),O&&e.React.createElement(o.SettingRow,{flow:"wrap",label:B("placeholder")},e.React.createElement(n.TextArea,{"aria-label":B("placeholder"),defaultValue:D,onAcceptValue:e=>{e=e.replace(/\n/gm,"");const t=((e,t)=>{const o=n.richTextUtils.getHTMLTextContent(e);return e.replace(null==o?void 0:o.trim(),t)})(A,e);T({id:S,config:x.set("placeholder",t)})}}))),null!=L&&e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,{flow:"no-wrap",label:B("textFormat"),role:"group","aria-label":B("textFormat")},e.React.createElement(y,{editor:L,onChange:V})),e.React.createElement(o.SettingRow,null,e.React.createElement(f,{widgetId:S,editor:L,defaultColor:b.style.color,useDataSources:E,onChange:V}))))};E.getFullConfig=e=>r.merge(e,{deep:!0});const R=E;function T(e){c.p=e}})(),u})())}}}));