/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-196931.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-196931"],{2137:(e,t,i)=>{var n,r,a,s,l,o;i.d(t,{L:()=>o,a:()=>l,f:()=>r,i:()=>n,l:()=>a,s:()=>s}),function(e){e.sourceUrl="sourceUrl",e.title="title",e.caption="caption",e.linkUrl="linkUrl",e.altText="altText"}(n||(n={})),function(e){e.expression="expression/",e.relationship="relationships/",e.raster="Raster."}(r||(r={})),function(e){e.feature="feature",e.cluster="cluster",e.mapNotes="mapNotes"}(a||(a={})),function(e){e.feature="feature",e.mapImage="map-image",e.scene="scene",e.ogcFeature="ogc-feature",e.imagery="imagery",e.wfs="wfs",e.wms="wms",e.csv="csv",e.geojson="geojson",e.stream="stream",e.imageryTile="imagery-tile",e.tile="tile",e.subtype="subtype",e.orientedImagery="oriented-imagery"}(s||(s={})),function(e){e.integer="integer",e.smallInteger="small-integer",e.bigInteger="big-integer",e.single="single",e.double="double",e.long="long",e.string="string",e.date="date",e.dateOnly="date-only",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e.oid="oid",e.guid="guid",e.globalId="global-id",e.number="number"}(l||(l={})),function(e){e.default="default",e.display="display",e.type="type",e.field="field"}(o||(o={}))},89393:(e,t,i)=>{i.d(t,{a:()=>p,b:()=>a,c:()=>d,d:()=>l,e:()=>s,f:()=>b,g:()=>m,h:()=>y,i:()=>h,j:()=>f,k:()=>g,l:()=>x,m:()=>o,n:()=>v,o:()=>F,p:()=>c,q:()=>w});var n=i(2137),r=i(21104);function a(e,t){if(-1!==e.fieldName.indexOf(n.f.expression)){const i=t.get(e.fieldName);return(null==i?void 0:i.title)?i.title:e.fieldName}return e.label?e.label:e.fieldName}function s(e){const t=new Map;return(null==e?void 0:e.expressionInfos)&&e.expressionInfos.forEach((e=>{const i=`${n.f.expression}${e.name}`;t.set(i,e)})),t}async function l(e){return new Map((await f(e)).filter((e=>e.visible)).map((e=>[e.name,e])))}async function o(e,t){var i,r,a,s,l,o,c,f,y;try{const p=d(e);if(p===n.s.mapImage&&e.layer.version>=10.5&&!(null===(r=null===(i=e.layer.capabilities)||void 0===i?void 0:i.operations)||void 0===r?void 0:r.supportsQuery)&&(null===(s=null===(a=e.layer.capabilities)||void 0===a?void 0:a.operations)||void 0===s?void 0:s.supportsIdentify))return{features:[await b(e,t)||await u(e)]};if(p===n.s.scene&&!(null===(o=null===(l=e.capabilities)||void 0===l?void 0:l.operations)||void 0===o?void 0:o.supportsQuery))return{features:[await u(e)]};const m=p===n.s.ogcFeature||p===n.s.stream?await t.whenLayerView(e):e,v=m.createQuery();v.where=m.definitionExpression||"1=1",v.outFields=["*"],v.returnM="hasM"in e&&e.hasM,v.returnZ="hasZ"in e&&e.hasZ,((null===(f=null===(c=m.sourceJSON)||void 0===c?void 0:c.advancedQueryCapabilities)||void 0===f?void 0:f.supportsPagination)||p===n.s.ogcFeature)&&(v.start=0,v.num=1),v.outSpatialReference=t.spatialReference;const g=await m.queryFeatures(v);return(null===(y=null==g?void 0:g.features)||void 0===y?void 0:y.length)||(g.features[0]=await u(e)),g}catch(e){console.error(e)}}async function u(e){return new Promise(((t,i)=>{(0,r.l)(["esri/Graphic","esri/geometry/Geometry"]).then((([i,n])=>{var r;const a=new i;if(null===(r=e.fields)||void 0===r?void 0:r.length){const t={};e.fields.forEach((e=>{t[e.name]=e.defaultValue})),a.attributes=t}if(e.geometryType){const t=new n;t.type=e.geometryType,a.geometry=t}t(a)}),(e=>{i(e)}))}))}function d(e){var t,i,r;return"map-image"===(null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.type)?n.s.mapImage:"subtype-sublayer"===(null==e?void 0:e.type)?n.s.subtype:"tile"===(null===(i=null==e?void 0:e.layer)||void 0===i?void 0:i.type)?n.s.tile:"scene"===(null==e?void 0:e.type)?n.s.scene:"ogc-feature"===(null==e?void 0:e.type)?n.s.ogcFeature:"imagery"===(null==e?void 0:e.type)?n.s.imagery:"imagery-tile"===(null==e?void 0:e.type)?n.s.imageryTile:"wfs"===(null==e?void 0:e.type)?n.s.wfs:"wms"===(null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.type)?n.s.wms:"csv"===(null==e?void 0:e.type)?n.s.csv:"geojson"===(null==e?void 0:e.type)?n.s.geojson:"stream"===(null==e?void 0:e.type)?n.s.stream:"oriented-imagery"===(null==e?void 0:e.type)?n.s.orientedImagery:n.s.feature}function c(e){const t=d(e);let i;return t===n.s.wms||t===n.s.mapImage?i=null==e?void 0:e.layer.version:t!==n.s.imagery&&t!==n.s.feature&&t!==n.s.scene||(i=e.version),Number.parseFloat(i)}async function f(e){return new Promise((async(t,i)=>{var r,a,s,l;switch(d(e)){case n.s.feature:case n.s.ogcFeature:case n.s.stream:t(e.fields);break;case n.s.mapImage:if((null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.portalItem)&&(null===(a=e.layer)||void 0===a?void 0:a.url.indexOf("https://demographics"))>-1&&(null===(s=e.layer)||void 0===s?void 0:s.url.indexOf(".arcgis.com"))>-1)try{const i=await(null===(l=e.layer.portalItem)||void 0===l?void 0:l.fetchData());if(null==i?void 0:i.thematicGroup){const n=new Map(e.fields.map((e=>[e.name,e]))),r=i.thematicGroup.fieldNames,a=[];r.forEach((e=>{n.has(e)&&a.push(n.get(e))})),t(a)}else t(e.fields)}catch(e){i(e)}else t(e.fields);break;case n.s.imagery:const o=e;t((o.fields||[]).concat(o.rasterFields||[]));break;case n.s.imageryTile:t(e.rasterFields);break;default:t("fields"in e&&e.fields)}}))}async function y(e){return new Promise((async t=>{var i,r,a,s,l;if(d(e)===n.s.stream)t("point");else if(e.geometryType)t(e.geometryType);else if(d(e)===n.s.mapImage&&(null===(r=null===(i=null==e?void 0:e.layer)||void 0===i?void 0:i.sourceJSON)||void 0===r?void 0:r.layers)){const i=null===(s=null===(a=e.layer.sourceJSON.layers.find((t=>{if(t.id===e.id)return t})))||void 0===a?void 0:a.geometryType)||void 0===s?void 0:s.toLowerCase();if(i)i.indexOf("point")>-1?t("point"):i.indexOf("line")>-1?t("polyline"):i.indexOf("polygon")>-1?t("polygon"):t(i);else{const i=null===(l=null==e?void 0:e.layer)||void 0===l?void 0:l.findSublayerById(e.id);i?await(null==i?void 0:i.createFeatureLayer().then((async e=>{const i=await(null==e?void 0:e.load());t(null==i?void 0:i.geometryType)}))):t(null)}}else t(null)}))}function p(e,t,i){let n="";if(/^raster.(item|service)pixelvalue/i.test(e))n="number";else if(t.has(e)){const i=t.get(e);n=i.type?i.type.toLowerCase():""}else if(i.has(e)){const t=i.get(e);n=t.returnType?t.returnType.toLowerCase():""}else n="number";return n}async function m(e,t){return"feature"!==e.type||e.url?"feature"===e.type||"csv"===e.type||"scene"===e.type||"wfs"===e.type||"geojson"===e.type?await e.queryFeatureCount():!t||"stream"!==e.type&&"ogc-feature"!==e.type?void 0:async function(e,t){return(await t.whenLayerView(e)).queryFeatureCount()}(e,t):async function(e){var t;const i=e.createQuery();i.outFields=["*"];const n=await e.queryFeatures(i);if(null===(t=n.features)||void 0===t?void 0:t.length)return n.features.length;throw new Error("could not get feature count")}(e)}async function v(e){if(!e.url)throw new Error("could not get layer.url");const[t]=await(0,r.l)(["esri/rest/query/executeForCount"]),i=await t.executeForCount(e.url,{});if(i)return i;throw new Error("could not get raster count")}const g=(e,t)=>{let i=[];return null==e||e.fieldInfos.forEach((e=>{e.fieldName.includes(n.f.expression)?t&&i.push({name:e.fieldName.slice(n.f.expression.length),alias:e.fieldName.slice(n.f.expression.length),type:"string"}):i.push({name:e.fieldName,alias:e.label,type:"string"})})),i};function w(e,t){let i=0===t.indexOf("#"),n=0===t.indexOf(".");for((n||i)&&(t=t.slice(1));e;){if(i){if(e.id===t)return e}else if(n){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement}return null}function h(e){return null!=e}const b=async(e,t)=>{var i,n;const[a,s]=await(0,r.l)(["esri/rest/identify","esri/rest/support/IdentifyParameters"]),l=new s;l.geometry=t.extent,l.mapExtent=t.extent,l.returnGeometry=!0,l.tolerance=6,l.layerOption="popup",l.width=t.width,l.height=t.height,l.layerIds=[e.id];const o=null===(i=await a.identify(e.layer.url,l))||void 0===i?void 0:i.results;return null===(n=null==o?void 0:o[0])||void 0===n?void 0:n.feature},x=async(e,t,i)=>{var n;const r=await e.whenLayerView(t),a=await r.queryAggregates();return await I(i,null===(n=a.features)||void 0===n?void 0:n[0])},I=async(e,t)=>{const[i,n]=await(0,r.l)(["esri/Graphic","esri/geometry/Point"]);let a;if(t)a=t.clone();else{a=new i;const t=g(e,!1);if(null==t?void 0:t.length){const e={};t.forEach((t=>{e[t.name]=""})),a.attributes=e}const r=new n;a.geometry=r}return a};function F(e){var t;if(!e)return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}}}]);