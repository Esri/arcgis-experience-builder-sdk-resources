/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea"],{24347:(e,t,a)=>{a.r(t),a.d(t,{arcgis_smart_mapping_panels_raster_class_breaks:()=>p,arcgis_smart_mapping_panels_raster_colormap:()=>g,arcgis_smart_mapping_panels_raster_flow:()=>b,arcgis_smart_mapping_panels_raster_rgb:()=>y,arcgis_smart_mapping_panels_raster_shaded_relief:()=>k,arcgis_smart_mapping_panels_raster_stretch:()=>R,arcgis_smart_mapping_panels_raster_unique_value:()=>x,arcgis_smart_mapping_panels_raster_vector_field:()=>F});var s=a(35110),n=a(59503),l=a(61886),i=(a(21104),a(2137),a(41657)),r=a(79340),o=a(34448),c=a(69818),d=a(86587),h=a(88703),u=a(92220),m=a(1397);a(1984),a(63280),a(23505),a(89393),a(73838),a(50478);const p=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterClassBreaksClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksClose",7),this.arcgisSmartMappingPanelsRasterClassBreaksBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksBackClick",7),this.arcgisSmartMappingPanelsRasterClassBreaksError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksError",7),this.symbolNodes=[],this.labelNodes=[],this.inputNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,a=t;(0,i.a)(e,a),this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,a=e,s=a.renderer;this.originalRendererObj=t.esriLang.clone(a.renderer),this.defaultColorRamp=s.classBreakInfos.map((e=>e.symbol.color))}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){clearTimeout(this.definedIntervalChangeHandle),clearTimeout(this.classesChangeHandle)}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.classBreaks.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterClassBreaksBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"class-breaks-block",heading:e.panels.classBreaks.classBreaks,open:!0},this.renderFieldSelector(),this.renderMethod(),this.renderClasses(),this.renderDefinedInterval(),this.renderColorScheme(),this.renderColorSlider(),this.renderValues())}renderFieldSelector(){var e;const{layer:t,strings:a}=n.s,l=t.renderer.field||a.panels.classBreaks.value,i=(0,c.g)(),r=i.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.z.STRING}))),o=i.find((e=>e.name===l));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:a.panels.classBreaks.field,fieldList:r,selectedField:{field:null!==(e=null==o?void 0:o.name)&&void 0!==e?e:a.panels.classBreaks.value,simpleFieldType:n.z.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderMethod(){const{layer:e}=n.s,t=e,a=t.renderer;return(0,s.h)("arcgis-smart-mapping-method-button",{key:a.authoringInfo.classificationMethod,showDefinedInterval:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,n.l)(),onArcgisSmartMappingMethodButtonChange:e=>{var a,i;const r=t.renderer;if("manual"===e.detail)r.authoringInfo.classificationMethod="manual",(0,n.ab)(),(0,s.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300);else{let t,n=(null===(a=null==r?void 0:r.authoringInfo)||void 0===a?void 0:a.numClasses)||(null===(i=r.classBreakInfos)||void 0===i?void 0:i.length);if("defined-interval"===e.detail){const e=r.classBreakInfos;t=(e[e.length-1].maxValue-e[0].minValue)/5,n=Math.ceil((r.classBreakInfos[n-1].maxValue-r.classBreakInfos[0].minValue)/t)}(0,l.r)((0,c.b)({classificationMethod:e.detail,numClasses:n,definedInterval:t}),this.flowItemNode).then((e=>{this.updateRenderer(e.renderer),(0,s.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300)}),(e=>{(0,s.f)(this.methodButtonNode),this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{layer:e,strings:t}=n.s,a=e.renderer,l=a.classBreakInfos.length,i=a.authoringInfo.classificationMethod;return(0,s.h)("calcite-label",null,t.panels.classBreaks.classifyClasses,(0,s.h)("calcite-input-number",{tabindex:"0",value:`${l}`,disabled:"defined-interval"===i,min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,h.d)((()=>{clearTimeout(this.classesChangeHandle);const e=parseInt(this.classesNode.value);e!==l&&(!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):this.handleClassesChange())}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderDefinedInterval(){const{layer:e,strings:t}=n.s,a=e.renderer;if("defined-interval"!==a.authoringInfo.classificationMethod)return null;const l=a.classBreakInfos[0].maxValue-a.classBreakInfos[0].minValue,i=Math.floor((a.classBreakInfos[a.classBreakInfos.length-1].maxValue-a.classBreakInfos[0].minValue)/9.1),r=a.classBreakInfos[a.classBreakInfos.length-1].maxValue-a.classBreakInfos[0].minValue;return(0,s.h)("calcite-label",null,t.panels.classBreaks.definedInterval,(0,s.h)("calcite-input-number",{tabIndex:0,value:""+Math.round(100*l)/100,min:i,max:r,step:.1,scale:"s",onCalciteInputNumberInput:e=>{const t=e.target,a=parseFloat(t.value);!t.value||a<t.min||a>t.max?this.definedIntervalChangeHandle=setTimeout((()=>this.handleDefinedIntervalChange()),3e3):(clearTimeout(this.definedIntervalChangeHandle),this.handleDefinedIntervalChange())},ref:e=>this.definedIntervalNode=e}))}renderColorScheme(){const{layer:e,strings:t}=n.s,a=e,l=a.renderer.classBreakInfos.map((e=>(0,n.w)(e.symbol)));return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.classBreaks.colorScheme,type:"raster-class-breaks",rampType:"discrete",colors:l,onArcgisSmartMappingSymbolButtonSymbolChange:e=>{const t=e.target,l=a.renderer;this.defaultColorRamp=l.classBreakInfos.map((e=>e.symbol.color)),(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode),(0,s.f)(t)},ref:e=>this.symbolButtonNode=e})}renderColorSlider(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-class-breaks-color-slider",{onArcgisSmartMappingClassBreaksColorSliderChange:e=>{const a=t.renderer,n=e.detail;(null==n?void 0:n.updateValues)&&(a.authoringInfo.classificationMethod="manual"),(null==n?void 0:n.invertColors)&&(0,s.f)(this.symbolButtonNode),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode),this.defaultColorRamp=a.classBreakInfos.map((e=>e.symbol.color))},ref:e=>this.sliderNode=e})}renderValues(){const{layer:e}=n.s,t=e.renderer;return this.labelNodes=[],this.inputNodes=[],(0,s.h)("calcite-list",null,t.classBreakInfos.map(((e,t)=>this.renderValue(e,t))).reverse())}renderValue(e,t){return(0,s.h)("calcite-list-item",null,(0,s.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,t)),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{layer:a,strings:l}=n.s;let i=a.renderer.classBreakInfos[t].symbol.clone();const r={"symbol-is-white":(0,n.aq)(i),symbol:!0};return(0,s.h)("div",{class:r,tabindex:"0","aria-label":l.panels.classBreaks.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.l)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,t)}}))}renderTextNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",tabindex:"0",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if(a.stopPropagation(),"Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const{layer:t}=n.s,a=t.renderer;(0,l.r)((0,c.b)({field:e}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.fieldNode.value=a.field,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}handleDefinedIntervalChange(){const{layer:e}=n.s,t=e.renderer,a=t.classBreakInfos[0].maxValue-t.classBreakInfos[0].minValue;let s=parseFloat(this.definedIntervalNode.value);s!==a&&(isNaN(s)||s<this.definedIntervalNode.min?s=this.definedIntervalNode.min:s>this.definedIntervalNode.max&&(s=this.definedIntervalNode.max),s=parseFloat(s.toFixed(2)),this.definedIntervalNode.value=`${s}`,(0,l.r)((0,c.b)({definedInterval:s}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.definedIntervalNode.value=`${a}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)})))}handleClassesChange(){(0,n.l)();const{layer:e}=n.s,t=e.renderer,a=t.classBreakInfos.length,{authoringInfo:s}=t||{};s.numClasses=this.classesNode.value?Number.parseInt(this.classesNode.value,10):0,"manual"===s.classificationMethod&&(s.classificationMethod="equal-interval");const i=Math.min(Math.max(parseInt(this.classesNode.value),1),10)||5;`${i}`!==this.classesNode.value&&(this.classesNode.value=`${i}`),(0,l.r)((0,c.b)({numClasses:i}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.classesNode.value=`${a}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}afterCreateValueSymbol(e,t){var a;const{layer:s,modules:l}=n.s;let i=s.renderer.classBreakInfos[t].symbol.clone();for(-1===t&&i.outline&&(i.outline.width=0),(0,n.aq)(i)&&(i.outline=new l.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:r}=l;i&&r.renderPreviewHTML(i,{size:(0,n.ar)(i),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleValueSymbolClick(e){(0,n.l)();const{strings:t}=n.s,a=(0,o.c)({referenceElement:this.flowItemNode,heading:t.panels.classBreaks.colorScheme});a.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,o.r)(a),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),a.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,o.r)(a),setTimeout((()=>{this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),n.s.classedSymbolSelectedIdx=e,(0,r.b)({popoverNode:a,onChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode)}}),this.popoverNode=a,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,t){const{layer:a}=n.s,l=a.renderer,i=t.currentTarget;if(l.classBreakInfos[e].label=i.value,""===i.value){const t=l.classBreakInfos[e];t.label=`${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`,this.inputNodes[e].value=this.labelNodes[e].textContent}(0,n.ab)(),(0,s.f)(this.hostElement)}handleInversionStatus(e){const{modules:t}=n.s;if(JSON.stringify(this.defaultColorRamp[0])!==JSON.stringify(e.classBreakInfos[0].symbol.color)){let a=e.classBreakInfos.map((e=>(0,n.w)(e.symbol)||new t.esriColor({r:64,g:64,b:64,a:1})));a=a.reverse(),e.classBreakInfos.map(((e,t)=>{(0,n.w)(e.symbol)&&(0,n.v)(e.symbol,a[t])}))}else this.defaultColorRamp=e.classBreakInfos.map((e=>e.symbol.color))}updateRenderer(e){const{layer:t}=n.s,a=t;this.handleInversionStatus(e),(0,i.a)(e,a),(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode)}get hostElement(){return(0,s.d)(this)}};p.style=":host{width:100%}.flow-item{height:100%}.class-breaks-block{overflow-x:hidden;overflow-wrap:anywhere}.hidden{display:none}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}";const g=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterColormapClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapClose",7),this.arcgisSmartMappingPanelsRasterColormapBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapBackClick",7),this.inputNodes=[],this.labelNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterColormapClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,a=t;(0,i.a)(e,a),this.arcgisSmartMappingPanelsRasterColormapClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,a=e,s=a.renderer;this.originalRendererObj=t.esriLang.clone(a.renderer),s.colormapInfos.forEach(((e,t)=>{e.label||(s.colormapInfos[t].label=" ")})),(0,n.ab)()}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.colormap.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterColormapBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"colormap-block",heading:e.panels.colormap.colormap,open:!0},this.renderColormapTable())}renderColormapTable(){const{layer:e,strings:t}=n.s,a=e.renderer;this.labelNodes=[],this.inputNodes=[];const l=a.colormapInfos.map(((e,t)=>this.renderColormapRow(e,t)));return(0,s.h)("calcite-table",{class:"table",caption:t.panels.colormap.colormapTable},(0,s.h)("calcite-table-row",{slot:"table-header"},(0,s.h)("calcite-table-header",{heading:t.panels.colormap.color,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:t.panels.colormap.value,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:t.panels.colormap.label,alignment:"center"})),l)}renderColormapRow(e,t){return(0,s.h)("calcite-table-row",null,(0,s.h)("calcite-table-cell",{alignment:"center"},this.renderColorNode(e)),(0,s.h)("calcite-table-cell",{alignment:"center"},e.value),(0,s.h)("calcite-table-cell",{alignment:"center",class:"label-cell"},this.renderLabelNode(e,t)))}renderColorNode(e){return(0,s.h)("div",{class:"color",ref:t=>{t&&this.afterCreateColor(t,e)}})}renderLabelNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",tabindex:"0",ref:e=>{e&&(this.labelNodes[t]=e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{class:"hidden",tabindex:"0",ref:e=>{e&&(this.inputNodes[t]=e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}afterCreateColor(e,t){var a;const{modules:s}=n.s;for(;null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:l}=s,i=l.renderColorRampPreviewHTML([t.color.clone()],{gradient:!1,width:20,height:20});i.classList.add("colorblock"),e.appendChild(i)}handleValueTextChange(e,t){const{layer:a}=n.s,l=a.renderer,i=t.currentTarget;""===i.value?this.inputNodes[e].value=this.labelNodes[e].textContent:l.colormapInfos[e].label=i.value,(0,n.ab)(),(0,s.f)(this.hostElement)}get hostElement(){return(0,s.d)(this)}};g.style=":host{width:100%}.flow-item{height:100%}.colormap-block{overflow-x:hidden}.table{width:100%}.color{display:flex;justify-content:center}.colorblock{border:1px solid #000}.hidden{display:none}.label{padding-top:5px;padding-bottom:5px}.label:focus{outline:2px solid var(--calcite-color-brand)}.label-cell{overflow-wrap:anywhere}";const b=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterFlowClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowClose",7),this.arcgisSmartMappingPanelsRasterFlowBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowBackClick",7),this.arcgisSmartMappingPanelsRasterFlowError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterFlowClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t}=this,{layer:a}=n.s,s=a;s.effect=t,(0,i.a)(e,s),this.arcgisSmartMappingPanelsRasterFlowClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e}=n.s,t=e;this.originalRendererObj=t.renderer,this.originalEffect=t.effect}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.flow.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterFlowBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"flow-block",heading:e.panels.flow.flowStyle,open:!0},this.renderMode(),this.renderSpeed(),this.renderDensity(),this.renderLength(),this.renderWidth(),this.renderColor(),this.renderColorSlider(),this.renderDirection(),this.renderRoundCaps(),this.renderShowInLegend(),this.renderEffects())}renderMode(){const{layer:e,strings:t}=n.s,a=e.renderer,l=a.authoringInfo,i=(null==l?void 0:l.flowTheme)?"wave-front"===(null==l?void 0:l.flowTheme):a.trailLength<1;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-chip",{value:"flowline",appearance:i?"outline-fill":"solid",kind:i?"neutral":"brand",class:i?"mode-hover":"",scale:"s",onClick:()=>this.handleModeChange("flowline")},t.panels.flow.flowline),(0,s.h)("span",null,"Â "),(0,s.h)("calcite-chip",{value:"wavefront",appearance:i?"solid":"outline-fill",kind:i?"brand":"neutral",class:i?"":"mode-hover",scale:"s",onClick:()=>this.handleModeChange("wavefront")},t.panels.flow.wavefront))}renderSpeed(){const{layer:e,strings:t}=n.s,a=e.renderer,l="wave-front"===a.authoringInfo.flowTheme,{flowSpeed:i}=a;return(0,s.h)("calcite-label",null,t.panels.flow.speed,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"speed",min:0,max:l?20:40,values:[i],precision:1,minLabel:t.panels.flow.slow,maxLabel:t.panels.flow.fast}))}renderDensity(){const{layer:e,strings:t}=n.s,a=e.renderer,{density:l}=a;return(0,s.h)("calcite-label",null,t.panels.flow.density,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"density",min:.1,max:1,values:[l],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderLength(){const{layer:e,strings:t}=n.s,a=e.renderer,l="wave-front"===a.authoringInfo.flowTheme,{trailLength:i}=a;return(0,s.h)("calcite-label",null,t.panels.flow.length,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"trail-length",min:l?.1:1,max:l?50:200,values:[i/.75],precision:l?1:0,minLabel:t.panels.flow.short,maxLabel:t.panels.flow.long}))}renderWidth(){const{layer:e,strings:t}=n.s,a=e,l=a.renderer,i="wave-front"===l.authoringInfo.flowTheme,{trailWidth:r}=l,o=Math.round(r/.75*10)/10;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-label",null,t.panels.flow.width),(0,s.h)("arcgis-smart-mapping-slider-input",{min:i?Math.min(5,Math.floor(o)):.1,max:i?Math.max(12,Math.ceil(o)):Math.max(5,Math.ceil(o)),values:[o],precision:1,suffixText:t.panels.flow.px,onArcgisSmartMappingSliderInputChange:e=>{const t=a.renderer,s=e.detail,{trailWidth:l}=t;s!==Math.round(l/.75*10)/10&&(t.trailWidth=.75*s,(0,n.ab)())}}))}renderColor(){const{layer:e,strings:t}=n.s,a=e.renderer,l=(0,n.a)(a,"color");return(0,s.h)("calcite-radio-button-group",{class:"block-content-padding",name:"colorType",layout:"vertical",onCalciteRadioButtonGroupChange:e=>this.handleColorTypeChange(e.target.selectedItem.value)},(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!l,value:"singleColor",ref:e=>this.singleColorNode=e}),t.panels.flow.singleColor),!l&&this.renderSingleColor()),(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!!l,value:"colorRamp",ref:e=>this.colorRampNode=e}),t.panels.flow.colorRamp),l&&this.renderColorRamp()))}renderSingleColor(){const{layer:e}=n.s,t=e.renderer,{color:a}=t,l=(0,n.aj)();return l.color=a,l.outline.color=a,(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:l,hideLabel:!0,type:"raster-flow",rampType:"continuous",onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement)}}))}renderColorRamp(){const{layer:e}=n.s,t=e.renderer,a=(0,n.a)(t,"color");if(!a)return;const l=a.stops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{colors:l,hideLabel:!0,type:"raster-flow",rampType:"continuous",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement),this.flowColorSliderNode&&(0,s.f)(this.flowColorSliderNode)}}))}renderColorSlider(){const{layer:e}=n.s,t=e.renderer;return(0,n.a)(t,"color")?(0,s.h)("arcgis-smart-mapping-flow-color-slider",{ref:e=>{e&&(this.flowColorSliderNode=e)},onArcgisSmartMappingFlowColorSliderChange:()=>{(0,s.f)(this.hostElement),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)},onArcgisSmartMappingFlowColorSliderError:e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e.detail)}):null}renderDirection(){const{layer:e,strings:t}=n.s,a=e.renderer,{flowRepresentation:l}=a;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"block-content-padding"},t.panels.flow.flowDirection,(0,s.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",onCalciteSegmentedControlChange:e=>this.handleDirectionChange(e.target.selectedItem.value)},(0,s.h)("calcite-segmented-control-item",{value:"to",checked:"flow-from"!==l},t.panels.flow.to),(0,s.h)("calcite-segmented-control-item",{value:"from",checked:"flow-from"===l},t.panels.flow.from)))}renderRoundCaps(){const{layer:e,strings:t}=n.s,a=e.renderer,{trailWidth:l,authoringInfo:i}=a,r="flow-line"===i.flowTheme,o="round"===a.trailCap,c=Math.round(1e3*l)/1e3>3;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.roundEndCaps,(0,s.h)("calcite-switch",{ref:e=>{e&&(this.roundCapToggleNode=e)},disabled:!c,scale:"s",checked:o,onCalciteSwitchChange:()=>this.handleRoundCapsToggle()})),r?(0,s.h)("div",{class:"hint-text "+(c?"":"disabled")},t.panels.flow.forWideLines):null)}renderShowInLegend(){const{layer:e,strings:t}=n.s,a=e.renderer,l=(0,n.a)(a,"color");if(!l)return null;const i=l.legendOptions,r=!i||!1!==i.showLegend;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"toggle-text toggles block-content-padding"},t.panels.flow.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:r,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderEffects(){const{layer:e,strings:t}=n.s,a=e;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.layerEffects,(0,s.h)("calcite-switch",{scale:"s",checked:!!a.effect,onCalciteSwitchChange:()=>this.handleEffectToggle()})),(0,s.h)("div",{class:"hint-text"},t.panels.flow.adjustEffects))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleModeChange(e){const{layer:t}=n.s,a=t,i=a.renderer.authoringInfo,r="wave-front"===i.flowTheme,o="wave-front"===i.flowTheme?"flow-line":"wave-front";(!r&&"wavefront"===e||r&&"flowline"===e)&&((0,n.l)(),(0,l.r)((0,u.a)({flowTheme:o}),this.flowItemNode).then((e=>{a.renderer=e.renderer.clone(),this.roundCapToggleNode.checked=!1,(0,s.f)(this.hostElement)}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e))))}handleColorTypeChange(e){(0,n.l)();const{layer:t}=n.s,a=t,i={includeColorVariable:"colorRamp"===e};"colorRamp"!==e?this.lastFlowTheme=(0,u.f)():this.lastFlowTheme&&(i.flowScheme=this.lastFlowTheme),(0,l.r)((0,u.a)(i),this.flowItemNode).then((e=>{a.renderer=e.renderer.clone(),(0,n.ab)(),(0,s.f)(this.hostElement)}),(e=>{this.singleColorNode.checked?(this.singleColorNode.checked=!1,this.colorRampNode.checked=!0):(this.colorRampNode.checked=!1,this.singleColorNode.checked=!0),this.arcgisSmartMappingPanelsRasterFlowError.emit(e)}))}handleDirectionChange(e){const{layer:t}=n.s;t.renderer.flowRepresentation="from"===e?"flow-from":"flow-to",(0,n.ab)()}handleRoundCapsToggle(){const{layer:e}=n.s,t=e.renderer;t.trailCap="round"===t.trailCap?"butt":"round",(0,n.ab)()}handleIncludeInLegendToggle(){const{layer:e}=n.s,t=e.renderer,a=(0,n.a)(t,"color"),s=a.legendOptions;s&&!1===s.showLegend?s.title?s.showLegend=!0:a.legendOptions=void 0:(a.legendOptions=s||{},a.legendOptions.showLegend=!1),(0,n.ab)()}handleEffectToggle(){const{layer:e}=n.s,t=e,a=t.renderer;if(t.effect)t.effect=void 0;else{const e=a.authoringInfo;(0,u.c)({flowTheme:e.flowTheme}).then((e=>{t.effect=e.layerEffect,(0,n.ab)()}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e)))}}get hostElement(){return(0,s.d)(this)}};var f;b.style=":host{width:100%}.flow-item{height:100%}.flow-block{overflow-x:hidden}.block-content-padding{padding-bottom:10px}.block-content-padding-large{padding-bottom:20px}.symbol-button-padding{padding-bottom:12px}.mode-hover{cursor:pointer}.toggles{padding-top:10px}.toggle-text{width:100%}.hint-text{font-size:smaller;margin-top:-8px}.hint-text.disabled{opacity:0.5}",function(e){e[e.ALL=-1]="ALL",e[e.RED=0]="RED",e[e.GREEN=1]="GREEN",e[e.BLUE=2]="BLUE"}(f||(f={}));const v={min:0,max:255,avg:0,stddev:0},y=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterRgbClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbClose",7),this.arcgisSmartMappingPanelsRasterRgbBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbBackClick",7),this.arcgisSmartMappingPanelsRasterRgbError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterRgbClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a,originalStatistics:s}=this,{layer:l}=n.s,r=l;r.effect=t,r.bandIds=a,r.rasterInfo.statistics=s,(0,i.a)(e,r),this.arcgisSmartMappingPanelsRasterRgbClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){var e;const{layer:t,modules:a}=n.s,s=t,{statistics:l}=s.rasterInfo;s.bandIds||(s.bandIds=await(0,n.as)(s)),this.originalRendererObj=a.esriLang.clone(s.renderer),this.originalEffect=s.effect,this.originalBandCombination=s.bandIds,this.originalStatistics=null!==(e=a.esriLang.clone(l))&&void 0!==e?e:[];const i=s.renderer;(0,n.ac)(l)||(0,n.ac)(i.statistics[0])||(i.statistics=new Array(3).fill(v)),!Array.isArray(i.statistics)||i.statistics.length||i.dynamicRangeAdjustment||(i.statistics=s.bandIds.map((e=>this.originalStatistics[e]))),this.rendererStatisticsSelection=s.bandIds[0],this.setGammaDisplay(),this.percentLabelFlip=(0,n.at)(this.hostElement),this.currentStatistics=[],s.bandIds.forEach((e=>this.currentStatistics.push(a.esriLang.clone(i.statistics[e]))))}componentDidLoad(){const{layer:e}=n.s,t=e.renderer,{stretchType:a=n.aw.STRETCH_TYPE}=t||{},s=a===n.av.PERCENT_CLIP,l=a===n.av.NONE,{dynamicRangeAdjustment:i}=t;!i&&!(l||s)&&this.updateStatisticsDisplay(t.statistics[0]),requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.rgb.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterRgbBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"rgb-block",heading:e.panels.rgb.rgb,open:!0},this.renderRgbBandSelectors(),this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderGammaBlock(),this.renderIndividualGammaToggle(),this.renderRangeAdjustmentToggle(),this.renderStatistics())}renderRgbBandSelectors(){const{layer:e,strings:t}=n.s,a=e,{rasterInfo:l}=a,{bandInfos:i}=l,r=i.map((e=>e.name)),{red:o,green:c,blue:d}=t.panels.rgb,h=[o,c,d].map(((e,t)=>(0,s.h)("calcite-label",null,e,(0,s.h)("calcite-combobox",{label:e,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:s=>{const l=s.target,i=a.renderer;a.bandIds[t]=r.indexOf(l.value);const o=a.bandIds[t];i.statistics[t]=this.currentStatistics[o],this.statisticsControlNode&&e===this.statisticsControlNode.value&&(this.rendererStatisticsSelection=o,this.updateStatisticsDisplay(i.statistics[t])),(0,n.ab)()}},r.map(((e,a)=>this.renderBandOptions(e,a,t)))))));return(0,s.h)(s.F,null,h)}renderBandOptions(e,t,a){const{layer:l}=n.s,i=l.bandIds[a];return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:i===t})}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.l)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const a=e.target;(0,l.r)((0,n.au)({stretchType:e.detail}),this.flowItemNode).then((l=>{"none"===e.detail&&(l.renderer.dynamicRangeAdjustment=!1),this.rendererStatisticsSelection=t.bandIds[0],(0,i.a)(l.renderer,t),(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(a)}),(e=>this.arcgisSmartMappingPanelsRasterRgbError.emit(e)))}})}renderStandardDeviationSection(){const{layer:e,strings:t}=n.s,a=e.renderer,{stretchType:l=n.aw.STRETCH_TYPE}=a||{};if(l!==n.av.STANDARD_DEVIATION)return null;let{numberOfStandardDeviations:i}=a||{};return(0,n.ac)(i)&&0!==i||(i=n.aw.STD_DEV),(0,s.h)("calcite-label",null,t.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:t.panels.rgb.stddev,scale:"s",tabindex:"0",min:1,max:100,step:.1,value:`${i}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{layer:e}=n.s,t=e.renderer,{stretchType:a=n.aw.STRETCH_TYPE}=t||{};if(a!==n.av.PERCENT_CLIP)return null;let{minPercent:l,maxPercent:i}=t||{};return(!(0,n.ac)(l)||l<=0||l>=100)&&(l=n.aw.MIN_PERCENT),(!(0,n.ac)(i)||i<=0||i>=100)&&(i=n.aw.MAX_PERCENT),l=parseFloat(l.toFixed(1)),i=parseFloat(i.toFixed(1)),t.minPercent=l,t.maxPercent=i,(0,n.ab)(),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",l),this.renderPercentClipSectionInput("max",i))}renderPercentClipSectionInput(e,t){const{percentLabelFlip:a}=this,{strings:l}=n.s;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,l.panels.rgb[e],(0,s.h)("calcite-input-number",{label:l.panels.rgb[e],scale:"s",min:.1,max:99.9,step:.1,prefixText:a?"%":void 0,suffixText:a?void 0:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderIndividualGammaToggle(){const{strings:e}=n.s;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"individual-gamma-label"},e.panels.rgb.individualGamma,(0,s.h)("calcite-switch",{scale:"s",checked:this.changeIndividualGamma,onCalciteSwitchChange:e=>this.handleGammaToggle(e)}))}renderGammaBlock(){const{layer:e,strings:t}=n.s,a=e.renderer,{gamma:l=n.aw.GAMMA}=a||{},i=Array.isArray(a.gamma)?a.gamma[0]:a.gamma,r=l[f.RED]||i,o=l[f.GREEN]||i,c=l[f.BLUE]||i;return(0,s.h)("calcite-label",null,t.panels.rgb.gamma,this.changeIndividualGamma?(0,s.h)("div",{class:"individual-gamma-selection"},this.renderIndividualGamma(r,"red"),this.renderIndividualGamma(o,"green"),this.renderIndividualGamma(c,"blue")):(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:Array.isArray(l)?l[0]:l,rendererType:"raster-rgb"}))}renderIndividualGamma(e,t){const{strings:a}=n.s;return(0,s.h)("div",{class:"individual-gamma-selection-value"},(0,s.h)("calcite-label",null,a.panels.rgb[t],(0,s.h)("calcite-input-number",{label:a.panels.rgb[t],numberButtonType:"none",tabindex:"0",scale:"s",value:`${e}`,min:.1,max:10,step:.1,onCalciteInputNumberInput:e=>{clearTimeout(this.individualGammaHandle);const a=e.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handleIndividualGammaChange(a,t):this.individualGammaHandle=setTimeout((()=>this.handleIndividualGammaChange(a,t)),3e3)}})))}renderRangeAdjustmentToggle(){const{layer:e,strings:t}=n.s,a=e.renderer,{dynamicRangeAdjustment:l}=a,{stretchType:i=n.aw.STRETCH_TYPE}=a||{};return i===n.av.NONE?null:(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.rgb.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.hostElement)}}))}renderStatistics(){const{layer:e,strings:t}=n.s,a=e,l=a.renderer,{stretchType:i=n.aw.STRETCH_TYPE}=l||{},r=i===n.av.PERCENT_CLIP,o=i===n.av.NONE,{dynamicRangeAdjustment:c}=l;return c||o||r?null:(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.panels.rgb.statistics,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const s=a.renderer,n=e.target.value,l=n===t.panels.rgb.red?a.bandIds[0]:n===t.panels.rgb.green?a.bandIds[1]:a.bandIds[2],i=n===t.panels.rgb.red?s.statistics[0]:n===t.panels.rgb.green?s.statistics[1]:s.statistics[2];this.rendererStatisticsSelection=l,this.updateStatisticsDisplay(i)},ref:e=>this.statisticsControlNode=e},(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.red,checked:this.rendererStatisticsSelection===a.bandIds[0]},t.panels.rgb.red),(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.green,checked:this.rendererStatisticsSelection===a.bandIds[1]&&this.rendererStatisticsSelection!==a.bandIds[0]},t.panels.rgb.green),(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.blue,checked:this.rendererStatisticsSelection===a.bandIds[2]&&this.rendererStatisticsSelection!==a.bandIds[0]&&this.rendererStatisticsSelection!==a.bandIds[1]},t.panels.rgb.blue))),this.renderStatisticsDisplay())}renderStatisticsDisplay(){var e,t,a,l,i,r,o,c,d,u,m,p,g,b;const{layer:f,strings:v}=n.s,y=f,C=y.renderer,{stretchType:S=n.aw.STRETCH_TYPE}=C||{},N=S===n.av.PERCENT_CLIP,w=S===n.av.STANDARD_DEVIATION,k=null!==y.rasterInfo.statistics,I=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0,R=(!k||N)&&!w,{min:x=(null!==(l=null===(a=null===(t=this.currentStatistics)||void 0===t?void 0:t[I])||void 0===a?void 0:a[0])&&void 0!==l?l:0),max:T=(null!==(o=null===(r=null===(i=this.currentStatistics)||void 0===i?void 0:i[I])||void 0===r?void 0:r[1])&&void 0!==o?o:255),avg:B=(null!==(u=null===(d=null===(c=this.currentStatistics)||void 0===c?void 0:c[I])||void 0===d?void 0:d[2])&&void 0!==u?u:0),stddev:E=(null!==(g=null===(p=null===(m=this.currentStatistics)||void 0===m?void 0:m[I])||void 0===p?void 0:p[3])&&void 0!==g?g:0)}=(null===(b=this.currentStatistics)||void 0===b?void 0:b[null!=I?I:0])||{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,v.panels.rgb.min,(0,s.h)("calcite-input-number",{label:v.panels.rgb.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(x)?this.round(x):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e,t;clearTimeout(this.minStatisticHandle);const a=parseFloat(this.minNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;!isNaN(a)&&a<=(null!==(t=this.currentStatistics[s].max)&&void 0!==t?t:this.currentStatistics[s][1])?(this.minNode.value=`${a}`,this.handleStatisticsChange(a,s,"min")):this.minStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[s].min)&&void 0!==e?e:this.currentStatistics[s][0];this.minNode.value=`${this.round(t)}`}),3e3)}),300),ref:e=>{e&&(this.minNode=e)}})),(0,s.h)("calcite-label",null,v.panels.rgb.max,(0,s.h)("calcite-input-number",{label:v.panels.rgb.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(T)?this.round(T):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e,t;clearTimeout(this.maxStatisticHandle);const a=parseFloat(this.maxNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;!isNaN(a)&&a>=(null!==(t=this.currentStatistics[s].min)&&void 0!==t?t:this.currentStatistics[s][0])?(this.maxNode.value=`${a}`,this.handleStatisticsChange(a,s,"max")):this.maxStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[s].max)&&void 0!==e?e:this.currentStatistics[s][1];this.maxNode.value=`${this.round(t)}`}),3e3)}),300),ref:e=>{e&&(this.maxNode=e)}})),(0,s.h)("calcite-label",null,v.panels.rgb.mean,(0,s.h)("calcite-input-number",{label:v.panels.rgb.mean,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.ac)(B)?this.round(B):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;clearTimeout(this.avgStatisticHandle);const t=parseFloat(this.avgNode.value),a=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;isNaN(t)?this.avgStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[a].avg)&&void 0!==e?e:this.currentStatistics[a][2];this.avgNode.value=`${this.round(t)}`}),3e3):(this.avgNode.value=`${t}`,this.handleStatisticsChange(t,a,"avg"))}),300),ref:e=>{e&&(this.avgNode=e)}})),(0,s.h)("calcite-label",null,v.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:v.panels.rgb.stddev,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.ac)(E)?this.round(E):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;clearTimeout(this.stddevStatisticHandle);const t=parseFloat(this.stddevNode.value),a=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;isNaN(t)?this.stddevStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[a].stddev)&&void 0!==e?e:this.currentStatistics[a][3];this.stddevNode.value=`${this.round(t)}`}),3e3):(this.stddevNode.value=`${t}`,this.handleStatisticsChange(t,a,"stddev"))}),300),ref:e=>{e&&(this.stddevNode=e)}})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}setGammaDisplay(){const{layer:e}=n.s,t=e.renderer,{gamma:a=n.aw.GAMMA}=t||{},s=Array.isArray(t.gamma)?t.gamma[0]:t.gamma,l=a[f.RED]||s,i=a[f.GREEN]||s,r=a[f.BLUE]||s;this.changeIndividualGamma=l!==i||l!==r||i!==r}handlePercentOrStddevChange(e,t){const{layer:a}=n.s,s=a.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"min"===t?s.minPercent=l:"max"===t?s.maxPercent=l:s.numberOfStandardDeviations=l,(0,n.ab)()}handleGammaToggle(e){const{layer:t}=n.s,a=t.renderer;this.changeIndividualGamma=!this.changeIndividualGamma,e.target.checked||(a.gamma=new Array(3).fill(a.gamma[0]),a.useGamma=!0),(0,n.ab)(),(0,s.f)(this.hostElement)}handleIndividualGammaChange(e,t){const{layer:a}=n.s,s=a.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"red"===t?s.gamma[f.RED]=l:"green"===t?s.gamma[f.GREEN]=l:s.gamma[f.BLUE]=l,s.useGamma=!0,(0,n.ab)()}handleDRAToggle(e){const{layer:t}=n.s,a=t,s=a.renderer;if(s.dynamicRangeAdjustment=e,e)s.statistics=[];else{const e=a.bandIds.map((e=>this.currentStatistics[e]));s.statistics=e}(0,n.ab)()}handleStatisticsChange(e,t,a){const{layer:s}=n.s,l=s,i=l.renderer,r="min "===a?0:"max"===a?1:"avg"===a?2:3;this.currentStatistics[t][a]?this.currentStatistics[t][a]=e:this.currentStatistics[t][r]=e;const o=[];l.bandIds.forEach(((e,a)=>{e===t&&o.push(a)})),o.forEach((e=>i.statistics[e]=this.currentStatistics[t])),(0,n.ab)()}updateStatisticsDisplay(e){const{min:t=e[0],max:a=e[1],avg:s=e[2],stddev:l=e[3]}=e;this.minNode.value=`${(0,n.ac)(t)?this.round(t):""}`,this.maxNode.value=`${(0,n.ac)(a)?this.round(a):""}`,this.avgNode.value=`${(0,n.ac)(s)?this.round(s):""}`,this.stddevNode.value=`${(0,n.ac)(l)?this.round(l):""}`}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.individualGammaHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get hostElement(){return(0,s.d)(this)}};y.style=":host{width:100%}.flow-item{height:100%}.rgb-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.individual-gamma-label,.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}.individual-gamma-selection{display:flex;justify-content:space-between}.individual-gamma-selection-value{display:flex;flex-flow:column;justify-content:space-between;width:30%}";const C="traditional",S="multi-directional",N="none",w={azimuth:315,altitude:45,pixelSizePower:.664,pixelSizeFactor:.024,zFactor:1},k=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterShadedReliefClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefClose",7),this.arcgisSmartMappingPanelsRasterShadedReliefBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefBackClick",7),this.arcgisSmartMappingPanelsRasterShadedReliefError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefError",7),this.handles=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,a=t;(0,i.a)(e,a),this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,a=e;this.originalRendererObj=t.esriLang.clone(a.renderer)}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.handles.forEach((e=>clearTimeout(e)))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.shadedRelief.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterShadedReliefBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"shaded-relief-block",heading:e.panels.shadedRelief.shadedRelief,open:!0},this.renderHillshadeTypeSelector(),this.renderColorScheme(),this.renderAzimuthSlider(),this.renderAltitudeSlider(),this.renderScalingSelector(),this.renderZFactorAndPixelInputs())}renderHillshadeTypeSelector(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-hillshade-type-button",{onArcgisSmartMappingHillshadeTypeButtonBeforeOpen:()=>(0,n.l)(),onArcgisSmartMappingHillshadeTypeButtonChange:e=>{const a=e.target,l=e.detail;t.renderer.hillshadeType=l,(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(a)}})}renderColorScheme(){const{layer:e,strings:t}=n.s,a=e.renderer,{colorRamp:l}=a||{},r=(0,i.n)(l);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.shadedRelief.colorScheme,type:"raster-shaded-relief",rampType:"continuous",colors:r,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement)}})}renderAzimuthSlider(){const{layer:e,strings:t}=n.s,a=e.renderer,{hillshadeType:l=S,azimuth:i=w.azimuth}=a||{};return l===C?(0,s.h)("calcite-label",null,t.panels.shadedRelief.azimuth,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"azimuth",min:0,max:360,values:[i],precision:1,minLabel:"0",maxLabel:"360"})):null}renderAltitudeSlider(){const{layer:e,strings:t}=n.s,a=e.renderer,{hillshadeType:l=S,altitude:i=w.altitude}=a||{};return l===C?(0,s.h)("calcite-label",null,t.panels.shadedRelief.altitude,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"altitude",min:0,max:90,values:[i],precision:1,minLabel:"0",maxLabel:"90"})):null}renderScalingSelector(){const{layer:e,strings:t}=n.s,a=e.renderer,{scalingType:l=N}=a||{},i=t.panels.shadedRelief.scalingOptions;return(0,s.h)("calcite-label",null,t.panels.shadedRelief.scaling,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const t=e.target;this.handleScalingOptionChange(t.value)}},(0,s.h)("calcite-segmented-control-item",{value:"none",checked:"none"===l},i.none),(0,s.h)("calcite-segmented-control-item",{value:"adjusted",checked:"adjusted"===l},i.adjusted)))}renderZFactorAndPixelInputs(){const{layer:e,strings:t}=n.s,a=e.renderer,{scalingType:l=N}=a||{},i=["zFactor"];return"adjusted"===l&&(i.push("pixelSizePower"),i.push("pixelSizeFactor")),(0,s.h)(s.F,null,i.map(((e,n)=>{var l;return(0,s.h)("calcite-label",null,t.panels.shadedRelief[e],(0,s.h)("calcite-input-number",{label:t.panels.shadedRelief[e],tabindex:"0",min:0,step:.1,scale:"s",value:`${null!==(l=a[e])&&void 0!==l?l:w[e]}`,onCalciteInputNumberInput:t=>{const a=t.target;""===a.value||parseFloat(a.value)<0?this.handles[n]=setTimeout((()=>this.handleZFactorOrPixelChange(a,e)),3e3):(clearTimeout(this.handles[n]),setTimeout((()=>this.handleZFactorOrPixelChange(a,e)),300))}}))})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleScalingOptionChange(e){const{layer:t}=n.s;t.renderer.scalingType=e,(0,n.ab)(),(0,s.f)(this.hostElement)}handleZFactorOrPixelChange(e,t){const{layer:a}=n.s,s=a.renderer;let l=parseFloat(e.value);(isNaN(l)||l<e.min)&&(l=e.min),e.value=`${l}`,s[t]=l,(0,n.ab)()}get hostElement(){return(0,s.d)(this)}};k.style=":host{width:100%}.flow-item{height:100%}.shaded-relief-block{overflow-x:hidden}";const I={min:0,max:255,avg:0,stddev:0},R=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterStretchClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchClose",7),this.arcgisSmartMappingPanelsRasterStretchBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchBackClick",7),this.arcgisSmartMappingPanelsRasterStretchError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterStretchClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a,originalStatistics:s}=this,{layer:l}=n.s,r=l;r.effect=t,r.bandIds=a,r.rasterInfo.statistics=s,(0,i.a)(e,r),this.arcgisSmartMappingPanelsRasterStretchClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){var e,t,a,s;const{layer:l,modules:i}=n.s,r=l,o=r.renderer,{statistics:c}=r.rasterInfo;this.originalRendererObj=i.esriLang.clone(r.renderer),this.originalEffect=r.effect,this.originalBandCombination=r.bandIds,this.originalStatistics=null!==(e=i.esriLang.clone(c))&&void 0!==e?e:[],this.currentStatistics=null!==(t=i.esriLang.clone(c))&&void 0!==t?t:[],1!==(null===(a=r.bandIds)||void 0===a?void 0:a.length)&&(r.bandIds=[0]),this.isAnEmptyArray(o.statistics)&&(o.statistics=[this.originalStatistics[0]]);const d=null!==(s=r.bandIds[0])&&void 0!==s?s:n.ax.BAND_INDEX;(0,n.ac)(c)||(0,n.ac)(o.statistics[0])||(o.statistics[0]={min:0,max:255,avg:0,stddev:0},this.currentStatistics[d]=o.statistics[0]);const h=o.statistics;this.isAnEmptyArray(h)&&!o.dynamicRangeAdjustment?(this.currentStatistics[d]={min:0,max:255,avg:0,stddev:0},o.statistics=[this.currentStatistics[d]]):this.currentStatistics[d]=o.statistics[0]}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.stretch.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterStretchBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"stretch-block",heading:e.panels.stretch.stretch,open:!0},this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderBandSelector(),this.renderGammaSlider(),this.renderColorScheme(),this.renderRangeAdjustmentToggle(),this.renderStatisticsTable())}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.l)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const a=e.target,r=e.detail;(0,l.r)((0,n.ay)({stretchType:r}),this.flowItemNode).then((e=>{var l;const o=null!==(l=t.bandIds[0])&&void 0!==l?l:n.ax.BAND_INDEX;(0,n.ac)(this.currentStatistics)&&(e.renderer.statistics=[this.currentStatistics[o]]),"none"===r&&(e.renderer.dynamicRangeAdjustment=!1,e.renderer.colorRamp=null),(0,i.a)(e.renderer,t),(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(a)}),(e=>{(0,s.f)(a),this.arcgisSmartMappingPanelsRasterStretchError.emit(e)}))}})}renderStandardDeviationSection(){const{layer:e,strings:t}=n.s,a=e.renderer,{stretchType:l=n.ax.STRETCH_TYPE}=a||{};if(l!==n.az.STANDARD_DEVIATION)return null;let{numberOfStandardDeviations:i}=a||{};return(0,n.ac)(i)&&0!==i||(i=n.ax.STD_DEV),(0,s.h)("calcite-label",null,t.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:t.panels.stretch.stddev,scale:"s",tabindex:"0",min:1,max:100,step:.1,value:`${i}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{layer:e}=n.s,t=e.renderer,{stretchType:a=n.ax.STRETCH_TYPE}=t||{};if(a!==n.az.PERCENT_CLIP)return null;let{minPercent:l,maxPercent:i}=t||{};return(!(0,n.ac)(l)||l<=0||l>=100)&&(l=n.ax.MIN_PERCENT),(!(0,n.ac)(i)||i<=0||i>=100)&&(i=n.ax.MAX_PERCENT),l=parseFloat(l.toFixed(1)),i=parseFloat(i.toFixed(1)),t.minPercent=l,t.maxPercent=i,(0,n.ab)(),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",l),this.renderPercentClipSectionInput("max",i))}renderPercentClipSectionInput(e,t){const{strings:a}=n.s;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,a.panels.stretch[e],(0,s.h)("calcite-input-number",{label:a.panels.stretch[e],scale:"s",min:.1,max:99.9,step:.1,suffixText:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderBandSelector(){const{layer:e,strings:t}=n.s,a=e,{bandCount:l}=a.rasterInfo;if(!(l>1))return null;const{bandInfos:i}=a.rasterInfo,r=i.map((e=>e.name));return(0,s.h)("calcite-label",null,t.panels.stretch.band,(0,s.h)("calcite-combobox",{label:t.panels.stretch.band,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:e=>{var t,l;const i=e.target,o=a.renderer;a.bandIds=[r.indexOf(i.value)];const c=null!==(t=a.bandIds[0])&&void 0!==t?t:n.ax.BAND_INDEX;o.statistics=[null!==(l=this.currentStatistics[c])&&void 0!==l?l:I],(0,n.ab)(),(0,s.f)(this.hostElement)}},r.map(((e,t)=>this.renderBandOptions(e,t)))))}renderBandOptions(e,t){var a;const{layer:l}=n.s,i=null!==(a=l.bandIds[0])&&void 0!==a?a:n.ax.BAND_INDEX;return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:i===t})}renderGammaSlider(){var e;const{layer:t,strings:a}=n.s,l=t.renderer;let{gamma:i=n.ax.GAMMA}=l||{};(0,n.ac)(i)||(i=n.ax.GAMMA),Array.isArray(i)&&(i=null!==(e=i[0])&&void 0!==e?e:n.ax.GAMMA);const{stretchType:r=n.ax.STRETCH_TYPE}=l||{};return r===n.az.NONE?null:(0,s.h)("calcite-label",null,a.panels.stretch.gamma,(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:i,rendererType:"raster-stretch"}))}renderColorScheme(){const{layer:e,strings:t}=n.s,a=e.renderer,{stretchType:l=n.ax.STRETCH_TYPE}=a||{};if(l===n.az.NONE)return null;const{colorRamp:r}=a||{},o=(0,i.n)(r);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.stretch.colorScheme,type:"raster-stretch",rampType:"continuous",colors:o,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement)}})}renderRangeAdjustmentToggle(){const{layer:e,strings:t}=n.s,a=e.renderer,{dynamicRangeAdjustment:l}=a,{stretchType:i=n.ax.STRETCH_TYPE}=a||{};return i===n.az.NONE?null:(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.stretch.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.hostElement)}}))}renderStatisticsTable(){var e;const{originalStatistics:t}=this,{layer:a,modules:l,strings:i}=n.s,r=a,o=r.renderer,{stretchType:c=n.ax.STRETCH_TYPE}=o||{},d=c===n.az.PERCENT_CLIP,u=c===n.az.NONE,m=c===n.az.STANDARD_DEVIATION,{dynamicRangeAdjustment:p}=o;if(p||u||d)return null;const g=null!==r.rasterInfo.statistics;let{statistics:b}=o||{};(!b||Array.isArray(b)&&b.length<1)&&(b=l.esriLang.clone(t));const f=null!==(e=r.bandIds[0])&&void 0!==e?e:n.ax.BAND_INDEX,v=(!g||d)&&!m,{min:y=0,max:C=255,avg:S=0,stddev:N=0}=(null==b?void 0:b[0])||{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,i.panels.stretch.statistics),(0,s.h)("calcite-label",null,i.panels.stretch.min,(0,s.h)("calcite-input-number",{label:i.panels.stretch.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(y)?this.round(y):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{clearTimeout(this.minStatisticHandle);const e=parseFloat(this.minNode.value);!isNaN(e)&&e<=this.currentStatistics[f].max?(this.minNode.value=`${e}`,this.handleStatisticsChange(e,f,"min")):this.minStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[f].min);this.minNode.value=`${e}`}),3e3)}),300),ref:e=>this.minNode=e})),(0,s.h)("calcite-label",null,i.panels.stretch.max,(0,s.h)("calcite-input-number",{label:i.panels.stretch.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(C)?this.round(C):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{clearTimeout(this.maxStatisticHandle);const e=parseFloat(this.maxNode.value);!isNaN(e)&&e>=this.currentStatistics[f].min?(this.maxNode.value=`${e}`,this.handleStatisticsChange(e,f,"max")):this.maxStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[f].max);this.maxNode.value=`${e}`}),3e3)}),300),ref:e=>this.maxNode=e})),(0,s.h)("calcite-label",null,i.panels.stretch.mean,(0,s.h)("calcite-input-number",{label:i.panels.stretch.mean,scale:"s",step:.1,disabled:v,numberButtonType:"none",value:`${(0,n.ac)(S)?this.round(S):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{clearTimeout(this.avgStatisticHandle);const e=parseFloat(this.avgNode.value);isNaN(e)?this.avgStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[f].avg);this.avgNode.value=`${e}`}),3e3):(this.avgNode.value=`${e}`,this.handleStatisticsChange(e,f,"avg"))}),300),ref:e=>this.avgNode=e})),(0,s.h)("calcite-label",null,i.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:i.panels.stretch.stddev,scale:"s",step:.1,disabled:v,numberButtonType:"none",value:`${(0,n.ac)(N)?this.round(N):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{clearTimeout(this.stddevStatisticHandle);const e=parseFloat(this.stddevNode.value);isNaN(e)?this.stddevStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[f].stddev);this.stddevNode.value=`${e}`}),3e3):(this.stddevNode.value=`${e}`,this.handleStatisticsChange(e,f,"stddev"))}),300),ref:e=>this.stddevNode=e})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handlePercentOrStddevChange(e,t){const{layer:a}=n.s,s=a.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"min"===t?s.minPercent=l:"max"===t?s.maxPercent=l:s.numberOfStandardDeviations=l,(0,n.ab)()}handleDRAToggle(e){var t;const{layer:a}=n.s,s=a,l=s.renderer,i=null!==(t=s.bandIds[0])&&void 0!==t?t:n.ax.BAND_INDEX;l.dynamicRangeAdjustment=e,l.statistics=e?[]:[this.currentStatistics[i]],(0,n.ab)()}handleStatisticsChange(e,t,a){const{layer:s}=n.s,l=s.renderer;this.currentStatistics[t][a]=e,l.statistics=[this.currentStatistics[t]],(0,n.ab)()}isAnEmptyArray(e){return Array.isArray(e)?0===e.length:null==e}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get hostElement(){return(0,s.d)(this)}};R.style=":host{width:100%}.flow-item{height:100%}.stretch-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}";const x=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueClose",7),this.arcgisSmartMappingPanelsRasterUniqueValueBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueBackClick",7),this.arcgisSmartMappingPanelsRasterUniqueValueError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueError",7),this.inputNodes=[],this.labelNodes=[],this.colorNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,a=t;(0,i.a)(e,a),this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,mapView:t,modules:a,strings:s}=n.s,l=e,r=l.renderer,o=(0,i.g)();n.s.lastDefault={defaultSymbol:r.defaultSymbol||(0,n.T)(l,t,o),defaultLabel:r.defaultLabel||s.panels.uniqueValue.other},this.originalRendererObj=a.esriLang.clone(l.renderer)}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){(0,n.ae)()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.uniqueValue.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"unique-value-block",heading:e.panels.uniqueValue.uniqueValue,open:!0},this.renderFieldSelector(),this.renderColorScheme(),this.renderValues())}renderFieldSelector(){var e;const{layer:t,strings:a}=n.s,l=t.renderer.field||a.panels.uniqueValue.value,i=(0,n.aA)(),r=i.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.z.STRING}))),o=i.find((e=>e.name===l));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:a.panels.uniqueValue.field,fieldList:r,selectedField:{field:null!==(e=null==o?void 0:o.name)&&void 0!==e?e:a.panels.uniqueValue.value,simpleFieldType:n.z.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderColorScheme(){var e;const{layer:t,mapView:a,modules:l,strings:r}=n.s,o=t.renderer,c=o.uniqueValueInfos;if(!c.length)return null;const d=l.typeSchemes.getSchemes({basemap:a.map.basemap,geometryType:"polygon"}),h=(0,n.aa)(d,Math.min(c.length,10))[0].colors,u=[];return(null===(e=o.authoringInfo)||void 0===e?void 0:e.colorRamp)?u.push(...(0,i.n)(o.authoringInfo.colorRamp)):u.push(...(null==c?void 0:c.length)?c.map(((e,t)=>(0,n.w)(e.symbol)||new l.esriColor(h[t%h.length]))):[]),(0,s.h)("arcgis-smart-mapping-symbol-button",{label:r.panels.uniqueValue.colorScheme,type:"raster-unique-value",rampType:"continuous",colors:l.esriLang.clone(u).reverse(),onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.symbolButtonNode)},ref:e=>this.symbolButtonNode=e})}renderValues(){const{layer:e}=n.s,t=e.renderer;return this.labelNodes=[],this.inputNodes=[],(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.field),(0,s.h)("calcite-list",{group:"unique-value-items",class:"gray-border",dragEnabled:!0,onCalciteListOrderChange:e=>{if(e.detail.toEl){const a=e.detail.dragEl;if("other-values-list"===e.detail.toEl.id){const e=t.uniqueValueInfos.filter(((e,t)=>t!==parseInt(a.label)));t.uniqueValueInfos=e}}const a=Array.from(e.target.children);this.handleSortValues(a)}},t.uniqueValueInfos.map(((e,t)=>this.renderValue(e,t)))),this.renderDefaultValue(),(0,s.h)("calcite-list",{id:"other-values-list",dragEnabled:!0,group:"unique-value-items"}))}renderValue(e,t){return(0,s.h)("calcite-list-item",{key:`values-${e.value}`,value:`${e.value}`,label:`${t}`},(0,s.h)("div",{slot:"actions-start"},this.renderColorNode(e,t)),this.renderTextNode(e,t))}renderColorNode(e,t){const{strings:a}=n.s;let l=e.symbol.clone();const i={"symbol-is-white":(0,n.aq)(l),symbol:!0};return-1!==t&&this.colorNodes.length&&(this.colorNodes=[]),(0,s.h)("div",{class:i,tabindex:"0","aria-label":a.panels.uniqueValue.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&(-1===t?this.defaultColorNode=e:this.colorNodes.push(e))},onClick:()=>{this.popoverNode?((-1===this.selectedPopoverIdx?this.defaultColorNode:this.colorNodes[this.selectedPopoverIdx]).classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.l)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleColorClick(t))):(this.selectedPopoverIdx=t,this.handleColorClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleColorClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateColorNode(e,t)}}))}renderTextNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:(-1===t?"default-label":"")+" label",slot:"content",tabindex:"0",ref:e=>{e&&(-1===t?this.defaultLabelNode=e:this.labelNodes[t]=e)},"aria-label":a.panels.uniqueValue.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(t,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(t,e)}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",tabindex:"0",ref:e=>{var a;e&&(-1===t?this.defaultInputNode=e:this.inputNodes[t]=e,null===(a=this.defaultInputNode)||void 0===a||a.classList.add("default-input-padding"))},value:e.label,onCalciteInputChange:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){(-1===t?this.defaultInputNode:this.inputNodes[t]).classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a);const n=-1===t?this.defaultLabelNode:this.labelNodes[t];n.classList.remove("hidden"),s.disabled=!1,setTimeout((()=>n.focus()),300)}}}))}renderDefaultValue(){const{layer:e,mapView:t,strings:a}=n.s,l=e,r=l.renderer,o=(0,i.g)(),c={symbol:r.defaultSymbol||(0,n.T)(l,t,o),label:r.defaultLabel||a.panels.uniqueValue.other};return(0,s.h)("calcite-list",{class:"default-list-padding"},(0,s.h)("calcite-list-item",null,(0,s.h)("calcite-checkbox",{class:"checkbox",slot:"actions-start",scale:"m",tabIndex:0,checked:!!r.defaultSymbol,onClick:e=>this.handleCheckboxClick(e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleCheckboxClick(e))},onMouseOver:()=>(0,n.af)(this.checkboxNode,a.panels.uniqueValue.otherTooltip),onMouseOut:()=>(0,n.ae)(),onFocus:()=>(0,n.af)(this.checkboxNode,a.panels.uniqueValue.otherTooltip),onFocusout:()=>(0,n.ae)(),ref:e=>{e&&(this.checkboxNode=e)}}),(0,s.h)("div",{slot:"content-start",class:"symbol-container"},this.renderColorNode(c,-1)),this.renderTextNode(c,-1)))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){var t;const{layer:a}=n.s,r=a,o=r.renderer;if(!o.uniqueValueInfos.length)return null;const c={field:e};!(0,n.$)()&&(null===(t=o.authoringInfo)||void 0===t?void 0:t.colorRamp)&&(c.colorRamp=o.authoringInfo.colorRamp),(0,l.r)((0,n.aB)(c),this.flowItemNode).then((e=>{(0,i.a)(e.renderer,r),(0,n.ab)(),(0,s.f)(this.hostElement)}),(e=>{this.fieldNode.value=o.field,this.arcgisSmartMappingPanelsRasterUniqueValueError.emit(e)}))}handleSortValues(e){const{layer:t,mapView:a,modules:l,strings:r}=n.s,o=(0,i.g)(),c=t,d=c.renderer;(0,n.l)();const h=e.map((e=>e.value)),u=d.uniqueValueInfos.map((e=>l.esriLang.clone(e)));u.sort(((e,t)=>h.indexOf(`${e.value}`)-h.indexOf(`${t.value}`))),u.length?d.uniqueValueInfos=u:(d.defaultSymbol=(0,n.T)(c,a,o),d.defaultLabel=r.panels.uniqueValue.other),(0,n.ab)(),(0,s.f)(this.hostElement)}afterCreateColorNode(e,t){var a;const{layer:s,mapView:l,modules:r}=n.s,o=s,c=o.renderer,d=(0,i.g)(),h=-1===t?c.defaultSymbol||(0,n.T)(o,l,d):c.uniqueValueInfos[t].symbol.clone();for(-1===t&&h.outline&&(h.outline.width=0),(0,n.aq)(h)&&(h.outline=new r.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:u}=r;h&&u.renderPreviewHTML(h,{size:(0,n.ar)(h),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleColorClick(e){(0,n.l)();const{strings:t}=n.s,a=(0,o.c)({referenceElement:this.flowItemNode,heading:t.panels.uniqueValue.colorScheme});a.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>this.handleRemoveColorFocus(a,e,!1))),a.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>this.handleRemoveColorFocus(a,e,!0))),n.s.selectedValue=e,(0,r.a)({popoverNode:a,onChange:()=>{const{layer:a}=n.s,l=a.renderer;-1!==e||l.defaultLabel||(l.defaultLabel=t.panels.uniqueValue.other),(0,n.ab)(),(0,s.f)(this.hostElement),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)}}),this.popoverNode=a,-1===e?this.defaultColorNode.classList.add("selected"):this.colorNodes[e].classList.add("selected")}handleRemoveColorFocus(e,t,a){(0,o.r)(e),setTimeout((()=>{const e=-1===t?this.defaultColorNode:this.colorNodes[t];a||e.focus(),e.classList.remove("selected"),this.popoverNode=null}),300)}handleLabelEdit(e,t){const a=-1===e?this.defaultInputNode:this.inputNodes[e];a.classList.remove("hidden"),a.setFocus(),t.target.classList.add("hidden")}handleValueTextChange(e,t){const{layer:a,strings:l}=n.s,i=a.renderer;if(-1===e&&!i.defaultLabel)return this.defaultInputNode.value=l.panels.uniqueValue.other,this.defaultLabelNode.textContent=l.panels.uniqueValue.other,(0,n.ab)(),void(0,s.f)(this.hostElement);const r=t.target;-1===e?i.defaultLabel=r.value:i.uniqueValueInfos[e].label=r.value,""===r.value?-1===e?(i.defaultLabel=l.panels.uniqueValue.other,this.defaultInputNode.value=l.panels.uniqueValue.other,this.defaultLabelNode.textContent=l.panels.uniqueValue.other):(i.uniqueValueInfos[e].label=`${i.uniqueValueInfos[e].value}`,this.inputNodes[e].value=i.uniqueValueInfos[e].label):-1===e&&(this.defaultInputNode.value=i.defaultLabel,this.defaultLabelNode.textContent=i.defaultLabel),(0,n.ab)(),(0,s.f)(this.hostElement)}handleCheckboxClick(e){const{layer:t,lastDefault:a,strings:l}=n.s,i=t.renderer;(0,o.r)(this.popoverNode),this.popoverNode=null,(0,n.l)(),i.uniqueValueInfos.length?(i.defaultSymbol?(i.defaultSymbol=void 0,i.defaultLabel=void 0,this.defaultLabelNode.textContent=l.panels.uniqueValue.other,this.defaultInputNode.value=l.panels.uniqueValue.other):(i.defaultSymbol=a.defaultSymbol,i.defaultLabel=this.defaultLabelNode.textContent),(0,n.ab)(),(0,s.f)(this.hostElement)):e.target.checked=!0}get hostElement(){return(0,s.d)(this)}};x.style=":host{width:100%}.flow-item{height:100%}.unique-value-block{overflow-x:hidden;overflow-wrap:anywhere}.label{padding:5px auto}.symbol{width:19px;height:19px}.symbol:focus,.label:focus{outline:2px solid var(--calcite-color-brand)}.symbol-container{cursor:pointer}.selected{outline:1px solid var(--calcite-color-brand)}.hidden{display:none}.gray-border{border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0}.checkbox{margin:0px 5.5px}.default-list-padding{padding-top:8px}";const{strings:T}=n.s,B=T.panels.vectorField.unitOptions,E=[{key:"meter-per-second",title:B.esriMetersPerSecond,selected:!1},{key:"kilometer-per-hour",title:B.esriKilometersPerHour,selected:!1},{key:"knots",title:B.esriKnots,selected:!1},{key:"feet-per-second",title:B.esriFeetPerSecond,selected:!1},{key:"mile-per-hour",title:B.esriMilesPerHour,selected:!1}],F=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterVectorFieldClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldClose",7),this.arcgisSmartMappingPanelsRasterVectorFieldBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldBackClick",7),this.arcgisSmartMappingPanelsRasterVectorFieldError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldError",7),this.documentClickHandler=void 0,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,a=t;(0,i.a)(e,a),this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e}=n.s,t=e;this.originalRendererObj=t.renderer}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.currentInput=this.inputUnitNode.value,this.currentOutput=this.outputUnitNode.value}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:l}=n.s,i=t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.vectorField.styleOptions,description:e?void 0:i,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterVectorFieldBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"vector-field-block",heading:e.panels.vectorField.vectorField,open:!0},this.renderSymbolStyleSelector(),this.renderSymbolDensitySlider(),this.renderSymbolScalingSlider(),this.renderInvertSymbols(),this.renderMagnitudeRange(),this.renderUnitSelectors())}renderSymbolStyleSelector(){return(0,s.h)("arcgis-smart-mapping-vector-symbol-button",{ref:e=>this.selectNode=e,onArcgisSmartMappingSelectBeforeOpen:()=>{var e;null===(e=this.popoverNode)||void 0===e||e.parentElement.removeChild(this.popoverNode),this.popoverNode=null,this.popoverOpen=!1},onArcgisSmartMappingSelectChange:e=>{const{layer:t}=n.s,a=t,i=a.renderer;let r=e.detail;r.includes("beaufort")&&(r=this.getExactBeaufortUnit(i.outputUnit)),this.resetOutputUnit(r,i),(0,l.r)((0,c.d)({style:r}),this.flowItemNode).then((e=>{a.renderer=e.renderer,(0,n.ab)(),(0,s.f)(this.hostElement),this.selectNode&&(0,s.f)(this.selectNode)}),(e=>{(0,s.f)(this.selectNode),this.arcgisSmartMappingPanelsRasterVectorFieldError.emit(e)}))}})}renderSymbolDensitySlider(){const{layer:e,strings:t}=n.s,a=e.renderer,{symbolTileSize:l}=a||{},i=100/l;return(0,s.h)("calcite-label",null,t.panels.vectorField.symbolDensity,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"vector-field",type:"density",min:1,max:5,values:[Math.round(10*i)/10],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderSymbolScalingSlider(){const{layer:e,strings:t}=n.s,a=e.renderer,l=(0,n.a)(a,"size"),{minSize:i,maxSize:r}=l;return(0,s.h)("calcite-label",null,t.panels.vectorField.symbolScaling,(0,s.h)("calcite-slider",{min:0,minValue:null!==i?i:20,max:100,maxValue:null!==r?r:80,step:1,labelHandles:!0,labelTicks:!0,precise:!0,snap:!0,onCalciteSliderInput:(0,h.d)((()=>{const e=this.symbolScalingSliderNode.minValue,t=this.symbolScalingSliderNode.maxValue;this.handleSymbolScaleChange(e,t)}),300),ref:e=>this.symbolScalingSliderNode=e}))}renderInvertSymbols(){const{layer:e,isRTL:t,strings:a}=n.s;let l="flow-from"!==e.renderer.flowRepresentation;return(0,s.h)("div",{class:"invert-symbol-wrapper"},(0,s.h)("calcite-label",{layout:"inline-space-between"},(0,s.h)("section",null,a.panels.vectorField.invertSymbols,(0,s.h)("calcite-button",{class:{"invert-symbol-margin":!0,[d.C.rtl]:t},"icon-start":"information",scale:"s",appearance:"transparent",kind:"neutral",onClick:()=>{this.popoverOpen?(this.removePopover(),this.buttonNode.setFocus()):this.togglePopover()},ref:e=>this.buttonNode=e}))),(0,s.h)("calcite-switch",{class:"invert-symbol-switch",scale:"s",label:a.panels.vectorField.invertSymbols,checked:l,onCalciteSwitchChange:e=>this.handleInvertSymbolsChange(e.currentTarget.checked?"flow-to":"flow-from")}))}renderMagnitudeRange(){const{layer:e,strings:t}=n.s,a=e.renderer,l=(0,n.a)(a,"size"),{minDataValue:i,maxDataValue:r}=l,o=(0,h.i)(i)?Math.round(10*i)/10:void 0,c=(0,h.i)(r)?Math.round(10*r)/10:void 0;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.panels.vectorField.magnitudeRange),(0,s.h)("calcite-label",null,t.panels.vectorField.min,(0,s.h)("calcite-input-number",{label:t.panels.vectorField.min,scale:"s",min:o,max:c,value:`${null!=o?o:""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=parseFloat(this.minRangeNode.value),t=isNaN(parseFloat(this.minRangeNode.value))?-1/0:parseFloat(this.minRangeNode.value),a=isNaN(parseFloat(this.maxRangeNode.value))?1/0:parseFloat(this.maxRangeNode.value);!isNaN(e)&&e>=t&&e<=a?(this.minRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(e,parseFloat(this.maxRangeNode.value))):(this.minRangeNode.value="",this.handleMagnitudeRangeValuesChange(void 0,parseFloat(this.maxRangeNode.value)))},ref:e=>this.minRangeNode=e})),(0,s.h)("calcite-label",null,t.panels.vectorField.max,(0,s.h)("calcite-input-number",{label:t.panels.vectorField.max,scale:"s",min:o,max:c,value:`${null!=c?c:""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=parseFloat(this.maxRangeNode.value),t=isNaN(parseFloat(this.minRangeNode.value))?-1/0:parseFloat(this.minRangeNode.value),a=isNaN(parseFloat(this.maxRangeNode.value))?1/0:parseFloat(this.maxRangeNode.value);!isNaN(e)&&e>=t&&e<=a?(this.maxRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(parseFloat(this.minRangeNode.value),e)):(this.maxRangeNode.value="",this.handleMagnitudeRangeValuesChange(parseFloat(this.minRangeNode.value),void 0))},ref:e=>this.maxRangeNode=e})))}renderUnitSelectors(){const{strings:e}=n.s;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,e.panels.vectorField.convertMagnitude),(0,s.h)("calcite-label",null,e.panels.vectorField.inputUnits,this.renderUnitSelector("input")),(0,s.h)("calcite-label",null,e.panels.vectorField.outputUnits,this.renderUnitSelector("output")))}renderUnitSelector(e){const{layer:t,strings:a}=n.s,l=t.renderer,i="output"===e&&["wind-barb","ocean-current-kn","ocean-current-m"].indexOf(l.style)>-1;return(0,s.h)("calcite-combobox",{disabled:i,key:"input"===e?l.inputUnit:l.outputUnit,label:"input"===e?a.panels.vectorField.inputUnits:a.panels.vectorField.outputUnits,clearDisabled:!0,scale:"s",selectionMode:"single",ref:t=>{t&&("output"===e?this.outputUnitNode=t:this.inputUnitNode=t)},onCalciteComboboxChange:()=>{"input"===e?(""===this.inputUnitNode.value?this.inputUnitNode.value=this.currentInput:this.currentInput=this.inputUnitNode.value,this.handleUnitSelectClick("input")):(""===this.outputUnitNode.value?this.outputUnitNode.value=this.currentOutput:this.currentOutput=this.outputUnitNode.value,this.handleUnitSelectClick("output"))}},E.map((t=>this.renderUnitOption(e,t))))}renderUnitOption(e,t){const{layer:a}=n.s,l=a.renderer,i=E.find((t=>"input"===e?t.key===l.inputUnit:t.key===l.outputUnit));return(0,s.h)("calcite-combobox-item",{value:t.key,textLabel:t.title,selected:!!i&&t===i})}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}getExactBeaufortUnit(e){switch(e=null!=e?e:"meter-per-second"){case"knots":return"beaufort-kn";case"meter-per-second":return"beaufort-m";case"mile-per-hour":return"beaufort-mi";case"kilometer-per-hour":return"beaufort-km";case"feet-per-second":return"beaufort-ft"}}resetOutputUnit(e,t){let a;switch(e){case"ocean-current-kn":case"wind-barb":a="knots";break;case"ocean-current-m":a="meter-per-second"}a&&(t.outputUnit=a)}handleSymbolScaleChange(e,t){const{layer:a}=n.s,s=a.renderer,l=(0,n.a)(s,"size");l.minSize=e,l.maxSize=t,(0,n.ab)()}handleInvertSymbolsChange(e){const{layer:t}=n.s;t.renderer.flowRepresentation=e,(0,n.ab)()}handleUnitSelectClick(e){const{layer:t}=n.s,a=t.renderer;"input"===e?a.inputUnit=this.inputUnitNode.value:(a.outputUnit=this.outputUnitNode.value,a.style.includes("beaufort")&&(a.style=this.getExactBeaufortUnit(a.outputUnit))),(0,n.ab)()}handleMagnitudeRangeValuesChange(e,t){if("number"==typeof e&&isNaN(e)&&(e=""),"number"==typeof t&&isNaN(t)&&(t=""),e===this.minRangeNode.max&&t===this.maxRangeNode.min)return;const{layer:a}=n.s,s=a.renderer,l=(0,n.a)(s,"size");""!==e&&(0,h.i)(e)?(e=Math.round(1e3*e)/1e3,l.minDataValue=e,this.minRangeNode.value=`${e}`,this.maxRangeNode.min=e+this.maxRangeNode.step):(l.minDataValue=null,this.minRangeNode.value=""),""!==t&&(0,h.i)(t)?(t=Math.round(1e3*t)/1e3,l.maxDataValue=t,this.maxRangeNode.value=`${t}`,this.minRangeNode.max=t-this.minRangeNode.step):(l.maxDataValue=null,this.maxRangeNode.value=""),(0,n.ab)()}togglePopover(){const{flowItemNode:e}=this,{strings:t}=n.s;this.popoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.popoverNode.props={title:t.panels.vectorField.invertSymbols,flowItemNode:e,moreInfo:t.panels.vectorField.invertSymbolsTip},this.popoverNode.referenceElement=this.buttonNode,this.popoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removePopover(),this.buttonNode.setFocus()})),document.body.appendChild(this.popoverNode),this.popoverNode.setOpen(!0),this.popoverOpen=!0,setTimeout((()=>{this.documentClickHandler=e=>{(0,m.i)(e.target)||this.removePopover()},document.addEventListener("click",this.documentClickHandler)}))}removePopover(){document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.popoverNode=null,this.popoverOpen=!1,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0)}get hostElement(){return(0,s.d)(this)}};F.style=":host{width:100%}.flow-item{height:100%}.vector-field-block{overflow-x:hidden}.invert-symbol-wrapper{display:flex;justify-content:space-between}.invert-symbol-margin{margin-right:inherit;margin-left:0.35rem}.arcgis--rtl .invert-symbol-margin{margin-left:inherit;margin-right:0.35rem}.invert-symbol-switch{padding-top:6px}"},88703:(e,t,a)=>{a.d(t,{a:()=>c,b:()=>u,c:()=>n,d:()=>s,e:()=>l,f:()=>d,g:()=>m,i:()=>i,m:()=>r,t:()=>o,u:()=>h});const s=(e,t)=>{let a,s="idle";const n=(...n)=>new Promise((l=>{switch(s){case"flushed":s="idle",a?(clearTimeout(a),l(e(...n))):l(null);break;case"invoked":clearTimeout(a),s="idle",l(e(...n));break;case"cancelled":clearTimeout(a),s="idle",l(null);break;default:a&&clearTimeout(a),s="pending",a=setTimeout((()=>(s="idle",l(e(...n)))),t)}}));return n.flush=function(...e){return s="flushed",n(...e)},n.invoke=function(...e){return s="invoked",n(...e)},n.cancel=function(...e){return s="cancelled",n(...e)},n.getStatus=function(){return s},n},n=(e,t)=>{let a;return(...s)=>new Promise((n=>{a||(a=setTimeout((()=>{clearTimeout(a),a=void 0,n(e(...s))}),t))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function i(e){return null!=e}async function r(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:a,data:s}=t(e);return[a,s]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,a)=>e&&t.indexOf(a)>-1),!0);function h(e,t){const a=[],s={};return e.forEach((e=>{const n=t(e);null==s[n]&&(s[n]=e,a.push(e))})),a}function u(e){const t={boolean:{},number:{},string:{}},a=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(a.indexOf(e)>=0)&&a.push(e)}))}const m=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((a,s)=>e.slice(t*s,t+t*s)))},61886:(e,t,a)=>{let s,n;function l(e){e.loading=!1}function i(e,t){return function(e){e.loading=!0,n=!1,s&&clearTimeout(s),s=setTimeout((()=>{l(e),n=!0}),6e4)}(t),e.then((e=>(l(t),n?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(l(t),Promise.reject(e))))}a.d(t,{r:()=>i})},1397:(e,t,a)=>{function s(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let t=null==e?void 0:e.parentElement;for(;t;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}a.d(t,{i:()=>s})},69818:(e,t,a)=>{a.d(t,{a:()=>l,b:()=>o,c:()=>r,d:()=>i,g:()=>c});var s=a(59503),n=(a(21104),a(2137),a(79340));function l(){const{layer:e,modules:t}=s.s,a=e,n="imagery"===a.type?a.rasterFunction:void 0;return t.RasterVectorFieldCreator.createRenderer({layer:a,rasterFunction:n}).then((e=>(a.effect=void 0,a.renderer=e.renderer,Promise.resolve(e))),(e=>Promise.reject(e)))}function i(e){const{layer:t,modules:a}=s.s,n=t,l=n.renderer,i="imagery"===n.type?n.rasterFunction:void 0;return e=e||{},a.RasterVectorFieldCreator.createRenderer({layer:n,rasterFunction:i,style:e.style||l.style}).then((e=>{e.renderer.symbolTileSize=l.symbolTileSize;const t=(0,s.a)(l,"size");return e.renderer.visualVariables=(0,s.q)(e.renderer,"size")||[],e.renderer.visualVariables.push(t),e.renderer.flowRepresentation=l.flowRepresentation,e.renderer.inputUnit=l.inputUnit,e.renderer.outputUnit=l.outputUnit,Promise.resolve(e)}),(e=>Promise.reject(e)))}function r(){const{layer:e,modules:t}=s.s,a=e,l="imagery"===a.type?a.rasterFunction:void 0,i=(0,n.c)([[245,245,0],[255,0,0]].map((e=>new t.esriColor(e))));return t.RasterClassBreaksCreator.createRenderer({layer:a,rasterFunction:l,colorRamp:i}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function o(e){const{layer:t,modules:a}=s.s,n=t,l=n.renderer,i="imagery"===n.type?n.rasterFunction:void 0;return a.RasterClassBreaksCreator.createRenderer({layer:n,rasterFunction:i,field:e.field||l.field,classificationMethod:e.classificationMethod||l.authoringInfo.classificationMethod,numClasses:e.numClasses||l.classBreakInfos.length,colorRamp:l.authoringInfo.colorRamp,definedInterval:e.definedInterval}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function c(){var e;const{layer:t,modules:a,strings:n}=s.s,l=t;let i;const{rasterInfo:r}=l,o=null===(e=null==r?void 0:r.attributeTable)||void 0===e?void 0:e.fields;return i=o?o.filter((e=>"oid"!==e.type&&"string"!==e.type)):[new a.Field({name:"value",alias:n.panels.classBreaks.value})],i}},92220:(e,t,a)=>{a.d(t,{a:()=>l,c:()=>n,f:()=>i});var s=a(59503);function n(e){const{layer:t,mapView:a,modules:n}=s.s,l=t;return e=e||{},n.RasterFlowCreator.createRenderer({layer:l,view:a,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||i()}).then((t=>(t.layerEffect&&-1===t.layerEffect.indexOf("drop-shadow")&&(l.effect=t.layerEffect),t.renderer.color=t.renderer.color&&(e.color||t.renderer.color),Promise.resolve(t))),(e=>Promise.reject(e)))}function l(e){var t;const{layer:a,mapView:n,modules:l}=s.s,r=a;e=e||{};const o=r.renderer,c=(0,s.a)(o,"color"),d=o.authoringInfo,h=e.flowTheme||(null==d?void 0:d.flowTheme)||"flow-line";return l.RasterFlowCreator.createRenderer({layer:r,view:n,theme:h,includeColorVariable:null!==(t=e.includeColorVariable)&&void 0!==t?t:!!c,legendOptions:e.legendOptions||(null==c?void 0:c.legendOptions),flowRepresentation:e.flowRepresentation||o.flowRepresentation,flowScheme:e.flowScheme}).then((t=>{const a=(0,s.t)(o,"color"),n=(0,s.t)(t.renderer,"color");(null==a?void 0:a.minSliderValue)&&(null==a?void 0:a.maxSliderValue)&&n&&(n.minSliderValue=a.minSliderValue,n.maxSliderValue=a.maxSliderValue);const c=(0,s.a)(r.renderer,"color"),u=(0,s.a)(t.renderer,"color");return c&&u&&c.stops.forEach(((e,t)=>{u.stops[t].value=e.value})),t.renderer.color=t.renderer.color&&(e.color||o.color||t.renderer.color),(e.flowScheme||i())&&c&&u&&c.stops.forEach(((e,t)=>{u.stops[t].color=new l.esriColor(e.color.toJSON())})),h===d.flowTheme&&(t.renderer.flowSpeed=o.flowSpeed,t.renderer.density=o.density,t.renderer.trailLength=o.trailLength,t.renderer.trailWidth=o.trailWidth,t.renderer.trailCap=o.trailCap),Promise.resolve(t)}),(e=>Promise.reject(e)))}function i(){const{layer:e,mapView:t,modules:a}=s.s,n=e.renderer,l=(0,s.a)(n,"color");if(!l)return null;const i=l.stops.map((e=>e.color)),r=a.flowSchemes.getSchemes({basemap:t.map.basemap||"topo"}),o=[r.primaryScheme].concat(r.secondarySchemes),c=[];return o.forEach((e=>{let t=i.some(((t,a)=>!(0,s.a5)(e.colors[a],t)));t?(e.colors=e.colors.reverse(),t=i.some(((t,a)=>!(0,s.a5)(e.colors[a],t))),t||c.push(e)):c.push(e)})),c.length?c[0]:null}a(21104),a(2137)}}]);