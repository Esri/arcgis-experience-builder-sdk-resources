/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-9babcd.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-9babcd"],{45518:(e,t,i)=>{i.r(t),i.d(t,{arcgis_symbol_picker:()=>re});var s=i(35110),o=i(68757),r=i(95909),l=i(68558),n=i(22250),a=i(1984),c=i(86587);function m(e){return{authMode:"public"===e.access?"anonymous":"auto"}}i(21104),i(73838),i(63280);const d=[{name:"Circle",type:"esriSMS",style:"esriSMSCircle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Square",type:"esriSMS",style:"esriSMSSquare",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Diamond",type:"esriSMS",style:"esriSMSDiamond",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Triangle",type:"esriSMS",style:"esriSMSTriangle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}}],u=[{type:"esriSLS",color:[0,0,0,255],width:.75,style:"esriSLSSolid"}],y=[{type:"esriSFS",color:[0,0,0,64],outline:{type:"esriSLS",color:[0,0,0,255],width:.75,style:"esriSLSSolid"},style:"esriSFSSolid"}];function h(e){return[{title:e.symbolSources.circle,name:"Circle",primitive:"circle"},{title:e.symbolSources.square,name:"Square",primitive:"square"},{title:e.symbolSources.cross,name:"Cross",primitive:"cross"},{title:e.symbolSources.x,name:"X",primitive:"x"},{title:e.symbolSources.kite,name:"Kite",primitive:"kite"},{title:e.symbolSources.triangle,name:"Triangle",primitive:"triangle"}].map((e=>{var t;return{dimensionality:"flat",name:e.name,title:e.title,type:"PointSymbol3D",symbolLayers:[{type:"Icon",resource:{primitive:e.primitive},material:{color:null===(t=null===r.e||void 0===r.e?void 0:r.e.gfxUtils)||void 0===t?void 0:t.defaultThematicColor},outline:{color:[0,0,0]}}]}}))}function p(e){return[{title:e.symbolSources.sphere,name:"Sphere",primitive:"sphere"},{title:e.symbolSources.tallCylinder,name:"Tall_Cylinder",primitive:"cylinder",mixins:{width:5,height:10,depth:5}},{title:e.symbolSources.cylinder,name:"Cylinder",primitive:"cylinder"},{title:e.symbolSources.tallCube,name:"Tall_Cube",primitive:"cube",mixins:{width:5,height:10,depth:5,anchor:"bottom"}},{title:e.symbolSources.cube,name:"Cube",primitive:"cube"},{title:e.symbolSources.tallCone,name:"Tall_Cone",primitive:"cone",mixins:{width:5,height:10,depth:5}},{title:e.symbolSources.cone,name:"Cone",primitive:"cone"},{title:e.symbolSources.invertedCone,name:"Inverted_Cone",primitive:"invertedCone"},{title:e.symbolSources.diamond,name:"Diamond",primitive:"diamond"},{title:e.symbolSources.tetrahedron,name:"Tetrahedron",primitive:"tetrahedron"}].map((e=>({dimensionality:"volumetric",name:e.name,title:e.title,type:"PointSymbol3D",symbolLayers:[Object.assign({type:"Object",resource:{primitive:e.primitive}},e.mixins)]})))}async function b(e,t,i,s){try{await r.e.symbolUtils.renderPreviewHTML(t,Object.assign({node:e},i))}catch(t){e.appendChild(S(s))}return e}function S(e){const t=document.createElement("span");return t.setAttribute("alt",""),t.innerHTML=e,t}function g(e="2d"){return{async getSymbol(t){const{data:i,parentData:s,portalItem:l}=t,n=await async function(e,t,i,s){const o=function(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}(i);let l=null;o||(l=`${i.itemUrl}/data`);const n={data:e,baseUrl:i.itemUrl,styleName:o,styleUrl:l},{portal:a}=i;return r.e.webStyleSymbolUtils.fetchSymbolFromStyle(n,t,{portal:a},s,r.e.styleUtils.symbolUrlFromStyleItem,m(i))}(s,i.name,l,s.cimVersion&&"2d"===e?"cimRef":"webRef");return"point-3d"===n.type&&n.symbolLayers.forEach((e=>{if(e.get("material.color"))if("icon"===e.type){const t=null!=e.material?e.material:{};t.color=r.e.gfxUtils.defaultThematicColor.clone(),e.material=t}else if("object"===e.type){const t=null!=e.material?e.material:{};t.color=t.color||(0,o.c)([255,255,255]),e.material=t}})),n},getThumbnail:async e=>async function(e){var t,i;const s=e.data;let o=null===(t=s.thumbnail)||void 0===t?void 0:t.href;const l=null===(i=s.thumbnail)||void 0===i?void 0:i.imageData,n=s.title||e.strings.symbolSources.noTitle,a=document.createElement("div"),c=!!s.cimRef,m=function(e){var t,i;const s=null===(t=e.formats)||void 0===t?void 0:t.includes("web3d"),o=null===(i=e.formatInfos)||void 0===i?void 0:i.some((e=>"gltf"===e.type||"gltf_basisu"===e.type));return s||o}(s),d={size:m&&"volumetric"===s.dimensionality?42:24,disableUpsampling:!1};if(c&&!m){const t=await e.getSymbol();if(!(0,r.f)(t))return(0,r.h)(t)&&delete d.size,b(a,t,d,n)}return r.e.devEnvironmentUtils.isDevEnvironment()&&(o=r.e.devEnvironmentUtils.adjustStaticAGOUrl(o)),o||l?b(a,new r.e.WebStyleSymbol({name:s.name,styleUrl:`${e.portalItem.itemUrl}/data`,thumbnail:{url:l?`data:image/jpeg;base64, ${l}`:r.e.urlUtils.makeAbsolute(o,e.portalItem.itemUrl)}}),d,n):(a.appendChild(S(n)),a)}(e)}}const v={getSymbol:async e=>r.e.jsonUtils.fromJSON(e.data),async getThumbnail(e){const t=await e.getSymbol(),i={size:"line"===(0,r.g)(t)?{width:24}:24};return r.e.symbolUtils.renderPreviewHTML(t,i)}},f={getSymbol:async e=>r.e.jsonUtils.fromJSON(e.data),async getThumbnail(e){const t=await e.getSymbol();return r.e.symbolUtils.renderPreviewHTML(t,{size:38})}},I=Function.prototype;class _{constructor({data:e,parentData:t,portalItem:i,strategy:s,strings:o}){this.data=e,this.parentData=t,this.portalItem=i,this.strategy=s,this.strings=o}async getSymbol(){if(!this._symbol){const e=this._symbolRequest||(this._symbolRequest=this.strategy.getSymbol(this));this._symbol=await e}return this._symbol.clone()}async getThumbnail(e){if(this._thumbnail)return e.appendChild(this._thumbnail),I;const t=this._thumbnailRequest||(this._thumbnailRequest=this.strategy.getThumbnail(this));return this._thumbnail=await t,()=>e.appendChild(this._thumbnail)}}class w{constructor({portalItem:e,strings:t,symbolType:i}){this.symbolType="2d",this.portalItem=e,this.strings=t,i&&(this.symbolType=i)}get data(){return this._data}get id(){var e;return null===(e=this.portalItem)||void 0===e?void 0:e.id}get keywords(){var e;return(null===(e=this.portalItem)||void 0===e?void 0:e.typeKeywords)||[]}get name(){var e;return null===(e=this.portalItem)||void 0===e?void 0:e.name}get title(){var e;return null===(e=this.portalItem)||void 0===e?void 0:e.title}async fetchData(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();return this._data||(this._data=await this.portalItem.fetchData("json",Object.assign(Object.assign({},e),m(this.portalItem)))),this._data}}class C extends w{constructor(){super(...arguments),this.type="symbol-set"}async getItems(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();if(!this._items){const t=await this.fetchData(e);this._items=t.map((e=>new _({data:e,parentData:t,portalItem:this.portalItem,strategy:v,strings:this.strings})))}return this._items}}class k extends w{constructor(){super(...arguments),this.type="web-style"}async getItems(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();if(!this._items){const t=await this.fetchData(e);this._items=t.items.map((e=>new _({data:e,parentData:t,portalItem:this.portalItem,strategy:g(this.symbolType),strings:this.strings})))}return this._items}}class E{constructor({strings:e}){this.keywords=[],this.name="Basic",this.type="symbol-set",this.title=e.symbolSources.basic}async getItems(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.map((e=>new _({data:e,strategy:v,strings:this.strings})))),this._items}}const T="basic-symbol-set:point",O="basic-symbol-set:line",U="basic-symbol-set:polygon";class A extends E{constructor(){super(...arguments),this.data=d,this.id=T,this.keywords=["Point"]}}class x extends E{constructor(){super(...arguments),this.data=u,this.id=O,this.keywords=["Line"]}}class N extends E{constructor(){super(...arguments),this.data=y,this.id=U,this.keywords=["Polygon"]}}class D{constructor({strings:e}){this.keywords=["3d"],this.id="basic-web-style:flat",this.name="Basic",this.type="web-style",this.data={items:h(e)},this.title=e.symbolSources.basic}async getItems(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.items.map((e=>new _({data:e,strategy:v,strings:this.strings})))),this._items}}class M{constructor({strings:e}){this.id="basic-web-style:volumetric",this.keywords=["3d","volumetric"],this.name="Basic",this.type="web-style",this.data={items:p(e)},this.title=e.symbolSources.basic}async getItems(e){if(r.e.promiseUtils.isAborted(e))throw r.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.items.map((e=>new _({data:e,parentData:this.data,strategy:f,strings:this.strings})))),this._items}}const F=({item:e,index:t,observer:i})=>{const o=e.data.title?(0,s.h)("calcite-tooltip",{"reference-element":e.data.name},e.data.title):null;return(0,s.h)("span",{class:"marker-item calcite-mode-dark",ref:s=>{s&&(s.item||(s.item=e,s.index=t,i.observe(s)))},id:e.data.name,slot:"thumbnail"},o)};function P(e,t){return function(e){return V({portal:e,queries:{group:e.symbolSetsGroupQuery,item:'type:"Symbol Set" AND (typekeywords:"by value" AND typekeywords:"marker")'}}).then(q)}(e).then((e=>e.map((e=>new C({portalItem:e,strings:t})))))}function L(e,t,i){return async function(e,t){const i="2d"===t?e.stylesGroupQuery2d:e.stylesGroupQuery3d;return i?V({portal:e,queries:{group:i,item:'type:"Style"'}}).then(q):[]}(e,t).then((e=>e.map((e=>new k({portalItem:e,symbolType:t,strings:i})))))}function R(e,t,i,s){return(null==s?void 0:s.length)?async function(e,t){let i="",s="";return t.forEach((e=>{i+=`${s}id:${e}`,s=" OR "})),V({portal:e,queries:{item:i}})}(e,s).then((e=>e.map((e=>new k({portalItem:e,symbolType:t,strings:i}))))):new Promise((e=>{e([])}))}function j(e,t){return"flat"===e?new D({strings:t}):new M({strings:t})}function G(e,t){const i={strings:e};return"line"===t?new x(i):"polygon"===t?new N(i):new A(i)}async function V(e){const t=e.portal,i=e.queries.group,s=e.queries.item;if(i){const{results:e}=await t.queryGroups({query:i,disableExtraQuery:!0});if(0===e.length)return[];const[o]=e;return(await o.queryItems({query:s,disableExtraQuery:!0,num:100,sortField:o.sortField})).results}return(await t.queryItems({query:s,disableExtraQuery:!0,num:100})).results}function q(e){const t=[];return e.forEach((e=>{e.typeKeywords.indexOf("default")>-1?t.unshift(e):t.push(e)})),t}const J="pointSymbol",$="lineSymbol",B="polygonSymbol",H=e=>!!e.portal;async function z(e,t){return Promise.all(e.map(t)).then((t=>e.filter(((e,i)=>t[i]))))}async function Q(e,t,i,s,o,l){const n=te(i),a="2d"===o?function(e,t){return async function(i,s){const o="point"===e?r.j:"line"===e?r.h:r.f;if(!function(i){if(t.includes("all"))return!0;const{data:s}=i,{dimensionality:o,type:r}=s;if("volumetric"===o)return!1;if("point"===e){if(t.includes("picture")&&"esriPMS"===r)return!0;if(t.includes("simple")&&"esriSMS"===r)return!0}if("line"===e&&t.includes("simple")&&"esriSLS"===r)return!0;if("polygon"===e&&t.includes("simple")&&"esriSFS"===r)return!0;const{formats:l}=s;return!(!ee(t)||!ee(l))}(i))return!1;const l=t.includes("cim:picture"),n=t.includes("cim:vector"),a=l&&n||!l&&!n,c=Y(s)&&!X(s)&&!Z(s),m=X(s)&&!Y(s)&&!Z(s),d=Z(s)&&!Y(s)&&!X(s),u="line"===e?$:"polygon"===e?B:J;if((c||m||d)&&a||"web-style"!==s.type||i.data.itemType===u)return!0;const y=await i.getSymbol();return!(0,r.i)(y)||o(y)}}(s,n):(c=n,async function(e){if(c.includes("all")||c.includes("3d"))return!0;const{data:{dimensionality:t}}=e;return c.includes("3d:flat")&&"flat"===t||c.includes("3d:volumetric")&&"volumetric"===t});var c;return z(t,(async t=>l?l(t,e,a):a(t,e)))}const W={point:"Point",line:"Line",polygon:"Polygon"};function Y({keywords:e}){return e.includes(W.point)||e.includes("pointSymbol")}function K({keywords:e}){return e.includes("marker")}function X({keywords:e}){return e.includes(W.line)||e.includes("lineSymbol")}function Z({keywords:e}){return e.includes(W.polygon)||e.includes("polygonSymbol")}function ee(e){return Array.isArray(e)&&e.some((e=>e.includes("cim")))}function te(e="all"){const t=Array.isArray(e)?e:[e],i=t.find((e=>"cim"===e&&t.find((e=>e.includes("cim:")))));return i?t.filter((e=>!e.includes("cim:"))):t}const ie="arcgis-symbol-styler-storage-styles",se="arcgis-symbol-picker__container",oe="incompatible-symbols-notice",re=class{constructor(e){(0,s.r)(this,e),this.arcgisActiveSymbolChange=(0,s.c)(this,"arcgisActiveSymbolChange",7),this.arcgisActiveSymbolItemChange=(0,s.c)(this,"arcgisActiveSymbolItemChange",7),this.arcgisActiveSourceIdChange=(0,s.c)(this,"arcgisActiveSourceIdChange",7),this.arcgisSymbolSourcesChange=(0,s.c)(this,"arcgisSymbolSourcesChange",7),this.arcgisActiveSourceItemsChange=(0,s.c)(this,"arcgisActiveSourceItemsChange",7),this.allCustomFileInfos=[],this.customSymbolsStorageId="arcgis-symbol-picker-custom-symbols",this.actionEls=[],this._onSymbolSourceChange=e=>{const t=e.currentTarget,{selectedItems:i}=t,s=i.find((e=>e.getAttribute("data-value")!==this._activeSourceId));this._activeSourceId=(null==s?void 0:s.getAttribute("data-value"))||this._activeSourceId,t.querySelectorAll("calcite-dropdown-item").forEach((e=>{e!==s&&(e.selected=!1)})),e.stopPropagation(),this.displayEmptyFilterMsg=!1},this.symbol=void 0,this.portal=void 0,this.symbolFilter=void 0,this.activeSourceId=void 0,this.activeSymbolItem=void 0,this.hideHeader=!1,this.symbolType="2d",this.customSymbolItemFilter=void 0,this.customSymbolSourceFilter=void 0,this.itemsPerRow=4,this.symbolSources=void 0,this.activeSymbolItems=void 0,this.messages=void 0,this._activeSourceId=void 0,this._symbolSources=void 0,this._activeSymbolItems=void 0,this.customSymbolError=void 0,this.isGridView=!0,this.displayEmptyFilterMsg=!1,this._activeSymbolFetch=void 0}handleActiveSourceItemIdChanges(){this._activeSourceId&&("custom-symbol-set"===this._activeSourceId?this._setupCustomSymbols():this._fetchAndSetUpSymbolItems(this._symbolSources.find((({id:e})=>e===this._activeSourceId))))}get editGeometry(){return(0,r.g)(this.symbol)}handleFileUploadChange({detail:e}){const t=e,i=t.cim&&JSON.stringify(t.cim.toJSON());if(t.dataURL&&t.dataURL.length>2e5)return void(this.customSymbolError="too-large");if(t.cim&&i.length>2e5)return void(this.customSymbolError="too-large");this.customSymbolError=void 0;const s=this.allCustomFileInfos.find((e=>t.dataURL&&e.dataURL&&e.dataURL===t.dataURL&&e.fileName===t.fileName||t.cim&&e.cim&&e.fileName===t.fileName&&i===JSON.stringify(e.cim.toJSON())));try{let e;if(s)e=this._activeSymbolItems.find((e=>e.data.name===s.fileName));else{const i=[...this.allCustomFileInfos,t];(0,n.s)(this.customSymbolsStorageId,i.map((e=>e.dataURL?e:Object.assign(Object.assign({},e),{cim:JSON.stringify(e.cim.toJSON())}))),!0),this.allCustomFileInfos=i,this._setupCustomSymbols(),e=this._activeSymbolItems[this._activeSymbolItems.length-1]}this.activeSymbolItem=e,this.arcgisActiveSymbolItemChange.emit(this.activeSymbolItem),this.activeSymbolItem.getSymbol().then((e=>this.arcgisActiveSymbolChange.emit(e))),setTimeout((()=>requestAnimationFrame((()=>{var e;null===(e=this.itemPaletteNode)||void 0===e||e.setFocus(),this.updateListSelection()}))),1)}catch(e){this.customSymbolError="storage-full"}}handleInvalidFile(){this.customSymbolError="invalid-file"}handleFileUploadError(){this.customSymbolError="error"}async getStyleItemIds(){var e;return null===(e=this._symbolSources)||void 0===e?void 0:e.filter((e=>"web-style"===e.type)).map((e=>e.id))}_renderSymbolSourceOptions(e,t){var i;const{messages:o,savedStyleIds:r}=this,l=e.filter((e=>"symbol-set"===e.type&&!(null==r?void 0:r.includes(e.id)))),n=e.filter((e=>"web-style"===e.type&&!(null==r?void 0:r.includes(e.id)))),a=e.filter((e=>r.includes(e.id)));a.sort(((e,t)=>e.title.localeCompare(t.title)));const c=!this.symbolFilter||!!(Array.isArray(this.symbolFilter)?this.symbolFilter:[this.symbolFilter]).find((e=>"custom"===e||"picture"===e))||r.length,m="3d"!==this.symbolType&&("point"===this.editGeometry&&c||(null===(i=this.savedStyleIds)||void 0===i?void 0:i.length))&&(0,s.h)("calcite-dropdown-group",{groupTitle:o.addedStyles,selectionMode:"multiple",key:"custom"},this._renderSourceDropdownItem(a,t),"point"===this.editGeometry&&c&&(0,s.h)("calcite-dropdown-item",{key:"custom","data-value":"custom-symbol-set",selected:"custom-symbol-set"===t},o.customSymbols)),d=l.length>0&&(0,s.h)("calcite-dropdown-group",{groupTitle:o.classicSymbols,selectionMode:"multiple",key:"classic"},this._renderSourceDropdownItem(l,t)),u=n.length>0&&(0,s.h)("calcite-dropdown-group",{groupTitle:o.newSymbols,selectionMode:"multiple",key:"webstyles"},this._renderSourceDropdownItem(n,t));return m?d?u?[d,u,m]:[d,m]:[u,m]:d&&u?[d,u]:(0,s.h)("calcite-dropdown-group",{key:"one-group"},this._renderSourceDropdownItem([...l,...n],t))}_renderSourceDropdownItem(e,t){return e.map((e=>(0,s.h)("calcite-dropdown-item",{key:e.id,"data-value":e.id,selected:e.id===t},e.title)))}_setupCustomSymbols(){const e=this.allCustomFileInfos.map((e=>{let t=24,i=24;if(e.width>e.height?i=Math.round(t/e.width*e.height):e.width<e.height&&(t=Math.round(i/e.height*e.width)),e.dataURL){const s=e.fileName.split(".")[1].toLowerCase();return new _({data:{angle:0,contentType:"png"===s?"image/png":"gif"===s?"image/gif":"image/jpeg",height:i,imageData:e.dataURL.split(",")[1],name:e.fileName,type:"esriPMS",url:void 0,width:t,xoffset:0,yoffset:0},parentData:null,portalItem:null,strategy:v,strings:this.messages})}return new _({data:{symbol:e.cim,name:e.fileName},parentData:{cimVersion:"2.6.0"},portalItem:null,strategy:{getSymbol:async e=>e.data.symbol,getThumbnail:async e=>b(document.createElement("div"),e.data.symbol,{size:24,disableUpsampling:!1},e.data.title)},strings:this.messages})}));this.setUpSymbolIntersectionObserver(),this.customSymbolError=void 0,this._activeSymbolFetch=null,this._activeSymbolItems=e,this.arcgisActiveSourceIdChange.emit("custom-symbol-set"),this.arcgisActiveSourceItemsChange.emit(e.map((e=>new _(Object.assign({},e)))))}async _fetchAndSetUpSymbolItems(e){this._activeSymbolFetch&&this._activeSymbolFetch.controller.abort();const t=new AbortController,i=t.signal;this._activeSymbolFetch={controller:t,id:e.id};const s=!this._activeSymbolItems&&this.activeSymbolItems||await e.getItems(t);if(null==i?void 0:i.aborted)return;const o=await Q(e,s,this.symbolFilter,this.editGeometry,this.symbolType,this.customSymbolItemFilter);(null==i?void 0:i.aborted)||(this.setUpSymbolIntersectionObserver(),this.customSymbolError=void 0,this._activeSymbolFetch=null,this._activeSymbolItems=o,this.arcgisActiveSourceIdChange.emit(this._activeSourceId),this.arcgisActiveSourceItemsChange.emit(o.map((e=>new _(Object.assign({},e))))))}onIncompatibleVectorSymbolsDismiss(e){(0,l.s)(l.l.ARCGIS_COMPONENT_NOTIFICATIONS,{key:l.a.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED,value:"true"}),e.stopPropagation()}tearDownSymbolIntersectionObserver(){var e;null===(e=this._symbolIntersectionObserver)||void 0===e||e.disconnect(),this._symbolIntersectionObserver=null}setUpSymbolIntersectionObserver(){this.tearDownSymbolIntersectionObserver();let e=0;const t={};this._symbolIntersectionObserver=new IntersectionObserver(((i,s)=>{function o(){e++,t[e]&&(t[e](),delete t[e],o())}i.forEach((i=>{if(!i.isIntersecting)return;const r=i.target;r.item.getThumbnail(r).then((i=>{r.index===e?(i(),o()):t[r.index]=i})),r.item.getSymbol(),s.unobserve(r)}))}))}async _fetchSources(){this._sourcesFetchController&&this._sourcesFetchController.abort(),this._sourcesFetchController=new AbortController;const e=this._sourcesFetchController.signal,t=this.portal,i=H(t)?t.portal:t,s=H(t)?t.before:null,o=H(t)?t.after:null,l=i?this.symbolSources||await async function(e,t,i,s,o,r){const l={};t&&await t(e,l),await e.load();const n=await("2d"===o?async function(e,t,i){const s=e.symbolSetsGroupQuery;e.symbolSetsGroupQuery='owner:esri AND title:"Map Viewer Beta Symbols"';const[o,r,l]=await Promise.all([P(e,t),L(e,"2d",t),R(e,"2d",t,i)]),n=e=>e.keywords.every((e=>"Basic"!==e)),a=[G(t,"point"),G(t,"line"),G(t,"polygon"),...o.filter(n),...r.filter(n),...l.filter(n)];return e.symbolSetsGroupQuery=s,a}(e,s,r):async function(e,t){const[i]=await Promise.all([L(e,"3d",t)]),s=[j("flat",t),j("volumetric",t),...i.filter((e=>e.keywords.every((e=>"Basic"!==e))))];return s}(e,s));return i&&await i(e,l),n}(i,s,o,this.messages,this.symbolType,this.savedStyleIds):[];if(null==e?void 0:e.aborted)return;this._symbolSources=await async function(e,t,i,s,o){const r=te(t),l="2d"===s?function(e,t){return async i=>{const s=i.keywords.includes("3d"),o=i.keywords.includes("Dictionary"),r="point"===e?Y(i)||K(i):"line"===e?X(i):Z(i),l=Y(i)||K(i)||X(i)||Z(i);if(s||o||!r&&l)return!1;if(t.includes("all"))return!0;const n="point"===e?T:"line"===e?O:U;return!(!t.includes("picture")||i.id==n||"symbol-set"!==i.type)||!(!t.includes("simple")||i.id!==n)||!(!ee(t)||"web-style"!==i.type)}}(i,r):function(e){const t={EsriThematicShapesStyle:!0};return async i=>{if(i.keywords.every((e=>!t[e]))&&"web-style"===i.type&&(e.includes("all")||e.includes("3d")))return!0;if(function(e){return"portalItem"in e}(i)){const t=await i.fetchData(),[s]=t.items,{dimensionality:o}=s;return e.includes("3d:flat")&&"flat"===o||e.includes("3d:volumetric")&&"volumetric"===o}return e.includes("3d:flat")&&"basic-web-style:flat"==i.id||e.includes("3d:volumetric")&&"basic-web-style:volumetric"==i.id}}(r);return z(e,(async e=>o?o(e,l):l(e)))}(l,this.symbolFilter,(0,r.g)(this.symbol),this.symbolType,this.customSymbolSourceFilter);const n=this._symbolSources.filter((e=>this.savedStyleIds.includes(e.id)));if(n.length!==this.savedStyleIds.length){const e=n.map((e=>e.id)),t=this.savedStyleIds.filter((t=>!e.includes(t)));this.savedStyleIds=e,this.removeStyleIds(t)}if(this.arcgisSymbolSourcesChange.emit(this._symbolSources),!this._activeSourceId){let e=this.activeSourceId;e&&(this._symbolSources.find((e=>e.id===this.activeSourceId))||(e=void 0)),this._activeSourceId=e||this._symbolSources[0].id}}_getCustomSymbolsFromStorage(){if("3d"===this.symbolType||"point"!==this.editGeometry)return;const e=(0,n.g)(this.customSymbolsStorageId,!0);e&&(this.allCustomFileInfos=e.map((e=>e.dataURL?e:Object.assign(Object.assign({},e),{cim:r.e.CIMSymbol.fromJSON(JSON.parse(e.cim))}))))}_renderSourceSelection(){const{messages:e}=this,t=this._symbolSources;if(!t)return;const i=this._symbolSources.find((e=>e.id===this._activeSourceId)),o="custom-symbol-set"===this._activeSourceId?e.customSymbols:null==i?void 0:i.title,r=1===t.length,l=(0,s.h)("calcite-dropdown",{class:{"marker-source-select":!0},hidden:r,maxItems:7,onCalciteDropdownSelect:this._onSymbolSourceChange,overlayPositioning:"absolute"},(0,s.h)("calcite-button",{alignment:"space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",scale:"m",slot:"trigger",width:"full"},o),this._renderSymbolSourceOptions(t,this._activeSourceId));return(0,s.h)("div",{class:"section",key:"header"},(0,s.h)("calcite-label",{class:"section"},this.hideHeader?null:this.messages.category,(0,s.h)("div",{class:"categories"},l,(0,s.h)("calcite-action",{id:"symbol-picker-grid",active:this.isGridView,appearance:"transparent",icon:"grid",scale:"s",class:"categories-center-action",text:this.messages.gridView,onClick:()=>{this.isGridView=!0,(0,s.f)(this.el)}}),(0,s.h)("calcite-tooltip",{"reference-element":"symbol-picker-grid"},this.messages.gridView),(0,s.h)("calcite-action",{id:"symbol-picker-list",active:!this.isGridView,appearance:"transparent",icon:"list",iconFlipRtl:!0,scale:"s",text:this.messages.listView,onClick:()=>{this.isGridView=!1,(0,s.f)(this.el)}}),(0,s.h)("calcite-tooltip",{"reference-element":"symbol-picker-list"},this.messages.listView))))}_renderItemSelection(){const{portal:e,messages:t}=this,i=this._activeSymbolFetch,o=H(e)?e.portal:e,r=(0,s.h)("div",{class:"remove-button"},(0,s.h)("calcite-button",{appearance:"transparent",kind:"danger",width:"full",onClick:()=>this.removeStyle()},t.removeStyle));return(0,s.h)("div",{class:{scroller:!0,"marker-selection":this.isGridView},key:"gallery"},i?(0,s.h)("calcite-loader",{label:""}):0===this._activeSymbolItems.length&&"custom-symbol-set"===this._activeSourceId?(0,s.h)("arcgis-symbol-picker-file-upload",{portal:o,strings:t}):this._activeSymbolItems.length>0?(0,s.h)("div",{class:"item-palette",key:this._activeSymbolItems.length},this.isGridView?this._renderGridView():this._renderListView(),"custom-symbol-set"===this._activeSourceId&&(0,s.h)("arcgis-symbol-picker-file-upload",{class:"file-upload",portal:o,strings:t}),this.displayEmptyFilterMsg&&(0,s.h)("div",{class:"empty-filter"},this.messages.noFilterSymbolsAvailable),this.savedStyleIds.includes(this._activeSourceId)&&r):(0,s.h)("div",null,(0,s.h)("div",{class:"empty-category-content"},this.messages.noSymbolsAvailable),this.savedStyleIds.includes(this._activeSourceId)&&r))}_renderGridView(){return(0,s.h)("arcgis-item-palette",{key:this._activeSourceId,items:this._activeSymbolItems.map(((e,t)=>({item:e,index:t,observer:this._symbolIntersectionObserver}))),ItemRenderer:F,itemsPerRow:this.itemsPerRow,selected:({item:e})=>{var t;return(null==e?void 0:e.data)===(null===(t=this.activeSymbolItem)||void 0===t?void 0:t.data)},onArcgisItemSelect:e=>{const{detail:{item:t}}=e;this.customSymbolError=void 0,this.arcgisActiveSymbolItemChange.emit(t),this.activeSymbolItem=t,t.getSymbol().then((e=>this.arcgisActiveSymbolChange.emit(e))),e.stopPropagation()},ref:e=>this.itemPaletteNode=e})}_renderListView(){const{messages:e}=this,t="rtl"===(0,c.g)(this.el);return(0,s.h)("calcite-list",{key:this._activeSourceId,filterEnabled:this._activeSymbolItems.length>10,filterPlaceholder:e.filterPlaceholder,onCalciteListFilter:e=>{const t=e.target;this.displayEmptyFilterMsg=t.filterText&&0===t.filteredItems.length}},this._activeSymbolItems.map(((e,i)=>{var o,r;return(0,s.h)("calcite-list-item",{key:i,label:e.data.title||e.data.name,value:i,selected:(null===(o=this.activeSymbolItem)||void 0===o?void 0:o.data.name)===e.data.name,metadata:null===(r=e.data.tags)||void 0===r?void 0:r.toString(),onCalciteListItemSelect:e=>{const t=e.target,i=this._activeSymbolItems[t.value];this.customSymbolError=void 0,this.arcgisActiveSymbolItemChange.emit(i),this.activeSymbolItem=i,i.getSymbol().then((e=>this.arcgisActiveSymbolChange.emit(e))),e.stopPropagation()}},(0,s.h)("div",{slot:"actions-start",class:"symbol-div",key:e.data.name,ref:t=>{t&&(e.getThumbnail(t).then((e=>e())),e.getSymbol())}}),"custom-symbol-set"===this._activeSourceId&&(0,s.h)("calcite-action",{slot:"actions-end",appearance:"transparent",text:this.messages.removeSymbol,ref:e=>{e&&(this.actionEls[i]=e)},onClick:()=>{this.removeCustomSymbol(i),(0,s.f)(this.el)},onMouseOver:()=>this.addTooltip({referenceElement:this.actionEls[i],placement:t?"right-start":"left-start",innerHTML:this.messages.removeSymbol}),onMouseOut:()=>this.removeTooltip()},(0,s.h)("calcite-icon",{scale:"s",icon:"x"})))})))}updateListSelection(){this.el.querySelectorAll("CALCITE-LIST-ITEM").forEach((e=>{e.selected=e.value===this.activeSymbolItem.data.name,e.selected&&e.setFocus()}))}removeCustomSymbol(e){this.allCustomFileInfos.splice(e,1),(0,n.s)(this.customSymbolsStorageId,this.allCustomFileInfos.map((e=>e.dataURL?e:Object.assign(Object.assign({},e),{cim:JSON.stringify(e.cim.toJSON())}))),!0),this._setupCustomSymbols(),this.activeSymbolItem=void 0}addTooltip(e){this.removeTooltip(),this.tooltipEl=document.createElement("calcite-tooltip"),this.tooltipEl.placement=e.placement||"auto",this.tooltipEl.referenceElement=e.referenceElement,this.tooltipEl.overlayPositioning="fixed",this.tooltipEl.innerHTML=e.innerHTML,this.tooltipEl.open=!0,this.el.parentElement.appendChild(this.tooltipEl)}removeTooltip(){var e;(null===(e=this.tooltipEl)||void 0===e?void 0:e.parentNode)&&(this.tooltipEl.parentNode.removeChild(this.tooltipEl),this.tooltipEl=void 0)}removeStyle(){var e;this.savedStyleIds=this.savedStyleIds.filter((e=>e!==this._activeSourceId)),this.removeStyleIds([this._activeSourceId]),this._activeSourceId=(null===(e=this.savedStyleIds)||void 0===e?void 0:e[0])||this._symbolSources[0].id}removeStyleIds(e){let t=(0,n.g)(ie,!0)||{},i=t.point||[];i=i.filter((t=>!e.includes(t))),t.point=i.length?i:void 0;let s=t.line||[];s=s.filter((t=>!e.includes(t))),t.line=s.length?s:void 0;let o=t.polygon||[];o=o.filter((t=>!e.includes(t))),t.polygon=o.length?o:void 0,JSON.stringify(t)===JSON.stringify({})?(0,n.r)(ie):(0,n.s)(ie,t,!0),this._fetchSources()}async componentWillLoad(){const[,[e]]=await Promise.all([r.e.load(),(0,a.g)(this.el)]);this.messages=e;const t=(0,r.g)(this.symbol),i=(0,n.g)(ie,!0)||{};this.savedStyleIds=(null==i?void 0:i[t])||[]}componentDidLoad(){this._symbolSources||this._fetchSources(),this._getCustomSymbolsFromStorage()}connectedCallback(){var e,t;this.setUpSymbolIntersectionObserver(),null===(e=this._activeSymbolFetch)||void 0===e||e.controller.abort(),null===(t=this._sourcesFetchController)||void 0===t||t.abort()}disconnectedCallback(){this.tearDownSymbolIntersectionObserver()}render(){const e=this._symbolSources,t=this._activeSymbolFetch;if(!e||t)return(0,s.h)("div",{class:se},(0,s.h)("calcite-loader",{label:""}));const i="basic-symbol-set"===this._activeSourceId||"custom-symbol-set"===this._activeSourceId,o=this._symbolSources.find((e=>e.id===this._activeSourceId)),r=!i&&"symbol-set"!==(null==o?void 0:o.type),n=null==o?void 0:o.keywords.includes("Adobe");return(0,s.h)("div",{class:se},this._renderSourceSelection(),this._renderItemSelection(),n?(0,s.h)("calcite-notice",{open:!0,kind:"danger",key:"copyright",scale:"s"},(0,s.h)("div",{slot:"message",innerHTML:this.messages.adobeCopyright.replace("${year}","2024")})):null,r&&"3d"!==this.symbolType&&!(0,l.g)(l.l.ARCGIS_COMPONENT_NOTIFICATIONS,l.a.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED)?(0,s.h)("calcite-notice",{open:!0,class:oe,closable:!0,icon:!0,key:"incompatible-symbols",onCalciteNoticeClose:this.onIncompatibleVectorSymbolsDismiss,scale:"s"},(0,s.h)("div",{slot:"message"},this.messages.incompatibleSymbolWarning)):null,this.customSymbolError?(0,s.h)("calcite-notice",{open:!0,class:oe,closable:!0,icon:"exclamation-mark-circle",kind:"danger",key:"large-symbol",onCalciteNoticeClose:()=>this.customSymbolError=void 0,scale:"s"},(0,s.h)("div",{slot:"message"},"too-large"===this.customSymbolError?this.messages.customSymbolErrors.tooLarge:"invalid-file"===this.customSymbolError?this.messages.customSymbolErrors.invalidFile:"storage-full"===this.customSymbolError?this.messages.customSymbolErrors.outOfSpace:"error"===this.customSymbolError?this.messages.customSymbolErrors.error:void 0)):null)}get el(){return(0,s.d)(this)}static get watchers(){return{_activeSourceId:["handleActiveSourceItemIdChanges"]}}};re.style=".scroller.sc-arcgis-symbol-picker{max-height:var(--scroller-max-height, min(100vh - 380px, 320px));overflow-y:auto;min-width:200px;overflow-x:hidden;display:flex;justify-content:center}.sc-arcgis-symbol-picker-h,.arcgis-symbol-picker__container.sc-arcgis-symbol-picker{display:flex;flex:1 1 auto;flex-flow:column nowrap;align-items:stretch}.categories.sc-arcgis-symbol-picker{display:flex;align-content:normal}.categories-center-action.sc-arcgis-symbol-picker{padding:0 5px}.marker-selection.sc-arcgis-symbol-picker{padding:8px}.symbol-div.sc-arcgis-symbol-picker{padding:0 8px}.marker-source-select.sc-arcgis-symbol-picker{width:calc(100% - 74px);display:block}.marker-source-select[hidden].sc-arcgis-symbol-picker+.marker-selection.sc-arcgis-symbol-picker{border-top:1px solid lightgray;background-color:var(--arcgis-app-background)}.marker-selection--dark.sc-arcgis-symbol-picker{background-color:var(--arcgis-app-foreground);color:var(--arcgis-app-background)}.empty-category-content.sc-arcgis-symbol-picker{display:flex;align-items:center;justify-content:center;padding:var(--arcgis-app-spacing-half) var(--arcgis-app-spacing-quarter)}.empty-filter.sc-arcgis-symbol-picker{display:flex;align-items:center;justify-content:center;padding:8px}.incompatible-symbols-notice.sc-arcgis-symbol-picker{margin:8px 0}.marker-item.sc-arcgis-symbol-picker{height:40px;width:38.5px;display:flex;justify-content:center;align-items:center;background-color:var(--arcgis-app-background)}.marker-item.sc-arcgis-symbol-picker [slot=thumbnail].sc-arcgis-symbol-picker>div.sc-arcgis-symbol-picker{margin:8px 10px;display:flex;justify-content:center;align-items:center}.item-palette.sc-arcgis-symbol-picker{width:100%;display:flex;flex-direction:column}.file-upload.sc-arcgis-symbol-picker{margin-top:20px;width:auto}.remove-button.sc-arcgis-symbol-picker{padding:10px 0}"},68757:(e,t,i)=>{i.d(t,{a:()=>o,c:()=>n,i:()=>a,t:()=>r});var s=i(95909);const o=e=>Number((100*(1-e)).toFixed(1)),r=e=>Number((1-e/100).toFixed(3)),l=[0,0,0,0];function n(e,t=!1){const i=null!=e?e:l;return t?s.e.Color.fromJSON(i):new s.e.Color(i)}function a({r:e,g:t,b:i,a:s}){return 0===e&&0===t&&0===i&&0===s}},88703:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>u,c:()=>o,d:()=>s,e:()=>r,f:()=>m,g:()=>y,i:()=>l,m:()=>n,t:()=>a,u:()=>d});const s=(e,t)=>{let i,s="idle";const o=(...o)=>new Promise((r=>{switch(s){case"flushed":s="idle",i?(clearTimeout(i),r(e(...o))):r(null);break;case"invoked":clearTimeout(i),s="idle",r(e(...o));break;case"cancelled":clearTimeout(i),s="idle",r(null);break;default:i&&clearTimeout(i),s="pending",i=setTimeout((()=>(s="idle",r(e(...o)))),t)}}));return o.flush=function(...e){return s="flushed",o(...e)},o.invoke=function(...e){return s="invoked",o(...e)},o.cancel=function(...e){return s="cancelled",o(...e)},o.getStatus=function(){return s},o},o=(e,t)=>{let i;return(...s)=>new Promise((o=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,o(e(...s))}),t))}))};function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e){return null!=e}async function n(e,t){return await Promise.all([e,a(t)]),e}function a(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:s}=t(e);return[i,s]}))),m=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function d(e,t){const i=[],s={};return e.forEach((e=>{const o=t(e);null==s[o]&&(s[o]=e,i.push(e))})),i}function u(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const y=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,s)=>e.slice(t*s,t+t*s)))},68558:(e,t,i)=>{var s,o;i.d(t,{a:()=>o,g:()=>n,l:()=>s,s:()=>l}),function(e){e.ARCGIS_COMPONENT_NOTIFICATIONS="arcgisComponent_notifications"}(s||(s={})),function(e){e.FEATURE_REDUCTION_WARNING_DISMISSED="arcgis_feature_reduction_warning_dismissed",e.POPUP_WARNING_DISMISSED="arcgis_popup_warning_dismissed",e.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED="arcgis_symbol_styler_incompatible_vector_symbols_dismissed",e.EFFECTS_TIP_DISMISSED="arcgis_effects_tip_dismissed",e.LAYER_VIEW_DEFINITION_DISMISSED="arcgis_layer_view_definition_dismissed",e.LAYER_OVERRIDE_STATUS_TIP_DISMISSED="arcgis_layer_override_status_tip_dismissed",e.SMART_MAPPING_TIP1_DISMISSED="arcgis_smart_mapping_tip1_dismissed",e.SMART_MAPPING_TIP2_DISMISSED="arcgis_smart_mapping_tip2_dismissed",e.LAYER_VIEW_JOIN_TIP_DISMISSED="arcgis_layer_view_join_tip_dismissed",e.MULTIDIMENSIONAL_INFO_TIP_DISMISSED="arcgis_multidimensional_info_tip_dismissed"}(o||(o={}));const r=e=>JSON.parse((e=>localStorage.getItem(e))(e))||{},l=(e,t)=>{const i=r(e);i[t.key]=t.value,((e,t)=>{localStorage.setItem(e,t)})(e,JSON.stringify(i))},n=(e,t)=>{const i=r(e);return(null==i?void 0:i.hasOwnProperty(t))?i[t]:null}},22250:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>m,c:()=>r,d:()=>o,g:()=>n,r:()=>a,s:()=>l});var s=i(88703);function o(e,t,i,s){!function(e,t,i){let s=null==(i=i||{})?void 0:i.expires;if("number"==typeof s){const e=new Date,t=24*s*60*60*1e3;e.setTime(Date.now()+t),s=i.expires=e}"string"!=typeof s&&(null==s?void 0:s.toUTCString)&&(i.expires=s.toUTCString());let o,r=`${e}=${encodeURIComponent(t)}`;for(o in i){r+=`; ${o}`;const e=i[o];!0!==e&&(r+=`=${e}`)}document.cookie=r}(e,s?JSON.stringify(t):t,i)}function r(e,t){const i=function(e){const t=document.cookie,i=new RegExp(`(?:^|; )${(0,s.e)(e)}=([^;]*)`),o=t.match(i);return o?decodeURIComponent(o[1]):void 0}(e);return i&&t?JSON.parse(i):i}function l(e,t,i){window.localStorage.setItem(e,i?JSON.stringify(t):t)}function n(e,t){const i=window.localStorage.getItem(e);return i&&t?JSON.parse(i):i}function a(e){window.localStorage.removeItem(e)}function c(e,t,i){window.sessionStorage.setItem(e,i?JSON.stringify(t):t)}function m(e,t){const i=window.sessionStorage.getItem(e);return i&&t?JSON.parse(i):i}},95909:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>m,c:()=>c,d:()=>a,e:()=>r,f:()=>y,g:()=>o,h:()=>u,i:()=>l,j:()=>d});var s=i(21104);function o(e){return"cim"===e.type?"CIMLineSymbol"===e.data.symbol.type?"line":"CIMPolygonSymbol"===e.data.symbol.type?"polygon":"point":"simple-marker"===e.type||"picture-marker"===e.type?"point":"simple-line"===e.type?"line":"polygon"}const r={loaded:!1,async load(){if(this.loaded)return;const[e,t,i,o,r,l,n,a,c,m,d,u,y,h,p,b,S]=await(0,s.l)(["esri/core/screenUtils","esri/Color","esri/portal/Portal","esri/symbols/CIMSymbol","esri/symbols/WebStyleSymbol","esri/core/devEnvironmentUtils","esri/core/promiseUtils","esri/core/urlUtils","esri/portal/PortalItem","esri/symbols/support/previewSymbol2D","esri/symbols/support/gfxUtils","esri/symbols/support/jsonUtils","esri/symbols/support/styleUtils","esri/symbols/support/svgUtils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/symbols/support/webStyleSymbolUtils"]);this.Color=t,this.Portal=i,this.CIMSymbol=o,this.WebStyleSymbol=r,this.devEnvironmentUtils=l,this.previewSymbol2D=m,this.promiseUtils=n,this.urlUtils=a,this.PortalItem=c,this.gfxUtils=d,this.jsonUtils=u,this.screenUtils=e,this.styleUtils=y,this.svgUtils=h,this.symbolUtils=p,this.cimSymbolUtils=b,this.webStyleSymbolUtils=S,this.loaded=!0}};function l(e){return"cim"===(null==e?void 0:e.type)}function n(e){return"simple-marker"===(null==e?void 0:e.type)}function a(e){return"picture-marker"===(null==e?void 0:e.type)}function c(e){return"simple-line"===(null==e?void 0:e.type)}function m(e){return"simple-fill"===(null==e?void 0:e.type)}function d(e){return"CIMPointSymbol"===e.data.symbol.type}function u(e){return"CIMLineSymbol"===e.data.symbol.type}function y(e){return"CIMPolygonSymbol"===e.data.symbol.type}}}]);