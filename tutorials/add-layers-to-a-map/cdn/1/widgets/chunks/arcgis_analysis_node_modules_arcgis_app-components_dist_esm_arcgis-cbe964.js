/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-cbe964.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-cbe964"],{3700:(e,t,i)=>{i.r(t),i.d(t,{arcgis_sketch:()=>R,arcgis_sketch_content:()=>A,arcgis_sketch_shortcuts:()=>F,arcgis_sketch_snapping:()=>V,arcgis_sketch_tools:()=>N});var s=i(35110),o=i(1984),l=i(86587),n=i(21104),a=i(22250),r=i(88703),c=i(95909),h=i(23505),p=i(2137),d=i(89393),u=i(27031);i(63280),i(73838);const g=["#ff4040","#ff8202","#faa83e","#ffd159","#73b566","#008977","#33e3c8","#43abeb","#4b64c9","#9868ed","#b055e6","#db5181","#e03b99","#2b2b2b","#bdbdbd","#ffffff"],m=["#ffffff","#bdbdbd","#2b2b2b","#e03b99","#db5181","#b055e6","#9868ed","#4b64c9","#43abeb","#33e3c8","#008977","#73b566","#ffd159","#faa83e","#ff8202","#ff4040"];function y(e){var t,i;switch(null===(t=null==e?void 0:e.geometry)||void 0===t?void 0:t.type){case"point":return"text"===(null===(i=null==e?void 0:e.symbol)||void 0===i?void 0:i.type)?"text":"point";case"polyline":return"polyline";default:return"polygon"}}const f=(e,t)=>{const i=[...new Set([...e.featureSources.filter((e=>e.enabled)).map((e=>e.layer.id))])],s={enabled:e.enabled,selfEnabled:e.selfEnabled,featureEnabled:e.featureEnabled,featureSourcesIds:i};(0,a.a)(t,s,!0)},S=async(e,t)=>{const i=await async function(e){const[t]=await(0,n.l)(["esri/core/CollectionFlattener"]),{map:i}=e,{allLayers:s}=i,o=new t({getCollections:()=>[s],getChildrenFunction:e=>"layers"in e?e.layers:"sublayers"in e?e.sublayers:null,itemFilterFunction:e=>!e.isTable});return[...new Set(o.toArray())]}(e);return i.filter((e=>t.includes(e.id))).map((e=>({layer:e,enabled:!0})))};class k{constructor(e,t,i,s,o,l,n){this.mapNotesLayer=e,this.mapView=t,this.sketchViewModelPoint=new i({layer:this.mapNotesLayer.pointLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:s,tooltipOptions:o}),this.sketchViewModelPoint.on("create",(e=>l(e,this.sketchViewModelPoint))),this.sketchViewModelPoint.on("update",(e=>n(e))),this.sketchViewModelLine=new i({layer:this.mapNotesLayer.polylineLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:s,tooltipOptions:o}),this.sketchViewModelLine.on("create",(e=>l(e,this.sketchViewModelLine))),this.sketchViewModelLine.on("update",(e=>n(e))),this.sketchViewModelPolygon=new i({layer:this.mapNotesLayer.polygonLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:s,tooltipOptions:o}),this.sketchViewModelPolygon.on("create",(e=>l(e,this.sketchViewModelPolygon))),this.sketchViewModelPolygon.on("update",(e=>n(e))),this.sketchViewModelText=new i({layer:this.mapNotesLayer.textLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:s,tooltipOptions:o}),this.sketchViewModelText.on("create",(e=>l(e,this.sketchViewModelText))),this.sketchViewModelText.on("update",(e=>n(e)))}delete(){this._deletePoint(),this._deleteLine(),this._deletePolygon(),this._deleteText()}cancel(){this._cancelPoint(),this._cancelLine(),this._cancelPolygon(),this._cancelText()}duplicate(){this._duplicatePoint(),this._duplicateLine(),this._duplicatePolygon(),this._duplicateText()}updateOnGraphic(e,t){var i;null===(i=this.hitTestHandle)||void 0===i||i.remove(),e&&(this.hitTestHandle=this.mapView.on("click",(async e=>{const i=(await this.mapView.hitTest(e,{include:this.mapNotesLayer})).results;if(i.length){const e=["point","polyline","polygon"];i.sort((function(t,i){return e.indexOf(t.graphic.geometry.type)-e.indexOf(i.graphic.geometry.type)}));const t=i[0].graphic;switch(t.layer){case this.mapNotesLayer.pointLayer:this.updatePoint([t]);break;case this.mapNotesLayer.textLayer:this.updateText([t]);break;case this.mapNotesLayer.polylineLayer:this.updateLine([t]);break;case this.mapNotesLayer.polygonLayer:this.updatePolygon([t]);default:return}}else t&&t({state:"complete"})})))}destroy(){this._destroyPoint(),this._destroyLine(),this._destroyPolygon(),this._destroyText()}getPointSVM(){return this.sketchViewModelPoint}getPoint(){return this.sketchViewModelPoint.pointSymbol}setPoint(e){this.sketchViewModelPoint.pointSymbol=e}createPoint(){this.sketchViewModelPoint.create("point")}updatePoint(e){this.sketchViewModelPoint.update(e)}_deletePoint(){this.sketchViewModelPoint.delete()}_cancelPoint(){this.sketchViewModelPoint.cancel()}_duplicatePoint(){this.sketchViewModelPoint.duplicate()}_destroyPoint(){this.sketchViewModelPoint.destroy()}getLineSVM(){return this.sketchViewModelLine}getLine(){return this.sketchViewModelLine.polylineSymbol}setLine(e){this.sketchViewModelLine.polylineSymbol=e}createLine(){this.sketchViewModelLine.create("polyline")}updateLine(e){this.sketchViewModelLine.update(e)}_deleteLine(){this.sketchViewModelLine.delete()}_cancelLine(){this.sketchViewModelLine.cancel()}_duplicateLine(){this.sketchViewModelLine.duplicate()}_destroyLine(){this.sketchViewModelLine.destroy()}getPolygonSVM(){return this.sketchViewModelPolygon}getPolygon(){return this.sketchViewModelPolygon.polygonSymbol}setPolygon(e){this.sketchViewModelPolygon.polygonSymbol=e}createPolygon(e){this.sketchViewModelPolygon.create(e)}updatePolygon(e){this.sketchViewModelPolygon.update(e)}_deletePolygon(){this.sketchViewModelPolygon.delete()}_cancelPolygon(){this.sketchViewModelPolygon.cancel()}_duplicatePolygon(){this.sketchViewModelPolygon.duplicate()}_destroyPolygon(){this.sketchViewModelPolygon.destroy()}getTextSVM(){return this.sketchViewModelText}getText(){return this.sketchViewModelText.pointSymbol}setText(e){this.sketchViewModelText.pointSymbol=e}createText(){this.sketchViewModelText.create("point")}updateText(e){this.sketchViewModelText.update(e)}_deleteText(){this.sketchViewModelText.delete()}_cancelText(){this.sketchViewModelText.cancel()}_duplicateText(){this.sketchViewModelText.duplicate()}_destroyText(){this.sketchViewModelText.destroy()}}function b(e){if(!function(e){var t,i,s,o,l,n;const a=e.data.symbol.symbolLayers;if(1===a.length){const e=a[0];if("CIMVectorMarker"!==e.type||e.colorLocked)return!1;const s=null===(i=null===(t=e.markerGraphics[0])||void 0===t?void 0:t.symbol)||void 0===i?void 0:i.symbolLayers;return 1===e.markerGraphics.length&&M(s)}if(2===a.length){const e=a[0],t=a[1];if("CIMVectorMarker"!==e.type||"CIMVectorMarker"!==t.type||e.colorLocked||e.size>t.size)return!1;const i=null===(o=null===(s=e.markerGraphics[0])||void 0===s?void 0:s.symbol)||void 0===o?void 0:o.symbolLayers,r=null===(n=null===(l=t.markerGraphics[0])||void 0===l?void 0:l.symbol)||void 0===n?void 0:n.symbolLayers;return 1===e.markerGraphics.length&&1===t.markerGraphics.length&&M(i)&&function(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type))}(e)&&E(e)}(r)}return!1}(e))return;const t=e.data.symbol.symbolLayers;return t[t.length-1].markerGraphics[0].symbol.symbolLayers.find((e=>"CIMSolidStroke"===e.type))}function v(e){return"cim"===e.type?c.e.cimSymbolUtils.getCIMSymbolSize(e):"text"===e.type?e.font.size:(0,r.i)(e.size)?e.size:e.width}function w(e,t){if("cim"===e.type)c.e.cimSymbolUtils.scaleCIMSymbolTo(e,t);else if((0,r.i)(e.size))e.size=t;else{const i=e.height/e.width;e.width=t,e.height=e.width*i}}function I(e){return"cim"===e.type?c.e.cimSymbolUtils.getCIMSymbolRotation(e,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1?e.angle:void 0}function P(e,t){(0,r.i)(t)&&("cim"===e.type?c.e.cimSymbolUtils.applyCIMSymbolRotation(e,t,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1&&(e.angle=t))}function C(e){var t,i;return"cim"===(null==e?void 0:e.type)?c.e.Color.fromJSON(null===(t=c.e.cimSymbolUtils.getCIMSymbolColor(e))||void 0===t?void 0:t.toJSON()):"simple-marker"===(null==e?void 0:e.type)&&["x","cross"].indexOf(null==e?void 0:e.style)>-1?null===(i=null==e?void 0:e.outline)||void 0===i?void 0:i.color:null==e?void 0:e.color}function T(e){return"cim"===(null==e?void 0:e.type)?function(e){var t,i,s;if("picture-marker"!==e.type&&"CIMPointSymbol"!==(null===(t=e.data.symbol)||void 0===t?void 0:t.type))return"CIMLineSymbol"===(null===(i=e.data.symbol)||void 0===i?void 0:i.type)?function(e){return e.data.symbol.symbolLayers[0]}(e):"CIMPolygonSymbol"===(null===(s=e.data.symbol)||void 0===s?void 0:s.type)?function(e){return e.data.symbol.symbolLayers.find((e=>"CIMSolidStroke"===e.type))}(e):void 0}(e):null==e?void 0:e.outline}function M(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type&&!e.colorLocked))}(e)&&E(e)}function E(e){return null==e?void 0:e.find((e=>"CIMSolidStroke"===e.type))}const x=(e,t)=>{const i={enabled:e.enabled};(0,a.a)(t,i,!0)},L=e=>e&&((0,a.b)(e.webmap,!0)||(0,a.b)(e.current,!0))||null,O=(0,h.c)({mapView:null,portal:null,layer:null,strings:null,currentLanguage:"",sketchMessage:"",svModel:null,snappingOptions:null,sketchTooltipOptions:null,snappingSessionStorageIds:null,sketchTooltipSessionStorageIds:null}).state,R=class{constructor(e){(0,s.r)(this,e),this.sketchUpdated=(0,s.c)(this,"sketchUpdated",7),this.arcgisSketchDismissedChange=(0,s.c)(this,"arcgisSketchDismissedChange",7),this.arcgisSketchCopyToNewSketchLayer=(0,s.c)(this,"arcgisSketchCopyToNewSketchLayer",7),this.arcgisRecentColorsUpdate=(0,s.c)(this,"arcgisRecentColorsUpdate",7),this.internalSketchUpdated=(0,s.c)(this,"internalSketchUpdated",7),this.closeSketchPopovers=(0,s.c)(this,"closeSketchPopovers",7),this.closePopupPopovers=(0,s.c)(this,"closePopupPopovers",7),this.sketchContentReRender=(0,s.c)(this,"sketchContentReRender",7),this.disableSketchPanel=(0,s.c)(this,"disableSketchPanel",7),this.closeSketchSnappingPopovers=(0,s.c)(this,"closeSketchSnappingPopovers",7),this.sketchActionOnSelectFeatures=(0,s.c)(this,"sketchActionOnSelectFeatures",7),this.sketchMode="update",this.escKey=!1,this.keepSelectionMessage="",this.keepSelectionTool=null,this.deleteInProgress=!1,this.needsMapViewHandles=!1,this.onGraphicUpdate=e=>{var t,i;if("start"===e.state)if(this.mapView.closePopup(),this.multipleSelectedGraphics.length<=1&&this.newSketchLayerFeatures.length<=1&&1===e.graphics.length)this.currentSketchInfo.graphics=[e.graphics[0]],this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,!this.multipleSelectedGraphics.length&&this.multipleSelectedGraphics.push(this.currentSketchInfo.graphics[0]),this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]),this.currentSketchInfo.popup=this.currentSketchInfo.graphics[0].popupTemplate,this.currentSketchInfo.title=(null===(t=this.currentSketchInfo.graphics[0].attributes)||void 0===t?void 0:t.title)||this.defaultGraphicTitle(),this.sketchContentReRender.emit(),this.showSketchContent=!0;else if(this.multipleSelectedGraphics.length||this.newSketchLayerFeatures.length){this.currentSketchInfo.graphics=this.multipleSelectedGraphics.length?this.multipleSelectedGraphics:this.newSketchLayerFeatures,this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]);const e=(null===(i=this.currentSketchInfo.graphics[0].attributes)||void 0===i?void 0:i.title)||this.defaultGraphicTitle(),t=this.currentSketchInfo.graphics.every((t=>{var i;return(null===(i=t.attributes)||void 0===i?void 0:i.title)===e})),s=this.currentSketchInfo.graphics[0].popupTemplate,o=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(s)));this.currentSketchInfo.title=t?e:null,this.currentSketchInfo.popup=o?s:null,this.sketchContentReRender.emit(),this.showSketchContent=!0}else this.sketchMessageHandler(null);if("complete"===e.state){const{keepSelectionTool:e}=this;this.newSketchLayerFeatures=[];const t=e!==this.sketchToolsEl.activeSelectTool;!e||t?(this.currentSketchInfo.graphics=null,this.multipleSelectedGraphics=[],this.closeSketchPopovers.emit(),this.internalSketchUpdated.emit(),this.sketchContentReRender.emit()):!this.deleteInProgress&&this.keepSelectToolSelection()}},this.mapView=void 0,this.layer=void 0,this.portal=void 0,this.dismissible=!1,this.snappingSessionStorageIds=void 0,this.sketchTooltipSessionStorageIds=void 0,this.activeSketchTool=void 0,this.sketchToolsToHide=[],this.hideSelectionTools=!1,this.selectedSketchFeaturesFeatures=void 0,this.mapNotesFeature=null,this.showSketchToolsOnly=!1,this.sketchToolsReferenceElement=void 0,this.currentSketchInfo={tool:null,symbol:null,graphics:null,popup:null,title:null,sourceIds:{}},this.multipleSelectedGraphics=[],this.newSketchLayerFeatures=[],this.showSketchContent=!0}async componentWillLoad(){var e;[this.strings,this.currentLanguage]=await(0,o.g)(this.hostElement),await this.loadAllModules(),await this.initializeSessionStorageOptions(),this.initializeSVModel(),O.svModel=this.svModel,O.mapView=this.mapView,O.layer=this.layer,O.portal=this.portal,O.strings=this.strings,O.currentLanguage=this.currentLanguage,O.snappingOptions=this.snappingOptions,O.sketchTooltipOptions=this.sketchTooltipOptions,O.snappingSessionStorageIds=this.snappingSessionStorageIds,O.sketchTooltipSessionStorageIds=this.sketchTooltipSessionStorageIds,this.mapNotesFeature&&(this.selectedSketchFeaturesFeatures=[this.mapNotesFeature]),(null===(e=this.selectedSketchFeaturesFeatures)||void 0===e?void 0:e.length)&&(this.multipleSelectedGraphics=this.selectedSketchFeaturesFeatures.filter((e=>(0,r.i)(e))),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,this.updateCurrentSketchInfo())}componentDidLoad(){this.needsMapViewHandles&&(this.mapView.focus(),this.watchDeleteOnMapView(!0),this.watchEscapeOnMapView(!0)),this.mapView.popupEnabled=!1,this.createSketchTools()}disconnectedCallback(){var e;this.watchEscapeOnMapView(!1),this.watchDeleteOnMapView(!1),this.svModel.updateOnGraphic(!1),this.removeSketchShortcuts(),null===(e=this.selectorOperation)||void 0===e||e.cancel(),this.removeSketchShortcutsTooltip()}arcgisSketchActiveSymbolChangeHandler(){this.sketchContentReRender.emit()}closeSketchPopoversHandler(){this.closePopupPopovers.emit(),this.sketchMessageHandler(null),this.showSketchContent=!1,this.closeSketchSnappingPopovers.emit(),this.removeSketchShortcuts(),this.setFocus()}closeSketchSnappingPopoversHandler(){this.sketchSnappingEl&&(document.body.removeChild(this.sketchSnappingEl),this.sketchSnappingEl=null,this.disableSketchPanel.emit(!1)),this.setFocus()}disableSketchPanelHandler(e){e.stopPropagation(),this.sketchFlowItemEl.disabled=e.detail}internalSketchUpdatedHandler(e){e.stopPropagation(),this.sketchUpdated.emit()}sketchGraphicUpdatesHandler(e){var t,i,s,o,l;e.stopPropagation();const n=e.detail;if(n.update){if("symbol"===n.type&&n.symbolSwitchFromRecent){const e=null===(t=C(this.currentSketchInfo.symbol.clone()))||void 0===t?void 0:t.toHex();e&&this.arcgisRecentColorsUpdate.emit(e)}if("update"===this.sketchMode&&(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)){const e=this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics[0].symbol.clone(),i=this.currentSketchInfo.symbol.clone(),l=v(t),a=I(t),h=C(t),p=T(t),d=null===(s=t.outline)||void 0===s?void 0:s.style,u=t.style,g=t.marker,m=t.backgroundColor,y=v(i),f=I(i),S=C(i),k=T(i),b=null===(o=i.outline)||void 0===o?void 0:o.style,M=i.style,E=i.marker,x=i.backgroundColor;this.currentSketchInfo.graphics.forEach(((t,i)=>{if("title"===n.type&&(t.attributes?this.currentSketchInfo.graphics[i].attributes.title=this.currentSketchInfo.title:this.currentSketchInfo.graphics[i].attributes={title:this.currentSketchInfo.title}),"popup"===n.type&&(this.currentSketchInfo.graphics[i].popupTemplate=this.currentSketchInfo.popup),"symbol"===n.type)if(!e||n.symbolSwitchFromRecent){const e=this.currentSketchInfo.symbol.clone();"recent-text"===n.textProp&&(e.text=this.currentSketchInfo.graphics[i].symbol.clone().text),this.currentSketchInfo.graphics[i].symbol=e}else if(n.symbolSwitch){const e=this.currentSketchInfo.symbol.clone(),t=this.currentSketchInfo.graphics[i].symbol.clone();(0,r.i)(v(t))&&(0,r.i)(v(e))&&w(e,v(t)),(0,r.i)(I(t))&&(0,r.i)(I(e))&&P(e,I(t)),this.currentSketchInfo.graphics[i].symbol=e}else{const e=this.currentSketchInfo.graphics[i].symbol.clone(),t=this.currentSketchInfo.symbol.clone();if(l!==y&&w(e,v(t)),a!==f&&P(e,I(t)),JSON.stringify(h)!==JSON.stringify(S)){const i=C(e),l=C(t);h.a===S.a?(i.r=l.r,i.g=l.g,i.b=l.b):i.a=l.a,o=i,"picture-marker"!==(s=e).type&&("cim"===s.type?c.e.cimSymbolUtils.applyCIMSymbolColor(s,o):"simple-marker"===s.type&&s.style&&["cross","x"].indexOf(s.style)>-1?(s.outline||(s.outline=new __esri.SimpleLineSymbol),s.outline.color=o):s.color=o)}if(JSON.stringify(m)!==JSON.stringify(x)&&(e.backgroundColor=x),JSON.stringify(p)!==JSON.stringify(k)){const i=T(e),s=T(t),o=(null==p?void 0:p.color.a)===(null==k?void 0:k.color.a);(null==p?void 0:p.width)===(null==k?void 0:k.width)?o?(i.color.r=s.color.r,i.color.g=s.color.g,i.color.b=s.color.b):i.color.a=s.color.a:i.width=s.width,function(e,t){"cim"===e.type?e.data.symbol.symbolLayers.forEach(((i,s)=>{"CIMSolidStroke"===i.type&&(e.data.symbol.symbolLayers[s]=t)})):e.outline=t}(e,i)}if(JSON.stringify(d)!==JSON.stringify(b)&&e.outline&&(e.outline.style=b),JSON.stringify(u)!==JSON.stringify(M)&&(e.style=M),JSON.stringify(g)!==JSON.stringify(E)&&(e.marker=E),n.textProp)switch(n.textProp){case"text":e.text=t.text;break;case"font":e.font.family=t.font.family,e.font.weight=t.font.weight,e.font.style=t.font.style;break;case"font-size":e.font.size=t.font.size;break;case"color":e.color=t.color;break;case"rotation":e.angle=t.angle;break;case"halo":e.haloColor=t.haloColor,e.haloSize=t.haloSize;break;case"halo-color":e.haloColor=t.haloColor;break;case"halo-size":e.haloSize=t.haloSize}this.currentSketchInfo.graphics[i].symbol=e}var s,o}))}else this.tempCreatedGraphic&&(this.tempCreatedGraphic.attributes?this.tempCreatedGraphic.attributes.title=this.currentSketchInfo.title:this.tempCreatedGraphic.attributes={title:this.currentSketchInfo.title},this.tempCreatedGraphic.popupTemplate=this.currentSketchInfo.popup,this.tempCreatedGraphic.symbol=this.currentSketchInfo.symbol),"point"===this.currentSketchInfo.tool?this.svModel.setPoint(this.currentSketchInfo.symbol):"text"===this.currentSketchInfo.tool?this.svModel.setText(this.currentSketchInfo.symbol):"polyline"===this.currentSketchInfo.tool?this.svModel.setLine(this.currentSketchInfo.symbol):["circle","polygon","rectangle"].indexOf(this.currentSketchInfo.tool)>-1&&this.svModel.setPolygon(this.currentSketchInfo.symbol);this.mapView.popup.features=[null===(l=this.currentSketchInfo.graphics)||void 0===l?void 0:l[0]]}n.close&&(this.clearHighlightAndPopup(),this.closeSketchPopovers.emit(),this.svModel.cancel(),this.svModel.updateOnGraphic(!1),this.setFocus()),this.internalSketchUpdated.emit()}async sketchActionOnDrawFeaturesHandler({detail:{tool:e,sketchMessage:t}}){switch(this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!0),this.watchDeleteOnMapView(!1),"update"===this.sketchMode&&this.closeSketchPopovers.emit(),this.sketchMessageHandler(t),this.sketchMode="continuous",this.svModel.cancel(),this.svModel.updateOnGraphic(!1),this.tempCreatedGraphic=null,this.currentSketchInfo.graphics=null,this.currentSketchInfo.tool=e,e){case"point":this.svModel.setPoint(await(async(e,t,i)=>{const s=await i.getBackgroundColorTheme(t);return new e({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,colorLocked:!0,anchorPoint:{x:0,y:-1.75},anchorPointUnits:"Relative",size:5.7,frame:{xmin:0,ymin:0,xmax:84.3,ymax:84.3},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[83.2,32.5],[84.3,40.7],[83.8,48.9],[81.7,56.9],[78.1,64.3],[73,70.9],[66.9,76.4],[59.7,80.5],[51.9,83.2],[43.7,84.3],[35.4,83.8],[27.4,81.7],[20,78],[13.4,73],[7.9,66.8],[3.8,59.7],[1.1,51.9],[0,43.7],[.5,35.4],[2.6,27.4],[6.3,20],[11.3,13.4],[17.5,7.9],[24.7,3.8],[32.5,1.1],[39.8,.1],[47.1,.3],[54.3,1.8],[61.1,4.5],[67.4,8.4],[72.9,13.3],[77.4,19.1],[80.9,25.5],[83.2,32.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===s?[242,242,242,255]:[255,255,255,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-.5},anchorPointUnits:"Relative",size:15,frame:{xmin:0,ymin:0,xmax:197.7,ymax:294.7},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[98.9,0],[119.4,23.2],[139.4,49.3],[156.8,75.2],[171.2,100.8],[182.4,125.3],[190.6,148.8],[195.7,171.4],[197.7,192.9],[197.7,195.8],[197.7,200.3],[197.6,202.5],[197.5,204.8],[197.3,207.1],[197,209.4],[196.7,211.7],[196.4,214.1],[196,216.4],[195.5,218.7],[195,221.1],[194.4,223.4],[193.7,225.8],[193,228.1],[192.2,230.5],[191.4,232.8],[190.5,235.1],[189.5,237.5],[188.5,239.7],[187.4,242],[186.2,244.3],[185,246.5],[183.7,248.7],[182.4,250.9],[181,253.1],[179.5,255.2],[178,257.3],[176.4,259.4],[174.7,261.4],[173.1,263.3],[171.3,265.3],[169.5,267.2],[167.7,269],[165.8,270.8],[163.9,272.5],[161.9,274.2],[159.9,275.8],[157.8,277.4],[155.7,278.9],[153.6,280.4],[151.4,281.7],[149.2,283.1],[147,284.4],[144.8,285.6],[142.5,286.7],[140.3,287.8],[138,288.8],[135.7,289.8],[133.4,290.7],[131,291.5],[128.7,292.3],[126.4,293],[124,293.6],[121.7,294.2],[119.4,294.7],[117,295.2],[114.7,295.6],[112.4,296],[110.1,296.3],[107.8,296.5],[105.5,296.7],[103.3,296.8],[101.1,296.9],[98.8,296.9],[83.1,295.7],[67.8,292],[53.3,285.9],[39.9,277.5],[28.1,267.2],[18,255.1],[10,241.5],[4.2,226.9],[.9,211.5],[0,195.8],[.1,192.9],[2.1,171.4],[7.2,148.8],[15.4,125.3],[26.6,100.8],[41,75.2],[58.4,49.3],[78.4,23.2],[98.9,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===s?[17,26,40,255]:[186,186,186,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0}],scaleX:1,angleAlignment:"Display",angle:0}}})})(this.CIMSymbol,this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getPoint(),this.svModel.createPoint();break;case"polyline":this.svModel.setLine(await(async(e,t)=>({type:"simple-line",color:"light"===await t.getBackgroundColorTheme(e)?[0,0,0]:[255,255,255],width:.75}))(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getLine(),this.svModel.createLine();break;case"polygon":case"rectangle":case"circle":this.svModel.setPolygon(await(async(e,t)=>{const i=await t.getBackgroundColorTheme(e);return{type:"simple-fill",color:"light"===i?[0,0,0,.25]:[255,255,255,.25],style:"solid",outline:{color:"light"===i?[0,0,0]:[255,255,255],width:.75}}})(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getPolygon(),this.svModel.createPolygon(e);break;case"text":this.svModel.setText(await(async(e,t,i,s)=>{const o=await t.getBackgroundColor(e),l=await t.getBackgroundColorTheme(e);return new i({text:s,color:"light"===l?[0,0,0]:"dark"===l?[255,255,255]:o||[0,0,0],haloColor:null,haloSize:.75,font:{size:16.5,family:"Arial",weight:"bold"},lineWidth:512})})(this.mapView,this.ColorUtils,this.TextSymbol,this.strings.text)),this.currentSketchInfo.symbol=this.svModel.getText(),this.svModel.createText()}this.currentSketchInfo.popup=null,this.currentSketchInfo.title=this.defaultGraphicTitle(),this.sketchContentReRender.emit(e),this.showSketchContent=!0}async sketchActionOnSelectFeaturesHandler({detail:{sketchMessage:e,multipleSelectTool:t}}){var i,s;this.keepSelectionMessage=e,this.keepSelectionTool=t,this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!1),this.closeSketchPopovers.emit(),this.tempCreatedGraphic=null,this.currentSketchInfo.graphics=null,this.currentSketchInfo.symbol=null,this.currentSketchInfo.tool=null,(null===(i=this.selectedSketchFeaturesFeatures)||void 0===i?void 0:i.length)||(this.watchDeleteOnMapView(!1),this.multipleSelectedGraphics=[]),this.svModel.cancel(),this.sketchMode="update",this.sketchMessageHandler(this.keepSelectionMessage),this.sketchContentReRender.emit(),this.keepSelectionTool?this.actionOnMultipleSelections(this.keepSelectionTool):(null===(s=this.selectorOperation)||void 0===s||s.cancel(),this.svModel.updateOnGraphic(!0))}arcgisSketchPanelLoaderHandler(e){e.stopPropagation(),this.sketchFlowItemEl.loading=e.detail}async done(){var e,t,i;this.removeHighlight(),(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&f(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&x(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchPopovers.emit(),this.svModel.destroy(),null===(i=this.sketchToolsEl)||void 0===i||i.remove(),this.sketchToolsEl=void 0,this.removeSketchShortcuts(),this.mapView.popupEnabled=!0}async activateLayer(e,t){var i,s;if(null===(i=this.svModel)||void 0===i||i.destroy(),this.layer=e,this.initializeSessionStorageOptions(),this.initializeSVModel(),t&&(this.newSketchLayerFeatures=t.map((e=>e.clone()))),null===(s=this.newSketchLayerFeatures)||void 0===s?void 0:s.length){let e=[],t=[],i=[],s=[];this.newSketchLayerFeatures.forEach((o=>{switch(y(o)){case"polyline":o.layer=this.layer.polylineLayer,t=[...t,o];break;case"polygon":o.layer=this.layer.polygonLayer,i=[...i,o];break;case"text":o.layer=this.layer.textLayer,s=[...s,o];break;default:o.layer=this.layer.pointLayer,e=[...e,o]}})),this.currentSketchInfo.graphics=this.newSketchLayerFeatures,this.updateCurrentSketchInfo(),setTimeout((()=>{e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),s.length&&this.svModel.updateText(s),this.sketchMode="update"}),300)}}async setFocus(e){var t;"dismiss-button"!==e||null===(t=this.dismissButtonEl)||void 0===t||t.setFocus()}async clearHighlights(){this.removeHighlight()}async initializeSessionStorageOptions(){var e;this.snappingOptions=await(async(e,t,i,s)=>{const o=(e=>e&&((0,a.b)(e.webmap,!0)||(0,a.b)(e.current,!0))||null)(e)||{enabled:!0,selfEnabled:!0,featureEnabled:!0,featureSourcesIds:[t.id]};return new s({enabled:o.enabled,selfEnabled:o.selfEnabled,featureEnabled:o.featureEnabled,featureSources:await S(i,o.featureSourcesIds)})})(this.snappingSessionStorageIds,this.layer,this.mapView,this.SnappingOptions),this.sketchTooltipOptions=(e=this.sketchTooltipSessionStorageIds,new(0,this.SketchTooltipOptions)({enabled:(L(e)||{enabled:!1}).enabled}))}initializeSVModel(){this.svModel=new k(this.layer,this.mapView,this.SketchViewModel,this.snappingOptions,this.sketchTooltipOptions,((e,t)=>this.onGraphicCreate(e,t)),this.onGraphicUpdate)}updateCurrentSketchInfo(){var e;this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]);const t=(null===(e=this.currentSketchInfo.graphics[0].attributes)||void 0===e?void 0:e.title)||this.defaultGraphicTitle(),i=this.currentSketchInfo.graphics.every((e=>{var i;return(null===(i=e.attributes)||void 0===i?void 0:i.title)===t})),s=this.currentSketchInfo.graphics[0].popupTemplate,o=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(s)));this.currentSketchInfo.title=i?t:null,this.currentSketchInfo.popup=o?s:null,this.showSketchContent=!0,this.svModel.updateOnGraphic(!0,this.onGraphicUpdate),this.needsMapViewHandles=!0}async updateSketchTools(){this.sketchToolsEl&&(this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.activeSketchTool=this.activeSketchTool)}createSketchTools(){var e;this.sketchToolsEl=document.createElement("arcgis-sketch-tools"),this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.activeSketchTool=this.activeSketchTool,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.refElement=null!==(e=this.sketchToolsReferenceElement)&&void 0!==e?e:this.hostElement,this.selectedSketchFeaturesFeatures&&(this.sketchToolsEl.mapNotesFeatures=this.selectedSketchFeaturesFeatures,this.sketchToolsEl.activeSelectTool=1===this.multipleSelectedGraphics.length?"select":"rectangle"),document.body.appendChild(this.sketchToolsEl),this.sketchContentEl&&!this.sketchContentEl.symbolStylerRefElement&&(this.sketchContentEl.symbolStylerRefElement=this.dismissButtonEl)}async loadAllModules(){[this.SketchViewModel,this.TextSymbol,this.ColorUtils,this.CIMSymbol,this.SnappingOptions,this.SketchTooltipOptions,this.SelectionOperation,this.drawUtils]=await(0,n.l)(["esri/widgets/Sketch/SketchViewModel","esri/symbols/TextSymbol","esri/views/support/colorUtils","esri/symbols/CIMSymbol","esri/views/interactive/snapping/SnappingOptions","esri/views/interactive/sketch/SketchTooltipOptions","esri/widgets/support/Selector2D/SelectionOperation","esri/views/draw/support/drawUtils"])}removeSketchShortcuts(){this.arcgisSketchShortcuts&&(this.arcgisSketchShortcuts.removeEventListener("arcgisSketchShortcutsDismissedChange",(()=>this.removeSketchShortcuts())),document.body.removeChild(this.arcgisSketchShortcuts),this.arcgisSketchShortcuts=null)}onGraphicCreate(e,t){if("start"===e.state&&(this.tempCreatedGraphic=null,this.removeHighlight()),"cancel"===e.state&&this.escKey){this.escKey=!1;const e="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(e)}if("complete"===e.state){this.internalSketchUpdated.emit(),e.graphic&&(e.graphic.popupTemplate=this.currentSketchInfo.popup,e.graphic.attributes={title:this.currentSketchInfo.title},this.currentSketchInfo.graphics=[e.graphic],this.tempCreatedGraphic=e.graphic,this.highlightGraphic(e.graphic));const i="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(i)}}watchEscapeOnMapView(e){var t;e&&!this.watchEscapeHandle?this.watchEscapeHandle=this.mapView.on("key-down",(e=>{"Escape"!==e.key||"active"!==this.svModel.getPointSVM().state&&"active"!==this.svModel.getLineSVM().state&&"active"!==this.svModel.getPolygonSVM().state&&"active"!==this.svModel.getTextSVM().state||(e.stopPropagation(),this.escKey=!0,this.svModel.cancel())})):(null===(t=this.watchEscapeHandle)||void 0===t||t.remove(),this.watchEscapeHandle=void 0)}watchDeleteOnMapView(e){var t;e&&!this.watchDeleteHandle?this.watchDeleteHandle=this.mapView.on("key-down",(e=>{"Delete"!==e.key&&"Backspace"!==e.key||(this.deleteInProgress=!0,this.svModel.delete(),this.deleteInProgress=!1,this.keepSelectToolSelection())})):(null===(t=this.watchDeleteHandle)||void 0===t||t.remove(),this.watchDeleteHandle=void 0)}defaultGraphicTitle(){switch(this.currentSketchInfo.tool){case"point":default:return this.strings.point;case"polyline":return this.strings.line;case"polygon":return this.strings.polygon;case"rectangle":return this.strings.rectangle;case"circle":return this.strings.circle;case"text":return this.strings.text}}clearHighlightAndPopup(){this.removeHighlight(),this.mapView.closePopup()}actionOnMultipleSelections(e){this.selectedSketchFeaturesFeatures=null;const t=[this.layer.pointLayer,this.layer.polylineLayer,this.layer.polygonLayer,this.layer.textLayer],i="rectangle"===e?{createTool:"rectangle"}:{createTool:"polygon",mode:"freehand"};(this.selectorOperation=new this.SelectionOperation({view:this.mapView,sources:t,options:i})).once("complete",(e=>{const{selection:t}=e;if(this.clearHighlightAndPopup(),!e.aborted&&t.length){let e=[],i=[],s=[],o=[];t.forEach((t=>{switch(y(t)){case"point":default:e=[...e,t];break;case"polyline":i=[...i,t];break;case"polygon":s=[...s,t];break;case"text":o=[...o,t]}})),this.multipleSelectedGraphics=[...e,...i,...s,...o],e.length&&this.svModel.updatePoint(e),i.length&&this.svModel.updateLine(i),s.length&&this.svModel.updatePolygon(s),o.length&&this.svModel.updateText(o),this.watchDeleteOnMapView(!0)}})),this.svModel.updateOnGraphic(!1)}sketchMessageHandler(e){O.sketchMessage=e}highlightGraphic(e){var t;this.removeHighlight();const i=null===(t=this.mapView.allLayerViews)||void 0===t?void 0:t.items.find((({layer:e})=>e===this.layer));this.createdGraphicHighlightHandle=null==i?void 0:i.highlight(e)}removeHighlight(){var e;null===(e=this.createdGraphicHighlightHandle)||void 0===e||e.remove(),this.createdGraphicHighlightHandle=void 0}keepSelectToolSelection(){this.sketchActionOnSelectFeatures.emit({sketchMessage:this.keepSelectionMessage,multipleSelectTool:this.keepSelectionTool})}addSketchShortcutsTooltip(){const e=this.sketchShortcutsTooltipEl=document.createElement("calcite-tooltip");e.referenceElement=this.sketchShortcutsEl,e.open=!0,e.innerHTML=this.strings.sketchShortcuts,document.body.append(e)}removeSketchShortcutsTooltip(){var e;this.sketchShortcutsTooltipEl&&(null===(e=this.sketchShortcutsTooltipEl.parentElement)||void 0===e||e.removeChild(this.sketchShortcutsTooltipEl),this.sketchShortcutsTooltipEl=null)}offsetDuplicatedFeatures(){this.multipleSelectedGraphics.forEach((e=>this.drawUtils.move(e.geometry,15*this.mapView.resolution,15*this.mapView.resolution)));let e=[],t=[],i=[],s=[];this.selectedSketchFeaturesFeatures=this.multipleSelectedGraphics,this.multipleSelectedGraphics.forEach((o=>{switch(y(o)){case"polyline":t=[...t,o];break;case"polygon":i=[...i,o];break;case"text":s=[...s,o];break;default:e=[...e,o]}})),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),s.length&&this.svModel.updateText(s)}renderSketchFlowPanel(){var e,t,i,o;const n=(0,s.h)("calcite-action",{text:"close",scale:"m",icon:"x",slot:"header-actions-end",ref:e=>this.dismissButtonEl=e,onClick:e=>{e.stopPropagation(),this.sketchMessageHandler(null),this.svModel.cancel(),this.clearHighlightAndPopup(),this.arcgisSketchDismissedChange.emit()}}),a=(0,s.h)("calcite-label",{alignment:"center",for:"multiple-selection-buttons"},(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)<=1?this.strings.singleFeatureSelected:this.strings.featuresSelected.replace("${number}",null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t.length.toString())),r=(0,s.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"trash",kind:"danger",width:"full",onClick:e=>{e.stopPropagation(),this.deleteInProgress=!0,this.svModel.delete(),this.deleteInProgress=!1,this.multipleSelectedGraphics=[],this.keepSelectToolSelection()}},this.strings.delete),c=(0,s.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"copy",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation(),this.newSketchLayerFeatures=this.currentSketchInfo.graphics.map((e=>e.clone())),this.arcgisSketchCopyToNewSketchLayer.emit({features:this.newSketchLayerFeatures})}},this.strings.copyToNewSketchLayer),h=(0,s.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"duplicate",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation(),this.svModel.duplicate(),this.offsetDuplicatedFeatures()}},this.strings.duplicate),p=(0,s.h)("div",{class:"snapping",ref:e=>this.shortcutSnappingDiv=e},(0,s.h)("calcite-button",{appearance:"outline-fill",class:"sketch-keyboard-button",kind:"neutral",iconStart:"keyboard",scale:"l",label:this.strings.sketchShortcuts,onClick:()=>{this.removeSketchShortcutsTooltip(),this.arcgisSketchShortcuts||(this.arcgisSketchShortcuts=document.createElement("arcgis-sketch-shortcuts"),this.arcgisSketchShortcuts.refElement=this.shortcutSnappingDiv,document.body.appendChild(this.arcgisSketchShortcuts),this.arcgisSketchShortcuts.addEventListener("arcgisSketchShortcutsDismissedChange",(()=>this.removeSketchShortcuts())))},onMouseOver:()=>this.addSketchShortcutsTooltip(),onMouseOut:()=>this.removeSketchShortcutsTooltip(),ref:e=>this.sketchShortcutsEl=e}),(0,s.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",width:"full",iconStart:"gear",iconEnd:"chevron-down",scale:"l",label:this.strings.settings,onClick:e=>{e.stopPropagation(),this.sketchSnappingEl||(this.sketchSnappingEl=document.createElement("arcgis-sketch-snapping"),this.sketchSnappingEl.refElement=this.shortcutSnappingDiv,document.body.appendChild(this.sketchSnappingEl),this.disableSketchPanel.emit(!0))}},this.strings.settings)),d=(0,s.h)("div",{class:O.sketchMessage&&"sketch-message"},(0,s.h)("calcite-notice",{width:"full",open:!(!O.sketchMessage||(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)>1)},(0,s.h)("div",{slot:"message"},O.sketchMessage)));return(0,s.h)("calcite-flow",{ref:e=>this.flowEl=e,dir:(0,l.g)(this.hostElement),class:"rtl"===(0,l.g)(this.hostElement)?l.C.rtl:""},(0,s.h)("calcite-flow-item",{ref:e=>this.sketchFlowItemEl=e,heading:this.strings.sketch,disabled:!this.layer.capabilities.operations.supportsMapNotesEditing},this.dismissible&&n,p,d,(null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.length)?(0,s.h)("div",{class:"multiple-selection"},a,(0,s.h)("div",{id:"multiple-selection-buttons",class:"buttons"},h,c,r)):null,this.showSketchContent&&(0,s.h)("arcgis-sketch-content",{currentSketchInfo:this.currentSketchInfo,flowEl:this.flowEl,symbolStylerRefElement:this.dismissButtonEl,ref:e=>this.sketchContentEl=e})))}render(){return(0,s.h)(s.H,{class:"calcite-match-height"},!this.showSketchToolsOnly&&this.renderSketchFlowPanel())}get hostElement(){return(0,s.d)(this)}};R.style=":host{display:flex;flex:1 1 auto;overflow:hidden}.sketch-delete-button{padding:var(--arcgis-app-cap-spacing-third)}.snapping{display:flex;padding:var(--arcgis-app-cap-spacing-half);background-color:var(--arcgis-app-background)}.sketch-message{padding:var(--arcgis-app-cap-spacing-half)}.sketch-keyboard-button{margin-right:0.3em}.multiple-selection{margin:1.3em}.multiple-selection calcite-button{margin-top:0.3em}.arcgis--rtl .sketch-keyboard-button{margin-right:unset;margin-left:0.3em}";const A=class{constructor(e){(0,s.r)(this,e),this.sketchGraphicUpdates=(0,s.c)(this,"sketchGraphicUpdates",7),this.arcgisSketchPanelLoader=(0,s.c)(this,"arcgisSketchPanelLoader",7),this.disableSketchPanel=(0,s.c)(this,"disableSketchPanel",7),this.arcgisSketchActiveSymbolChange=(0,s.c)(this,"arcgisSketchActiveSymbolChange",7),this.resizeObserver=new ResizeObserver((()=>this.reRender=!this.reRender)),this.divNodes=[],this.symbolNodes=[],this.suggestedFillColors=[],this.savedColors=[],this.storePointStyler=e=>{e&&(this.pointStyler=e,this.startPointEdit())},this.storePolylineStyler=e=>{e&&(this.polylineStyler=e,this.startPolylineEdit())},this.storePolygonStyler=e=>{e&&(this.polygonStyler=e,this.startPolygonEdit())},this.openFontPopover=()=>{var e;this.arcgisFontPicker||(this.disableSketchPanel.emit(!0),this.arcgisFontPicker=document.createElement("arcgis-font-picker"),this.arcgisFontPicker.fontMap=u.f,this.arcgisFontPicker.font=null===(e=this.currentSketchInfo.symbol)||void 0===e?void 0:e.font,this.arcgisFontPicker.popoverProps={refElement:this.hostElement},this.arcgisFontPicker.addEventListener("arcgisFontPickerDismissed",this.closeFontPopover),this.arcgisFontPicker.addEventListener("arcgisFontPickerChange",this.changeFont),document.body.appendChild(this.arcgisFontPicker))},this.closeFontPopover=()=>{this.arcgisFontPicker&&(this.disableSketchPanel.emit(!1),document.body.removeChild(this.arcgisFontPicker),this.arcgisFontPicker=null)},this.changeFont=e=>{var t;const i=e.detail;if(i){const e=null===(t=this.currentSketchInfo.symbol)||void 0===t?void 0:t.clone();e.font.family=i.family,e.font.weight=i.weight,e.font.style=i.style,this.updateSymbol(e,!1,!1,"font"),this.reRender=!this.reRender}},this.updateRotation=(0,r.d)((()=>{clearTimeout(this.rotationValueHandle);const e=parseInt(this.rotationEl.value);!e||e<this.rotationEl.min||e>this.rotationEl.max?this.rotationValueHandle=setTimeout((()=>this.handleTextPropChange(this.rotationEl,"rotation")),3e3):this.handleTextPropChange(this.rotationEl,"rotation")}),500),this.currentSketchInfo=void 0,this.flowEl=void 0,this.symbolStylerRefElement=void 0,this.storageId=void 0,this.reRender=!0}async componentWillLoad(){this.arcgisSketchPanelLoader.emit(!0),await this.loadAllModules(),g.forEach((e=>this.suggestedFillColors.push(new this.Color(e)))),m.forEach((e=>this.savedColors.push(new this.Color(e)))),this.mapView=O.mapView,this.strings=O.strings,this.currentLanguage=O.currentLanguage,this.portal=O.portal,this.flowEl||(this.flowEl=(0,d.q)(this.hostElement,"calcite-flow"));const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols",t=(0,a.g)(e,!0);t&&(this.recentSymbols=[...t])}componentDidLoad(){this.arcgisSketchPanelLoader.emit(!1),this.flowEl&&this.resizeObserver.observe(this.flowEl)}disconnectedCallback(){clearTimeout(this.fontSizeValueHandle),clearTimeout(this.rotationValueHandle),clearTimeout(this.haloSizeValueHandle),this.flowEl&&this.resizeObserver.unobserve(this.flowEl)}calciteFlowItemBackHandler(e){e.stopPropagation(),this.mapView.closePopup(),this.sketchPopupFlowItem=null}sketchContentReRenderHandler(e){e.stopPropagation(),(0,r.i)(e.detail)&&(this.storageId=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(e.detail)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${e.detail}-symbols`:"arcgis-sketch-recent-point-symbols",this.recentSymbols=(0,a.g)(this.storageId,!0)),this.reRender=!this.reRender,this.sketchPopupFlowItem&&(this.flowEl.back(),this.sketchPopupFlowItem=null);const{tool:t}=this.currentSketchInfo;"point"===t?this.startPointEdit():"polyline"===t?this.startPolylineEdit():["circle","polygon","rectangle"].includes(t)&&this.startPolygonEdit()}popupUpdatedHandler({detail:{mapNotesPopuptemplate:e}}){this.currentSketchInfo.popup=e,this.sketchGraphicUpdates.emit({type:"popup",update:!0,close:!1})}async loadAllModules(){[this.Color,this.cimSymbolUtils,this.symbolUtils,this.CIMSymbol,this.SimpleLineSymbol,this.SimpleFillSymbol,this.PictureMarkerSymbol,this.PictureFillSymbol,this.TextSymbol]=await(0,n.l)(["esri/Color","esri/symbols/support/cimSymbolUtils","esri/symbols/support/symbolUtils","esri/symbols/CIMSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/PictureMarkerSymbol","esri/symbols/PictureFillSymbol","esri/symbols/TextSymbol"])}updateSymbol(e,t,i,s,o){var l;const n=this.currentSketchInfo.symbol.clone(),c=e.clone(),h=v(this.currentSketchInfo.symbol)!==v(e);if(this.currentSketchInfo.symbol=e.clone(),"recent-text"===s&&(this.currentSketchInfo.symbol.text=n.text),this.sketchGraphicUpdates.emit({type:"symbol",update:!0,close:!1,symbolSwitch:t,symbolSwitchFromRecent:i,textProp:s}),o)this.arcgisSketchActiveSymbolChange.emit();else if(!(h&&!t&&!i||["halo-size","color-update-symbol-only"].indexOf(s)>-1)){"text"===c.type&&(c.text=this.strings.textPreview);const e=null===(l=this.recentSymbols)||void 0===l?void 0:l.filter((e=>JSON.stringify(e)!==JSON.stringify(c))),t=(0,r.i)(e)?[c,...e].slice(0,5):[c],i=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";(0,a.s)(i,t,!0),this.recentSymbols=t,this.arcgisSketchActiveSymbolChange.emit()}}applyCimOutline(e,t){const i=b(e);if(!i)return;const s=t.color.toRgba();s[3]*=255,i.color=s,i.width=t.size}getCimOutlineProps(e){var t;const i=b(e);return{color:new this.Color(null==i?void 0:i.color),size:null!==(t=null==i?void 0:i.width)&&void 0!==t?t:1}}getPopoverProps(e){var t;const i=null===(t=this.flowEl)||void 0===t?void 0:t.getBoundingClientRect();return{placement:e?"bottom-start":"bottom-end",offsetDistance:10,offsetSkidding:e?3:-3,overlayPositioning:"fixed",maxHeight:i&&i.height-65+"px",refElement:this.symbolStylerRefElement}}startPointEdit(){var e;const t="cim"===this.currentSketchInfo.symbol.type;null===(e=this.pointStyler)||void 0===e||e.edit(this.currentSketchInfo.symbol.clone(),{sections:{marker:{open:!0,symbolsOpen:!0,sizeOpen:!1,rotationOpen:!1,markerType:["cim:vector","custom"],keepChoice:!0,parts:{size:{autoSizeAdjust:!1}}},fill:t&&{type:"color",optional:!0,suggestedColors:this.suggestedFillColors,savedColors:this.savedColors,open:!1,suggestedColorsOpen:!0},stroke:t&&{optional:!0,open:!1,type:"color",suggestedColors:this.suggestedFillColors,savedColors:this.savedColors}},marker:{size:t?this.cimSymbolUtils.getCIMSymbolSize(this.currentSketchInfo.symbol):"picture-marker"===this.currentSketchInfo.symbol.type?this.currentSketchInfo.symbol.width:25},fill:{color:t&&this.cimSymbolUtils.getCIMSymbolColor(this.currentSketchInfo.symbol)||this.suggestedFillColors[0]},stroke:t&&this.getCimOutlineProps(this.currentSketchInfo.symbol),fillEnabled:t,strokeEnabled:t,portal:this.createPortalProp()})}startPolylineEdit(){var e,t,i,s,o;null===(e=this.polylineStyler)||void 0===e||e.edit(this.currentSketchInfo.symbol.clone(),{sections:{stroke:{type:"color",open:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!0,autoStrokeAdjust:!1}}},stroke:{color:(null===(t=this.currentSketchInfo.symbol)||void 0===t?void 0:t.color)||this.savedColors[1],size:(null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.width)||10,style:(null===(s=this.currentSketchInfo.symbol)||void 0===s?void 0:s.style)||"solid",marker:null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.marker},portal:this.createPortalProp()})}createPortalProp(){return{portal:this.portal,before:async(e,t)=>{await e.load(),t.originalStylesGroupQuery2d=e.stylesGroupQuery2d,e.stylesGroupQuery2d=e.isPortal?'title:"Esri Sketch Styles" AND owner:esri_webstyles':'title:"Esri Sketch Styles" AND owner:esri_en'},after:async(e,t)=>{e.stylesGroupQuery2d=t.originalStylesGroupQuery2d}}}startPolygonEdit(){var e,t,i,s,o;null===(e=this.polygonStyler)||void 0===e||e.edit(this.currentSketchInfo.symbol.clone(),{sections:{fill:{type:"color",open:!0,optional:!0,suggestedColorsOpen:!0,transparencyOpen:!1,suggestedColors:this.suggestedFillColors},stroke:{type:"color",open:!1,optional:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!0,autoStrokeAdjust:!1}}},fill:{color:this.currentSketchInfo.symbol.color||this.suggestedFillColors[0]},stroke:{color:(null===(t=this.currentSketchInfo.symbol.outline)||void 0===t?void 0:t.color)||this.suggestedFillColors[0],size:(null===(i=this.currentSketchInfo.symbol.outline)||void 0===i?void 0:i.width)||10,style:(null===(s=this.currentSketchInfo.symbol.outline)||void 0===s?void 0:s.style)||"solid",autoAdjusted:!1},fillEnabled:!!this.currentSketchInfo.symbol.color,strokeEnabled:!!(null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.outline),portal:this.createPortalProp()})}handleTextPropChange(e,t){var i;let s=parseInt(e.value);isNaN(s)||s<e.min?s=e.min:s>e.max&&(s=e.max),e.value=`${s}`;const o=null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.clone();switch(t){case"font-size":o.font.size=.75*s;break;case"halo-size":o.haloSize=.75*s;break;case"rotation":o.angle=s}this.updateSymbol(o,!1,!1,t),"rotation"===t&&(this.reRender=!this.reRender)}handleRotationSliderValueChange(e,t){var i;const s=null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.clone();s.angle=e,this.updateSymbol(s,!1,!1,"rotation",t)}render(){var e,t,i,o,n,r,c,h,g,m,y,f,S,k;const b="rtl"===(0,l.g)(this.hostElement),v=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,w=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,I=null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.every((e=>w===e.geometry.type)),P=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o[0].symbol.type,C=null===(n=this.currentSketchInfo.graphics)||void 0===n?void 0:n.every((e=>P===e.symbol.type)),T=(null===(r=this.currentSketchInfo.graphics)||void 0===r?void 0:r.some((e=>"text"===e.symbol.type)))&&!(null===(c=this.currentSketchInfo.graphics)||void 0===c?void 0:c.every((e=>"text"===e.symbol.type))),M=(0,s.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:v&&I&&!C,mode:v?"minimal":"default",key:"point-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.pointSourceId,ref:this.currentSketchInfo.symbol&&this.storePointStyler,popoverProps:this.getPopoverProps(b),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>{this.updateSymbol(e,t)},onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.pointSourceId=e}),E=(0,s.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:v&&I&&!C,mode:v?"minimal":"default",key:"polyline-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polylineSourceId,ref:this.currentSketchInfo.symbol&&this.storePolylineStyler,popoverProps:this.getPopoverProps(b),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>{this.updateSymbol(e,t)},onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polylineSourceId=e}),x=(0,s.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:v&&I&&!C,mode:v?"minimal":"default",key:"polygon-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polygonSourceId,ref:this.currentSketchInfo.symbol&&this.storePolygonStyler,popoverProps:this.getPopoverProps(b),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>{this.updateSymbol(e,t)},onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polygonSourceId=e}),L=this.currentSketchInfo.symbol;let O,R;this.textContentEl&&(O=null==L?void 0:L.text,R=null===(h=this.currentSketchInfo.graphics)||void 0===h?void 0:h.every((e=>O===e.symbol.text)));const A=(0,s.h)("calcite-label",null,this.strings.content,(0,s.h)("calcite-text-area",{resize:"vertical",placeholder:this.strings.textContentPlaceholder,value:R?null==L?void 0:L.text:"",onCalciteTextAreaInput:e=>{e.stopPropagation();const t=null==L?void 0:L.clone();t.text=e.target.value,this.updateSymbol(t,!1,!1,"text")},ref:e=>this.textContentEl=e})),F=(0,s.h)("calcite-label",null,this.strings.font,(0,s.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",label:(0,u.b)((null==L?void 0:L.font)||{family:"Arial",style:"normal",weight:"normal"}),width:"full",scale:"m",onClick:this.openFontPopover},(0,u.b)(null==L?void 0:L.font))),V=(0,s.h)("calcite-label",null,this.strings.size,(0,s.h)("calcite-input-number",{scale:"s",min:5,max:125,value:`${(null===(g=null==L?void 0:L.font)||void 0===g?void 0:g.size)/.75||0}`,onCalciteInputNumberInput:e=>{clearTimeout(this.fontSizeValueHandle),e.stopPropagation();const t=parseInt(this.fontSizeEl.value);!t||t<this.fontSizeEl.min||t>this.fontSizeEl.max?this.fontSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.fontSizeEl,"font-size")),3e3):this.handleTextPropChange(this.fontSizeEl,"font-size")},ref:e=>this.fontSizeEl=e})),N=(0,s.h)("calcite-label",null,this.strings.color,(0,s.h)("arcgis-color-input",{color:(null===(m=null==L?void 0:L.color)||void 0===m?void 0:m.toHex())||"#ffffff",popoverProps:this.getPopoverProps(b),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{const t=null==L?void 0:L.clone();t.color=new this.Color(e.target.color),this.updateSymbol(t,!1,!1,"color-update-symbol-only")},onArcgisColorInputPopoverClose:e=>{const t=e.detail;if(t){const e=null==L?void 0:L.clone();e.color=new this.Color(t),this.updateSymbol(e,!1,!1,"color-update-recent")}},onArcgisColorInputSwatchUpdate:e=>{const t=e.detail;if(t){const e=null==L?void 0:L.clone();e.color=new this.Color(t),this.updateSymbol(e,!1,!1,"color-update-recent")}}})),U=(0,s.h)("calcite-label",null,this.strings.rotation,(0,s.h)("div",{class:"rotation"},(0,s.h)("calcite-slider",{min:0,max:360,value:(null==L?void 0:L.angle)||0,step:1,onCalciteSliderInput:e=>this.handleRotationSliderValueChange(e.target.value,!0),onCalciteSliderChange:e=>this.handleRotationSliderValueChange(e.target.value,!1)}),(0,s.h)("calcite-input-number",{scale:"s",min:0,max:360,suffixText:b?"":"",prefixText:b?"":"",step:1,value:`${(null==L?void 0:L.angle)||0}`,onCalciteInputNumberInput:this.updateRotation,ref:e=>this.rotationEl=e}))),D=(0,s.h)("calcite-block-section",{ref:e=>this.haloBlockSection=e,text:this.strings.halo,toggleDisplay:"switch",open:!!(null==L?void 0:L.haloColor),onCalciteBlockSectionToggle:e=>{e.stopPropagation();const t=null==L?void 0:L.clone();this.haloBlockSection.open?(t.haloColor=this.tempHaloColor||new this.Color("white"),t.haloSize=(null==t?void 0:t.haloSize)||.75):(this.tempHaloColor=t.haloColor,t.haloColor=null),this.updateSymbol(t,!1,!1,"halo")}},(0,s.h)("div",{class:"halo-block"},(0,s.h)("calcite-label",null,this.strings.color,(0,s.h)("arcgis-color-input",{color:(null===(y=null==L?void 0:L.haloColor)||void 0===y?void 0:y.toHex())||"#ffffff",popoverProps:this.getPopoverProps(b),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{const t=null==L?void 0:L.clone();t.haloColor=new this.Color(e.target.color),this.updateSymbol(t,!1,!1,"halo-color")}})),(0,s.h)("calcite-label",null,this.strings.size,(0,s.h)("calcite-input-number",{scale:"s",min:1,max:10,value:`${(null==L?void 0:L.haloSize)/.75||0}`,onCalciteInputNumberInput:e=>{clearTimeout(this.haloSizeValueHandle),e.stopPropagation();const t=parseInt(this.haloSizeEl.value);!t||t<this.haloSizeEl.min||t>this.haloSizeEl.max?this.haloSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.haloSizeEl,"halo-size")),3e3):this.handleTextPropChange(this.haloSizeEl,"halo-size")},ref:e=>this.haloSizeEl=e})))),B=(0,s.h)("calcite-block-section",{ref:e=>this.backgroundColorSection=e,text:this.strings.background,toggleDisplay:"switch",open:!!(null==L?void 0:L.backgroundColor),onCalciteBlockSectionToggle:e=>{e.stopPropagation();const t=null==L?void 0:L.clone();this.backgroundColorSection.open?t.backgroundColor=this.tempBackgroundColor||new this.Color("white"):(this.tempBackgroundColor=t.backgroundColor,t.backgroundColor=null),this.updateSymbol(t,!1,!1,"background-color")}},(0,s.h)("div",{class:"background-color-block"},(0,s.h)("calcite-label",null,this.strings.color,(0,s.h)("arcgis-color-input",{color:(null===(f=null==L?void 0:L.backgroundColor)||void 0===f?void 0:f.toHex())||"#ffffff",popoverProps:this.getPopoverProps(b),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{const t=null==L?void 0:L.clone();t.backgroundColor=new this.Color(e.target.color),this.updateSymbol(t,!1,!1,"color-update-symbol-only")},onArcgisColorInputPopoverClose:e=>{const t=e.detail;if(t){const e=null==L?void 0:L.clone();e.backgroundColor=new this.Color(t),this.updateSymbol(e,!1,!1,"color-update-recent")}},onArcgisColorInputSwatchUpdate:e=>{const t=e.detail;if(t){const e=null==L?void 0:L.clone();e.backgroundColor=new this.Color(t),this.updateSymbol(e,!1,!1,"color-update-recent")}}})))),H=(0,s.h)("div",null,A,F,V,N,U,D,B);let z;switch(this.divNodes=[],this.symbolNodes=[],this.currentSketchInfo.tool){case"point":z=this.strings.point;break;case"polyline":z=this.strings.line;break;case"text":z=this.strings.text;break;default:z=this.strings.polygon}z=z.toLocaleLowerCase();const G=(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,this.strings.recentSymbols),(0,s.h)("div",{class:"container",ref:e=>this.recentSymbolsContainerEl=e},(null===(S=this.recentSymbols)||void 0===S?void 0:S.length)?this.recentSymbols.map(((e,t)=>e?(0,s.h)("div",{key:"symbol",class:"symbol",tabindex:"0",onClick:()=>this.handleRecentSymbolSelect(t),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleRecentSymbolSelect(t))},ref:i=>{i&&(this.divNodes[t]=i,this.afterCreateDiv(i,e,t))}}):null)):(0,s.h)("div",{key:"no-recent-symbol",class:"no-recent-symbols"},this.strings.noRecentSymbols.replace("${tool}",z))),(0,s.h)("calcite-button",{scale:"s",class:"clear-recent-button",width:"half",disabled:!(null===(k=this.recentSymbols)||void 0===k?void 0:k.length),onClick:()=>{const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";this.recentSymbols=[],(0,a.s)(e,this.recentSymbols,!0),(0,s.f)(this.hostElement)}},this.strings.clear)),_=(0,s.h)("calcite-label",{class:"sketch-title"},this.strings.title,(0,s.h)("calcite-inline-editable",{scale:"m"},(0,s.h)("calcite-input",{alignment:"start",placeholder:this.strings.enterTitlePlaceholder,type:"text",value:this.currentSketchInfo.title,onBlur:e=>{this.currentSketchInfo.title=e.target.value,this.sketchGraphicUpdates.emit({type:"title",update:!0,close:!1})}}))),J=(0,s.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:b?"chevron-left":"chevron-right",label:this.strings.popup,width:"full",scale:"l",class:"sketch-popup-button",onClick:e=>{var t,i;if(e.stopPropagation(),!this.sketchPopupFlowItem){this.sketchPopupFlowItem=document.createElement("calcite-flow-item"),this.sketchPopupFlowItem.heading=this.strings.sketch,this.sketchPopupFlowItem.description=this.strings.popup;const e=document.createElement("calcite-fab");e.icon="plus",e.slot="fab",e.scale="s",e.appearance="outline-fill",e.kind="neutral",e.label=this.strings.addContent,e.text=this.strings.addContent,e.textEnabled=!0,this.sketchPopupFlowItem.appendChild(e);const s=document.createElement("arcgis-popup");if(s.lang=this.currentLanguage,s.mapView=this.mapView,s.layerDisplayType=p.l.mapNotes,s.mapNotesGraphic=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0],s.mapNotesPopupTemplate=this.currentSketchInfo.popup,s.calciteFlowProps={flow:this.flowEl,calciteFab:e,calciteFlowItem:this.sketchPopupFlowItem},this.sketchPopupFlowItem.appendChild(s),this.flowEl.appendChild(this.sketchPopupFlowItem),v){s.multiplePopupsSelected=!0,s.disableEditing=!0;const e=document.createElement("calcite-button");e.label=this.strings.applyChanges,e.innerHTML=this.strings.applyChanges,e.scale="l",e.slot="footer",this.sketchPopupFlowItem.append(e),e.addEventListener("click",(()=>{var t;this.alertEl&&(null===(t=this.alertEl.parentElement)||void 0===t||t.removeChild(this.alertEl),this.alertEl=null),s.disableEditing=!1,s.update(),e.kind="neutral",e.disabled=!0,this.alertEl=document.createElement("calcite-alert"),this.alertEl.kind="success",this.alertEl.icon="check-circle";const i=document.createElement("div");i.slot="message",i.innerHTML=this.strings.changesApplied,this.alertEl.append(i),this.alertEl.open=!0,document.body.append(this.alertEl),this.alertEl.addEventListener("calciteAlertClose",(()=>{var e;null===(e=this.alertEl.parentElement)||void 0===e||e.removeChild(this.alertEl),this.alertEl=null}))})),s.addEventListener("bulkPopupUpdated",(()=>{e.kind="brand",e.disabled=!1}))}this.sketchPopupFlowItem.setFocus(),this.sketchPopupFlowItem.beforeBack=async()=>await s.done(),this.mapView.closePopup(),(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)&&this.currentSketchInfo.popup&&this.mapView.openPopup({features:[this.currentSketchInfo.graphics[0]],location:(0,d.o)(this.currentSketchInfo.graphics[0].geometry)})}}},this.strings.popup);return(0,s.h)(s.H,null,(0,s.h)("div",{dir:(0,l.g)(this.hostElement)},(!v||I&&!T)&&(0,s.h)("div",{class:"recent-symbols"},G),(0,s.h)("div",{class:"sketch-content"},_,J,(()=>{if(!v||I&&!T)switch(this.currentSketchInfo.tool){case"point":return M;case"text":return H;case"polyline":return E;case"polygon":case"rectangle":case"circle":return x;default:return null}})())))}handleRecentSymbolSelect(e){this.updateSymbol(this.symbolNodes[e],!0,!0,this.textContentEl?"recent-text":void 0),this.divNodes[0].focus()}async afterCreateDiv(e,t,i){var s;let o;if(["simple-line","simple-fill","picture-marker","picture-fill","text","cim"].indexOf(t.type)>-1)"text"===t.type&&(t.text=this.strings.textPreview),o=t;else switch(t.type){case"CIMSymbolReference":o=this.CIMSymbol.fromJSON(t);break;case"esriSLS":o=this.SimpleLineSymbol.fromJSON(t);break;case"esriSFS":o=this.SimpleFillSymbol.fromJSON(t);break;case"esriPMS":o=this.PictureMarkerSymbol.fromJSON(t);break;case"esriPFS":o=this.PictureFillSymbol.fromJSON(t);break;case"esriTS":o=this.TextSymbol.fromJSON(t)}for(;null===(s=null==e?void 0:e.childNodes)||void 0===s?void 0:s.length;)e.removeChild(e.childNodes[0]);const l=o.clone();"text"===l.type&&(l.haloSize=Math.min(2,l.haloSize)),"simple-line"===l.type&&(l.width=Math.min(2,l.width));const n={maxSize:"text"===l.type?17:24,scale:!0,size:"simple-line"===l.type?{width:this.recentSymbolsContainerEl.clientWidth/9}:{width:"text"===l.type?17:24,height:"text"===l.type?17:24}};l&&await this.symbolUtils.renderPreviewHTML(l,n).then((t=>{t&&(e.append(t),this.symbolNodes[i]=o)}))}get hostElement(){return(0,s.d)(this)}};A.style=".sketch-content{display:flex;flex-direction:column;background-color:var(--arcgis-app-background);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing-half)}.sketch-title calcite-inline-editable{border:1px solid;border-color:var(--calcite-color-border-input);padding:var(--arcgis-app-cap-spacing-third)}.rotation{display:flex;align-items:center;justify-content:space-between;position:relative}.rotation calcite-slider{width:50%}.rotation calcite-input-number{width:45%;font-size:var(--arcgis-app-font-size-0);font-family:var(--arcgis-app-font-family)}.sketch-popup-button{margin-bottom:0.4em}.recent-symbols{display:flex;flex-direction:column;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing-half)}.container{background-color:var(--arcgis-app-background);box-shadow:0px 1px 10px 2px rgba(0, 0, 0, 0.1);padding:8px 12px;display:flex;align-items:center;justify-content:space-evenly}.symbol{height:32px;display:flex;align-items:center;cursor:pointer}.symbol:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}.no-recent-symbols{min-height:32px;display:flex;align-items:center}.clear-recent-button{padding-top:8px;margin:auto}.halo-block,.background-color-block{padding-top:6px}";const F=class{constructor(e){(0,s.r)(this,e),this.arcgisSketchShortcutsDismissedChange=(0,s.c)(this,"arcgisSketchShortcutsDismissedChange",7),this.refElement=void 0,this.isOpen=!1}componentWillLoad(){this.strings=O.strings}componentDidLoad(){this.isOpen=!0}async reposition(){var e;null===(e=this.sketchShortcutsPopover)||void 0===e||e.reposition()}render(){const e="rtl"===(0,l.g)(this.hostElement)?"trailing-start":"leading-start";return(0,s.h)(s.H,{class:"js-app-flyout"},(0,s.h)("calcite-popover",{dir:(0,l.g)(this.hostElement),class:"popover "+("rtl"===(0,l.g)(this.hostElement)?l.C.rtl:""),ref:e=>this.sketchShortcutsPopover=e,placement:e,open:this.isOpen,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:this.strings.sketchShortcuts},(0,s.h)("calcite-panel",{heading:this.strings.sketchShortcuts,closable:!0,style:{width:`${Math.max(this.refElement.getBoundingClientRect().width,375)}px`},onCalcitePanelClose:()=>this.arcgisSketchShortcutsDismissedChange.emit()},(0,s.h)("div",{class:"sketch-shortcut"},(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"Ctrl",scale:"m"},"Ctrl"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.ctrlShortcut),(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"Enter",scale:"m"},"Enter"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.cShortcut),(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"Z",scale:"m"},"Z"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.zShortcut),(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"R",scale:"m"},"R"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.rShortcut),(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"Esc",scale:"m"},"Esc"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.escShortcut),(0,s.h)("calcite-chip",{class:"sketch-shortcut-chip",value:"Tab",scale:"m"},"Tab"),(0,s.h)("calcite-label",{class:"sketch-shortcut-label"},this.strings.tabShortcut)))))}get hostElement(){return(0,s.d)(this)}};F.style=".sketch-shortcut{background-color:var(--arcgis-app-background);display:grid;grid-template-columns:21% auto;row-gap:var(--arcgis-app-cap-spacing-half);padding:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-chip{margin-right:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-label{align-self:center}.popover{z-index:100}.arcgis--rtl .sketch-shortcut{max-height:40vh}.arcgis--rtl .sketch-shortcut-chip{margin-left:var(--arcgis-app-cap-spacing-half);margin-right:0}";const V=class{constructor(e){(0,s.r)(this,e),this.closeSketchSnappingPopovers=(0,s.c)(this,"closeSketchSnappingPopovers",7),this.refElement=void 0}async componentWillLoad(){this.strings=O.strings,this.mapView=O.mapView,this.snappingOptions=O.snappingOptions,this.snappingSessionStorageIds=O.snappingSessionStorageIds,this.sketchTooltipOptions=O.sketchTooltipOptions,this.sketchTooltipSessionStorageIds=O.sketchTooltipSessionStorageIds,await this.loadAllModules(),this.addSnappingWidget(),this.addTooltipsWidget()}componentDidLoad(){this.snappingControls.container=this.snappingControlDiv,this.sketchTooltipControls.container=this.sketchTooltipControlDiv}disconnectedCallback(){var e,t;null===(e=this.snappingControls)||void 0===e||e.destroy(),null===(t=this.sketchTooltipControls)||void 0===t||t.destroy()}async reposition(){var e;null===(e=this.sketchSnappingPopover)||void 0===e||e.reposition()}async loadAllModules(){const[e,t]=await(0,n.l)(["esri/widgets/support/SnappingControls","esri/widgets/support/SketchTooltipControls"]);this.SnappingControls=e,this.SketchTooltipControls=t}addSnappingWidget(){this.snappingControls=new this.SnappingControls({view:this.mapView,snappingOptions:O.snappingOptions,visibleElements:{header:!1}})}addTooltipsWidget(){this.sketchTooltipControls=new this.SketchTooltipControls({view:this.mapView,tooltipOptions:O.sketchTooltipOptions,visibleElements:{tooltipsToggle:!0,labelsToggle:!1}}),this.sketchTooltipControls.sketchOptions.tooltips=O.sketchTooltipOptions}render(){return(0,s.h)(s.H,{class:"js-app-flyout"},(0,s.h)("calcite-popover",{dir:(0,l.g)(this.hostElement),placement:"leading-start",ref:e=>this.sketchSnappingPopover=e,open:!0,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:this.strings.settings,style:{zIndex:"100"}},(0,s.h)("calcite-panel",{closable:!0,headingLevel:2,heading:this.strings.settings,style:{width:`${this.refElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>{var e,t;(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&f(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&x(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchSnappingPopovers.emit()}},(0,s.h)("div",{class:"content"},(0,s.h)("div",{ref:e=>this.sketchTooltipControlDiv=e}),(0,s.h)("div",{ref:e=>this.snappingControlDiv=e})))))}get hostElement(){return(0,s.d)(this)}};V.style=".content{max-height:60vh}";const N=class{constructor(e){(0,s.r)(this,e),this.sketchActionOnDrawFeatures=(0,s.c)(this,"sketchActionOnDrawFeatures",7),this.sketchActionOnSelectFeatures=(0,s.c)(this,"sketchActionOnSelectFeatures",7),this.refElement=void 0,this.mapNotesFeatures=null,this.sketchToolsToHide=[],this.activeSketchTool=void 0,this.hideSelectionTools=!1,this.activeSelectTool=void 0,this.isOpen=!1}componentWillLoad(){this.strings=O.strings,this.svModel=O.svModel,this.layer=O.layer,this.isOpen=!0}componentDidLoad(){var e;if(null===(e=this.mapNotesFeatures)||void 0===e?void 0:e.length){let e=[],t=[],i=[],s=[];this.mapNotesFeatures.forEach((o=>{switch(y(o)){case"polyline":t=[...t,o];break;case"polygon":i=[...i,o];break;case"text":s=[...s,o];break;default:e=[...e,o]}})),this.activeSelectTool&&("select"===this.activeSelectTool?this.actionOnSelectFeatures(this.strings.selectText,this.sketchSelectElement):this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")),e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),s.length&&this.svModel.updateText(s)}else{const e={point:this.sketchPointElement,polygon:this.sketchPolygonElement,polyline:this.sketchPolyLineElement,circle:this.sketchCircleElement,rectangle:this.sketchRectangleElement,text:this.sketchTextElement};let t,i;if(this.activeSketchTool)t=this.activeSketchTool,i=e[t];else{let s=["point","polyline","polygon","rectangle","circle","text"];s=s.filter((e=>!this.sketchToolsToHide.includes(e))),t=s.length?s[0]:"point",i=e[t]}this.actionOnDrawFeatures(t,this.strings.addStamp,i)}}async reposition(){var e;null===(e=this.sketchToolsPopoverElement)||void 0===e||e.reposition()}actionOnDrawFeatures(e,t,i){this.clearActiveSelection(),i.active=!0,this.sketchActionOnDrawFeatures.emit({tool:e,sketchMessage:t})}actionOnSelectFeatures(e,t,i){const{active:s=!1}=t;this.clearActiveSelection(),t.active=!s,this.activeSelectTool=t.active?null!=i?i:"select":null,this.svModel.cancel(),this.sketchActionOnSelectFeatures.emit({sketchMessage:s?"":e,multipleSelectTool:!s&&i||null})}clearActiveSelection(){[this.sketchPointElement,this.sketchPolyLineElement,this.sketchPolygonElement,this.sketchRectangleElement,this.sketchCircleElement,this.sketchTextElement,this.sketchSelectElement,this.sketchRectangleSelectElement,this.sketchLassoSelectElement].forEach((e=>{e&&(e.active=!1)}))}render(){const e=(0,s.h)("calcite-action-group",null,!this.sketchToolsToHide.includes("point")&&(0,s.h)("calcite-action",{ref:e=>this.sketchPointElement=e,text:this.strings.stamp,label:this.strings.stamp,title:this.strings.stamp,icon:"pin",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("point",this.strings.addStamp,this.sketchPointElement)}}),!this.sketchToolsToHide.includes("polyline")&&(0,s.h)("calcite-action",{ref:e=>this.sketchPolyLineElement=e,text:this.strings.line,label:this.strings.line,title:this.strings.line,icon:"line",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("polyline",this.strings.startFinishDrawing,this.sketchPolyLineElement)}}),!this.sketchToolsToHide.includes("polygon")&&(0,s.h)("calcite-action",{ref:e=>this.sketchPolygonElement=e,text:this.strings.polygon,label:this.strings.polygon,title:this.strings.polygon,icon:"polygon",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("polygon",this.strings.startFinishDrawing,this.sketchPolygonElement)}}),!this.sketchToolsToHide.includes("rectangle")&&(0,s.h)("calcite-action",{ref:e=>this.sketchRectangleElement=e,text:this.strings.rectangle,label:this.strings.rectangle,title:this.strings.rectangle,icon:"rectangle",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("rectangle",this.strings.addRectangle,this.sketchRectangleElement)}}),!this.sketchToolsToHide.includes("circle")&&(0,s.h)("calcite-action",{ref:e=>this.sketchCircleElement=e,text:this.strings.circle,label:this.strings.circle,title:this.strings.circle,icon:"circle",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("circle",this.strings.addCircle,this.sketchCircleElement)}}),!this.sketchToolsToHide.includes("text")&&(0,s.h)("calcite-action",{ref:e=>this.sketchTextElement=e,text:this.strings.text,label:this.strings.text,title:this.strings.text,icon:"text",scale:"m",alignment:"center",onClick:async()=>{this.actionOnDrawFeatures("text",this.strings.addText,this.sketchTextElement)}})),t=(0,s.h)("calcite-action-group",{layout:"vertical"},(0,s.h)("calcite-action",{ref:e=>this.sketchSelectElement=e,text:this.strings.select,label:this.strings.select,title:this.strings.select,icon:"cursor",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.selectText,this.sketchSelectElement)}}),(0,s.h)("calcite-action",{ref:e=>this.sketchRectangleSelectElement=e,text:this.strings.rectangleSelect,label:this.strings.rectangleSelect,title:this.strings.rectangleSelect,icon:"cursor-marquee",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")}}),(0,s.h)("calcite-action",{ref:e=>this.sketchLassoSelectElement=e,text:this.strings.lassoSelect,label:this.strings.lassoSelect,title:this.strings.lassoSelect,icon:"lasso",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchLassoSelectElement,"lasso")}}));return(0,s.h)(s.H,{class:"js-app-flyout"},(0,s.h)("calcite-popover",{dir:(0,l.g)(this.hostElement),ref:e=>this.sketchToolsPopoverElement=e,placement:"leading-start",open:this.isOpen,referenceElement:this.refElement,offsetDistance:15,pointerDisabled:!0,focusTrapDisabled:!0,triggerDisabled:!0,label:this.strings.sketch,class:"popover",onCalcitePopoverBeforeClose:()=>this.sketchToolsPopoverElement.open=!0},(0,s.h)("calcite-action-pad",{position:"start",layout:"vertical",expandDisabled:!0},e,!this.hideSelectionTools&&t)))}get hostElement(){return(0,s.d)(this)}};N.style=".popover{z-index:100}"},27031:(e,t,i)=>{i.d(t,{a:()=>o,b:()=>a,f:()=>l,m:()=>n,p:()=>s});const s=["above-center","above-left","above-right","below-center","below-left","below-right","center-center","center-left","center-right"],o=["above-after","above-along","above-before","above-start","above-end","below-after","below-along","below-before","below-start","below-end","center-after","center-along","center-before","center-start","center-end"],l=new Map;l.set("Abril Fatface Regular",{font:{family:"Abril Fatface",style:"normal",weight:"normal"}}),l.set("Alegreya Bold",{font:{family:"Alegreya",style:"normal",weight:"bold"}}),l.set("Alegreya Bold Italic",{font:{family:"Alegreya",style:"italic",weight:"bold"}}),l.set("Alegreya Italic",{font:{family:"Alegreya",style:"italic",weight:"normal"}}),l.set("Alegreya Regular",{font:{family:"Alegreya",style:"normal",weight:"normal"}}),l.set("Alegreya Sans Italic",{font:{family:"Alegreya Sans",style:"italic",weight:"normal"}}),l.set("Alegreya SC Bold",{font:{family:"Alegreya SC",style:"normal",weight:"bold"}}),l.set("Alegreya SC Italic",{font:{family:"Alegreya SC",style:"italic",weight:"normal"}}),l.set("Alegreya SC Regular",{font:{family:"Alegreya SC",style:"normal",weight:"normal"}}),l.set("Amarante Regular",{font:{family:"Amarante",style:"normal",weight:"normal"}}),l.set("Amatic SC Bold",{font:{family:"Amatic SC",style:"normal",weight:"bold"}}),l.set("Arial Bold",{font:{family:"Arial",style:"normal",weight:"bold"}}),l.set("Arial Bold Italic",{font:{family:"Arial",style:"italic",weight:"bold"}}),l.set("Arial Italic",{font:{family:"Arial",style:"italic",weight:"normal"}}),l.set("Arial Regular",{font:{family:"Arial",style:"normal",weight:"normal"}}),l.set("Arial Unicode MS Bold",{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}}),l.set("Arial Unicode MS Regular",{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}}),l.set("Atomic Age Regular",{font:{family:"Atomic Age",style:"normal",weight:"normal"}}),l.set("Audiowide Regular",{font:{family:"Audiowide",style:"normal",weight:"normal"}}),l.set("Avenir Next LT Pro Bold",{font:{family:"Avenir Next LT Pro",style:"normal",weight:"bold"}}),l.set("Avenir Next LT Pro Bold Italic",{font:{family:"Avenir Next LT Pro",style:"italic",weight:"bold"}}),l.set("Avenir Next LT Pro Demi Italic",{font:{family:"Avenir Next LT Pro Demi",style:"italic",weight:"normal"}}),l.set("Avenir Next LT Pro Italic",{font:{family:"Avenir Next LT Pro",style:"italic",weight:"normal"}}),l.set("Avenir Next LT Pro Light Italic",{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}}),l.set("Avenir Next LT Pro Regular",{font:{family:"Avenir Next LT Pro",style:"normal",weight:"normal"}}),l.set("Avenir Next LT Pro Light Italic",{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}}),l.set("Avenir Next LT Pro Light Regular",{font:{family:"Avenir Next LT Pro Light",style:"normal",weight:"normal"}}),l.set("Avenir Next LT Pro Medium Bold",{font:{family:"Avenir Next LT Pro Medium",style:"normal",weight:"bold"}}),l.set("Avenir Next LT Pro Medium Bold Italic",{font:{family:"Avenir Next LT Pro Medium",style:"italic",weight:"bold"}}),l.set("Avenir Next LT Pro Regular Bold",{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"bold"}}),l.set("Avenir Next LT Pro Regular Bold Italic",{font:{family:"Avenir Next LT Pro Regular",style:"italic",weight:"bold"}}),l.set("Avenir Next LT Pro Regular Italic",{font:{family:"Avenir Next LT Pro Regular",style:"italic",weight:"normal"}}),l.set("Avenir Next LT Pro Regular Regular",{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"normal"}}),l.set("Belleza Regular",{font:{family:"Belleza",style:"normal",weight:"normal"}}),l.set("BellTopo Sans Bold",{font:{family:"BellTopo Sans",style:"normal",weight:"bold"}}),l.set("BellTopo Sans Bold Italic",{font:{family:"BellTopo Sans",style:"italic",weight:"bold"}}),l.set("BellTopo Sans Italic",{font:{family:"BellTopo Sans",style:"italic",weight:"normal"}}),l.set("BellTopo Sans Regular",{font:{family:"BellTopo Sans",style:"normal",weight:"normal"}}),l.set("Black Ops One Regular",{font:{family:"Black Ops One",style:"normal",weight:"normal"}}),l.set("Cabin Sketch Bold",{font:{family:"Cabin Sketch",style:"normal",weight:"bold"}}),l.set("Cabin Sketch Regular",{font:{family:"Cabin Sketch",style:"normal",weight:"normal"}}),l.set("Coming Soon Regular",{font:{family:"Coming Soon",style:"normal",weight:"normal"}}),l.set("FGDC GeoAge Regular",{font:{family:"FGDC GeoAge",style:"normal",weight:"normal"}}),l.set("Homemade Apple Regular",{font:{family:"Homemade Apple",style:"normal",weight:"normal"}}),l.set("IM FELL DW Pica PRO Italic",{font:{family:"IM FELL DW Pica PRO",style:"italic",weight:"normal"}}),l.set("IM FELL DW Pica PRO Regular",{font:{family:"IM FELL DW Pica PRO",style:"normal",weight:"normal"}}),l.set("Josefin Sans Regular",{font:{family:"Josefin Sans",style:"normal",weight:"normal"}}),l.set("Josefin Sans Semibold Italic",{font:{family:"Josefin Sans Semibold",style:"italic",weight:"normal"}}),l.set("Josefin Slab Bold",{font:{family:"Josefin Slab",style:"normal",weight:"bold"}}),l.set("Josefin Slab Bold Italic",{font:{family:"Josefin Slab",style:"italic",weight:"bold"}}),l.set("Josefin Slab Italic",{font:{family:"Josefin Slab",style:"italic",weight:"normal"}}),l.set("Josefin Slab Light Italic",{font:{family:"Josefin Slab Light",style:"italic",weight:"normal"}}),l.set("Josefin Slab Regular",{font:{family:"Josefin Slab",style:"normal",weight:"normal"}}),l.set("Josefin Slab Semibold Italic",{font:{family:"Josefin Slab Semibold",style:"italic",weight:"normal"}}),l.set("Josefin Slab Thin Italic",{font:{family:"Josefin Slab Thin",style:"italic",weight:"normal"}}),l.set("Just Another Hand Regular",{font:{family:"Just Another Hand",style:"normal",weight:"normal"}}),l.set("Kranky Regular",{font:{family:"Kranky",style:"normal",weight:"normal"}}),l.set("Life Savers Bold",{font:{family:"Life Savers",style:"normal",weight:"bold"}}),l.set("Loved By The King Regular",{font:{family:"Loved By The King",style:"normal",weight:"normal"}}),l.set("Merriweather Bold",{font:{family:"Merriweather",style:"normal",weight:"bold"}}),l.set("Merriweather Bold Italic",{font:{family:"Merriweather",style:"italic",weight:"bold"}}),l.set("Merriweather Italic",{font:{family:"Merriweather",style:"italic",weight:"normal"}}),l.set("Merriweather Regular",{font:{family:"Merriweather",style:"normal",weight:"normal"}}),l.set("Montserrat Bold",{font:{family:"Montserrat",style:"normal",weight:"bold"}}),l.set("Montserrat Italic",{font:{family:"Montserrat",style:"italic",weight:"normal"}}),l.set("Montserrat Medium Italic",{font:{family:"Montserrat Medium",style:"italic",weight:"normal"}}),l.set("Montserrat Regular",{font:{family:"Montserrat",style:"normal",weight:"normal"}}),l.set("Montserrat Semibold Italic",{font:{family:"Montserrat Semibold",style:"italic",weight:"normal"}}),l.set("Noto Sans Bold",{font:{family:"Noto Sans",style:"normal",weight:"bold"}}),l.set("Noto Sans Bold Italic",{font:{family:"Noto Sans",style:"italic",weight:"bold"}}),l.set("Noto Sans Italic",{font:{family:"Noto Sans",style:"italic",weight:"normal"}}),l.set("Noto Sans Regular",{font:{family:"Noto Sans",style:"normal",weight:"normal"}}),l.set("Noto Serif Bold",{font:{family:"Noto Serif",style:"normal",weight:"bold"}}),l.set("Noto Serif Bold Italic",{font:{family:"Noto Serif",style:"italic",weight:"bold"}}),l.set("Noto Serif Italic",{font:{family:"Noto Serif",style:"italic",weight:"normal"}}),l.set("Noto Serif Regular",{font:{family:"Noto Serif",style:"normal",weight:"normal"}}),l.set("Old Standard TT Bold",{font:{family:"Old Standard TT",style:"normal",weight:"bold"}}),l.set("Old Standard TT Italic",{font:{family:"Old Standard TT",style:"italic",weight:"normal"}}),l.set("Old Standard TT Regular",{font:{family:"Old Standard TT",style:"normal",weight:"normal"}}),l.set("Orbitron Bold",{font:{family:"Orbitron",style:"normal",weight:"bold"}}),l.set("Orbitron Regular",{font:{family:"Orbitron",style:"normal",weight:"normal"}}),l.set("Oregano Italic",{font:{family:"Oregano",style:"italic",weight:"normal"}}),l.set("Oregano Regular",{font:{family:"Oregano",style:"normal",weight:"normal"}}),l.set("Oswald Bold",{font:{family:"Oswald",style:"normal",weight:"bold"}}),l.set("Oswald Regular",{font:{family:"Oswald",style:"normal",weight:"normal"}}),l.set("Pacifico Regular",{font:{family:"Pacifico",style:"normal",weight:"normal"}}),l.set("Palatino Linotype Regular",{font:{family:"Palatino Linotype",style:"normal",weight:"normal"}}),l.set("Playfair Display Black Regular",{font:{family:"Playfair Display Black",style:"normal",weight:"normal"}}),l.set("Playfair Display Bold",{font:{family:"Playfair Display",style:"normal",weight:"bold"}}),l.set("Playfair Display Bold Italic",{font:{family:"Playfair Display",style:"italic",weight:"bold"}}),l.set("Playfair Display Italic",{font:{family:"Playfair Display",style:"italic",weight:"normal"}}),l.set("Playfair Display Regular",{font:{family:"Playfair Display",style:"normal",weight:"normal"}}),l.set("Playfair Display SC Bold",{font:{family:"Playfair Display SC",style:"normal",weight:"bold"}}),l.set("Playfair Display SC Regular",{font:{family:"Playfair Display SC",style:"normal",weight:"normal"}}),l.set("Redressed Regular",{font:{family:"Redressed",style:"normal",weight:"normal"}}),l.set("Risque Regular",{font:{family:"Risque",style:"normal",weight:"normal"}}),l.set("Roboto Condensed Italic",{font:{family:"Roboto Condensed",style:"italic",weight:"normal"}}),l.set("Roboto Condensed Light Italic",{font:{family:"Roboto Condensed Light",style:"italic",weight:"normal"}}),l.set("Rye Regular",{font:{family:"Rye",style:"normal",weight:"normal"}}),l.set("Special Elite Regular",{font:{family:"Special Elite",style:"normal",weight:"normal"}}),l.set("Syncopate Bold",{font:{family:"Syncopate",style:"normal",weight:"bold"}}),l.set("Syncopate Regular",{font:{family:"Syncopate",style:"normal",weight:"normal"}}),l.set("Tangerine Regular",{font:{family:"Tangerine",style:"normal",weight:"normal"}}),l.set("Ubuntu Bold",{font:{family:"Ubuntu",style:"normal",weight:"bold"}}),l.set("Ubuntu Bold Italic",{font:{family:"Ubuntu",style:"italic",weight:"bold"}}),l.set("Ubuntu Condensed Regular",{font:{family:"Ubuntu Condensed",style:"normal",weight:"normal"}}),l.set("Ubuntu Italic",{font:{family:"Ubuntu",style:"italic",weight:"normal"}}),l.set("Ubuntu Light Bold",{font:{family:"Ubuntu Light",style:"normal",weight:"bold"}}),l.set("Ubuntu Light Bold Italic",{font:{family:"Ubuntu Light",style:"italic",weight:"bold"}}),l.set("Ubuntu Light Italic",{font:{family:"Ubuntu Light",style:"italic",weight:"normal"}}),l.set("Ubuntu Light Regular",{font:{family:"Ubuntu Light",style:"normal",weight:"normal"}}),l.set("Ubuntu Medium Italic",{font:{family:"Ubuntu Medium",style:"italic",weight:"normal"}}),l.set("Ubuntu Mono Bold",{font:{family:"Ubuntu Mono",style:"normal",weight:"bold"}}),l.set("Ubuntu Mono Bold Italic",{font:{family:"Ubuntu Mono",style:"italic",weight:"bold"}}),l.set("Ubuntu Mono Italic",{font:{family:"Ubuntu Mono",style:"italic",weight:"normal"}}),l.set("Ubuntu Mono Regular",{font:{family:"Ubuntu Mono",style:"normal",weight:"normal"}}),l.set("Ubuntu Regular",{font:{family:"Ubuntu",style:"normal",weight:"normal"}}),l.set("UnifrakturCook Bold",{font:{family:"UnifrakturCook",style:"normal",weight:"bold"}}),l.set("Vast Shadow Regular",{font:{family:"Vast Shadow",style:"normal",weight:"normal"}}),l.set("Walter Turncoat Regular",{font:{family:"Walter Turncoat",style:"normal",weight:"normal"}});const n=new Map;function a(e){return e?"normal"===e.style&&"normal"===e.weight?`${e.family} Regular${"BellTopo Sans"===e.family?"(Beta)":""}`:"normal"===e.style&&"bold"===e.weight?`${e.family} Bold`:"italic"===e.style&&"normal"===e.weight?`${e.family} Italic`:"italic"===e.style&&"bold"===e.weight?`${e.family} Bold Italic`:"Arial Regular":""}n.set("Arial Bold",{font:{family:"Arial",style:"normal",weight:"bold"}}),n.set("Arial Bold Italic",{font:{family:"Arial",style:"italic",weight:"bold"}}),n.set("Arial Italic",{font:{family:"Arial",style:"italic",weight:"normal"}}),n.set("Arial Regular",{font:{family:"Arial",style:"normal",weight:"normal"}}),n.set("Arial Unicode MS Bold",{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}}),n.set("Arial Unicode MS Bold Italic",{font:{family:"Arial Unicode MS",style:"italic",weight:"bold"}}),n.set("Arial Unicode MS Italic",{font:{family:"Arial Unicode MS",style:"italic",weight:"normal"}}),n.set("Arial Unicode MS Regular",{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}}),n.set("Avenir Bold",{font:{family:"Avenir",style:"normal",weight:"bold"}}),n.set("Avenir Bold Italic",{font:{family:"Avenir",style:"italic",weight:"bold"}}),n.set("Avenir Italic",{font:{family:"Avenir",style:"italic",weight:"normal"}}),n.set("Avenir Regular",{font:{family:"Avenir",style:"normal",weight:"normal"}}),n.set("Times New Roman Bold",{font:{family:"Times New Roman",style:"normal",weight:"bold"}}),n.set("Times New Roman Bold Italic",{font:{family:"Times New Roman",style:"italic",weight:"bold"}}),n.set("Times New Roman Italic",{font:{family:"Times New Roman",style:"italic",weight:"normal"}}),n.set("Times New Roman Regular",{font:{family:"Times New Roman",style:"normal",weight:"normal"}}),n.set("Verdana Bold",{font:{family:"Verdana",style:"normal",weight:"bold"}}),n.set("Verdana Bold Italic",{font:{family:"Verdana",style:"italic",weight:"bold"}}),n.set("Verdana Italic",{font:{family:"Verdana",style:"italic",weight:"normal"}}),n.set("Verdana Regular",{font:{family:"Verdana",style:"normal",weight:"normal"}})},88703:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>d,c:()=>o,d:()=>s,e:()=>l,f:()=>h,g:()=>u,i:()=>n,m:()=>a,t:()=>r,u:()=>p});const s=(e,t)=>{let i,s="idle";const o=(...o)=>new Promise((l=>{switch(s){case"flushed":s="idle",i?(clearTimeout(i),l(e(...o))):l(null);break;case"invoked":clearTimeout(i),s="idle",l(e(...o));break;case"cancelled":clearTimeout(i),s="idle",l(null);break;default:i&&clearTimeout(i),s="pending",i=setTimeout((()=>(s="idle",l(e(...o)))),t)}}));return o.flush=function(...e){return s="flushed",o(...e)},o.invoke=function(...e){return s="invoked",o(...e)},o.cancel=function(...e){return s="cancelled",o(...e)},o.getStatus=function(){return s},o},o=(e,t)=>{let i;return(...s)=>new Promise((o=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,o(e(...s))}),t))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function a(e,t){return await Promise.all([e,r(t)]),e}function r(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:s}=t(e);return[i,s]}))),h=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function p(e,t){const i=[],s={};return e.forEach((e=>{const o=t(e);null==s[o]&&(s[o]=e,i.push(e))})),i}function d(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const u=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,s)=>e.slice(t*s,t+t*s)))},23505:(e,t,i)=>{i.d(t,{c:()=>a});var s=i(35110);const o=e=>!("isConnected"in e)||e.isConnected,l=((e,t)=>{let i;return(...e)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(o))})(...e)}),2e3)}})(),n=e=>"function"==typeof e?e():e,a=(e,t)=>{const i=((e,t=((e,t)=>e!==t))=>{const i=n(e);let s=new Map(Object.entries(null!=i?i:{}));const o={dispose:[],get:[],set:[],reset:[]},l=()=>{var t;s=new Map(Object.entries(null!==(t=n(e))&&void 0!==t?t:{})),o.reset.forEach((e=>e()))},a=e=>(o.get.forEach((t=>t(e))),s.get(e)),r=(e,i)=>{const l=s.get(e);t(i,l,e)&&(s.set(e,i),o.set.forEach((t=>t(e,i,l))))},c="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>a(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(r(t,i),!0)}),h=(e,t)=>(o[e].push(t),()=>{((e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)})(o[e],t)});return{state:c,get:a,set:r,on:h,onChange:(t,i)=>{const s=h("set",((e,s)=>{e===t&&i(s)})),o=h("reset",(()=>i(n(e)[t])));return()=>{s(),o()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{o.dispose.forEach((e=>e())),l()},reset:l,forceUpdate:e=>{const t=s.get(e);o.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof s.g)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,s.g)();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(s.f)),l(e)},reset:()=>{e.forEach((e=>e.forEach(s.f))),l(e)}}})()),i}},22250:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>h,c:()=>l,d:()=>o,g:()=>a,r:()=>r,s:()=>n});var s=i(88703);function o(e,t,i,s){!function(e,t,i){let s=null==(i=i||{})?void 0:i.expires;if("number"==typeof s){const e=new Date,t=24*s*60*60*1e3;e.setTime(Date.now()+t),s=i.expires=e}"string"!=typeof s&&(null==s?void 0:s.toUTCString)&&(i.expires=s.toUTCString());let o,l=`${e}=${encodeURIComponent(t)}`;for(o in i){l+=`; ${o}`;const e=i[o];!0!==e&&(l+=`=${e}`)}document.cookie=l}(e,s?JSON.stringify(t):t,i)}function l(e,t){const i=function(e){const t=document.cookie,i=new RegExp(`(?:^|; )${(0,s.e)(e)}=([^;]*)`),o=t.match(i);return o?decodeURIComponent(o[1]):void 0}(e);return i&&t?JSON.parse(i):i}function n(e,t,i){window.localStorage.setItem(e,i?JSON.stringify(t):t)}function a(e,t){const i=window.localStorage.getItem(e);return i&&t?JSON.parse(i):i}function r(e){window.localStorage.removeItem(e)}function c(e,t,i){window.sessionStorage.setItem(e,i?JSON.stringify(t):t)}function h(e,t){const i=window.sessionStorage.getItem(e);return i&&t?JSON.parse(i):i}},95909:(e,t,i)=>{i.d(t,{a:()=>a,b:()=>h,c:()=>c,d:()=>r,e:()=>l,f:()=>u,g:()=>o,h:()=>d,i:()=>n,j:()=>p});var s=i(21104);function o(e){return"cim"===e.type?"CIMLineSymbol"===e.data.symbol.type?"line":"CIMPolygonSymbol"===e.data.symbol.type?"polygon":"point":"simple-marker"===e.type||"picture-marker"===e.type?"point":"simple-line"===e.type?"line":"polygon"}const l={loaded:!1,async load(){if(this.loaded)return;const[e,t,i,o,l,n,a,r,c,h,p,d,u,g,m,y,f]=await(0,s.l)(["esri/core/screenUtils","esri/Color","esri/portal/Portal","esri/symbols/CIMSymbol","esri/symbols/WebStyleSymbol","esri/core/devEnvironmentUtils","esri/core/promiseUtils","esri/core/urlUtils","esri/portal/PortalItem","esri/symbols/support/previewSymbol2D","esri/symbols/support/gfxUtils","esri/symbols/support/jsonUtils","esri/symbols/support/styleUtils","esri/symbols/support/svgUtils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/symbols/support/webStyleSymbolUtils"]);this.Color=t,this.Portal=i,this.CIMSymbol=o,this.WebStyleSymbol=l,this.devEnvironmentUtils=n,this.previewSymbol2D=h,this.promiseUtils=a,this.urlUtils=r,this.PortalItem=c,this.gfxUtils=p,this.jsonUtils=d,this.screenUtils=e,this.styleUtils=u,this.svgUtils=g,this.symbolUtils=m,this.cimSymbolUtils=y,this.webStyleSymbolUtils=f,this.loaded=!0}};function n(e){return"cim"===(null==e?void 0:e.type)}function a(e){return"simple-marker"===(null==e?void 0:e.type)}function r(e){return"picture-marker"===(null==e?void 0:e.type)}function c(e){return"simple-line"===(null==e?void 0:e.type)}function h(e){return"simple-fill"===(null==e?void 0:e.type)}function p(e){return"CIMPointSymbol"===e.data.symbol.type}function d(e){return"CIMLineSymbol"===e.data.symbol.type}function u(e){return"CIMPolygonSymbol"===e.data.symbol.type}}}]);