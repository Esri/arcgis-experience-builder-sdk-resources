/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757"],{1918:(t,e,a)=>{a.r(e),a.d(e,{arcgis_schema_editor_category:()=>l,arcgis_schema_editor_category_row:()=>d});var i=a(35110),r=a(80462),o=a(26077),n=a(88703),s=a(46346);const c="arcgis-schema-editor-category-row__drag-handle",l=class{constructor(t){(0,i.r)(this,t),this.arcgisSchemaEditorInternalDeleteClick=(0,i.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.arcgisSchemaEditorInternalDragHandleInteract=(0,i.c)(this,"arcgisSchemaEditorInternalDragHandleInteract",7),this.listOrderChanged=(0,i.c)(this,"listOrderChanged",7),this.itemRefs={},this.isSpecialDepthState=null,this.isRoot=!1,this.SORTABLE_ANIMATION_TIME=200,this.handleHandleKeyboardEvent=async({event:t,category:e})=>{var a,i,r;const o=t.code;if(!["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(o))return;const s=e.path,{sortable:c,getParentSortable:l,category:d,SORTABLE_ANIMATION_TIME:g}=this,{category:h}=null!==(a=null==l?void 0:l())&&void 0!==a?a:{category:null},y=c.toArray(),u=y.indexOf(s);let p=!1,m=u;const C=d;let v=C;const f=e;switch(y.splice(u,1),o){case"ArrowDown":m=(u+1)%(y.length+1),y.splice(m,0,s);break;case"ArrowUp":m=u-1,m<0&&(m=y.length),y.splice(m,0,s);break;case"ArrowLeft":if(!h)return;p=!1,v=h,m=h.categories.findIndex((t=>t.path===d.path));break;case"ArrowRight":const t=d.categories,e=t.length;if(e<2)return;p=!1,m=(u+1)%e,v=t[m]}const w={fromCategory:C,toCategory:v,fromItemCategory:f,fromIndex:u,toIndex:m};(null===(r=null===(i=this.isMoveValid)||void 0===i?void 0:i.call(this,w))||void 0===r||r)&&(p&&(c.sort(y,!0),await(0,n.t)(g)),this.listOrderChanged.emit(w))},this.renderCategoryContainer=()=>{const{category:t,rootCategoryPath:e,canAddCategory:a,isRoot:r,isCollapsed:n,isAddingCategory:s,isBeingDragged:c,canEditCategory:l,saveNewTitle:d,saveNewCategory:g,maxDepth:h,i18n:y,isMoveValid:u,canDeleteCategory:p,newCategoryMode:m,isSpecialDepthState:C,isLastInList:v,handleHandleKeyboardEvent:f}=this,w=t.path,I=t.categories,_=I.length,b=_>0,E=!s,S=s||"max-depth"===C||c||!a||n,x=n||c||S&&E,D=!b||"next-depth-max"===C;return(0,i.h)("div",{class:{"arcgis-schema-editor-category__outer-category-container":!0,"arcgis-schema-editor-category__outer-category-container--last-in-list":v,"arcgis-schema-editor-category__outer-category-container--first-level":"first-level"===C,"arcgis-schema-editor-category__outer-category-container--hidden":x,"arcgis-schema-editor-category__outer-category-container--root":r}},b&&(0,i.h)("ul",{class:"arcgis-schema-editor-category__category-container",ref:t=>{this.dragContainerRef=t,this.sortable||this.initializeSortable()}},I.map(((t,r)=>{const o=t.path;return(0,i.h)("li",{class:"arcgis-schema-editor-category__row-container",key:o,"data-sortable-id":o},(0,i.h)("arcgis-schema-editor-category",{isLastInList:r===_-1,category:t,rootCategoryPath:e,newCategoryMode:m,canAddCategory:a,canDeleteCategory:p,canEditCategory:l,i18n:y,maxDepth:h,isMoveValid:u,saveNewTitle:d,saveNewCategory:g,getParentSortable:()=>({sortable:this.sortable,category:this.category,getParentSortable:this.getParentSortable}),ref:t=>this.itemRefs[o]=t,onArcgisSchemaEditorInternalDragHandleInteract:t=>{t.stopPropagation(),f(t.detail)}}))}))),(0,i.h)("arcgis-schema-editor-category-row",{class:{"arcgis-schema-editor-category__new-category--hide":E},category:{categories:[],count:0,path:(0,o.b)(w,{title:"new-category"}),title:""},isCollapsible:!1,isCollapsed:!0,isNewCategory:!0,canDeleteCategory:!1,canEditCategory:()=>!0,i18n:y,onArcgisSchemaEditorInternalCancelClick:()=>this.isAddingCategory=!1,saveNewTitle:async t=>{const e=await g(t);return e&&(this.isAddingCategory=!1),e},ref:t=>this.newCategoryRef=t}),(0,i.h)("div",{class:{"arcgis-schema-editor-category__add-category-btn":!0,"arcgis-schema-editor-category__add-category-btn--hide":S}},(0,i.h)("div",{class:{"arcgis-schema-editor-category__add-category-btn-divider":D}}),(0,i.h)("calcite-button",{appearance:"transparent",kind:"neutral",onClick:()=>this.isAddingCategory=!0,iconStart:"plus-circle",ref:t=>this.addCategoryButtonRef=t}),(0,i.h)("calcite-tooltip",{referenceElement:this.addCategoryButtonRef},(0,i.h)("div",null,r?y.categoryItem.addCategory:y.categoryItem.addSubcategory))))},this.category=void 0,this.rootCategoryPath=void 0,this.canAddCategory=void 0,this.canDeleteCategory=void 0,this.newCategoryMode=void 0,this.showInputByDefault=!1,this.canEditCategory=void 0,this.maxDepth=void 0,this.i18n=void 0,this.isMoveValid=void 0,this.saveNewTitle=void 0,this.saveNewCategory=void 0,this.getParentSortable=void 0,this.isLastInList=!1,this.isCollapsed=!1,this.isBeingDragged=!1,this.isAddingCategory=!1,this.addCategoryButtonRef=void 0}componentWillLoad(){const t=this.category.path;this.isRoot=null===t;const e=(0,s.h)(t,this.rootCategoryPath);this.isSpecialDepthState=e>this.maxDepth&&!this.isRoot?"max-depth":e===this.maxDepth?"next-depth-max":1===e?"first-level":null,this.isCollapsed=this.newCategoryMode&&!this.isRoot}componentDidLoad(){this.onShowInputByDefaultChange(),this.initializeSortable()}initializeSortable(){!this.sortable&&this.dragContainerRef&&(this.sortable=r.S.create(this.dragContainerRef,{group:"arcgis-schema-editor",dataIdAttr:"data-sortable-id",animation:this.SORTABLE_ANIMATION_TIME,handle:`.${c}`,chosenClass:"arcgis-schema-editor-category-row--dragging",onSort:t=>{var e,a;const{from:i,to:r,oldIndex:o,newIndex:n,item:s}=t,c={fromCategory:i.closest("arcgis-schema-editor-category").category,toCategory:r.closest("arcgis-schema-editor-category").category,fromItemCategory:s.querySelector("arcgis-schema-editor-category").category,fromIndex:o,toIndex:n},l=null===(a=null===(e=this.isMoveValid)||void 0===e?void 0:e.call(this,c))||void 0===a||a;null!==l&&(l?this.listOrderChanged.emit(c):i.insertBefore(s,i.children[o>n?o+1:o]))},setData:t=>{t.setData("foo","bar")}}))}onShowInputByDefaultChange(){this.isAddingCategory=this.newCategoryMode&&this.isRoot&&this.showInputByDefault}onIsAddingCategoryChange(){var t;null===(t=this.newCategoryRef)||void 0===t||t.reset()}async expandOrCollapseAll(t){this.isRoot||(this.isCollapsed=t),Object.values(this.itemRefs).forEach((e=>{null==e||e.expandOrCollapseAll(t)}))}async setIsBeingDragged(t){this.category.categories.length>0&&(this.isBeingDragged=t)}render(){const{category:t,canDeleteCategory:e,canEditCategory:a,isRoot:r,isCollapsed:o,i18n:n,renderCategoryContainer:s,saveNewTitle:c,isSpecialDepthState:l,arcgisSchemaEditorInternalDeleteClick:d,arcgisSchemaEditorInternalDragHandleInteract:g}=this;return(0,i.h)(i.H,null,!r&&(0,i.h)("arcgis-schema-editor-category-row",{category:t,isCollapsible:"max-depth"!==l,isCollapsed:o,canDeleteCategory:e,canEditCategory:t=>a({category:t,parentCategory:this.category}),i18n:n,onArcgisSchemaEditorInternalDeleteClick:t=>{t.stopPropagation(),d.emit(t.detail)},onArcgisSchemaEditorInternalExpandClick:t=>this.isCollapsed=t.detail.isCollapsed,saveNewTitle:c,onArcgisSchemaEditorRowInternalDragHandleInteract:({detail:t})=>{g.emit(t)}}),s())}get el(){return(0,i.d)(this)}static get watchers(){return{showInputByDefault:["onShowInputByDefaultChange"],isAddingCategory:["onIsAddingCategoryChange"]}}};l.style=".arcgis-schema-editor-category__category-container{list-style-type:none;margin-top:0px;margin-bottom:0px;padding-inline-start:0px}.arcgis-schema-editor-category__outer-category-container{margin-top:0.5rem;padding-inline-start:1rem;padding-bottom:1rem;margin-inline-start:1rem;border-left:1px solid var(--calcite-color-border-2)}.arcgis-schema-editor-category__outer-category-container:not(:last-child){margin-bottom:1.5rem}.arcgis-schema-editor-category__outer-category-container--last-in-list{padding-bottom:0.5rem}.arcgis-schema-editor-category__outer-category-container--first-level{padding-bottom:1.5rem}.arcgis-schema-editor-category__outer-category-container--root{margin-left:0px;margin-right:0px;padding-left:0px;padding-right:0px;border-width:0px}.arcgis-schema-editor-category__outer-category-container--hidden{display:none}.arcgis-schema-editor-category__row-container:not(:last-child){margin-bottom:0.5rem}.arcgis-schema-editor-category__add-category-btn-divider{margin-inline-start:1rem;margin-top:0.5rem;height:0.75rem;border-left:1px solid var(--calcite-color-border-2)}.arcgis-schema-editor-category__add-category-btn--hide,.arcgis-schema-editor-category__new-category--hide{display:none}";const d=class{constructor(t){(0,i.r)(this,t),this.arcgisSchemaEditorRowInternalDragHandleInteract=(0,i.c)(this,"arcgisSchemaEditorRowInternalDragHandleInteract",7),this.arcgisSchemaEditorInternalDeleteClick=(0,i.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.arcgisSchemaEditorInternalExpandClick=(0,i.c)(this,"arcgisSchemaEditorInternalExpandClick",7),this.arcgisSchemaEditorInternalCancelClick=(0,i.c)(this,"arcgisSchemaEditorInternalCancelClick",7),this.onCancelEdit=()=>{const{arcgisSchemaEditorInternalCancelClick:t,isNewCategory:e}=this;e||(this.isEditing=!1),this.editedCategoryTitle=this.category.title,t.emit()},this.onSaveEdit=async()=>{const{category:t,editInputRef:e,editedCategoryTitle:a,saveNewTitle:i,setInvalid:r,isNewCategory:o}=this;if(!a)return r(),!1;if(a===t.title&&!o)return this.isEditing=!1,!0;e.status="idle";try{return await i({newTitle:a,path:t.path,categoryCount:t.count})?(o||(this.isEditing=!1),!0):(r(),!1)}catch(t){return o||(this.isEditing=!1),console.error(t),!1}},this.setInvalid=()=>{const{editInputRef:t}=this;t.status="invalid",t.setFocus()},this.category=void 0,this.i18n=void 0,this.isNewCategory=!1,this.canEditCategory=void 0,this.canDeleteCategory=void 0,this.isCollapsible=void 0,this.isCollapsed=void 0,this.saveNewTitle=void 0,this.isEditing=this.isNewCategory,this.editedCategoryTitle=this.category.title,this.expandCollapseButtonRef=void 0,this.deleteButtonRef=void 0,this.editInputRef=void 0,this.cantEditIconRef=void 0,this.isInteracting=!1}async reset(){const{isNewCategory:t,category:e,canEditReason:a}=this;t&&!0===a&&(this.editedCategoryTitle=e.title,this.editInputRef.status="idle",this.isEditing=!1,await(0,n.t)(50),this.isEditing=!0,this.editInputRef.setFocus())}async setFocus(){this.editInputRef.setFocus()}componentWillLoad(){var t,e;this.canEditReason=null===(e=null===(t=this.canEditCategory)||void 0===t?void 0:t.call(this,this.category))||void 0===e||e}render(){const{category:t,isCollapsed:e,isEditing:a,isCollapsible:r,canDeleteCategory:o,canEditReason:n,i18n:s,editedCategoryTitle:l,onCancelEdit:d,onSaveEdit:g,arcgisSchemaEditorInternalExpandClick:h,isNewCategory:y}=this,u=t.count,p=a?l:`${l} ${u?`(${u})`:""}`,m=!0===n,C=m&&!a&&!y&&o;return(0,i.h)(i.H,null,(0,i.h)("div",{class:"arcgis-schema-editor-category-row"},!y&&!a&&(0,i.h)("calcite-button",{appearance:"transparent",kind:"neutral",iconStart:"drag",class:c,onFocus:()=>this.isInteracting=!0,onBlur:()=>this.isInteracting=!1,onKeyDown:e=>{this.isInteracting&&this.arcgisSchemaEditorRowInternalDragHandleInteract.emit({category:t,event:e})}}),r&&(0,i.h)(i.F,null,(0,i.h)("calcite-button",{appearance:"transparent",kind:"neutral",onClick:()=>h.emit({isCollapsed:!e}),iconStart:e||a?"chevron-up":"chevron-down",class:"cta",ref:t=>this.expandCollapseButtonRef=t}),(0,i.h)("calcite-tooltip",{referenceElement:this.expandCollapseButtonRef},(0,i.h)("div",{class:"btn-popover"},e?s.categoryItem.expand:s.categoryItem.collapse))),m?(0,i.h)("calcite-inline-editable",{class:"arcgis-schema-editor-category-row__inline-input",controls:!0,onKeyDown:t=>{switch(t.key){case"Escape":d();break;case"Enter":g()}},editingEnabled:a,afterConfirm:async()=>{if(!1===await g())throw new Error},onCalciteInlineEditableEditCancel:t=>{t.stopPropagation(),d()},onCalciteInternalInlineEditableEnableEditingChange:()=>this.isEditing=!0},(0,i.h)("calcite-input",{value:p,onCalciteInputInput:t=>this.editedCategoryTitle=t.target.value,required:!0,ref:t=>this.editInputRef=t})):(0,i.h)(i.F,null,(0,i.h)("div",{class:"arcgis-schema-editor-category-row__inline-input"},p),(0,i.h)("calcite-action",{class:"arcgis-schema-editor-category-row__cant-edit-reason",icon:"exclamation-mark-triangle-f",appearance:"transparent",label:n,ref:t=>this.cantEditIconRef=t,text:"",textEnabled:!1}),(0,i.h)("calcite-tooltip",{referenceElement:this.cantEditIconRef},(0,i.h)("div",{class:"btn-popover"},n))),C&&(0,i.h)(i.F,null,(0,i.h)("calcite-button",{appearance:"transparent",kind:"danger",onClick:()=>this.arcgisSchemaEditorInternalDeleteClick.emit({path:t.path,categoryCount:u}),iconStart:"trash",class:"cta",ref:t=>this.deleteButtonRef=t}),(0,i.h)("calcite-tooltip",{referenceElement:this.deleteButtonRef},(0,i.h)("div",{class:"btn-popover"},s.categoryItem.deleteCategory)))))}get el(){return(0,i.d)(this)}};d.style=".arcgis-schema-editor-category-row{display:flex;align-items:center;background-color:var(--calcite-color-foreground-1);height:2.5rem}.arcgis-schema-editor-category-row--editing{padding-left:0.5rem;padding-right:0.5rem}.arcgis-schema-editor-category-row__inline-input{font-size:0.875rem;width:100%}.arcgis-schema-editor-category-row__cta{display:flex;align-items:center;justify-content:center;height:100%;width:2.5rem}.arcgis-schema-editor-category-row__drag-handle{height:100%}.arcgis-schema-editor-category-row__btn-popover{white-space:nowrap;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem}.arcgis-schema-editor-category-row__cant-edit-reason{--calcite-ui-icon-color:var(--calcite-color-status-warning)}.arcgis-schema-editor-category-row--dragging{opacity:0.25}"},26077:(t,e,a)=>{a.d(e,{U:()=>i,a:()=>n,b:()=>r,g:()=>o});const i="/Categories",r=(t,e,a=!0)=>{const i=null!=t?t:"";return`${i}${i.endsWith("/")?"":"/"}${a?e.title.toLocaleLowerCase():e.title}`};function o(t){var e;let a=null===(e=null==t?void 0:t[0])||void 0===e?void 0:e.title;return a&&"/"!==a.charAt(0)&&(a=`/${a}`),a||i}const n=(t,e)=>`${t.replace(/\/([^\/]+)$/,`/${e}`)}`},88703:(t,e,a)=>{a.d(e,{a:()=>l,b:()=>h,c:()=>r,d:()=>i,e:()=>o,f:()=>d,g:()=>y,i:()=>n,m:()=>s,t:()=>c,u:()=>g});const i=(t,e)=>{let a,i="idle";const r=(...r)=>new Promise((o=>{switch(i){case"flushed":i="idle",a?(clearTimeout(a),o(t(...r))):o(null);break;case"invoked":clearTimeout(a),i="idle",o(t(...r));break;case"cancelled":clearTimeout(a),i="idle",o(null);break;default:a&&clearTimeout(a),i="pending",a=setTimeout((()=>(i="idle",o(t(...r)))),e)}}));return r.flush=function(...t){return i="flushed",r(...t)},r.invoke=function(...t){return i="invoked",r(...t)},r.cancel=function(...t){return i="cancelled",r(...t)},r.getStatus=function(){return i},r},r=(t,e)=>{let a;return(...i)=>new Promise((r=>{a||(a=setTimeout((()=>{clearTimeout(a),a=void 0,r(t(...i))}),e))}))};function o(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(t){return null!=t}async function s(t,e){return await Promise.all([t,c(e)]),t}function c(t){return new Promise((e=>setTimeout(e,t)))}const l=(t,e)=>Object.fromEntries((t||[]).map((t=>{const{key:a,data:i}=e(t);return[a,i]}))),d=(t,e)=>t.length===e.length&&t.reduce(((t,a)=>t&&e.indexOf(a)>-1),!0);function g(t,e){const a=[],i={};return t.forEach((t=>{const r=e(t);null==i[r]&&(i[r]=t,a.push(t))})),a}function h(t){const e={boolean:{},number:{},string:{}},a=[];return t.filter((t=>{let i=typeof t;return i in e?!e[i].hasOwnProperty(t)&&(e[i][t]=!0):!(a.indexOf(t)>=0)&&a.push(t)}))}const y=(t,e)=>[...Array(Math.ceil(t.length/e))].map(((a,i)=>t.slice(e*i,e+e*i)))},46346:(t,e,a)=>{a.d(e,{M:()=>C,a:()=>s,b:()=>m,c:()=>p,d:()=>l,e:()=>o,f:()=>n,g:()=>r,h:()=>c,i:()=>d,j:()=>u});var i=a(26077);const r=(t,{fromCategory:{path:e},toCategory:{path:a},fromIndex:i,toIndex:r},o)=>{const n=structuredClone(t),s=l(n,e,o);let c=s;e!==a&&(c=l(n,a,o));const[d]=s.targetCategory.categories.splice(i,1);return c.targetCategory.categories.splice(r,0,d),g(n)},o=(t,{newTitle:e,path:a},i)=>{const r=structuredClone(t);return l(r,a,i).targetCategory.title=e,g(r)},n=(t,{newTitle:e,path:a},i)=>{const r=structuredClone(t),o=a.replace(/\/[^/]+$/,"");if(o){const{targetCategory:t}=l(r,o,i);t.categories.push({title:e,categories:[],count:0,path:null})}else r.categories.push({title:e,categories:[],count:0,path:null});return g(r)},s=(t,{path:e},a)=>{const i=structuredClone(t),{targetIndex:r,parentCategory:o}=l(i,e,a);return null==o||o.categories.splice(r,1),g(i)},c=(t,e)=>{var a;return null!==(a=null==t?void 0:t.toLocaleLowerCase().replace(e.toLowerCase(),"").slice(1).split("/").length)&&void 0!==a?a:0},l=(t,e,a)=>{var r;const o=a.toLocaleLowerCase();if(null==e||e===o)return{targetCategory:t,targetIndex:1,parentCategory:null,originalPath:e};const n=e.slice(1).split("/");let s=0===e.toLocaleLowerCase().indexOf(o)?(0,i.b)("",{title:n.shift()}):"",c=null,l=t,d=0,g=s;do{s=(0,i.b)(s,{title:n.shift()}),c=l,d=l.categories.findIndex((t=>t.path.toLocaleLowerCase()===s.toLocaleLowerCase())),l=l.categories[d],g+=`/${null!==(r=null==l?void 0:l.title)&&void 0!==r?r:""}`}while(n.length>0&&l.categories.length);return g=g.replace(o,a),{targetCategory:l,targetIndex:d,parentCategory:c,originalPath:g}},d=({categoryAggregationData:t,categorySchema:e,rootCategoryPath:a})=>{var i,r;const o=a.toLocaleLowerCase();return{title:"",path:null,count:null!==(r=null===(i=t.fieldValues.find((t=>t.value===o)))||void 0===i?void 0:i.count)&&void 0!==r?r:0,categories:y({parentPath:null,categorySchema:e,categoryAggregationData:t,lowerCaseRootCategoryPath:o})}},g=t=>t.categories.map(h),h=t=>({title:t.title,categories:t.categories.map(h)}),y=({categoryAggregationData:t,categorySchema:e,parentPath:a,lowerCaseRootCategoryPath:r})=>e.map((e=>{var o,n;const s=(0,i.b)(null!=a?a:r,e),c=null===(o=t.fieldValues.find((t=>t.value===s)))||void 0===o?void 0:o.count,l=y({parentPath:s,categorySchema:null!==(n=e.categories)&&void 0!==n?n:[],categoryAggregationData:t,lowerCaseRootCategoryPath:r});return{title:e.title,path:s,count:null!=c?c:0,categories:l}})),u=t=>t.reduce(((t,e)=>{var a;return t+1+u(null!==(a=e.categories)&&void 0!==a?a:[])}),0),p=({targetCategory:t,targetParentCategory:e})=>{var a;const i=null===(a=t.title.toLocaleLowerCase())||void 0===a?void 0:a.trim();return i?i.length>C?"maxCharacter":e.categories.some((e=>e.title.toLowerCase()===i&&e.path!==t.path))?"destinationHasSameName":null:"emptyTitle"},m=({rootCategoryPath:t,uiCategory:e,uiPath:a})=>l(e,a,t).originalPath,C=100}}]);