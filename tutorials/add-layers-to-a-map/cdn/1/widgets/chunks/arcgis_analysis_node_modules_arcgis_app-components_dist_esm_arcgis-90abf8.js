/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-90abf8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-90abf8"],{73838:(e,t,r)=>{r.d(t,{a:()=>i,c:()=>n,g:()=>o});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},r.exports),r.exports}},85679:(e,t,r)=>{r.r(t),r.d(t,{arcgis_publish_item_pages_item_properties:()=>g});var i=r(35110),o=r(76338),n=r(79233),s=r(46710),a=r(91659),l=r(91306),c=r(42015),u=r(74504),d=r(12856),p=r(27669),h=r(17752),f=r(7803),m=r(64510);r(66913),r(21104),r(73838),r(70392),r(75858),r(23505),r(56086),r(52299),r(82669),r(73208),r(35105),r(16082),r(67148),r(64307),r(76743),r(63280),r(9657),r(53040),r(51287),r(20982),r(37526),r(84873),r(38477),r(30007);const g=class{constructor(e){(0,i.r)(this,e),this.workflowCancel=(0,i.c)(this,"workflowCancel",7),this.workflowComplete=(0,i.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,i.c)(this,"newItemToggleNavigationEnabled",7),this.arcgisWorkflowUpdateError=(0,i.c)(this,"arcgisWorkflowUpdateError",7),this.workflowCancelled=!1,this.handleRequest=async()=>{const{categories:e,title:t}=l.i;if(await this.validate()){(null==t?void 0:t.length)>250&&(this.titleRef.title=t.substring(0,250));try{const{publishResponse:t}=await this.publishItem();if(e&&await(0,o.u)({portal:this.portal,itemIds:[t.id],categories:e}),this.workflowCancelled)(null==t?void 0:t.id)&&await(0,d.d)(t.id),this.workflowCancel.emit();else{const e=Object.assign({},t);this.workflowComplete.emit(e)}(0,p.r)()}catch(e){console.error(e),this.errorMessage=this.parseError(e.code),this.arcgisWorkflowUpdateError.emit(this.errorMessage),this.showLoader(!1)}}else this.arcgisWorkflowUpdateError.emit(this.errorMessage)},this.item=void 0,this.portal=void 0,this.user=void 0,this.errorMessage=void 0,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0}async validate(){var e,t,r;const i=await(null===(e=this.titleRef)||void 0===e?void 0:e.validateTitle());if(i)return this.errorMessage={title:m.p.i18n.error.title,description:i.translatedMessage},this.titleRef.focusMainInput(),!1;const o=await(null===(t=this.itemPropertiesFolderRef)||void 0===t?void 0:t.saveActiveFolder());if(o){if("boolean"==typeof o&&!o)return!1;if("string"==typeof o)return this.errorMessage={title:m.p.i18n.error.title,description:o},!1}const n=await(null===(r=this.summaryRef)||void 0===r?void 0:r.getErrorMessage());return!n||(this.errorMessage={title:m.p.i18n.error.title,description:n.translatedMessage},!1)}async navigateToNextPage(){this.handleRequest()}async componentWillLoad(){var e,t;if(m.p.i18n=m.p.i18n,null!==(e=this.portal)&&void 0!==e||(this.portal=s.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=s.c.user),!this.item)return console.error("No item found"),void this.arcgisWorkflowUpdateError.emit(this.errorMessage);this.folder=await(0,n.d)(this.item.ownerFolder,this.user)}async publishItem(){const{id:e,type:t}=this.item,r={success:!0,id:e,folder:null},i="Image Collection"===t?await this.publishImageCollection(r):await this.publishService(e);return await(0,u.a)(i,this.user),{addResponse:r,publishResponse:i}}async publishService(e){var t;const{type:r}=this.item,i=h.a[r].fileExt[0];this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:m.p.i18n.publishingService});const{result:o,error:n}=await(0,u.p)({itemId:e,user:this.user,title:l.i.title,extension:i,type:r});if(!n){const e=null===(t=o.services)||void 0===t?void 0:t[0];return{success:!0,id:null==e?void 0:e.serviceItemId,jobId:null==e?void 0:e.jobId,serviceType:null==e?void 0:e.type,serviceUrl:null==e?void 0:e.serviceurl}}console.error("there was an error",n)}async publishImageCollection(e){var t,r,i,o;const{config:n,user:a,portal:u}=s.c;this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:m.p.i18n.publishingService});const d=(0,c.c)(e,l.i.title,{config:n,user:a,portal:u});try{for(var p,h=!0,f=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,o){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,o,(t=e[r](t)).done,t.value)}))}}}(d);!(t=(p=await f.next()).done);h=!0){o=p.value,h=!1;const e=o;if("string"!=typeof e)return{success:!0,id:e.serviceItemId,jobId:null,serviceType:e.type,serviceUrl:e.serviceurl};this.updateLoader("indeterminate",m.p.i18n[e])}}catch(e){r={error:e}}finally{try{h||t||!(i=f.return)||await i.call(f)}finally{if(r)throw r.error}}}showLoader(e,t){t&&this.updateLoader(t.loaderType,t.loaderMessage),e?(this.newItemToggleNavigationEnabled.emit(!1),this.loading=!0):(this.newItemToggleNavigationEnabled.emit(!0),this.loading=!1)}updateLoader(e,t){this.loaderType=e,this.loaderMessage=t}parseError(e){var t,r,i,o;const{i18n:n}=m.p;return{title:null!==(r=null===(t=n.error[e])||void 0===t?void 0:t.title)&&void 0!==r?r:"no error code title",description:null!==(o=null===(i=n.error[e])||void 0===i?void 0:i.description)&&void 0!==o?o:"no error code description"}}render(){if(!this.item)return;const{type:e}=this.item,{user:t}=s.c;return(0,i.h)(i.H,null,(0,i.h)("arcgis-new-item-loader",{type:this.loaderType,value:f.w.uploadProgress,active:this.loading,text:this.loaderMessage}),(0,i.h)("arcgis-item-properties",{onArcgisItemPropertiesChange:()=>this.arcgisWorkflowUpdateError.emit(null)},"Service Definition"!==e&&(0,i.h)("arcgis-title-input",{itemTitle:this.item.title,class:"medium",currentFolder:this.item.ownerFolder,type:e,enablePublishing:!0,ref:e=>{this.titleRef=e}}),(0,i.h)("arcgis-folder-picker",{class:"medium",ref:e=>this.itemPropertiesFolderRef=e,folder:this.folder}),!(0,a.d)(t)&&(0,i.h)("arcgis-categories-picker",{class:"medium"}),(0,i.h)("arcgis-tags-picker",{class:"medium"}),(0,i.h)("arcgis-summary-input",{class:"medium",ref:e=>this.summaryRef=e})))}get el(){return(0,i.d)(this)}};g.style=".layer-description.sc-arcgis-publish-item-pages-item-properties{display:block;margin-bottom:0.75rem}.locator__heading.sc-arcgis-publish-item-pages-item-properties{font-size:0.875rem;font-weight:500;color:var(--calcite-color-text-1);line-height:18px;margin-bottom:2px}.locator__description.sc-arcgis-publish-item-pages-item-properties{margin:0px;margin-bottom:1rem;padding:0px;font-size:0.875rem;color:var(--calcite-color-text-1)}.medium.sc-arcgis-publish-item-pages-item-properties{--arcgis-label-font-weight:500}.info-container.sc-arcgis-publish-item-pages-item-properties{margin-bottom:1.5rem}"},26077:(e,t,r)=>{r.d(t,{U:()=>i,a:()=>s,b:()=>o,g:()=>n});const i="/Categories",o=(e,t,r=!0)=>{const i=null!=e?e:"";return`${i}${i.endsWith("/")?"":"/"}${r?t.title.toLocaleLowerCase():t.title}`};function n(e){var t;let r=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return r&&"/"!==r.charAt(0)&&(r=`/${r}`),r||i}const s=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},76338:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>d,c:()=>f,f:()=>u,g:()=>c,u:()=>h});var i=r(66913),o=r(26077),n=r(46710),s=r(75858),a=r(91659),l=r(70392);const c=async({portal:e,user:t,group:r,useCache:i=!1})=>{var o;try{const n=await(r?d(r.id,e,i):u(e,t,i));return{result:null!==(o=null==n?void 0:n.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function u(e,t,r=!0){if(null!=e||(e=n.c.portal),null!=t||(t=n.c.user),!(null==e?void 0:e.id)||t&&(0,a.d)(t))return null;const o=()=>(0,i.r)(`${(0,l.g)(e)}portals/${e.id}/categorySchema`);return r?(0,i.f)(o,"categorySchema",e.id):o()}async function d(e,t,r=!0){if(null!=t||(t=null===n.c||void 0===n.c?void 0:n.c.portal),!e||!t)return null;const o=()=>(0,i.r)(`${(0,s.g)(t,{id:e})}categorySchema`);return r?(0,i.f)(o,"categorySchema",e):o()}async function p(e,t,r=!0){const o=()=>async function(e,t){var r;const o=(0,l.g)(e),n=await(0,i.r)(`${o}portals/self`),a=await(0,i.r)(`${o}community/groups?q=${n.contentCategorySetsGroupQuery}`),c=null===(r=null==a?void 0:a.results)||void 0===r?void 0:r[0],u=(await(0,i.r)((0,s.a)(e,c),{q:`typekeywords: ${t}`})).results[0];return(0,i.r)(`${o}content/items/${u.id}/data`)}(e,t);return r?(0,i.f)(o,"categorySchema",t):o()}async function h({categories:e,itemIds:t,portal:r}){try{const o=`${(0,l.g)(r)}/content/updateItems`,n=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,i.r)(o,{items:n},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const f=async({path:e,portal:t,group:r,updateInfo:i})=>{try{const n=(await m({category:e,portal:t,group:r,num:1})).total;if(0===n)return console.warn(`No items found with category ${e} when updating schema`),{};const s=100,a=Math.ceil(n/s),l=[];for(let n=0;n<a;n++)l.push(m({category:e,portal:t,group:r,start:n*s,num:s}).then((({results:t})=>{const r={};return t.forEach((t=>{const n="change-title"===i.type?t.categories.map((t=>{const r=(0,o.a)(e,i.newTitle);return t===e?r:t.replace(`${e}/`,`${r}/`)})):t.categories.filter((t=>!t.startsWith(e)));r[t.id]=n})),r})));const c=await Promise.all(l);return await Promise.all(c.map((e=>h({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${i.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},m=({category:e,num:t=100,start:r=0,portal:o,group:n})=>{const a={start:r,num:t,categories:JSON.stringify([e])},c=n?(0,s.a)(o,n):`${(0,l.g)(o)}search`;return(0,i.r)(c,Object.assign(Object.assign({},a),{q:n?void 0:`orgid: ${o.id}`}))}},75858:(e,t,r)=>{r.d(t,{a:()=>n,g:()=>o});var i=r(70392);const o=(e,t)=>(0,i.a)(`${(0,i.g)(e)}community/groups/${t.id}`),n=(e,t)=>`${((e,t)=>(0,i.a)(`${(0,i.g)(e)}content/groups/${t.id}`))(e,t)}search`},42015:(e,t,r)=>{r.d(t,{c:()=>c});var i=r(15059),o=r(12856),n=r(52299),s=r(66913),a=function(e){return this instanceof a?(this.v=e,this):new a(e)},l=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=r.apply(e,t||[]),n=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){o[e]&&(i[e]=function(t){return new Promise((function(r,i){n.push([e,t,r,i])>1||l(e,t)}))})}function l(e,t){try{(r=o[e](t)).value instanceof a?Promise.resolve(r.value.v).then(c,u):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){l("next",e)}function u(e){l("throw",e)}function d(e,t){e(t),n.shift(),n.length&&l(n[0][0],n[0][1])}};function c(e,t,r){return l(this,arguments,(function*(){const{config:l,portal:c,user:u}=r,{item:d}=yield a(function(e,t){const r=`${t.userContentUrl}/items/${e.id}`;return(0,s.r)(r)}(e,u)),p=yield a((0,n.t)(c));yield yield a("publishingService");const h=d.ownerFolder&&"/"!==d.ownerFolder&&"root"!==d.ownerFolder,f=`${t}---${(0,i.g)()}`,{createServiceResponse:m,addToDefinitionResponse:g}=yield a((0,n.u)(Object.assign({name:h?f:t,layers:(null==p?void 0:p.layers)||[],tables:(null==p?void 0:p.tables)||[]},p),{config:l,user:u}));h&&(yield a((0,o.m)(m.itemId,d.ownerFolder)),yield a((0,o.u)(m.itemId,{title:t}))),yield yield a("appendingPhotos");const{statusUrl:v}=yield a(function(e,t,r){var i;const o=t.layers[0],n=`${e.encodedServiceURL}/${null!==(i=o.id)&&void 0!==i?i:0}/append`,a={appendItemId:r.id,appendUploadFormat:"imageCollection",appendAttachmentsInfo:JSON.stringify({ignoreAttachmentsWithoutLocation:!0}),upsert:!1,useGlobalIds:!1,rollbackOnFailure:!0};return(0,s.r)(n,a,{},"post")}(m,g,d));yield a(function(e,t,r){const i=`${r.userContentUrl}/addRelationship`,o={relationshipType:"Service2Data",destinationItemId:t.id,originItemId:e.itemId};return(0,s.r)(i,o,{},"post")}(m,d,u)),yield yield a("checkingStatus"),yield a((0,s.p)(v)),yield yield a(m)}))}},21104:(e,t,r)=>{r.d(t,{l:()=>n});var i=r(73838),o=(0,i.c)((function(e,t){i.a,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},r="4.24",i="next";function o(e){if(e.toLowerCase()===i)return i;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function n(e){return void 0===e&&(e=r),"https://js.arcgis.com/".concat(e,"/")}function s(e){return!e||o(e)?function(e){void 0===e&&(e=r);var t=n(e),s=o(e);if(s!==i&&3===s.major){var a=s.minor<=10?"js/":"";return"".concat(t).concat(a,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}(e):e}function a(e,t){var r=s(e),i=function(e){return document.querySelector('link[href*="'.concat(e,'"]'))}(r);return i||function(e,t){if(t){var r=document.querySelector(t);r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}(i=function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}(r),t),i}var l={};function c(e,t,r){var i;r&&(i=function(e,t){var r=function(i){t(i.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",r,!1)};return e.addEventListener("error",r,!1),r}(e,r));var o=function(){t(e),e.removeEventListener("load",o,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",o,!1)}function u(){return document.querySelector("script[data-esri-loader]")}function d(){var e=window.require;return e&&e.on}function p(e){void 0===e&&(e={});var r={};[l,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}));var i=r.version,o=r.url||n(i);return new t.Promise((function(e,t){var n=u();if(n){var s=n.getAttribute("src");s!==o?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(s,")."))):d()?e(n):c(n,e,t)}else if(d())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var l=r.css;l&&a(!0===l?i:l,r.insertCssBefore),c(n=function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}(o),(function(){n.setAttribute("data-esri-loader","loaded"),e(n)}),t),document.body.appendChild(n)}}))}function h(e){return new t.Promise((function(t,r){var i=window.require.on("error",r);window.require(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];i.remove(),t(e)}))}))}e.utils=t,e.loadModules=function(e,t){if(void 0===t&&(t={}),d())return h(e);var r=u(),i=r&&r.getAttribute("src");return!t.url&&i&&(t.url=i),p(t).then((function(){return h(e)}))},e.getScript=u,e.isLoaded=d,e.loadScript=p,e.setDefaultOptions=function(e){void 0===e&&(e={}),l=e},e.loadCss=a,Object.defineProperty(e,"__esModule",{value:!0})}(t)}));const n=async(e,t)=>(await o.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},64510:(e,t,r)=>{r.d(t,{p:()=>i});const i=(0,r(23505).c)({sourceItem:null,i18n:null}).state},27669:(e,t,r)=>{r.d(t,{a:()=>a,r:()=>s});var i=r(91306),o=r(82669),n=r(84873);function s(){o.d.reset(),i.a.reset()}const a=()=>{if(o.a.existingItem||"register"===n.u.workflow)return;o.d.reset();const e=i.i.folder;i.a.reset(),i.i.folder=e}}}]);