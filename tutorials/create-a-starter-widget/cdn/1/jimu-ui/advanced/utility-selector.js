System.register(["jimu-core","jimu-for-builder","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/setting-components","jimu-ui/basic/item-selector","jimu-ui/basic/list-tree"],(function(e,t){var i={},s={},n={},l={},a={},o={},r={};return{setters:[function(e){i.Immutable=e.Immutable,i.React=e.React,i.ReactRedux=e.ReactRedux,i.SessionManager=e.SessionManager,i.SupportedItemTypes=e.SupportedItemTypes,i.SupportedUtilityType=e.SupportedUtilityType,i.UtilityManager=e.UtilityManager,i.appConfigUtils=e.appConfigUtils,i.classNames=e.classNames,i.css=e.css,i.getAppStore=e.getAppStore,i.hooks=e.hooks,i.jsx=e.jsx},function(e){s.getAppConfigAction=e.getAppConfigAction},function(e){n.Alert=e.Alert,n.Button=e.Button,n.Checkbox=e.Checkbox,n.Collapse=e.Collapse,n.Label=e.Label,n.Loading=e.Loading,n.LoadingType=e.LoadingType,n.MultiSelect=e.MultiSelect,n.Tab=e.Tab,n.Tabs=e.Tabs,n.TextInput=e.TextInput,n.Tooltip=e.Tooltip,n.UrlInput=e.UrlInput,n.defaultMessages=e.defaultMessages},function(e){l.DataSourceTree=e.DataSourceTree},function(e){a.SidePopper=e.SidePopper},function(e){o.ItemSelector=e.ItemSelector,o.ItemSelectorMode=e.ItemSelectorMode},function(e){r.List=e.List,r.TreeItemActionType=e.TreeItemActionType}],execute:function(){e((()=>{var e={90075:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.6 6.188V1.824h-2.4v2.14L8 1 0 8.412h2.4V13H1v2h14v-2h-1.4V8.412H16zM10 9v3H6V9z" clip-rule="evenodd"></path></svg>'},69359:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M5.736 1c.424 0 .832.184 1.136.516L8 2.75h6.4c.88 0 1.6.788 1.6 1.75v8.75c0 .963-.72 1.75-1.6 1.75H1.6C.72 15 0 14.213 0 13.25l.008-10.5C.008 1.788.72 1 1.6 1zm.144 4.922A2.936 2.936 0 0 1 8 5a2.936 2.936 0 0 1 2.12.922c.563.589.88 1.388.88 2.22 0 .681-.211 1.344-.604 1.886l-.095.128L8 13l-2.3-2.842c-.014-.017-.096-.13-.096-.13A3.21 3.21 0 0 1 5 8.144c0-.833.317-1.632.88-2.221m1.514 3.171c.18.126.39.193.606.193.29 0 .566-.121.771-.335a1.182 1.182 0 0 0 .136-1.443 1.104 1.104 0 0 0-.49-.421C8.218 7 8 6.977 7.787 7.022a1.076 1.076 0 0 0-.558.313 1.16 1.16 0 0 0-.299.585c-.042.222-.02.451.062.66.083.209.223.388.402.513" clip-rule="evenodd"></path></svg>'},10433:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M10 5a2 2 0 1 0 0-4 2 2 0 0 0 0 4M2 15a2 2 0 1 0 0-4 2 2 0 0 0 0 4M16 13a2 2 0 1 1-4 0 2 2 0 0 1 4 0M3.2 9.638 7.006 5l1.546 1.269-3.806 4.638zM13.594 9.222 12.2 6l-1.835.794 1.393 3.222zM10.5 12h-5v2h5z"></path></svg>'},14407:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M5.6 11.2h4.8v1.6H5.6zm10.4 0h-2.4v3.2A1.6 1.6 0 0 1 12 16H4a1.6 1.6 0 0 1-1.6-1.6v-3.2H0V5.6A1.6 1.6 0 0 1 1.6 4h.8V1.6A1.6 1.6 0 0 1 4 0h8a1.6 1.6 0 0 1 1.6 1.6V4h.8A1.6 1.6 0 0 1 16 5.6zM4 4h8V1.6H4zm8 5.6H4v4.8h8zm2.4-2.8a1.203 1.203 0 0 0-1.2-1.2 1.2 1.2 0 1 0 1.2 1.2"></path></svg>'},17826:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M13.714 5.823v4.97c0 .914-.36 1.789-1.004 2.434a3.422 3.422 0 0 1-4.848 0 3.448 3.448 0 0 1-1.004-2.433V5.44c0-.507-.201-.993-.558-1.352a1.901 1.901 0 0 0-2.694 0 1.915 1.915 0 0 0-.558 1.352v5.1a2.302 2.302 0 0 1 .712 3.918 2.282 2.282 0 0 1-3.727-1.366 2.302 2.302 0 0 1 .281-1.55 2.288 2.288 0 0 1 1.21-1.001v-5.1c0-.914.362-1.789 1.005-2.434a3.422 3.422 0 0 1 4.848 0A3.448 3.448 0 0 1 8.381 5.44v5.353c0 .507.201.993.558 1.352a1.9 1.9 0 0 0 2.694 0c.357-.359.558-.845.558-1.352v-4.97H9.905L12.953 2 16 5.823z"></path></svg>'},11167:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2V4a2 2 0 0 1 2-2h8a2 2 0 0 0-2-2z"></path><path fill="#000" fill-rule="evenodd" d="M6 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm5.489 2.938c-.786-.786-1.728-1.078-2.829-.876a.402.402 0 0 0-.212.68l1.619 1.618a.402.402 0 0 1 0 .569l-1.138 1.138a.402.402 0 0 1-.569 0L6.742 8.448a.402.402 0 0 0-.68.212c-.202 1.1.09 2.043.876 2.829a3.22 3.22 0 0 0 3.532.688l1.588 1.587a.805.805 0 0 0 1.137 0l.57-.569a.805.805 0 0 0 0-1.137l-1.588-1.588a3.22 3.22 0 0 0-.688-3.532" clip-rule="evenodd"></path></svg>'},13372:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4.751a2 2 0 0 0-.495-1.317L12.098.683A2 2 0 0 0 10.592 0zm3.325 3.077c1.376-.252 2.554.114 3.536 1.095a4.024 4.024 0 0 1 .86 4.416l1.985 1.984c.392.393.392 1.03 0 1.422l-.712.712a1.006 1.006 0 0 1-1.422 0L8.588 10.72a4.024 4.024 0 0 1-4.416-.86c-.981-.982-1.347-2.16-1.095-3.536a.503.503 0 0 1 .85-.265L5.95 8.083a.503.503 0 0 0 .711 0l1.422-1.422a.503.503 0 0 0 0-.71L6.06 3.926a.503.503 0 0 1 .265-.85" clip-rule="evenodd"></path></svg>'},41074:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M7.2 4a.8.8 0 1 1 1.6 0v3.2H12a.8.8 0 0 1 0 1.6H8.8V12a.8.8 0 0 1-1.6 0V8.8H4a.8.8 0 1 1 0-1.6h3.2z" clip-rule="evenodd"></path></svg>'},79775:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.154 3.154a.527.527 0 0 1 .746 0l1.317 1.317A8.618 8.618 0 0 1 8 4c2.667 0 5.667 1.333 7 4-.696 1.393-1.847 2.422-3.168 3.087l1.014 1.013a.527.527 0 1 1-.746.746l-1.317-1.317A8.617 8.617 0 0 1 8 12c-2.667 0-5.667-1.333-7-4 .696-1.393 1.847-2.422 3.168-3.087L3.154 3.9a.527.527 0 0 1 0-.746m1.698 2.443C3.726 6.087 2.782 6.882 2 8c1.422 2.033 3.382 3 6 3a8.66 8.66 0 0 0 2.03-.225l-.675-.674A2.5 2.5 0 0 1 5.9 6.644zm6.296 4.805C12.275 9.913 13.218 9.119 14 8c-1.422-2.033-3.382-3-6-3-.726 0-1.402.074-2.03.225l.675.674a2.5 2.5 0 0 1 3.457 3.456zM6.5 8c0-.221.048-.431.134-.62l1.987 1.986A1.5 1.5 0 0 1 6.5 8m.88-1.366 1.986 1.987a1.5 1.5 0 0 0-1.987-1.987" clip-rule="evenodd"></path></svg>'},15467:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 12c-2.667 0-5.667-1.333-7-4 1.333-2.667 4.333-4 7-4s5.667 1.333 7 4c-1.333 2.667-4.333 4-7 4m0-7c-2.618 0-4.578.967-6 3 1.422 2.033 3.382 3 6 3s4.578-.967 6-3c-1.422-2.033-3.382-3-6-3m0 5.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3" clip-rule="evenodd"></path></svg>'},59788:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},96009:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .538.538 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.538.538 0 0 1 0 .738" clip-rule="evenodd"></path></svg>'},55339:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},59455:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0m1 0A7 7 0 1 1 1 8a7 7 0 0 1 14 0M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8" clip-rule="evenodd"></path></svg>'},80272:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0m1 0A7 7 0 1 1 1 8a7 7 0 0 1 14 0M7.5 4.5a.5.5 0 0 1 1 0v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3z" clip-rule="evenodd"></path></svg>'},30224:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},88866:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},79964:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},48891:e=>{"use strict";e.exports=i},23137:e=>{"use strict";e.exports=s},30726:e=>{"use strict";e.exports=n},338:e=>{"use strict";e.exports=l},77756:e=>{"use strict";e.exports=a},20878:e=>{"use strict";e.exports=o},59587:e=>{"use strict";e.exports=r}},t={};function c(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var i in t)c.o(t,i)&&!c.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{"use strict";c.r(u),c.d(u,{AddUtilityTabs:()=>Ie,UtilityIcon:()=>V,UtilitySelector:()=>ze,selectUtilitySVG:()=>H});var e=c(48891),t=c(23137),i=c(59587),s=c(30726),n=c(77756),l=c(338);const a=[{name:"printTask",type:e.SupportedUtilityType.Printing},{name:"geometry",type:e.SupportedUtilityType.Geometry},{name:"geoenrichment",type:e.SupportedUtilityType.GeoEnrichment},{name:"route",type:e.SupportedUtilityType.Routing},{name:"geocode",dynamic:!0,type:e.SupportedUtilityType.GeoCoding}];var o=c(11167),r=c.n(o);const p=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:r()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var m=c(88866),d=c.n(m);const v=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:d()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var y=function(e,t,i,s){return new(i||(i=Promise))((function(n,l){function a(e){try{r(s.next(e))}catch(e){l(e)}}function o(e){try{r(s.throw(e))}catch(e){l(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}r((s=s.apply(e,t||[])).next())}))};const g={gp:/\/rest\/services\/.*\/GPServer\/?$/,geometry:/\/rest\/services\/.*\/GeometryServer\/?/,geocode:/\/rest\/services\/.*\/GeocodeServer\/?/,geoenrich:/\/rest\/services\/.*\/GeoenrichmentServer\/?/,na:/\/rest\/services\/.*\/NAServer\/?/,gptask:/\/rest\/services\/.*\/GPServer\/.+/};function f(e){var t;const i=e.match(/\/([\w\s%]*)\/(?:GP|NA|Geoenrichment|Geometry|Geocode)Server\/?([\w\s%]*)?\/?/);return 3===(null==i?void 0:i.length)?decodeURI(null!==(t=i[2])&&void 0!==t?t:i[1]):""}function b(e,t,i,s){const{url:n,label:l}=e,a=null===t||t.includes(e.type),o=!i||l.toLowerCase().includes(i.toLowerCase()),r=!s||s.test(n);return a&&o&&r}function h(e){return Object.values(g).some((t=>t.test(e)))}function x(t){var i,s;return y(this,void 0,void 0,(function*(){if(e.SessionManager.getInstance().removeFromNoPermissionResourceInfoList(t),g.gp.test(t))return e.UtilityManager.getGPServerInfo(t);const n=yield e.UtilityManager.getServiceInfo(t);return n?g.geometry.test(t)?{type:e.SupportedUtilityType.Geometry,info:n}:g.geocode.test(t)?{type:e.SupportedUtilityType.GeoCoding,info:n}:g.geoenrich.test(t)?{type:e.SupportedUtilityType.GeoEnrichment,info:n}:g.na.test(t)?{type:"esriNAServerRouteLayer"===n.layerType&&(null===(i=n.supportedTravelModes)||void 0===i?void 0:i.length)>0&&(null===(s=n.networkClasses)||void 0===s?void 0:s.length)>0?e.SupportedUtilityType.Routing:null,info:n}:g.gptask.test(t)?{type:e.UtilityManager.isPrintingTask(n)?e.SupportedUtilityType.Printing:e.SupportedUtilityType.GPTask,info:n}:{type:null,info:n}:null}))}var j=c(13372),w=c.n(j);const O=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:w()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var S=c(69359),N=c.n(S);const k=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:N()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var I=c(90075),R=c.n(I);const C=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:R()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var U=c(10433),T=c.n(U);const E=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:T()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var P=c(14407),M=c.n(P);const A=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:M()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var G=c(17826),B=c.n(G);const L=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:B()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var z=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i};function V(t){const{type:i}=t,s=z(t,["type"]);switch(i){case e.SupportedUtilityType.GeoEnrichment:return(0,e.jsx)(k,Object.assign({},s));case e.SupportedUtilityType.GeoCoding:return(0,e.jsx)(C,Object.assign({},s));case e.SupportedUtilityType.Geometry:return(0,e.jsx)(E,Object.assign({},s));case e.SupportedUtilityType.Printing:return(0,e.jsx)(A,Object.assign({},s));case e.SupportedUtilityType.Routing:return(0,e.jsx)(L,Object.assign({},s))}return(0,e.jsx)(O,Object.assign({},s))}function H(t){switch(t){case e.SupportedUtilityType.GeoEnrichment:return N();case e.SupportedUtilityType.GeoCoding:return R();case e.SupportedUtilityType.Geometry:return T();case e.SupportedUtilityType.Printing:return M();case e.SupportedUtilityType.Routing:return B();default:return w()}}var $=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i};function D(e,t){if(/rest\/services\/.*\/GeocodeServer/.test(t.url)){const{url:e}=t;return $(t,["url"])}return"printTask"===e?{templates:t.templates}:null}const _=e.css`
  .utility-item.utility-item-selected {
    outline: 1px solid var(--primary-700);
    border-radius: 0;
    position: relative;
    .item-active-icon {
      position: absolute;
      top: -1px;
      right: -1px;
      & > div {
        width: 0;
        height: 0;
        border-top: 0.75rem var(--primary-700) solid;
        border-left: 0.75rem transparent solid;
        background-color: transparent;
      }
    }
  }

  .utility-item-not-matched.utility-item-selected {
    outline: 1px solid var(--primary-700);
    border-radius: 0;
  }

  .utility-item-not-matched {
    position: relative;

    .item-active-icon {
      position: absolute;
      top: -1px;
      right: -1px;
      .icon-container {
        width: 0;
        height: 0;
        border-top: 0.75rem var(--primary-700) solid;
        border-left: 0.75rem transparent solid;
        background-color: transparent;
      }
    }
  }

  .org-tree {
    height: auto !important;
  }
  .tree-root {
    padding: 0.5rem 0;

  }
`;function J(i){var n;const{keyword:o,pattern:r,serviceTypes:c,useUtilities:u,isMultiple:m,onChange:d}=i,y=null===(n=(0,e.getAppStore)().getState().portalSelf)||void 0===n?void 0:n.helperServices,[g,f]=e.React.useState([]),[h,x]=e.React.useState(null),j=e.hooks.useTranslation(s.defaultMessages);e.React.useEffect((()=>{f(function(e,t,i,s,n){const l=[];return a.forEach((a=>{const o=e[a.name];if(a.dynamic){if(Array.isArray(o))l.push({id:a.name,name:a.name,label:n(a.name),type:a.type,children:o.map(((e,t)=>{var i;const s=D(a.name,e);return{id:`${a.name}_${t}`,name:a.name,type:a.type,index:t,label:null!==(i=e.name)&&void 0!==i?i:e.id,url:e.url,setting:s}})).filter((e=>b(e,t,i,s)))});else if(o){const e=D(a.name,o);l.push({id:a.name,name:a.name,label:n(a.name),type:a.type,url:o.url,setting:e})}}else if(o){const e=D(a.name,o);l.push({id:a.name,name:a.name,label:n(a.name),type:a.type,url:o.url,setting:e})}})),l.filter((e=>e.children?e.children.length>0:b(e,t,i,s)))}(y,c,o,r,j))}),[y,c,o,r,j]),e.hooks.useEffectOnce((()=>{const t=function(t,i){const s=i.map((t=>e.UtilityManager.getInstance().getUtilityJson(t.utilityId))).filter((e=>{if("org"===(null==e?void 0:e.source)){const{name:i,url:s,index:n,taskName:l}=e;return!function(e,t,i,s,n){var l;if(s>=0){const s=e[t];return!!Array.isArray(s)&&s.some((e=>(e.name===n||e.id===n)&&e.url===i))}return(null===(l=e[t])||void 0===l?void 0:l.url)===i}(t,i,s,n,l)}return!1}));return s}(y,null!=u?u:(0,e.Immutable)([]));x(t)}));const w=e.hooks.useEventCallback((e=>{const{children:t}=e;return null!=t?t:[]})),O=e.hooks.useEventCallback((e=>e.label)),S=e.hooks.useEventCallback((e=>"root"!==e.id&&!e.children)),N=e.hooks.useEventCallback(((t,i,s=!1)=>(0,e.jsx)("div",{className:"w-100 d-flex align-items-center",css:e.css`
          height: 1.625rem;
          line-height: 1.625rem;
          background-color: ${s?"var(--light-500)":"transparent"};
          color: var(--dark-800);
        `},(0,e.jsx)("div",{className:"d-flex flex-shrink-0 justify-content-center align-items-center h-100",css:e.css`width: 1.625rem; background-color: var(--info-400);`},(null==i?void 0:i.children)||"root"===(null==i?void 0:i.id)?(0,e.jsx)(p,{color:"var(--black)",className:"mr-0"}):(0,e.jsx)(V,{type:null==i?void 0:i.type,color:"var(--black)",className:"mr-0"})),(0,e.jsx)("div",{className:"text-truncate px-1"},t)))),k=e.React.useCallback((t=>{const{label:i,index:s,name:n,url:l}=t;let a=-1;return null==u||u.some(((t,o)=>{const r=e.UtilityManager.getInstance().getUtilityJson(t.utilityId);if("org"===(null==r?void 0:r.source))if(s>=0){if(r.index>=0&&r.name===n&&r.taskName===i)return a=o,!0}else if(r.name===n&&r.url===l)return a=o,!0;return!1})),a}),[u]),I=e.React.useCallback((i=>{if("function"==typeof d){const s=k(i),n=e.UtilityManager.getInstance().getIdOfOrgUtility(i.name,i.url,i.index,i.label),l=null!=u?u:(0,e.Immutable)([]);if(s>=0){if(m&&(d(l.filter(((e,t)=>t!==s))),!e.UtilityManager.getInstance().isUtilityUsed(n))){const e=(0,t.getAppConfigAction)(),i=e.appConfig.utilities.without(n);e.updateUtilities(i).exec()}}else if(null!=n)d(m?e.Immutable.set(l,l.length,{utilityId:n}):(0,e.Immutable)([{utilityId:n}]));else{const s=(0,t.getAppConfigAction)(),n=s.appConfig,a=e.appConfigUtils.getUniqueId(n,"utility"),o={id:a,type:i.type,name:i.name,label:i.label,url:i.url,source:"org"};i.setting&&(o.orgSetting=i.setting),i.index>=0&&(o.taskName=i.label,o.index=i.index),s.addUtility(o).exec(),d(m?e.Immutable.set(l,l.length,{utilityId:a}):(0,e.Immutable)([{utilityId:a}]))}}}),[k,u,m,d]),R=e.React.useCallback((t=>{const i=k(t)>=0;return(0,e.jsx)(s.Button,{type:"tertiary",className:(0,e.classNames)("utility-item jimu-outline-inside text-left w-100",{"utility-item-selected":i}),"aria-checked":i,"aria-label":t.label,title:t.label,onClick:()=>{I(t)}},N(t.label,t,!0),i&&(0,e.jsx)("div",{className:"item-active-icon"},(0,e.jsx)("div",{className:"text-center"})))}),[k,N,I]);return(0,e.jsx)("div",{className:"utility-tree w-100 my-4",css:_},(null==h?void 0:h.length)>0&&(0,e.jsx)("div",{className:"p-2 mb-2"},(0,e.jsx)("div",{className:"d-flex mb-2 justify-content-between align-items-center"},(0,e.jsx)("span",{className:"font-13"},"Expired"),(0,e.jsx)(s.Tooltip,{title:j("orgUtilityNotAvailable")},(0,e.jsx)(s.Button,{type:"tertiary",size:"sm",icon:!0},(0,e.jsx)(v,{size:"s"})))),h.map((t=>{var i,n,l,a,o,r;const c=null==u?void 0:u.some((e=>e.utilityId===t.id));return(0,e.jsx)("div",{className:"w-100",key:t.id},(0,e.jsx)(s.Button,{type:"tertiary",className:(0,e.classNames)("utility-item-not-matched jimu-outline-inside text-left p-0 w-100",{"utility-item-selected":c}),"aria-checked":c,"aria-label":null!==(n=null!==(i=t.taskName)&&void 0!==i?i:t.label)&&void 0!==n?n:t.name,title:null!==(a=null!==(l=t.taskName)&&void 0!==l?l:t.label)&&void 0!==a?a:t.name,onClick:()=>{I({name:t.name,url:t.url,index:t.index,label:t.taskName})}},N(null!==(r=null!==(o=t.taskName)&&void 0!==o?o:t.label)&&void 0!==r?r:t.name,{type:t.type},!0),c&&(0,e.jsx)("div",{className:"item-active-icon"},(0,e.jsx)("div",{className:"icon-container"}))))}))),g.map((t=>(0,e.jsx)("div",{key:t.id},(0,e.jsx)(l.DataSourceTree,{className:"org-tree",dataSource:t,getChildDataSources:w,getLabel:O,isNodeSelectable:S,renderSelectableNode:R,renderUnselectableNode:(e,t)=>N(e,t),defaultOpen:!0})))))}var F=function(e,t,i,s){return new(i||(i=Promise))((function(n,l){function a(e){try{r(s.next(e))}catch(e){l(e)}}function o(e){try{r(s.throw(e))}catch(e){l(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}r((s=s.apply(e,t||[])).next())}))};const q=e.css`
  .utility-item.utility-item-selected {
    outline: 1px solid var(--primary-700);
    position: relative;
    .item-active-icon {
      position: absolute;
      top: -1px;
      right: -1px;
      & > div {
        width: 0;
        height: 0;
        border-top: 0.75rem var(--primary-700) solid;
        border-left: 0.75rem transparent solid;
        background-color: transparent;
      }
    }
  }
  .tree-root {
    padding: 0.5rem 0;
  }
`;function K(t){const{keyword:i,pattern:n,serviceTypes:a,utilities:o,useUtilities:r,isMultiple:c,onUtilitiesChange:u,className:m}=t,[d,v]=e.React.useState([]),y=e.hooks.useCancelablePromiseMaker();e.React.useEffect((()=>{y(function(t,i,s,n){var l,a;return F(this,void 0,void 0,(function*(){const o=[],r=Object.keys(null!=t?t:{}),c=(0,e.getAppStore)().getState().appStateInBuilder.appRuntimeInfo,u=null!==(l=c.utilityStates)&&void 0!==l?l:{};for(let l=0;l<r.length;l++){const c=t[r[l]];if("org"===c.source||r[l]in u&&!1===u[r[l]].success)continue;const p=yield e.UtilityManager.getInstance().getUtility(c.id);let m;m=c.portalUrl&&c.itemId?{id:c.id,label:null!==(a=c.label)&&void 0!==a?a:c.sourceLabel,type:c.type,url:p.itemInfo.url}:{id:c.id,label:c.label,type:c.type,url:c.url},p.tasks&&(m.children=p.tasks.filter((e=>e.visible||null==e.visible)).map(((t,i)=>{var s;return{rootId:c.id,id:`${c.id}_${i}`,task:t.name,type:t.isPrintingTask?e.SupportedUtilityType.Printing:e.SupportedUtilityType.GPTask,label:null!==(s=t.label)&&void 0!==s?s:t.name,url:`${m.url}/${t.name}`}})).filter((e=>b(e,i,s,n)))),o.push(m)}return o.filter((e=>e.children?e.children.length>0:b(e,i,s,n)))}))}(o,a,i,n)).then((e=>{v(e)}))}),[o,y,a,i,n]);const g=e.hooks.useEventCallback((e=>{const{children:t}=e;return null!=t?t:[]})),f=e.hooks.useEventCallback((e=>e.label)),h=e.hooks.useEventCallback((e=>"root"!==e.id&&!e.children)),x=e.hooks.useEventCallback(((t,i,s=!1)=>(0,e.jsx)("div",{className:"w-100 d-flex align-items-center",css:e.css`
          height: 1.625rem;
          line-height: 1.625rem;
          background-color: ${s?"var(--light-500)":"transparent"};
          color: var(--dark-800);
        `},(0,e.jsx)("div",{className:"d-flex flex-shrink-0 justify-content-center align-items-center h-100",css:e.css`width: 1.625rem; background-color: var(--info-400);`},(null==i?void 0:i.children)||"root"===i.id?(0,e.jsx)(p,{color:"var(--black)",className:"mr-0"}):(0,e.jsx)(V,{type:null==i?void 0:i.type,color:"var(--black)",className:"mr-0"})),(0,e.jsx)("div",{className:"text-truncate px-1"},t)))),j=e.React.useCallback((e=>{const{id:t,rootId:i,task:s}=e;let n=-1;return null==r||r.some(((e,l)=>(e.utilityId===t||e.utilityId===i&&e.task===s)&&(n=l,!0))),n}),[r]),w=e.React.useCallback((t=>{var i,s;if("function"==typeof u){const n=j(t),l=null!=r?r:(0,e.Immutable)([]);n>=0?c&&u(l.filter(((e,t)=>t!==n))):u(c?e.Immutable.set(l,l.length,{utilityId:null!==(i=t.rootId)&&void 0!==i?i:t.id,task:t.task}):(0,e.Immutable)([{utilityId:null!==(s=t.rootId)&&void 0!==s?s:t.id,task:t.task}]))}}),[j,r,c,u]),O=e.React.useCallback((t=>{const i=j(t)>=0;return(0,e.jsx)(s.Button,{type:"tertiary",className:(0,e.classNames)("utility-item jimu-outline-inside text-left w-100",{"utility-item-selected":i}),"aria-checked":i,"aria-label":t.label,title:t.label,onClick:()=>{w(t)}},x(t.label,t,!0),i&&(0,e.jsx)("div",{className:"item-active-icon"},(0,e.jsx)("div",{className:"text-center"})))}),[j,x,w]);return(0,e.jsx)("div",{className:(0,e.classNames)("utility-tree w-100",m,{"my-4":!(null==m?void 0:m.includes("my-"))}),css:q},d.map((t=>(0,e.jsx)("div",{key:t.id},(0,e.jsx)(l.DataSourceTree,{className:"added-tree",dataSource:t,getChildDataSources:g,getLabel:f,isNodeSelectable:h,renderSelectableNode:O,renderUnselectableNode:(e,t)=>x(e,t),defaultOpen:!0})))))}var Q=c(20878),W=c(96009),X=c.n(W);const Y=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:X()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var Z=c(59788),ee=c.n(Z);const te=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:ee()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var ie=c(55339),se=c.n(ie);const ne=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:se()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var le=c(80272),ae=c.n(le);const oe=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:ae()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var re=c(59455),ce=c.n(re);const ue=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:ce()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var pe=c(15467),me=c.n(pe);const de=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:me()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var ve=c(79775),ye=c.n(ve);const ge=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:ye()},n)):e.React.createElement("svg",Object.assign({className:l},n))},fe=e.css`
  border-left: 1px solid var(--light-800);
  border-bottom: 1px solid var(--light-800);
  width: 1.5rem;
  height: 2.1rem;
  position: absolute;
  top: -16px;
  left: 8px;
`;function be(t){var i,n;const{utility:l,onRemove:a,onChange:o}=t,[r,c]=e.React.useState(!1),[u,m]=e.React.useState(null),[d,v]=e.React.useState(!1),y=e.hooks.useTranslation();e.hooks.useEffectOnce((()=>{e.UtilityManager.getInstance().getUtilityFromJson(l).then((e=>{var t;(null===(t=e.tasks)||void 0===t?void 0:t.length)>0&&m(e.tasks)})).finally((()=>{v(!0)}))}));const g=e.React.useCallback((()=>{c(!r)}),[r]),f=e.React.useCallback((()=>{a(l)}),[a,l]),b=e.React.useCallback((e=>{const t=[];u.forEach((i=>{i.name===e.name?t.push(Object.assign(Object.assign({},i),{visible:null!=i.visible&&!i.visible})):t.push(i)})),m(t);const i=l.set("tasks",t);o(i)}),[u,l,o]);return d?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("div",{className:"w-100 d-flex align-items-center mb-2 pl-4",css:e.css`
          height: 1.625rem;
          line-height: 1.625rem;
          background-color: var(--light-500);
          color: var(--dark-800);
          position: relative;
        `},(0,e.jsx)("div",{className:"d-flex flex-shrink-0 justify-content-center align-items-center h-100"},(null==u?void 0:u.length)>0&&(0,e.jsx)(s.Button,{className:"px-0",type:"tertiary",icon:!0,size:"sm",onClick:g,css:e.css`
                position: absolute;
                left: 0;
              `},r?(0,e.jsx)(ue,{size:"s"}):(0,e.jsx)(oe,{size:"s"})),(0,e.jsx)("div",{className:"utility-icon-container"},(null==u?void 0:u.length)>0?(0,e.jsx)(p,{color:"var(--black)"}):(0,e.jsx)(O,{color:"var(--black)"}))),(0,e.jsx)("div",{className:"text-truncate px-2",title:null!==(i=l.label)&&void 0!==i?i:l.sourceLabel},null!==(n=l.label)&&void 0!==n?n:l.sourceLabel),(0,e.jsx)(s.Button,{className:"ml-auto",type:"tertiary",icon:!0,size:"sm",onClick:f},(0,e.jsx)(ne,null))),(null==u?void 0:u.length)>0&&(0,e.jsx)(s.Collapse,{isOpen:r},u.map((t=>(0,e.jsx)("div",{key:t.name,className:"d-flex align-items-center mb-2",css:e.css`padding-left: 2rem; position: relative;`},(0,e.jsx)("div",{className:"utility-icon-container mr-2"},(0,e.jsx)(O,{color:"var(--black)"})),(0,e.jsx)("div",{className:"text-truncate",title:t.name},t.name),(0,e.jsx)(s.Button,{type:"tertiary",title:null==t.visible||t.visible?y("invisible"):y("visible"),"aria-label":null==t.visible||t.visible?y("invisible"):y("visible"),className:"p-0 ml-auto utility-tasks align-items-center",onClick:()=>{b(t)}},null==t.visible||t.visible?(0,e.jsx)(de,null):(0,e.jsx)(ge,null)),(0,e.jsx)("div",{className:"collapse-line",css:fe})))))):(0,e.jsx)("div",{className:"loading-container"},(0,e.jsx)(s.Loading,{type:s.LoadingType.Bar}))}const he=e.css`
  max-height: 300px;
  background-color: var(--light-500);

  .item-list {
    max-height: 180px;
    overflow: auto;
  }

  .utility-icon-container {
    display: flex;
    flex-shrink: 0;
    justify-content: center;
    align-items: center;
    background-color: var(--info-400);
    width: 1.625rem;
    height: 1.625rem;
    margin-right: 8px;
    svg {
      margin-right: 0 !important;
    }
  }
`;function xe(t){const{utilities:i,onDoneClick:n,onChange:l}=t,a=e.hooks.useTranslation(s.defaultMessages),[o,r]=e.React.useState(!1),c=e.React.useCallback((()=>{r(!o)}),[o]),u=e.React.useCallback((e=>{l(i.filter((t=>t.id!==e.id)))}),[l,i]),p=e.React.useCallback((t=>{const s=i.findIndex((e=>e.id===t.id));l(e.Immutable.set(i,s,t))}),[l,i]);return i?(0,e.jsx)("div",{className:"w-100 p-4 shadow-lg",css:he},(0,e.jsx)("div",{className:"new_utility_header d-flex align-items-center"},(0,e.jsx)("div",{className:"font-13"},(0,e.jsx)("span",null,i.length),(0,e.jsx)("span",{className:"ml-1"},a("selected"))),(0,e.jsx)(s.Button,{className:"ml-2",type:"tertiary",icon:!0,size:"sm",onClick:c},o?(0,e.jsx)(Y,null):(0,e.jsx)(te,null)),!o&&(0,e.jsx)(s.Button,{className:"ml-auto",type:"primary","aria-label":a("done"),onClick:n},a("done"))),(0,e.jsx)(s.Collapse,{isOpen:o},(0,e.jsx)("div",{className:"my-4 item-list"},i.map(((t,i)=>(0,e.jsx)(be,{key:i,utility:t,onChange:p,onRemove:u}))))),o&&(0,e.jsx)(s.Button,{className:"w-100",type:"primary","aria-label":a("done"),onClick:n},a("done"))):null}var je=function(e,t,i,s){return new(i||(i=Promise))((function(n,l){function a(e){try{r(s.next(e))}catch(e){l(e)}}function o(e){try{r(s.throw(e))}catch(e){l(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}r((s=s.apply(e,t||[])).next())}))};const we=(0,e.Immutable)([e.SupportedItemTypes.GeocodingService,e.SupportedItemTypes.GeometryService,e.SupportedItemTypes.GeoprocessingService,e.SupportedItemTypes.NetworkAnalysisService]);function Oe(){var t;const i=(0,e.getAppStore)().getState();let s;return s=window.jimuConfig.isBuilder?null===(t=i.appStateInBuilder)||void 0===t?void 0:t.appConfig:i.appConfig,e.appConfigUtils.getUniqueId(s,"utility")}const Se=new Map,Ne=new Map,ke=(0,e.Immutable)({});function Ie(t){const{utilities:i=ke,onChange:n,batchUtilityJsons:l,onBatchUpdate:a,onBatchDone:o,isMultiple:r=!0,immediate:c=!0}=t,[u,p]=e.React.useState(""),[m,d]=e.React.useState(!1),[v,y]=e.React.useState({show:!1,msg:null}),[g,b]=e.React.useState(!1),j=e.hooks.useTranslation(s.defaultMessages),w=e.ReactRedux.useSelector((e=>e.portalUrl)),O=e.React.useMemo((()=>{const t=[];return Object.keys(i).forEach((e=>{const s=i[e];s.portalUrl&&t.push(s.itemId)})),null==l||l.forEach((e=>{e.portalUrl&&t.push(e.itemId)})),(0,e.Immutable)(t)}),[i,l]),S=e.hooks.useEventCallback((t=>/^https:\/\//.test(t)&&h(t)?e.UtilityManager.getInstance().urlExist(t)?(d(!1),{valid:!1,msg:j("duplicatedService")}):(d(!0),{valid:!0}):(d(!1),{valid:!1,msg:j("serviceNotSupported")}))),N=e.hooks.useEventCallback((e=>{p(e.value)})),k=e.React.useCallback((t=>je(this,void 0,void 0,(function*(){let i=Ne.get(t.id),s=!1;return i||(i=yield e.UtilityManager.getInstance().getUrlOfItem(t.portalUrl,t.id),i&&Ne.set(t.id,i)),i&&(Se.has(i)?Se.get(i).valid&&(s=!0):s=h(i)),s?(y({show:!1,msg:null}),!0):(y({show:!0,msg:j("serviceNotSupported")}),setTimeout((()=>{y({show:!1,msg:null})}),3e3),!1)}))),[j]),I=e.React.useCallback(((t,s)=>je(this,void 0,void 0,(function*(){var t;const o=Ne.get(s.id);if(o&&!Se.has(o))try{const{type:e,info:t}=yield x(o);if(null==e)throw Se.set(o,{valid:!1}),new Error(`service not supported ${o}`);Se.set(o,{valid:!0,type:e,info:t}),y({show:!1,msg:null})}catch(e){return y({show:!0,msg:j("invalidResourceItem")}),void setTimeout((()=>{y({show:!1,msg:null})}),3e3)}if(o&&(null===(t=Se.get(o))||void 0===t?void 0:t.valid)){const{type:t,info:r}=Se.get(o),u={id:Oe(),sourceLabel:s.title,type:t,source:"custom",itemId:s.id,portalUrl:s.portalUrl,url:o};if(t===e.SupportedUtilityType.GPServer&&(u.tasks=null==r?void 0:r.tasks),c){const e=i.set(u.id,u);n(e)}else u.id=`${Date.now()}`,a(e.Immutable.set(l,l.length,u))}}))),[n,a,l,i,c,j]),R=e.React.useCallback(((e,t)=>{if(c){const e=Object.keys(i).find((e=>i[e].itemId===t.id&&i[e].portalUrl===t.portalUrl)),s=i.without(e);n(s)}else a(l.filter((e=>e.itemId!==t.id)))}),[n,a,i,l,c]),C=e.React.useCallback((()=>je(this,void 0,void 0,(function*(){var t,s,o;const r=e.UtilityManager.getInstance().urlExist(u);if(!Se.has(u)){b(!0);try{const{type:e,info:t}=yield x(u);if(null==e)throw Se.set(u,{valid:!1}),new Error(`service not supported ${u}`);Se.set(u,{valid:!0,type:e,info:t})}catch(e){return y({show:!0,msg:j("invalidResourceItem")}),void setTimeout((()=>{y({show:!1,msg:null})}),3e3)}finally{b(!1)}}const m=Se.get(u);if(!r&&(null==m?void 0:m.valid)){const r={id:Oe(),type:m.type,source:"custom",url:u,label:null!==(s=null===(t=m.info)||void 0===t?void 0:t.displayName)&&void 0!==s?s:f(u)};if(m.type===e.SupportedUtilityType.GPServer&&(r.tasks=null===(o=m.info)||void 0===o?void 0:o.tasks),c){const e=i.set(r.id,r);n(e)}else r.id=`${Date.now()}`,a(e.Immutable.set(l,l.length,r));p(""),d(!1)}}))),[n,a,i,l,c,u,j]);return(0,e.jsx)("div",{className:"w-100 h-100",css:e.css`position: relative;`},(0,e.jsx)(s.Tabs,{css:e.css`
          height: ${c?"100%":"calc(100% - 64px)"};
          overflow: hidden;
          .tab-content {
            max-height: calc(100% - 2rem);
          }
        `,type:"underline",fill:!0},(0,e.jsx)(s.Tab,{id:"layers",title:j("url")},(0,e.jsx)("div",{className:"w-100 pt-4 px-4",css:e.css`
              position: relative;
            `},(0,e.jsx)(s.UrlInput,{schemes:["https"],height:80,value:u,placeholder:j("websitePlaceholder"),checkValidityOnChange:S,onChange:N})),(0,e.jsx)("div",{className:"d-flex px-4 pt-4 flex-column align-items-end"},(0,e.jsx)(s.Button,{className:"w-100",type:"primary",disabled:!m||g,onClick:C,css:e.css`position: relative;min-height:2rem;`},g?(0,e.jsx)(s.Loading,{type:s.LoadingType.DotsSecondary}):j("add"))),(0,e.jsx)("div",{className:"d-flex px-4 pt-2 flex-column"},(0,e.jsx)("div",{css:e.css`
              color: var(--dark-400);
              font-weight: 400;
              font-size: 13px;
              line-height: 18px;
            `},j("supportedServices")))),(0,e.jsx)(s.Tab,{id:"widgets",title:j("items")},(0,e.jsx)(Q.ItemSelector,{mode:Q.ItemSelectorMode.Simple,itemType:we,portalUrl:w,isMultiple:r,isSelectable:k,onSelect:I,onRemove:R,selectedItems:O,disableRemoveItemsSelectedOnMount:!0}))),(0,e.jsx)("div",{css:e.css`
        position: absolute;
        bottom: 0;
        width: 100%;
      `},v.show&&(0,e.jsx)(s.Alert,{closable:!0,form:"basic",onClose:()=>{y({show:!1,msg:null})},open:!0,text:v.msg,type:"warning",withIcon:!0,className:"w-100"}),(0,e.jsx)(xe,{utilities:l,onChange:a,onDoneClick:o})))}var Re=c(30224),Ce=c.n(Re);const Ue=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:Ce()},n)):e.React.createElement("svg",Object.assign({className:l},n))};var Te=c(79964),Ee=c.n(Te),Pe=c(41074),Me=c.n(Pe);const Ae=t=>{const i=window.SVG,{className:s}=t,n=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:l,src:Me()},n)):e.React.createElement("svg",Object.assign({className:l},n))},Ge={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:i.TreeItemActionType.RenderOverrideItem,children:[{name:i.TreeItemActionType.RenderOverrideItemBody,children:[{name:i.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:i.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:i.TreeItemActionType.RenderOverrideItemTitle},{name:i.TreeItemActionType.RenderOverrideItemCommands}]}]}]})},Be={[e.SupportedUtilityType.GeoCoding]:"geocodingService",[e.SupportedUtilityType.GeoEnrichment]:"geoenrichmentService",[e.SupportedUtilityType.Geometry]:"geometryService",[e.SupportedUtilityType.Printing]:"printingService",[e.SupportedUtilityType.Routing]:"routingService",[e.SupportedUtilityType.GPServer]:"geoprocessingService",[e.SupportedUtilityType.GPTask]:"geoprocessingTask"},Le=Object.keys(Be);function ze(l){const{useUtilities:a,onChange:o,pattern:r,types:c=Le,isMultiple:u=!1,showRemove:p=!0,showOrgUtility:m=!0,closePopupOnSelect:d=!0}=l,v=e.hooks.useTranslation(s.defaultMessages),y=e.ReactRedux.useSelector((e=>{var t,i,s;return window.jimuConfig.isBuilder?null===(i=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.utilities:null===(s=e.appConfig)||void 0===s?void 0:s.utilities})),g=e.ReactRedux.useSelector((e=>{var t,i,s;return window.jimuConfig.isBuilder?null===(i=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo)||void 0===i?void 0:i.utilityStates:null===(s=e.appRuntimeInfo)||void 0===s?void 0:s.utilityStates})),f=e.React.useRef(y),b=e.React.useRef(c),[h,x]=e.React.useState(!1),[j,w]=e.React.useState(0),[O,S]=e.React.useState(c),[N,k]=e.React.useState(""),[I,R]=e.React.useState((0,e.Immutable)([])),C=e.React.useRef(),U=e.React.useRef(),T=e.React.useCallback((()=>c.map((t=>({value:t,label:v(Be[t]),render:(i,n)=>(0,e.jsx)(s.Label,{className:"d-flex w-100 h-100 align-items-center mb-0"},(0,e.jsx)(s.Checkbox,{checked:n.includes(t)}),(0,e.jsx)("span",{className:"ml-2"},v(Be[t])))})))),[v,c]),E=e.React.useCallback(((e,t,i)=>{S(i)}),[]);e.React.useEffect((()=>{if(y!==f.current&&(f.current=y,(null==a?void 0:a.length)>0)){const t=[];a.forEach((e=>{y[e.utilityId]&&t.push(e)})),a.length!==t.length&&o((0,e.Immutable)(t))}}),[y,a,o]),e.React.useEffect((()=>{let e=!1;e=c.length!==b.current.length||c.some((e=>!b.current.includes(e))),e&&(b.current=c,S(c))}),[c]);const P=e.React.useCallback((()=>{x(!h)}),[h]),M=e.hooks.useEventCallback((()=>{w(1)})),A=e.hooks.useEventCallback((()=>{w(0)})),G=e.React.useCallback((e=>{o(e),!u&&d&&x(!1)}),[o,u,d]),B=e.hooks.useEventCallback((e=>{(0,t.getAppConfigAction)().updateUtilities(e).exec()})),L=e.hooks.useEventCallback((e=>{R(e)})),z=e.React.useCallback((()=>{const i=(0,t.getAppConfigAction)(),s=e.UtilityManager.getInstance();let n=i.appConfig;I.forEach((t=>{if(!t.itemId&&!s.urlExist(t.url)||t.itemId&&!s.itemExist(t.portalUrl,t.itemId)){const i=t.set("id",e.appConfigUtils.getUniqueId(n,"utility"));n=n.setIn(["utilities",i.id],i)}})),i.updateUtilities(n.utilities).exec(),R((0,e.Immutable)([])),A()}),[I,A]),V=e.hooks.useEventCallback((e=>{k(e.target.value)})),$=e.React.useCallback((e=>{o(a.filter(((t,i)=>i!==e)))}),[a,o]);return(0,e.jsx)("div",{className:"px- pb-2 w-100",ref:C,css:e.css`
      .jimu-tree-item__icon {
        background-color: var(--info-400);
        width: 18px;
        height: 18px;
        margin-right: 8px;
        svg {
          margin-right: 0 !important;
        }
      }
    `},(null==a?void 0:a.length)>0&&(0,e.jsx)(i.List,Object.assign({className:"utility-list mb-2",itemsJson:a.map(((t,i)=>{var s,n;const l=e.UtilityManager.getInstance().getUtilityJson(t.utilityId),a=[];return null===(n=null===(s=null==g?void 0:g[t.utilityId])||void 0===s?void 0:s.success)||void 0===n||n||a.push({label:v("utilityNotAvailable"),iconProps:()=>({icon:Ee(),size:16,color:"var(--warning-700)"})}),(u||p)&&a.push({label:v("remove"),iconProps:()=>({icon:se(),size:12}),action:({data:e})=>{const{itemJsons:[t]}=e;$(+t.itemKey)}}),{itemStateDetailContent:t,itemKey:`${i}`,itemStateIcon:{icon:H(l.type),color:"var(--black)"},itemStateTitle:null!=l?e.UtilityManager.getInstance().getLabelOfUseUtility(t):t.utilityId,itemStateCommands:a}})),onClickItemBody:P},Ge)),(u||null==a||0===a.length)&&(0,e.jsx)(s.Button,{className:"w-100",type:"tertiary",onClick:P,css:e.css`
            border: 1px dashed var(--dark-100);
            &, &:hover { color: var(--primary-700); }
            &:hover { border: 1px dashed var(--dark-400); }
          `,ref:U},v("selectUtility")),(0,e.jsx)(n.SidePopper,{title:v("selectUtility"),position:"right",isOpen:h&&0===j,toggle:P,trigger:C.current,backToFocusNode:U.current},(0,e.jsx)("div",{className:"h-100 d-flex flex-column"},(0,e.jsx)("div",{className:"px-4 pb-2",css:e.css`height: 50px;`},(0,e.jsx)(s.TextInput,{type:"search",prefix:(0,e.jsx)(Ue,{size:"s"}),value:N,onChange:V,placeholder:v("SearchLabel")})),c!==Le&&c.length>1&&(0,e.jsx)("div",{className:"d-flex justify-content-between align-items-center px-4 mb-4"},(0,e.jsx)("span",null,v("type")),(0,e.jsx)(s.MultiSelect,{"aria-label":v("type"),size:"sm",css:e.css`width: 120px; .jimu-dropdown { width: 100%; }`,values:(0,e.Immutable)(O),items:T(),onClickItem:E,displayByValues:e=>v("numSelected",{number:e.length})})),(0,e.jsx)("div",{className:"d-flex flex-column",css:e.css`flex: 1 1 auto; .tab-content {overflow: auto;}`},(0,e.jsx)("div",{css:e.css`flex: 1 1 0; overflow: auto;`},m&&(0,e.jsx)(s.Tabs,{className:"px-4",type:"pills",fill:!0},(0,e.jsx)(s.Tab,{id:"org_utility",title:v("organization")},(0,e.jsx)(J,{isMultiple:u,keyword:N.trim(),pattern:r,serviceTypes:O,useUtilities:a,onChange:G})),(0,e.jsx)(s.Tab,{id:"added_utility",title:v("added")},(0,e.jsx)(K,{isMultiple:u,keyword:N.trim(),pattern:r,serviceTypes:O,utilities:y,useUtilities:a,onUtilitiesChange:G}))),!m&&(0,e.jsx)(K,{isMultiple:u,keyword:N.trim(),pattern:r,serviceTypes:O,utilities:y,useUtilities:a,onUtilitiesChange:G,className:"px-4 my-0"})),(0,e.jsx)("div",{css:e.css`height: 40px;border-top: 1px solid var(--light-800);`},(0,e.jsx)(s.Button,{className:"w-100 h-100",type:"tertiary","aria-label":v("add"),onClick:M},(0,e.jsx)("div",{className:"d-flex align-items-center px-2"},(0,e.jsx)(Ae,{size:"l",color:"var(--primary-700)"}),(0,e.jsx)("span",{css:e.css`color: var(--primary-700)`},v("addUtility")))))))),(0,e.jsx)(n.SidePopper,{title:v("addUtility"),position:"right",isOpen:h&&1===j,toggle:A,trigger:C.current},(0,e.jsx)("div",{className:"h-100",css:e.css`position: relative;`},(0,e.jsx)("div",{css:e.css`height: 100%; .tab-content {overflow: auto;}`},(0,e.jsx)(Ie,{utilities:y,batchUtilityJsons:I,isMultiple:!0,immediate:!1,onBatchUpdate:L,onBatchDone:z,onChange:B})))))}})(),u})())}}}));