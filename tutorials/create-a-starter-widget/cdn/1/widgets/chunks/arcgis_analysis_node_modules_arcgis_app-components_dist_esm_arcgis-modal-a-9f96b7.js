/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-modal-a-9f96b7.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-modal-a-9f96b7"],{16716:(t,e,i)=>{i.r(e),i.d(e,{arcgis_modal_arcade:()=>n});var s=i(35110),a=i(21104),r=i(1984);i(73838),i(63280),i(86587);const n=class{constructor(t){(0,s.r)(this,t),this.arcgisModalArcadeClose=(0,s.c)(this,"arcgisModalArcadeClose",7),this.hideDocumentationActions=!1,this.arcadeScript=void 0,this.arcadeProfile=void 0,this.testData=void 0,this.suggestions=void 0,this.returnPredictOutputType=!0,this.arcadeTitle=void 0,this.arcadeTitleEditable=!1,this.arcadeTitleEditingEnabled=!1,this.addExistingExpressions=!1,this.layer=void 0,this.scriptInvalid=!0}async componentWillLoad(){var t;if([this.strings,this.currentLanguage]=await(0,r.g)(this.hostElement),await this.loadAllModules(),this.addExistingExpressions&&this.layer){const e=this.getExistingExpressions();e&&((null===(t=this.suggestions)||void 0===t?void 0:t.length)?this.suggestions.push(e):this.suggestions=[e])}}async loadAllModules(){[this.arcade,this.arcadeUtils]=await(0,a.l)(["esri/arcade","esri/layers/support/arcadeUtils"])}async getOutputType(){try{const t=await this.arcadeEditor.getTestResult();switch(null==t?void 0:t.type){case"boolean":case"date":case"time":case"dateOnly":case"dictionary":case"number":return t.type;case"text":return"string";default:return null}}catch(t){return null}}getExistingExpressions(){if("subtype-sublayer"===this.layer.type)return{label:this.strings.existing,suggestions:[]};const t=this.arcadeUtils.getExpressionsFromLayer(this.layer).map((t=>{var e;return{label:(null==t?void 0:t.title)||(null==t?void 0:t.name)||this.strings.newExpression,description:this.getStringFromProfileName(null===(e=t.profileInfo)||void 0===e?void 0:e.name),code:t.expression}}));return{label:this.strings.existing,suggestions:(null==t?void 0:t.length)?t:[]}}getStringFromProfileName(t){switch(t){case"form-constraint":return this.strings.constraint;case"feature-z":return this.strings.featureZ;case"form-calculation":return this.strings.formCalculation;case"labeling":return this.strings.labeling;case"popup":return this.strings.popup;case"popup-element":return this.strings.popupElement;case"feature-reduction-popup":return this.strings.featureReductionPopup;case"feature-reduction-popup-element":return this.strings.featureReductionPopupElement;case"visualization":return this.strings.visualization;case"field-calculation":return this.strings.fieldCalculation;default:return this.strings.unknown}}render(){return(0,s.h)(s.H,null,(0,s.h)("calcite-modal",{class:"arcade-modal",open:!0,scale:"l",escapeDisabled:!0,outsideCloseDisabled:!0,role:"dialog",onCalciteModalClose:()=>this.arcgisModalArcadeClose.emit()},(0,s.h)("h3",{slot:"header",class:"header"},this.arcadeTitle&&this.arcadeTitleEditable?(0,s.h)("calcite-inline-editable",{scale:"l",editingEnabled:this.arcadeTitleEditingEnabled,messageOverrides:{cancelEditing:this.strings.cancel,enableEditing:this.strings.edit,confirmChanges:this.strings.done}},(0,s.h)("calcite-input",{ref:t=>this.arcadeTitleInput=t,alignment:"start",placeholder:this.strings.titlePlaceHolder,scale:"l",type:"text",value:this.arcadeTitle||this.strings.newExpression})):this.arcadeTitle||this.strings.newExpression),(0,s.h)("arcgis-arcade-editor",{slot:"content",class:"arcade-editor",ref:t=>this.arcadeEditor=t,hideDocumentationActions:this.hideDocumentationActions,script:this.arcadeScript,profile:this.arcadeProfile,testData:this.testData,suggestions:this.suggestions,onDiagnosticsChange:async t=>{var e;const i=t.detail;if(null==i?void 0:i.length){for(let t=0;t<i.length;t++)if(1===(null===(e=i[t])||void 0===e?void 0:e.severity))return void(this.scriptInvalid=!0);this.scriptInvalid=!1}else this.scriptInvalid=!1}}),(0,s.h)("calcite-button",{slot:"secondary",width:"full",appearance:"outline-fill",alignment:"center",scale:"m",onClick:()=>this.arcgisModalArcadeClose.emit()},this.strings.cancel),(0,s.h)("calcite-button",{slot:"primary",width:"full",alignment:"center",appearance:"solid",scale:"m",disabled:this.scriptInvalid,onClick:async()=>{var t;this.arcgisModalArcadeClose.emit(Object.assign(Object.assign({script:await this.arcadeEditor.getScript()},this.arcadeTitle&&{title:(null===(t=this.arcadeTitleInput.value)||void 0===t?void 0:t.trim())||this.strings.newExpression}),this.returnPredictOutputType&&{predictOutputType:await this.getOutputType()}))}},this.strings.done)))}get hostElement(){return(0,s.d)(this)}};n.style=".arcade-modal.sc-arcgis-modal-arcade{top:7.5%;left:7.5%;right:7.5%;--calcite-modal-width:85%;--calcite-modal-height:85%}.arcade-editor.sc-arcgis-modal-arcade{width:100%;height:100%}.header.sc-arcgis-modal-arcade{width:50%}"}}]);