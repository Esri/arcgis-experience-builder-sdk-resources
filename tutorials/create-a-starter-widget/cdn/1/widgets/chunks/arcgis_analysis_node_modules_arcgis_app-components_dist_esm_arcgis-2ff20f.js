/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f"],{56631:(e,t,i)=>{i.d(t,{a:()=>s});var n=i(66913),a=i(9316),l=i(52299);async function s(e){var t;const i=(0,a.g)(e),s=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,n.r)(s,i,{},"post"),{status:a,recordCount:r}=await(0,l.v)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:a,recordCount:r}}}catch(e){let t="unhandledError";const i={error:e}.error.description.toLowerCase();switch(!0){case i.includes("the create unique index statement terminated because a duplicate key was found for the object name"):t="invalidUniqueIdentifier";break;case i.includes("does not allow nulls"):t="cannotAddNullData";break;case i.includes("the value violates the maxlength limit of this column"):t="exceededMaxFieldLength";break;case i.includes("input string was not in a correct format"):t="invalidFieldType"}return console.error(e),{error:{code:t,message:JSON.stringify(e)}}}}},9316:(e,t,i)=>{i.d(t,{c:()=>d,g:()=>p,h:()=>c});var n=i(82669),a=i(24147),l=i(30007),s=i(17752),r=i(84873),o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i};function d(e,t){var i;const n=(null==e?void 0:e.type)||null,a=(null==t?void 0:t.type)||null;return a&&(a===n||(null===(i={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[n])||void 0===i?void 0:i.indexOf(a))>-1)}function p(e){var t;const{timezone:i,analyzeResults:r,type:d,fieldMappings:p,dataLayer:c,id:u,uidPair:y,addAppendSelectOption:g,sourceDataLayer:m}=e;let h,T;const{publishParameters:v}=r,f=o(r,["publishParameters"]),F="upsert"===g||"update"===g,b=function(e){return e.filter((e=>e.source!==a.N)).map((({source:e,name:t})=>({source:e,name:t})))}(p),w=function(e){return e.map((e=>e.name))}(b),I={dateFieldsTimeReference:{timeZone:i||"UTC",respectsDaylightSaving:!0}},O={sourceTableName:c.name,fieldMappings:(null==b?void 0:b.length)?JSON.stringify(b):null,upsert:F,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:F&&"esriFieldTypeGlobalID"===(null==y?void 0:y.type),updateGeometry:!F||"attributeAndGeometry"===n.a.addAppendSelectUpdateTypeOption,appendFields:w.length?JSON.stringify(w):null,appendItemId:u,appendUploadFormat:s.a[n.a.type].appendUploadFormat,rollbackOnFailure:!0},D=o(v,["layers"]);if("CSV"===d)v.layerInfo.dateFieldsTimeReference=I.dateFieldsTimeReference,T=Object.assign(Object.assign(Object.assign({},I),v),f);else if("Microsoft Excel"===d){const e=function(e,t){const i=Object.assign({},e);return i.locationType=t.locationType,"address"===i.locationType?(i.addressFields=t.addressFields,i.sourceCountry=t.sourceCountry):"coordinates"===i.locationType&&(i.coordinateFieldType=t.coordinateFieldType,"LatitudeAndLongitude"===i.coordinateFieldType?(i.latitudeFieldName=t.latitudeFieldName,i.longitudeFieldName=t.longitudeFieldName):i.coordinateFieldName=t.coordinateFieldName),i}((0,l.a)({},!0),D);e.dateFieldsTimeReference=I.dateFieldsTimeReference,D.name=c.name,T=Object.assign(Object.assign(Object.assign(Object.assign({},I),{layers:[e]}),D),f)}else T=Object.assign(Object.assign(Object.assign({},I),v),f);return h=Object.assign(Object.assign({},O),{appendSourceInfo:JSON.stringify(T)}),"add"===g?h.upsertMatchingField=m.objectIdField||(null===(t=m.uniqueField)||void 0===t?void 0:t.name):F&&(null==y?void 0:y.isUniqueIndex)&&(h.upsertMatchingField=null==y?void 0:y.name),h}function c(e,t){const i=t.appendErrorMessages;let n=r.u.i18n.error,a=i.appendError;switch(e.code){case"invalidUniqueIdentifier":n=i.invalidUniqueIdentifier.title,a=i.invalidUniqueIdentifier.description;break;case"cannotAddNullData":n=i.cannotAddNullData.title,a=i.cannotAddNullData.description;break;case"exceededMaxFieldLength":n=i.exceededMaxFieldLength.title,a=i.exceededMaxFieldLength.description;break;case"invalidFieldType":n=i.invalidFieldType.title,a=i.invalidFieldType.description}return{title:n,description:a}}},27627:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>c});var n=i(35110),a=i(56631),l=i(64031),s=i(12856),r=i(82669),o=i(84873),d=i(34100),p=i(9316);i(66913),i(46710),i(23505),i(21104),i(73838),i(70392),i(52299),i(91306),i(73208),i(35105),i(16082),i(67148),i(56086),i(79233),i(64307),i(76743),i(63280),i(9657),i(53040),i(51287),i(20982),i(37526),i(17752),i(7803),i(74504),i(38477),i(30007),i(91659),i(24147);const c=class{constructor(e){(0,n.r)(this,e),this.workflowComplete=(0,n.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,n.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,n.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,n.c)(this,"newItemPrevPage",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===o.u.workflow?"attribute":"uploaded",this.i18n=o.u.i18n.appendSelectUpdateType,"append"===o.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,d.v)({dataLayer:r.a.dataLayer,type:r.a.type,sourceDataLayer:r.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),o.u.nextText="updateAppend"}async handleNext(){const e=this.selected;if("update"===o.u.workflow){r.a.addUpdateItemPropertiesOption=e;const t="uploaded"===e;r.a.keepDescription=t,this.handleUpdate()}else r.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:n,fileName:a}=r.a,s=await(0,l.b)(n,n.itemOwner.userContentUrl,{file:e,overwrite:t,keepDescription:i,fileName:a});s.success?this.workflowComplete.emit({success:s.success}):(this.loading=!1,this.error={title:o.u.i18n.error,description:o.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e,t;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.appendCloseNotice;const i=await(0,a.a)({sourceDataLayer:r.a.sourceDataLayer,existingItem:r.a.existingItem,timezone:r.a.timezone,analyzeResults:r.a.analyzeResults,type:r.a.type,fieldMappings:r.a.fieldMappings,dataLayer:r.a.dataLayer,id:r.a.id,uidPair:r.a.uidPair,addAppendSelectOption:r.a.addAppendSelectOption});if("completed"!==(null===(e=null==i?void 0:i.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,p.h)(null!==(t=null==i?void 0:i.error)&&void 0!==t?t:{code:"unhandledError"},{appendErrorMessages:o.u.i18n.append.appendErrorMessages});else{await(0,s.d)(r.a.id,{permanentDelete:!0});const e=Object.assign({appendType:r.a.addAppendSelectOption},i);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:a,error:l}=this;let s=t,r=e.header,d="appendOptions";return"update"===o.u.workflow&&(s=i,r=e.itemPropertiesHeader,d="updateOptions"),(0,n.h)(n.H,{class:{"overflow-hidden":this.loading}},(0,n.h)("arcgis-new-item-description",{header:r}),(0,n.h)("calcite-tile-select-group",{layout:"vertical",class:"tile-select"},Object.keys(s).map((t=>{const{icon:i}=s[t];return(0,n.h)("calcite-tile-select",{key:t,checked:this.selected===t,heading:e[d][t].title,description:e[d][t].description,icon:i,name:"feature-layer-create-mode","input-enabled":!0,width:"full",type:"radio",value:t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelectChange:e=>{this.selected=e.target.value}})}))),"append"===o.u.workflow&&this.cannotUpdateGeometry&&(0,n.h)("calcite-notice",{class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,n.h)("div",{slot:"title"},e[a.title]),(0,n.h)("div",{slot:"message"},e[a.description])),(0,n.h)("arcgis-new-item-loader",{type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,n.h)("arcgis-new-item-alert",{heading:null==l?void 0:l.title,description:null==l?void 0:l.description,link:{href:null==l?void 0:l.link,title:null==l?void 0:l.linkText},active:!!l,onAlertDismiss:()=>this.error=null}))}get el(){return(0,n.d)(this)}};c.style=".tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}"},34100:(e,t,i)=>{function n(e){var t,i;const{dataLayer:n,type:a,sourceDataLayer:l}=e,s=null!==(t=null==n?void 0:n.geometryType)&&void 0!==t?t:null===(i=null==n?void 0:n.layerInfo)||void 0===i?void 0:i.geometryType;if("Microsoft Excel"===a||"CSV"===a){if(("address"===n.locationType&&n.addressFields||"coordinates"===n.locationType)&&"esriGeometryPoint"===(null==l?void 0:l.geometryType))return null;if(!s||"none"===n.locationType||"Table"===(null==l?void 0:l.type))return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==l?void 0:l.geometryType)!==s)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else if((null==l?void 0:l.geometryType)!==(null==n?void 0:n.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}function a(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>a,v:()=>n})}}]);