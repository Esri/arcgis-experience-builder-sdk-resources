/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6"],{14526:(e,l,r)=>{r.r(l),r.d(l,{arcgis_smart_mapping_flow_color_slider:()=>n});var o=r(35110),s=r(59503),i=r(61886),t=(r(21104),r(77419)),a=(r(2137),r(92220));r(86587),r(63280),r(1984),r(23505),r(89393),r(73838);const n=class{constructor(e){(0,o.r)(this,e),this.arcgisSmartMappingFlowColorSliderChange=(0,o.c)(this,"arcgisSmartMappingFlowColorSliderChange",7),this.arcgisSmartMappingFlowColorSliderError=(0,o.c)(this,"arcgisSmartMappingFlowColorSliderError",7),this.currentStopValues=[],this.styleSheetStatus="not-loaded"}componentDidLoad(){this.flowItemNode=(0,s.f)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=s.s;return(0,o.h)(o.H,null,(0,o.h)("link",{rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,o.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,o.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderFlowColorSlider():"not-loaded"===this.styleSheetStatus?this.renderFlowColorSliderLoading():null)}renderFlowColorSlider(){var e,l;const{layer:r,strings:i}=s.s,t=r,a=t.renderer,n=(0,s.a)(a,"color");if(!n)return;const{sourceJSON:h}=t,{minValues:u,maxValues:d}=h,c=(0,s.t)(a,"color"),p=null!==(e=null==c?void 0:c.minSliderValue)&&void 0!==e?e:null==u?void 0:u[0],m=null!==(l=null==c?void 0:c.maxSliderValue)&&void 0!==l?l:null==d?void 0:d[0];if((0,s.ac)(p)&&(0,s.ac)(m)&&p!==m&&1!==(null==n?void 0:n.stops.length)){const e=this.prepareFlowColorSlider();return n.stops.forEach(((e,l)=>{this.currentStopValues[l]=e.value})),(e||this.flowColorSlider)&&this.flowColorSlider.min!==this.flowColorSlider.max?(0,o.h)("div",{class:"slider-box"},(0,o.h)("calcite-label",null,i.panels.flow.dataRange),(0,o.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),(0,o.h)("div",null,"Â "),this.renderResetButton()),(0,o.h)("div",{ref:e=>{e&&this.afterFlowColorSliderCreate(e)}})):this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max?null:this.renderFlowColorSliderLoading()}this.flowColorSlider&&(this.flowColorSlider.destroy(),this.flowColorSlider=void 0)}renderFlowColorSliderLoading(){const{strings:e}=s.s;return(0,o.h)("div",{class:"slider-box"},(0,o.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=s.s;return(0,o.h)("arcgis-smart-mapping-action",{text:e.panels.flow.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderResetButton(){const{strings:e}=s.s;return(0,o.h)("arcgis-smart-mapping-action",{text:e.panels.flow.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareFlowColorSlider(){var e,l,r,o;const{layer:i,modules:a}=s.s,n=i,h=n.renderer,u=(0,s.a)(h,"color"),{sourceJSON:d}=n,{minValues:c,maxValues:p}=d,m=(0,s.t)(h,"color"),f=null!==(e=null==m?void 0:m.minSliderValue)&&void 0!==e?e:null==c?void 0:c[0],S=null!==(l=null==m?void 0:m.maxSliderValue)&&void 0!==l?l:null==p?void 0:p[0],g=m?(0,s.aE)(m.theme,u.stops):void 0;if(!this.flowColorSlider||!u&&this.flowColorSlider.stops){null===(r=this.flowColorSlider)||void 0===r||r.destroy();let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),e.labelFormatFunction=l=>l.toFixed(e.precision),this.flowColorSlider=new a.ColorSlider(e),this.flowColorSlider.min===this.flowColorSlider.max&&this.flowColorSlider.set(e),this.createFlowColorSliderChangeEvents()}else{if("dragging"===(null===(o=this.flowColorSlider.slider)||void 0===o?void 0:o.state))return!0;let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),this.flowColorSlider.set(e)}return(0,s.ac)(this.flowColorSlider)}handleInvertSlider(){const{layer:e}=s.s,l=e.renderer,r=(0,s.a)(l,"color");let i=r.stops.map((e=>e.color));i=i.reverse(),r.stops.forEach(((e,l)=>{e.color=i[l]})),(0,s.ab)(),(0,o.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}handleResetSlider(){const{layer:e}=s.s,l=e.renderer;(0,i.r)((0,a.c)({includeColorVariable:!0}),this.flowItemNode).then((e=>{const r=(0,s.a)(l,"color"),i=(0,s.t)(l,"color"),t=(0,s.a)(e.renderer,"color"),a=(0,s.t)(e.renderer,"color");i.minSliderValue=a.minSliderValue,i.maxSliderValue=a.maxSliderValue,r.stops.forEach(((e,l)=>e.value=t.stops[l].value)),(0,s.ab)(),(0,o.f)(this.hostElement)}),(e=>this.arcgisSmartMappingFlowColorSliderError.emit(e)))}afterFlowColorSliderCreate(e){if(this.flowColorSlider.container)e.append(this.flowColorSlider.container);else{const l=document.createElement("div");e.append(l),this.flowColorSlider.container=l}}createFlowColorSliderChangeEvents(){this.flowColorSlider&&(this.flowColorSlider.on("min-change",(e=>{e.value>this.currentStopValues[0]?(this.flowColorSlider.stops.forEach(((e,l)=>{e.value=this.currentStopValues[l]})),this.handleMinMaxChange(this.currentStopValues[0],this.flowColorSlider.max)):this.handleMinMaxChange(e.value,this.flowColorSlider.max)})),this.flowColorSlider.on("max-change",(e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.flowColorSlider.stops.forEach(((e,l)=>{e.value=this.currentStopValues[l]})),this.handleMinMaxChange(this.flowColorSlider.min,this.currentStopValues[this.currentStopValues.length-1])):this.handleMinMaxChange(this.flowColorSlider.min,e.value)})),this.flowColorSlider.on("thumb-change",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("thumb-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("segment-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))))}handleMinMaxChange(e,l){const{layer:r}=s.s,i=r.renderer,t=(0,s.t)(i,"color")||{};t.minSliderValue=e,t.maxSliderValue=l,i.authoringInfo.classificationMethod="manual",(0,s.ab)(),(0,o.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}updateRendererStops(e){const{layer:l}=s.s,r=l.renderer,o=(0,s.a)(r,"color");o.stops=e,o.stops.forEach(((e,l)=>{this.currentStopValues[l]=e.value})),(0,s.ab)(),this.arcgisSmartMappingFlowColorSliderChange.emit()}get hostElement(){return(0,o.d)(this)}};n.style=".slider-box{height:275px}.slider-box .esri-color-slider{min-width:200px}.slider-box .esri-color-slider .esri-slider .esri-slider__content{height:130px}.slider-box .esri-color-slider .esri-slider .esri-slider__label,.slider-box .esri-color-slider .esri-slider .esri-slider__min,.slider-box .esri-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}"},61886:(e,l,r)=>{let o,s;function i(e){e.loading=!1}function t(e,l){return function(e){e.loading=!0,s=!1,o&&clearTimeout(o),o=setTimeout((()=>{i(e),s=!0}),6e4)}(l),e.then((e=>(i(l),s?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(i(l),Promise.reject(e))))}r.d(l,{r:()=>t})},77419:(e,l,r)=>{r.d(l,{a:()=>a,b:()=>t,g:()=>d,u:()=>i});var o=r(59503),s=(r(21104),r(89393));function i(e){const{layer:l,modules:r}=o.s,i=(0,o.j)(l),t=r.esriLang.clone(i.classBreakInfos);i.classBreakInfos=[],t.forEach(((l,r)=>{l=function(e,l,r,i){if((0,s.i)(l))if(0===l);else if(l<1){const s=Math.round(1/l);e.minValue="first"===i?Math.floor(e.minValue/l)/s:Math.round(e.minValue/l)/s,e.maxValue="last"===i?Math.ceil(e.maxValue/l)/s:Math.round(e.maxValue/l)/s,e.label=`${r>0?"> ":""}${e.minValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===i?Math.floor(e.minValue/l)*l:Math.round(e.minValue/l)*l,e.maxValue="last"===i?Math.ceil(e.maxValue/l)*l:Math.round(e.maxValue/l)*l,e.label=(r>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(l,e,r,0===r?"first":r===t.length-1?"last":void 0),i.addClassBreakInfo({minValue:l.minValue,maxValue:l.maxValue,symbol:l.symbol,label:l.label})}))}function t(e){const{layer:l}=o.s,r=(0,o.j)(l).classBreakInfos;let s=e,i=1/0;r.forEach((e=>{s||(s=Math.max(n(e.minValue),n(e.maxValue))),i=Math.min(i,e.maxValue-e.minValue)}));const t=[];return i>1e7?(t.push(1e7),t.push(1e6),t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e6?(t.push(1e6),t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e5?(t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e4?(t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e3?(t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001)):i>100?(t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5)):i>10?(t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>1?(s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.1?(s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.01?(s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.001?(s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7)):i>1e-4?(s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7),s>8&&t.push(1e-8)):i>1e-5&&(s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7),s>8&&t.push(1e-8),s>9&&t.push(1e-9)),t}function a(){const{layer:e}=o.s,l=(0,o.j)(e);let r=1e10;return l.classBreakInfos.forEach((e=>{r=Math.min(r,h(e.minValue)),r=Math.min(r,h(e.maxValue))})),r}function n(e){let l=1;for(;Math.round(e*l)/l!==e;)l*=10;return Math.log(l)/Math.LN10}function h(e){let l=1e-8;for(;u(Math.round(e/l)*l)===e;)l*=10;return l/10}function u(e){return parseFloat(e.toPrecision(12))}function d(e){var l,r,o,i,t,a,h,d;let c=0;e.forEach((e=>{(0,s.i)(e.value)?c=Math.max(n(u(e.value)),c):((0,s.i)(e.minValue)&&(c=Math.max(n(u(e.minValue)),c)),(0,s.i)(e.maxValue)&&(c=Math.max(n(u(e.maxValue)),c)),(0,s.i)(e.min)&&(c=Math.max(n(u(e.min)),c)),(0,s.i)(e.max)&&(c=Math.max(n(u(e.max)),c)))})),c=Math.min(c,3);const p=e[0],m=e[e.length-1],f=Math.min(null!==(r=null!==(l=p.minValue)&&void 0!==l?l:p.min)&&void 0!==r?r:p.value,null!==(i=null!==(o=m.minValue)&&void 0!==o?o:m.min)&&void 0!==i?i:m.value),S=Math.max(null!==(a=null!==(t=p.maxValue)&&void 0!==t?t:p.max)&&void 0!==a?a:p.value,null!==(d=null!==(h=m.maxValue)&&void 0!==h?h:m.max)&&void 0!==d?d:m.value)-f;return S/e.length<2e-7?c=8:S/e.length<2e-6?c=7:S/e.length<2e-5?c=6:S/e.length<2e-4?c=5:S/e.length<.002?c=4:S/e.length<.02?c=3:S/e.length<.2?c=Math.max(c,2):S/e.length<2&&(c=Math.max(c,1)),Math.round(c)}},92220:(e,l,r)=>{r.d(l,{a:()=>i,c:()=>s,f:()=>t});var o=r(59503);function s(e){const{layer:l,mapView:r,modules:s}=o.s,i=l;return e=e||{},s.RasterFlowCreator.createRenderer({layer:i,view:r,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||t()}).then((l=>(l.layerEffect&&-1===l.layerEffect.indexOf("drop-shadow")&&(i.effect=l.layerEffect),l.renderer.color=l.renderer.color&&(e.color||l.renderer.color),Promise.resolve(l))),(e=>Promise.reject(e)))}function i(e){var l;const{layer:r,mapView:s,modules:i}=o.s,a=r;e=e||{};const n=a.renderer,h=(0,o.a)(n,"color"),u=n.authoringInfo,d=e.flowTheme||(null==u?void 0:u.flowTheme)||"flow-line";return i.RasterFlowCreator.createRenderer({layer:a,view:s,theme:d,includeColorVariable:null!==(l=e.includeColorVariable)&&void 0!==l?l:!!h,legendOptions:e.legendOptions||(null==h?void 0:h.legendOptions),flowRepresentation:e.flowRepresentation||n.flowRepresentation,flowScheme:e.flowScheme}).then((l=>{const r=(0,o.t)(n,"color"),s=(0,o.t)(l.renderer,"color");(null==r?void 0:r.minSliderValue)&&(null==r?void 0:r.maxSliderValue)&&s&&(s.minSliderValue=r.minSliderValue,s.maxSliderValue=r.maxSliderValue);const h=(0,o.a)(a.renderer,"color"),c=(0,o.a)(l.renderer,"color");return h&&c&&h.stops.forEach(((e,l)=>{c.stops[l].value=e.value})),l.renderer.color=l.renderer.color&&(e.color||n.color||l.renderer.color),(e.flowScheme||t())&&h&&c&&h.stops.forEach(((e,l)=>{c.stops[l].color=new i.esriColor(e.color.toJSON())})),d===u.flowTheme&&(l.renderer.flowSpeed=n.flowSpeed,l.renderer.density=n.density,l.renderer.trailLength=n.trailLength,l.renderer.trailWidth=n.trailWidth,l.renderer.trailCap=n.trailCap),Promise.resolve(l)}),(e=>Promise.reject(e)))}function t(){const{layer:e,mapView:l,modules:r}=o.s,s=e.renderer,i=(0,o.a)(s,"color");if(!i)return null;const t=i.stops.map((e=>e.color)),a=r.flowSchemes.getSchemes({basemap:l.map.basemap||"topo"}),n=[a.primaryScheme].concat(a.secondarySchemes),h=[];return n.forEach((e=>{let l=t.some(((l,r)=>!(0,o.a5)(e.colors[r],l)));l?(e.colors=e.colors.reverse(),l=t.some(((l,r)=>!(0,o.a5)(e.colors[r],l))),l||h.push(e)):h.push(e)})),h.length?h[0]:null}r(21104),r(2137)}}]);