"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-929bcb"],{2766:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>f,c:()=>g,d:()=>m,e:()=>b,f:()=>C});var a=r(99248),s=r(16888),l=r(95323),i=r(43278),o=r(92123);const n={ALGORITHMIC_COLOR_RAMP:"AlgorithmicColorRamp",MULTIPART_COLOR_RAMP:"MultiPartColorRamp"};function c(e){const t=(e.h+360)%360/60,r=e.s/100,a=e.v/100*255,s=a*r,l=s*(1-Math.abs(t%2-1));let i;switch(Math.floor(t)){case 0:i={r:s,g:l,b:0};break;case 1:i={r:l,g:s,b:0};break;case 2:i={r:0,g:s,b:l};break;case 3:i={r:0,g:l,b:s};break;case 4:i={r:l,g:0,b:s};break;case 5:case 6:i={r:s,g:0,b:l};break;default:i={r:0,g:0,b:0}}return i.r=Math.round(i.r+a-s),i.g=Math.round(i.g+a-s),i.b=Math.round(i.b+a-s),i}function u(e){const t=e.algorithm??"esriHSVAlgorithm";let{FromColor:r,ToColor:a}=e;if(!Array.isArray(r)){const{r:e,g:t,b:a}=c({h:r.Hue,s:r.Saturation,v:r.Value});r=[e,t,a,r.AlphaValue]}if(!Array.isArray(a)){const{r:e,g:t,b:r}=c({h:a.Hue,s:a.Saturation,v:a.Value});a=[e,t,r,a.AlphaValue]}return{type:"algorithmic",algorithm:t,fromColor:r,toColor:a}}function h(e){if("multipart"===e?.type){const t=e.colorRamps,r=t.map((e=>e.fromColor));return r.push(t[t.length-1].toColor),r}return[e.fromColor,e.toColor]}function d(e){if((0,o.m)(e))return;if(!(0,o.m)(e.colorRamps)||!(0,o.m)(e.toColor)&&!(0,o.m)(e.fromColor))return e;const t=e?.type===n.MULTIPART_COLOR_RAMP?"multipart":"algorithmic",r="multipart"===t?e.ArrayOfColorRamp.map((e=>u(e))):void 0,a="algorithmic"===t?u(e):void 0;return{type:t,colorRamps:r,fromColor:a?.fromColor,toColor:a?.toColor}}function g(e){return t=h(d(e)),Array.isArray(t)?t.some((e=>!(0,o.m)(e.r)&&!(0,o.m)(e.g)&&!(0,o.m)(e.b)))?t:t.map((e=>({r:e[0],g:e[1],b:e[2],a:1}))):t;var t}function p(e,t){const{portal:r}=e,{extraColorRamps:a=[],defaultColors:s}=t,o={color:s||[new l.default([0,0,0,1]),new l.default([255,255,255,1])]},n={color:new l.default([0,0,0,.5]),size:1,style:"solid"},c=function(){const e=[];return i.P.forEach((t=>{e.push({name:i.a.toJSON(t.id),stops:h(t).reverse().map((e=>new l.default(e))),tags:["raster"]})})),e}();return c.push(...a),c.sort((e=>e.tags.indexOf("raster")>-1?-1:1)),{portal:r,sections:{marker:{parts:{preview:!1,rotation:!1,size:!1}},fill:{type:"color-ramp",style:"continuous",colorRamps:c,open:!0,colorRampsOpen:!0,transparencyOpen:!1,parts:{colorRamps:!0,transparency:!1},extraParts:{autoStrokeAdjust:!1,width:!0}}},stroke:{...n,color:[new l.default([13,38,68,1]),new l.default([56,98,122,1]),new l.default([98,158,176,1]),new l.default([177,205,194,1]),new l.default([255,252,212,1])]},fill:o}}function f(e){const t=d(e);if((0,o.m)(t))return;const r=(0,o.m)(t?.clone),l="multipart"===e?.type||e?.type===n.MULTIPART_COLOR_RAMP,c=r?l?s.default.fromJSON(t):a.default.fromJSON(t):t;return(0,i.g)(c)}function m(e){const t=[];for(let r=0;r<e.length-1;r++)t[r]=new a.default({algorithm:"hsv",fromColor:e[r],toColor:e[r+1]||new l.default({r:255,g:255,b:255,a:1})});return e.length>2?new s.default({colorRamps:t}):t[0]}function b(e,t){return(0,i.c)(e,{numColors:t})}function C(){const e=i.P[0];return s.default.fromJSON(e)}},41567:(e,t,r)=>{r.r(t),r.d(t,{rfx_cte_attribute_table:()=>g});var a=r(14947),s=r(59498),l=(r(34319),r(92123)),i=r(90949),o=r(95166),n=r(826),c=(r(46574),r(46717),r(55139),r(57098),r(74656),r(91123),r(78979),r(46869),r(83345),r(2766));r(86944);const u="rasterHelpClickHandler",h="rfx-cte-attribute-table",d={generateTable:`${h}__generate-table`,generateTableContainer:`${h}__generate-table-container`,generateTableSection:`${h}__generate-table-section`,generateTableComponent:`${h}__generate-table-component`},g=class{constructor(e){(0,a.r)(this,e),this.rfxArgumentChange=(0,a.c)(this,"rfxArgumentChange",7),this.customGridDetails={},this.defaultFields=[{name:"ObjectID",type:"esriFieldTypeOID",alias:"OID"},{name:"Value",type:"esriFieldTypeInteger",alias:"Value"},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",length:256},{name:"Red",type:"esriFieldTypeInteger",alias:"Red"},{name:"Green",type:"esriFieldTypeInteger",alias:"Green"},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue"},{name:"Alpha",type:"esriFieldTypeInteger",alias:"Alpha"}],this.gridDefaultFields={Value:n.G.textInput,ClassName:n.G.textInput,Color:n.G.color},this.isRasterArgRFT=!1,this.minMaxDefaults={min:"1",max:"7"},this.helpActionClickEventHandlers=new Map,this.updateValue=e=>{const t=[],{detail:{gridOptions:r=this.gridOptions}}=e??{detail:{}};r.forEach(((e,a)=>{if(a===r.length-1)return;const s={attributes:{ObjectID:a,Value:(0,l.m)(e.Value)?null:parseInt(e.Value,10),ClassName:e.ClassName,Red:e.Color?.[0]??0,Green:e.Color?.[1]??0,Blue:e.Color?.[2]??0,Alpha:e.Color?.[3]??255}};t.push(s)}));const a=this.widgetArgs.inputArgs.AttributeTableAsRecordSet;(0,l.m)(a.fields)&&(a.fields=this.defaultFields),a.features=t,this.rfxArgumentChange.emit({value:t})},this.updateRasterInputArg=e=>{const t=e.detail.value;this.widgetArgs.inputArgs.Raster.value=t},this.createCustomGridOptions=()=>{const{min:e,max:t,className:r,colorRamp:a}=this.customGridDetails,s=t-e+1,l=[],i=(0,c.e)(a,s).reverse();for(let a=e,s=0;a<=t;a++,s++)l.push({id:a+1,Value:a,ClassName:`${r}${a}`,Color:[i[s][1],i[s][2],i[s][3],255]});l.push(this.getDefaultValueObject()),this.gridOptions=l,this.updateValue()},this.gridOptions=void 0,this.widgetArgs=void 0}connectedCallback(){this.processWidgetArgs()}async componentWillLoad(){({strings:this.strings}=await(0,s.b)(this.hostElement,(0,a.g)("."))),this.setupInitialState()}componentDidLoad(){this.attachHelpClickEventHandlers()}processWidgetArgs(){if(!(0,l.m)(this.widgetArgs?.inputArgs)&&((0,o.d)(this.widgetArgs.inputArgs?.Raster)&&(this.isRasterArgRFT=!0),!Object.keys(this.widgetArgs.inputArgs).some((function(e){if("AttributeTableAsRecordSet"===e)return!0})))){const e={name:"AttributeTableAsRecordSet",isPublic:!1,type:"RecordSet"};this.widgetArgs.rfxArgs.AttributeTableAsRecordSet=e,this.widgetArgs.inputArgs.AttributeTableAsRecordSet=e}}setupInitialState(){this.createGridLayout(),this.createGridOptions()}attachHelpClickEventHandlers(){const e=this.widgetArgs.onHelpActionClick({heading:this.strings.raster,referenceElement:this.rasterLabelContainer,helpTextID:this.widgetArgs.helpTextIDs?.attributetable_raster});this.helpActionClickEventHandlers.set(u,e)}createGridLayout(){this.gridLayout={},Object.keys(this.gridDefaultFields).forEach((e=>{this.gridLayout[e]={label:this.strings[e.toLowerCase()],uiType:this.gridDefaultFields[e]}}))}getDefaultValueObject(){return{id:0,Value:0,ClassName:"",Color:[0,0,0,255]}}createGridOptions(){const e=[],t=this.widgetArgs?.inputArgs.AttributeTableAsRecordSet;t?.features?.length>0&&t.features.forEach(((t,r)=>{const a=t.attributes;null!=a.Alpha&&a.Alpha<=1&&(a.Alpha=Math.round(255*a.Alpha));const s={id:r+1,Value:a.Value,ClassName:a.ClassName,Color:[a.Red,a.Green,a.Blue,a.Alpha]};e.push(s)})),0===e.length&&e.push(this.getDefaultValueObject()),this.gridOptions=e}renderGenerateTable(){return(0,a.h)("calcite-block",{class:d.generateTableContainer,heading:this.strings.generate,collapsible:!0},(0,a.h)("div",{class:d.generateTable},(0,a.h)("div",{class:d.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.minValue,hideHelp:!0}),(0,a.h)("div",{class:d.generateTableComponent},(0,a.h)("calcite-input-number",{scale:i.U.Scale,value:this.minMaxDefaults.min,ref:e=>this.customGridDetails.min=Number.parseInt(e.value,10),onCalciteInputNumberChange:e=>this.customGridDetails.min=Number.parseInt(e.target.value,10)}))),(0,a.h)("div",{class:d.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.maxValue,hideHelp:!0}),(0,a.h)("div",{class:d.generateTableComponent},(0,a.h)("calcite-input-number",{scale:i.U.Scale,value:this.minMaxDefaults.max,ref:e=>this.customGridDetails.max=Number.parseInt(e.value,10),onCalciteInputNumberChange:e=>this.customGridDetails.max=Number.parseInt(e.target.value,10)}))),(0,a.h)("div",{class:d.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.classBaseName,hideHelp:!0}),(0,a.h)("div",{class:d.generateTableComponent},(0,a.h)("calcite-input-text",{scale:i.U.Scale,value:this.strings.defaultClassName,ref:e=>this.customGridDetails.className=e.value,onCalciteInputTextChange:e=>this.customGridDetails.className=e.target.value}))),(0,a.h)("div",{class:d.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.colorscheme,hideHelp:!0}),(0,a.h)("div",{class:d.generateTableComponent},(0,a.h)("rfx-dte-color-ramp-selector",{ref:e=>this.customGridDetails.colorRamp=e.value,onRfxArgumentChange:e=>this.customGridDetails.colorRamp=e.target.value})))),(0,a.h)("calcite-button",{scale:i.U.Scale,onClick:this.createCustomGridOptions},this.strings.generate))}renderRasterSelect(){return(0,a.h)("calcite-label",{alignment:"start",scale:i.U.Scale,layout:"default",ref:e=>{this.rasterLabelContainer=e}},(0,a.h)("rfx-label",{label:this.strings.raster,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(u)()}),(0,a.h)("rfx-dte-raster-input",{mode:this.widgetArgs.mode,inputLayers:this.widgetArgs.inputLayers,allowScalar:this.widgetArgs.allowScalar,rfxVariable:this.widgetArgs.inputArgs.Raster,onRfxArgumentChange:this.updateRasterInputArg,rfxBrowseLayerClick:this.widgetArgs.onRfxBrowseLayerClick}))}render(){return(0,a.h)("div",null,!0!==this.isRasterArgRFT?this.renderRasterSelect():null,(0,a.h)("rfx-grid",{hasHeader:!0,canAdd:!0,canRemove:!0,hasIdColumn:!0,gridLayout:this.gridLayout,gridOptions:this.gridOptions,hasBorder:!0,onRfxGridOptionChange:this.updateValue}),this.renderGenerateTable())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}};g.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.rfx-cte-attribute-table__generate-table{width:100%}.rfx-cte-attribute-table__generate-table-container{padding-top:var(--rfx-full-spacing)}.rfx-cte-attribute-table__generate-table-section{padding-bottom:var(--rfx-half-spacing)}.rfx-cte-attribute-table__generate-table-component{padding-top:var(--rfx-half-spacing)}",r(25829),r(22760),r(86578),r(99248),r(16888),r(95323),r(43278)}}]);