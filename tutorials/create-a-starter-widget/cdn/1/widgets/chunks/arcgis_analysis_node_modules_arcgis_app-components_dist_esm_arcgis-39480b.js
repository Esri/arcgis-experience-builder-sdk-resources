/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-39480b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-39480b"],{31913:(e,i,t)=>{t.r(i),t.d(i,{arcgis_smart_mapping_color_slider:()=>m});var s=t(35110),o=t(59503),l=t(78246),r=t(61886),a=(t(21104),t(77419)),n=(t(2137),t(99258)),d=t(28642),u=t(51298),h=t(6216);t(86587),t(63280),t(1984),t(23505),t(89393),t(73838);const m=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingColorSliderChange=(0,s.c)(this,"arcgisSmartMappingColorSliderChange",7),this.arcgisSmartMappingColorSliderError=(0,s.c)(this,"arcgisSmartMappingColorSliderError",7),this.currentStopValues=[],this.currentBreakValues=[],this.zigzagClick=!1,this.styleSheetStatus="not-loaded",this.histogramStatus=o.b.MISSING,this.statisticsStatus=o.b.MISSING,this.sliderZoomed=!1,this.cap=void 0}async updateStatistics(){var e;this.statisticsStatus=o.b.MISSING,this.statistics=null,this.histogramStatus=o.b.MISSING,this.histogram=null,null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){this.getStatistics()}componentDidLoad(){this.flowItemNode=(0,o.f)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=o.s;return(0,s.h)(s.H,null,(0,s.h)("link",{rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderColorSlider():"not-loaded"===this.styleSheetStatus?this.renderColorSliderLoading():null)}renderColorSlider(){const{statisticsStatus:e,histogramStatus:i,sliderZoomed:t}=this,{layer:l,strings:r}=o.s,a=(0,o.j)(l),n=(0,o.a)(a,"color");if(!(e===o.b.FAILED||e===o.b.MISSING||n&&1===n.stops.length||!n&&1===a.classBreakInfos.length)){if(e===o.b.IN_PROGRESS||i===o.b.IN_PROGRESS&&!this.colorSlider)return this.renderColorSliderLoading();{const e=this.prepareColorSlider();let i=!1;if(n&&!t){const e=(0,o.t)(a,"color"),t=(0,o.aD)(n.stops,null==e?void 0:e.minSliderValue,null==e?void 0:e.maxSliderValue);((null==t?void 0:t.minMaxSame)||!(0,o.ac)(null==t?void 0:t.min)&&!(0,o.ac)(null==t?void 0:t.max))&&(i=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return n?this.currentStopValues=n.stops.map((e=>e.value)):this.currentBreakValues=a.classBreakInfos.map((e=>({min:e.minValue,max:e.maxValue}))),(e||this.colorSlider)&&this.colorSlider.min!==this.colorSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,r.panels.color.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),n&&(0,s.h)(s.F,null,(0,s.h)("div",null," "),this.renderZoomButton(i),(0,s.h)("div",null," "),this.renderResetButton())),(0,s.h)("div",{ref:e=>{e&&this.afterColorSliderCreate(e)}})):this.colorSlider&&this.colorSlider.min===this.colorSlider.max?null:this.renderColorSliderLoading()}}this.colorSlider&&(this.colorSlider.destroy(),this.colorSlider=void 0)}renderColorSliderLoading(){const{strings:e}=o.s;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=o.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderZoomButton(e){const{strings:i}=o.s,{sliderZoomed:t}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:i.panels.color.zoomSlider,icon:t?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=o.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareColorSlider(){var e,i;const{statistics:t,histogram:s,histogramStatus:r,sliderZoomed:u}=this,{layer:h,mapView:m,modules:c}=o.s,p=(0,o.j)(h),g=(0,o.g)(),S=["color-age","color-age-size"].indexOf(g)>-1,f=this.getFieldInfo().simpleFieldType===o.z.DATE,x=(0,o.a)(p,"color"),b=(0,o.t)(p,"color");let v,V,z;if(b?(v=(0,o.aE)(b.theme,x.stops),V=b.minSliderValue,z=b.maxSliderValue):(V=p.classBreakInfos[0].minValue,z=p.classBreakInfos[p.classBreakInfos.length-1].maxValue),({min:V,max:z}=(0,o.ad)({min:V,max:z})),r===o.b.IN_PROGRESS)return!1;if(!this.colorSlider||x&&this.colorSlider.breaks||!x&&this.colorSlider.stops){null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSliderBars=[];let i={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=V?V:t.min,max:null!=z?z:t.max};x?(i=Object.assign(Object.assign({},i),v),f&&!S&&(i.hasTimeData=!0,(0,l.a)(i,m.timeZone)),i.stops=x.stops,i.precision=(0,a.g)(x.stops),i.histogramConfig.barCreatedFunction=s&&n.b.bind(this,x,s,this.colorSliderBars),this.colorSlider=new c.ColorSlider(i),this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(i)):(i.histogramConfig.min=p.classBreakInfos[0].minValue,i.histogramConfig.max=p.classBreakInfos[p.classBreakInfos.length-1].maxValue,this.sliderZoomed=!1,i.breaks=(0,d.g)(),i.precision=(0,a.g)(i.breaks),i.histogramConfig.barCreatedFunction=s&&n.b.bind(this,i.breaks,s,this.colorSliderBars),this.colorSlider=new c.ClassedColorSlider(i),this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(i),(0,n.u)(this.colorSlider,this.colorSliderBars,i.breaks,s)),this.createColorSliderChangeEvents()}else{const e=this.colorSlider;if("dragging"===(null===(i=e.slider)||void 0===i?void 0:i.state))return!0;let r={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=V?V:t.min,max:null!=z?z:t.max};x?(r=Object.assign(Object.assign({},r),v),r.stops=x.stops,r.precision=(0,a.g)(x.stops),r.hasTimeData=f&&!S,f&&!S&&(0,l.a)(r,m.timeZone),u?this.zigzagClick||(r.zoomOptions=(0,o.aD)(x.stops,null==b?void 0:b.minSliderValue,null==b?void 0:b.maxSliderValue)):r.zoomOptions=null,r.histogramConfig.barCreatedFunction=s&&n.b.bind(this,x,s,this.colorSliderBars),(0,n.u)(e,this.colorSliderBars,x,s)):(r.breaks=(0,d.g)(),r.precision=(0,a.g)(r.breaks),r.histogramConfig.barCreatedFunction=s&&n.b.bind(this,r.breaks,s,this.colorSliderBars),(0,n.u)(e,this.colorSliderBars,r.breaks,s)),this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(r.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.colorSlider.slider.min=r.zoomOptions.min,r.zoomOptions.min=null):(this.colorSlider.slider.max=r.zoomOptions.max,r.zoomOptions.max=null)),this.adjustedZoomOptions=null,this.zoomAdjustment=null,this.colorSlider.set(r),this.zigzagClick=!1}return(0,o.ac)(this.colorSlider)}handleInvertSlider(){const{layer:e,modules:i}=o.s,t=(0,o.j)(e),l=(0,o.a)(t,"color");if((0,n.u)(this.colorSlider,this.colorSliderBars,l||(0,d.g)(),this.histogram),l){let e=l.stops.map((e=>e.color));e=e.reverse(),l.stops.forEach(((i,t)=>{i.color=e[t]}))}else{let e=t.classBreakInfos.map((e=>(0,o.w)(e.symbol)||new i.esriColor({r:64,g:64,b:64,a:1})));e=e.reverse(),t.classBreakInfos.map(((i,t)=>{(0,o.w)(i.symbol)&&(0,o.v)(i.symbol,e[t])}))}(0,o.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingColorSliderChange.emit()}handleZoomSlider(e){var i,t,s,l;if(this.cap=this.colorSlider.slider.max,this.histogramStatus===o.b.IN_PROGRESS)return;const{statistics:r}=this,{layer:a}=o.s,n=(0,o.j)(a);this.sliderZoomed=(0,o.ac)(e)?e:!this.sliderZoomed;const d=(0,o.a)(n,"color");d||(this.sliderZoomed=!1);const u=(0,o.t)(n,"color"),h=this.sliderZoomed?(0,o.aD)(d.stops,null!==(i=null==u?void 0:u.minSliderValue)&&void 0!==i?i:r.min,null!==(t=null==u?void 0:u.maxSliderValue)&&void 0!==t?t:r.max):null,m=(null==u?void 0:u.minSliderValue)===(null==u?void 0:u.maxSliderValue);this.getHistogram({field:d.field,expression:d.valueExpression,expressionTitle:d.valueExpressionTitle,simpleFieldType:o.z.NUMBER},d.normalizationField,r,h&&h.min||(m?r.min:null!==(s=u.minSliderValue)&&void 0!==s?s:r.min),h&&h.max||(m?r.max:null!==(l=u.maxSliderValue)&&void 0!==l?l:r.max))}handleResetSlider(){const{layer:e}=o.s,i=(0,o.j)(e),t=(0,o.g)();this.sliderZoomed=!1;let l=(0,o.a)(i,"color");const a=(0,o.t)(i,"color"),n=null==a?void 0:a.theme,m=this.getFieldInfo(),c=l?l.normalizationField:i.normalizationField;let p;"color"===t?p=d.b:"color-age"===t?(m.field=a.field,p=d.d):"color-age-size"===t?(m.field=a.field,p=h.h):"color-size-age"===t?p=h.i:"color-size"===t?p=h.j:"compare"===t&&(p=u.a),(0,r.r)(p({fieldInfos:(0,o.h)(e),normalizationField:c,noReuse:!0,theme:n,discardMinMax:!0},"color"),this.flowItemNode).then((e=>{var i;if(0===(null===(i=e.statistics)||void 0===i?void 0:i.count)){const[i,t]=this.getDefaultDataRange(m),s=i,l=t;e.statistics.min=s,e.statistics.max=l,e.statistics.avg=(l+s)/2,this.statistics=e.statistics,this.statisticsStatus=o.b.SUCCESS}else e.statistics&&(0,o.ac)(e.statistics.min)&&(0,o.ac)(e.statistics.max)&&e.statistics.min<=e.statistics.max?(e.statistics=(0,o.ad)(e.statistics),this.statistics=e.statistics,this.statisticsStatus=o.b.SUCCESS,this.getHistogram(m,c,e.statistics,e.statistics.min,e.statistics.max)):this.statisticsStatus=o.b.FAILED;a.minSliderValue=this.statistics.min,a.maxSliderValue=this.statistics.max,(0,o.ab)(),(0,s.f)(this.hostElement)}),(e=>this.arcgisSmartMappingColorSliderError.emit(e)))}afterColorSliderCreate(e){if(this.colorSlider.container)e.append(this.colorSlider.container);else{const i=document.createElement("div");i.classList.add("slider-container"),e.append(i),this.colorSlider.container=i}}getStatistics(){var e;const{layer:i,useFeatureReduction:t,mapView:s,modules:l}=o.s,r=i,a=(0,o.j)(r);let n,d;const u=this.getFieldInfo(),h=(0,o.a)(a,"color"),m=h?h.normalizationField:a.normalizationField,c=(0,o.t)(a,"color")||{};n=c.minSliderValue,d=c.maxSliderValue;const p=a.authoringInfo;if("equal-interval"===(null==p?void 0:p.classificationMethod)){const e=a.classBreakInfos;n=e[0].minValue,d=e[e.length-1].maxValue}this.statisticsStatus=o.b.IN_PROGRESS,this.statistics||l.summaryStatistics({layer:r,view:s,field:u.field,valueExpression:u.expression,normalizationField:m,forBinning:"featureReduction"in r&&"binning"===(null===(e=r.featureReduction)||void 0===e?void 0:e.type)&&t}).then((e=>{if(0===e.count){const[i,t]=this.getDefaultDataRange(u),s=c.minSliderValue||i,l=c.maxSliderValue||t;e.min=s,e.max=l,e.avg=(l+s)/2,(0,o.ac)(c.minSliderValue)||(c.minSliderValue=s,c.maxSliderValue=l)}else if(!(0,o.ac)(e.avg)||!(0,o.ac)(e.min)||!(0,o.ac)(e.max))return void(this.statisticsStatus=o.b.FAILED);e=(0,o.ad)(e),n=null!=n?n:e.min,d=null!=d?d:e.max,n===d&&(n=e.min,d=e.max),this.statistics=e,this.statisticsStatus=o.b.SUCCESS,this.getHistogram(u,m,e,n,d)}),(e=>{console.log(e),this.statisticsStatus=o.b.FAILED}))}getHistogram(e,i,t,s,l){var r;const{layer:a,useFeatureReduction:n,mapView:d,modules:u}=o.s,h=a;(t=t||this.statistics)&&0!==t.count&&(this.histogramStatus=o.b.IN_PROGRESS,u.histogram({layer:h,view:d,field:e.field,valueExpression:e.expression,numBins:50,minValue:(0,o.ac)(s)?s:t.min,maxValue:(0,o.ac)(l)?l:t.max,normalizationField:i,forBinning:"featureReduction"in h&&"binning"===(null===(r=h.featureReduction)||void 0===r?void 0:r.type)&&n}).then((e=>{this.histogram=e,this.histogramStatus=o.b.SUCCESS}),(e=>{console.log(e),this.histogramStatus=o.b.FAILED})))}onMinMaxChange(e,i,t){const{statistics:s}=this,{layer:l}=o.s,r=(0,o.j)(l),a=(0,o.a)(r,"color"),u=(0,o.t)(r,"color")||{};if(!a){let t=r.classBreakInfos[0],s=r.classBreakInfos[r.classBreakInfos.length-1];t.minValue=e,t.label=(0,o.aC)(t,this.colorSlider.precision),s.maxValue=i,s.label=`> ${(0,o.aC)(s,this.colorSlider.precision)}`}"min"===t?u.minSliderValue=e:u.maxSliderValue=i;const h=(0,o.aD)(null==a?void 0:a.stops,u.minSliderValue,u.maxSliderValue);this.zoomButtonNode&&(this.sliderZoomed?this.zoomButtonNode.disabled=!1:!h||h.minMaxSame||!(0,o.ac)(h.min)&&!(0,o.ac)(h.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1),this.sliderZoomed&&(this.adjustedZoomOptions=this.colorSlider.zoomOptions,"min"===t?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=i,this.zoomAdjustment="max"));const m=this.getFieldInfo(),c=a?a.normalizationField:r.normalizationField;this.getHistogram(m,c,s,e,i),(0,n.u)(this.colorSlider,this.colorSliderBars,a||(0,d.g)(),this.histogram),e===u.minSliderValue&&i===u.maxSliderValue&&(this.sliderZoomed=!1),r.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingColorSliderChange.emit()}createColorSliderChangeEvents(){const{layer:e}=o.s,i=(0,o.j)(e),t=(0,o.a)(i,"color");this.colorSlider&&(this.colorSlider.watch("zoomOptions",((e,i)=>{this.sliderZoomed&&((null==i?void 0:i.min)&&!(null==e?void 0:e.min)||(null==i?void 0:i.max)&&!(null==e?void 0:e.max))&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.colorSlider.on("min-change",(e=>{t?e.value>this.currentStopValues[0]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.currentStopValues[0],this.colorSlider.slider.max,"min")):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min"):e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.colorSlider.slider.max,"min"):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min")})),this.colorSlider.on("max-change",(e=>{t?e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.colorSlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max"):e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.colorSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min,"max"):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max")})),this.colorSlider.on("thumb-change",(e=>{if(t){const i=this.getFieldInfo();if((0,o.aI)(i)&&0===e.value)return void(0,s.f)(this.hostElement);const t=this.colorSlider.stops;this.updateRendererStops(t)}else this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("thumb-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("segment-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks)})))}updateRendererStops(e){const{layer:i}=o.s,t=(0,o.j)(i),s=(0,o.a)(t,"color"),l=(0,o.t)(t,"color");s.stops=e,this.currentStopValues=s.stops.map((e=>e.value));const r=(0,o.aD)(null==s?void 0:s.stops,null==l?void 0:l.minSliderValue,null==l?void 0:l.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!r||r.minMaxSame||!(0,o.ac)(r.min)&&!(0,o.ac)(r.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,(0,n.u)(this.colorSlider,this.colorSliderBars,s,this.histogram),(0,o.ab)()}updateRendererBreaks(e){const{layer:i}=o.s,t=(0,o.j)(i);t.authoringInfo.classificationMethod="manual",t.classBreakInfos.forEach(((i,t)=>{if(i.minValue!==e[t].min||i.maxValue!==e[t].max){i.minValue=e[t].min,i.maxValue=e[t].max;const s=t>0?"> ":"";i.label=`${s} ${(0,o.aC)(i,this.colorSlider.precision)}`,this.currentBreakValues[t].min=e[t].min,this.currentBreakValues[t].max=e[t].max}})),(0,n.u)(this.colorSlider,this.colorSliderBars,(0,d.g)(),this.histogram),(0,o.ab)(),this.arcgisSmartMappingColorSliderChange.emit()}getDefaultDataRange(e){if(e.simpleFieldType===o.z.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){const{layer:e}=o.s,i=(0,o.j)(e),t=(0,o.a)(i,"color"),s=(0,o.x)(t?t.field:i.field);return{field:(null==t?void 0:t.field)||i.field,expression:(null==t?void 0:t.valueExpression)||i.valueExpression,expressionTitle:(null==t?void 0:t.valueExpressionTitle)||i.valueExpressionTitle,simpleFieldType:s?s.simpleFieldType:o.z.NUMBER}}handleZigzagClick(e){var i,t;const{statistics:s}=this,{layer:l}=o.s,r=(0,o.j)(l),a=(0,o.a)(r,"color"),n=(0,o.t)(r,"color"),d=this.getFieldInfo(),u=a?a.normalizationField:r.normalizationField,h=n.minSliderValue===n.maxSliderValue;this.getHistogram(d,u,s,null!==(i=null==e?void 0:e.min)&&void 0!==i?i:h?s.min:n.minSliderValue,null!==(t=null==e?void 0:e.max)&&void 0!==t?t:h?s.max:n.maxSliderValue),e||(this.sliderZoomed=!1)}get hostElement(){return(0,s.d)(this)}};m.style=".slider-box{height:320px}.slider-box .esri-color-slider,.slider-box .esri-classed-color-slider{min-width:200px}.slider-box .esri-color-slider .esri-slider .esri-slider__content,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__content{height:175px}.slider-box .esri-color-slider__histogram-container,.slider-box .esri-classed-color-slider__histogram-container{width:85px}.slider-box .esri-color-slider .esri-slider .esri-slider__label,.slider-box .esri-color-slider .esri-slider .esri-slider__min,.slider-box .esri-color-slider .esri-slider .esri-slider__max,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__max:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}.slider-container{overflow:hidden}"},51298:(e,i,t)=>{t.d(i,{a:()=>r,c:()=>l,g:()=>a});var s=t(59503),o=(t(21104),t(89393));function l(e){var i;const{layer:t,useFeatureReduction:l,mapImageSublayer:r,mapView:a,modules:n}=s.s,d=t;e=e||{};const u=(0,s.p)((0,s.j)(d));return n.ColorCreator.createContinuousRenderer({layer:d,view:a,field:e.fieldInfos[0].field,theme:"above-and-below",colorScheme:(0,s.Q)("above-and-below"),normalizationField:e.fieldInfos[1].field,outlineOptimizationEnabled:!r&&((0,o.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:(0,s.u)(d)),sizeOptimizationEnabled:!r&&(!(0,o.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(i=d.featureReduction)||void 0===i?void 0:i.type)&&l}).then((e=>(((0,s.t)(e.renderer,"color")||{}).style="ratio",(0,s.o)(u,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function r(e){var i,t,l,r;const{layer:n,useFeatureReduction:d,mapImageSublayer:u,mapView:h,modules:m}=s.s,c=n;e=e||{};const p=(0,s.j)(c),g=(0,s.a)(p,"color");if(g&&e.fieldInfo&&e.fieldInfo.field==g.field&&e.normalizationField===g.normalizationField&&(delete e.fieldInfos,(0,s.S)(e)))return Promise.resolve({renderer:p.clone()});const S=(0,s.t)(p,"color"),f=(0,s.p)(p);let x=e.fieldInfos?e.fieldInfos[0]:g?{field:g.field,expression:g.valueExpression,expressionTitle:g.valueExpressionTitle,simpleFieldType:s.z.NUMBER}:{field:p.field,expression:p.valueExpression,expressionTitle:p.valueExpressionTitle,simpleFieldType:s.z.NUMBER};const b=e.normalizationField?e.normalizationField:g?g.normalizationField:p.normalizationField,v=p.classBreakInfos&&p.classBreakInfos.length?p.classBreakInfos[0].symbol:null,V=p.defaultSymbol,z=p.defaultLabel;let C=!1;(null===e.normalizationField||e.normalizationField||e.fieldInfo)&&(C=!0);const I=e.discardMinMax?void 0:(0,o.i)(e.min)?e.min:C?void 0:S?S.minSliderValue:p.classBreakInfos[0].minValue,M=e.discardMinMax?void 0:(0,o.i)(e.max)?e.max:C?void 0:S?S.maxSliderValue:p.classBreakInfos[p.classBreakInfos.length-1].maxValue;return m.ColorCreator.createContinuousRenderer({layer:c,view:h,field:x?x.field:p.field,theme:"above-and-below",colorScheme:(0,s.Q)("above-and-below"),normalizationField:b,minValue:I,maxValue:M,outlineOptimizationEnabled:!u&&((0,o.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!f.sizeOutlineVisVar),sizeOptimizationEnabled:!u&&((0,o.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!f.sizeAutoVisVar),legendOptions:(null===(i=e.legendOptions)||void 0===i?void 0:i.toJSON())||(null===(t=null==g?void 0:g.legendOptions)||void 0===t?void 0:t.toJSON())||(null===(l=p.legendOptions)||void 0===l?void 0:l.toJSON()),defaultSymbolEnabled:(0,o.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!p.defaultSymbol,forBinning:"binning"===(null===(r=c.featureReduction)||void 0===r?void 0:r.type)&&d}).then((i=>{if(e.discardMinMax){const e=(0,s.a)(p,"color"),t=(0,s.a)(i.renderer,"color");e.stops.forEach(((e,i)=>e.value=t.stops[i].value));const o=!!S&&"percent"===S.style,l=!!S&&"percent-of-total"===S.style;e.stops[0].label=`< ${a(e.stops[0].value,o,l)}`,e.stops[2].label=`${a(e.stops[2].value,o,l)}`,e.stops[4].label=`> ${a(e.stops[4].value,o,l)}`}return((0,s.t)(i.renderer,"color")||{}).style="ratio",(0,s.o)(f,i.renderer),v&&i.renderer.classBreakInfos&&i.renderer.classBreakInfos.length&&(i.renderer.classBreakInfos[0].symbol=v),V&&(i.renderer.defaultSymbol=V,i.renderer.defaultLabel=z),Promise.resolve(i)}),(e=>Promise.reject(e)))}function a(e,i,t){return t?Math.round(e/(1+e)*1e4)/100+"%":i?Math.round(1e4*e)/100+"%":`${e}`}},78246:(e,i,t)=>{t.d(i,{a:()=>o,b:()=>r,d:()=>a,u:()=>l});var s=t(59503);function o(e,i){e.labelFormatFunction=e=>n(e,i,"short-date"),e.inputFormatFunction=e=>n(e,i,"short-date"),e.inputParseFunction=e=>function(e,i){if(!e)return e;let t;if(i&&"system"!==i)if("unknown"===i)t=e;else{const s=new Date;t=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime())}else t=e+6e4*(new Date).getTimezoneOffset();return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(t).toISOString()),t}(Date.parse(e),i)}function l(e,i){let t;if(i&&"system"!==i)if("unknown"===i)t=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});t=new Date(new Date(o).getTime()-6e4*s).toISOString()}else{const i=(new Date).getTimezoneOffset();t=new Date(e-6e4*i).toISOString()}return t}function r(e,i,t){let s;if(i&&"system"!==i)if("unknown"===i)s=new Date(e).toISOString();else{const t=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});s=new Date(new Date(o).getTime()-6e4*t).toISOString()}else{const i=(new Date).getTimezoneOffset();s=new Date(e-6e4*i).toISOString()}return s=t?s.substring(11,19):s.substring(11,16),s}function a(e,i){let t,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),i&&"system"!==i)if("unknown"===i)t=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime();t=s.getTime()+e}else{const e=(new Date).getTimezoneOffset();t=s.getTime()+6e4*e}return t}function n(e,i,t){const{modules:o}=s.s;let l;return l="unknown"===i?o.intl.formatDate(e,Object.assign(Object.assign({},o.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:"utc",timeZoneName:"shortOffset"})):o.intl.formatDate(e,Object.assign(Object.assign({},o.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:i})),l}t(21104),t(2137)},61886:(e,i,t)=>{let s,o;function l(e){e.loading=!1}function r(e,i){return function(e){e.loading=!0,o=!1,s&&clearTimeout(s),s=setTimeout((()=>{l(e),o=!0}),6e4)}(i),e.then((e=>(l(i),o?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(l(i),Promise.reject(e))))}t.d(i,{r:()=>r})},77419:(e,i,t)=>{t.d(i,{a:()=>a,b:()=>r,g:()=>h,u:()=>l});var s=t(59503),o=(t(21104),t(89393));function l(e){const{layer:i,modules:t}=s.s,l=(0,s.j)(i),r=t.esriLang.clone(l.classBreakInfos);l.classBreakInfos=[],r.forEach(((i,t)=>{i=function(e,i,t,l){if((0,o.i)(i))if(0===i);else if(i<1){const o=Math.round(1/i);e.minValue="first"===l?Math.floor(e.minValue/i)/o:Math.round(e.minValue/i)/o,e.maxValue="last"===l?Math.ceil(e.maxValue/i)/o:Math.round(e.maxValue/i)/o,e.label=`${t>0?"> ":""}${e.minValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===l?Math.floor(e.minValue/i)*i:Math.round(e.minValue/i)*i,e.maxValue="last"===l?Math.ceil(e.maxValue/i)*i:Math.round(e.maxValue/i)*i,e.label=(t>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(i,e,t,0===t?"first":t===r.length-1?"last":void 0),l.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function r(e){const{layer:i}=s.s,t=(0,s.j)(i).classBreakInfos;let o=e,l=1/0;t.forEach((e=>{o||(o=Math.max(n(e.minValue),n(e.maxValue))),l=Math.min(l,e.maxValue-e.minValue)}));const r=[];return l>1e7?(r.push(1e7),r.push(1e6),r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01)):l>1e6?(r.push(1e6),r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01)):l>1e5?(r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01)):l>1e4?(r.push(1e4),r.push(1e3),r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01)):l>1e3?(r.push(1e3),r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01),o>3&&r.push(.001)):l>100?(r.push(100),r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01),o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5)):l>10?(r.push(10),o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01),o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6)):l>1?(o>0&&r.push(1),o>1&&r.push(.1),o>2&&r.push(.01),o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6)):l>.1?(o>1&&r.push(.1),o>2&&r.push(.01),o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6)):l>.01?(o>2&&r.push(.01),o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6)):l>.001?(o>3&&r.push(.001),o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6),o>7&&r.push(1e-7)):l>1e-4?(o>4&&r.push(1e-4),o>5&&r.push(1e-5),o>6&&r.push(1e-6),o>7&&r.push(1e-7),o>8&&r.push(1e-8)):l>1e-5&&(o>5&&r.push(1e-5),o>6&&r.push(1e-6),o>7&&r.push(1e-7),o>8&&r.push(1e-8),o>9&&r.push(1e-9)),r}function a(){const{layer:e}=s.s,i=(0,s.j)(e);let t=1e10;return i.classBreakInfos.forEach((e=>{t=Math.min(t,d(e.minValue)),t=Math.min(t,d(e.maxValue))})),t}function n(e){let i=1;for(;Math.round(e*i)/i!==e;)i*=10;return Math.log(i)/Math.LN10}function d(e){let i=1e-8;for(;u(Math.round(e/i)*i)===e;)i*=10;return i/10}function u(e){return parseFloat(e.toPrecision(12))}function h(e){var i,t,s,l,r,a,d,h;let m=0;e.forEach((e=>{(0,o.i)(e.value)?m=Math.max(n(u(e.value)),m):((0,o.i)(e.minValue)&&(m=Math.max(n(u(e.minValue)),m)),(0,o.i)(e.maxValue)&&(m=Math.max(n(u(e.maxValue)),m)),(0,o.i)(e.min)&&(m=Math.max(n(u(e.min)),m)),(0,o.i)(e.max)&&(m=Math.max(n(u(e.max)),m)))})),m=Math.min(m,3);const c=e[0],p=e[e.length-1],g=Math.min(null!==(t=null!==(i=c.minValue)&&void 0!==i?i:c.min)&&void 0!==t?t:c.value,null!==(l=null!==(s=p.minValue)&&void 0!==s?s:p.min)&&void 0!==l?l:p.value),S=Math.max(null!==(a=null!==(r=c.maxValue)&&void 0!==r?r:c.max)&&void 0!==a?a:c.value,null!==(h=null!==(d=p.maxValue)&&void 0!==d?d:p.max)&&void 0!==h?h:p.value)-g;return S/e.length<2e-7?m=8:S/e.length<2e-6?m=7:S/e.length<2e-5?m=6:S/e.length<2e-4?m=5:S/e.length<.002?m=4:S/e.length<.02?m=3:S/e.length<.2?m=Math.max(m,2):S/e.length<2&&(m=Math.max(m,1)),Math.round(m)}},99258:(e,i,t)=>{t.d(i,{b:()=>o,u:()=>l});var s=t(59503);function o(e,i,t,s,o){const l=(null==e?void 0:e.length)?a(e,i.bins[s]):r(e.stops,i.bins[s]);l&&o.setAttribute("fill",l.toHex()),l&&o.setAttribute("opacity",`${Math.max(l.a,.2)}`),t.push(o)}function l(e,i,t,s){null==i||i.forEach(((i,o)=>{const l=(s||e.histogramConfig).bins[o],n=e.breaks?a(t||e.breaks,l):r((t||e).stops,l);n&&i.setAttribute("fill",n.toHex()),n&&i.setAttribute("opacity",`${Math.max(n.a,.2)}`)}))}function r(e,i){const{modules:t}=s.s;if(!i)return;const o=(i.maxValue-i.minValue)/2+i.minValue;let l=e[0],r=e[e.length-1];const a=l.value,n=r.value;if(o<a)return l.color;if(o>n)return r.color;const d=e.filter((e=>e.value===o));if(d.length>0)return d[0].color;l=null,r=null,e.forEach(((i,t)=>{!l&&!r&&i.value>=o&&(l=e[t-1],r=i)}));const u=(o-l.value)/(r.value-l.value);return t.esriColor.blendColors(l.color,r.color,u)}function a(e,i){if(!i)return;const t=(i.maxValue-i.minValue)/2+i.minValue;let s=e[0],o=e[e.length-1];if(t<s.min||t>o.max)return;const l=e.filter((e=>e.min===t));return l.length>0?l[0].color:(s=e[e.length-1],o=null,e.forEach(((i,l)=>{!o&&i.min>=t&&(s=e[l-1],o=i)})),s.color)}t(21104),t(2137)}}]);