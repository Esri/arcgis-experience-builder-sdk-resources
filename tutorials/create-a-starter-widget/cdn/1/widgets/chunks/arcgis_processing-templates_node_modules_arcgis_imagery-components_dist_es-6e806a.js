/*! For license information please see arcgis_processing-templates_node_modules_arcgis_imagery-components_dist_es-6e806a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_processing-templates_node_modules_arcgis_imagery-components_dist_es-6e806a"],{93979:(e,t,i)=>{i.r(t),i.d(t,{arcgis_imagery_multidimensional_info:()=>c});var s=i(41126),n=i(76589),a=i(14886),r=i(67455),o=i(20353);const l="imageryMultidimensionalInfoTipDismissed",c=class{constructor(e){(0,s.r)(this,e),this.manager=(0,a.u)(this),this.filterItems=[],this.showFilterLength=10,this.showRawSourceInfo=!1,this.layer=void 0,this.open=!1,this.showStatistics=!1,this.multidimensionalInfo=void 0,this.selectedVariableNames=[],this.messages=(0,o.u)({blocking:!0})}watchLayer(e){this.closePopover(),this.multidimensionalInfo=void 0,this.selectedVariableNames=[],this.initLayer(e)}async componentWillLoad(){this.initLayer(this.layer)}disconnectedCallback(){this.closePopover()}async done(){this.closePopover()}render(){const{layer:e,multidimensionalInfo:t,messages:i}=this;if(!t){const t=!e?.loaded;return(0,s.h)(s.H,null,(0,s.h)("calcite-block",{class:"info",heading:i.multidimensionalInfo.info,collapsible:!0,open:!!this.open,loading:t},t?(0,s.h)("calcite-loader",{class:"loader",label:"",type:"indeterminate"}):(0,s.h)("div",null,i.general.unsupported)))}const{variables:n}=t;n.forEach((({dimensions:e})=>e.forEach((e=>{}))));const a=this.showRawSourceInfo&&!(0,r.g)(l);return(0,s.h)(s.H,null,(0,s.h)("calcite-block",{class:"info",heading:i.multidimensionalInfo.info,collapsible:!0,open:!!this.open,onCalciteBlockClose:()=>this.closePopover()},a&&this.renderNotice(),this.renderVariableSelect(),(0,s.h)("slot",null)))}renderNotice(){return(0,s.h)("calcite-notice",{open:!0,closable:!0,icon:!0,scale:"s",class:"notice",onCalciteNoticeClose:()=>(0,r.s)(l,!0)},(0,s.h)("div",{slot:"message"}," ",this.messages.multidimensionalInfo.tip))}renderVariableFilter(){const{messages:e}=this;return(0,s.h)("calcite-filter",{items:this.filterItems,messageOverrides:this.filterMessages,placeholder:e.multidimensionalInfo.searchVariables,onCalciteFilterChange:e=>{const t=e.target.filteredItems;this.selectedVariableNames=t.map((({name:e})=>e))}})}renderVariableSelect(){const{variables:e}=this.multidimensionalInfo,{serviceRasterInfo:t}=this.layer,i=(t?.keyProperties).DefaultVariable??e[0].name,n=[];e.forEach((({dimensions:e})=>e.forEach((e=>{n.some((t=>t.name===e.name))||n.push(e)}))));const{multidimensionalInfo:a}=this.messages,r=n.map((({name:e,values:t})=>{const i="StdTime"===e?a.timeValues:"StdZ"===e?a.zValues:a.generalValues.replace("${dimensionName}",e),s=t?.length;return s?`${i}: ${s}`:i})).join("; "),o=this.selectedVariableNames?.length?e.filter((({name:e})=>this.selectedVariableNames.includes(e))):e;return(0,s.h)("div",{ref:e=>this.variableEl=e},(0,s.h)("calcite-label",null,`${a.variables}: ${e.length}; ${r}`),e.length>=this.showFilterLength&&this.renderVariableFilter(),(0,s.h)("calcite-list",{label:a.variables},o.map((e=>this.renderVariableListItem(e,e.name===i)))))}renderVariableListItem(e,t){const{name:i,unit:n,description:a}=e,r=n?`${i} (${n})`:i,{general:o}=this.messages;return(0,s.h)("calcite-list-item",{label:r,description:a??"",key:i,onClick:()=>this.renderPickListPopover(e)},(0,s.h)("calcite-action",{icon:"information",scale:"s",text:o.close,slot:"actions-start",onClick:()=>this.renderPickListPopover(e)}),t?(0,s.h)("calcite-chip",{slot:"actions-end",label:o.default},(0,s.h)("span",{class:"default-variable"},o.default)):null)}renderPickListPopover(e){if(this.popOver)return this.popOver.variableInfo=e,void this.popOver.setFocus("dismiss-button");const t=document.createElement("arcgis-imagery-multidimensional-variable-info");t.variableInfo=e,t.showStatistics=this.showStatistics,t.messages=this.messages;let i=0;this.variableEl&&(i=this.variableEl.getBoundingClientRect().top-this.el.getBoundingClientRect().top),t.popoverProps={refElement:this.el,placement:"leading-start",offsetDistance:0,offsetSkidding:i,popoverWidth:300},t.addEventListener("arcgisClose",(()=>{this.closePopover()})),document.body.appendChild(t),t.componentOnReady().then((()=>{requestAnimationFrame((()=>{t.setFocus("dismiss-button")}))})),this.popOver=t}closePopover(){this.popOver&&(document.body.removeChild(this.popOver),this.popOver=void 0)}async initLayer(e){e&&(e.loaded||await e.load(),this.multidimensionalInfo=await(0,n.g)(e,this.showRawSourceInfo),this.multidimensionalInfo&&(this.filterItems=this.multidimensionalInfo.variables.map((({name:e,dimensions:t})=>({name:e,dimensionNames:t.map((e=>e.name))})))),this.filterMessages={clear:this.messages.general.clear,label:this.messages.multidimensionalInfo.searchVariables})}static get assetsDirs(){return["assets"]}get el(){return(0,s.g)(this)}static get watchers(){return{layer:["watchLayer"]}}};c.style=":host{display:flex;flex:1 1 auto}.info{width:100%}.default-variable{font-size:var(--calcite-font-size--2)}.notice{margin-bottom:10px}"},76589:(e,t,i)=>{i.d(t,{a:()=>g,b:()=>c,c:()=>l,d:()=>m,e:()=>f,f:()=>o,g:()=>h,h:()=>n,i:()=>u,m:()=>s,u:()=>d});const s=10.9,n=Number.MAX_VALUE-1;function a(e,t){const i=new Date(e),{useFriendlyIsoFormat:s,intl:n,format:a}=t;if(s&&n)return n.formatDate(i,{...n.convertDateFormatToIntlOptions(a??"short-date-long-time"),timeZone:"UTC"});let r=new Date(e).toISOString();return r=`${r.slice(0,r.indexOf("."))}Z`,r}function r(e,t,i="long"){const s=new Date(2022,9,10);return s.setMonth(e-1),t.formatDate(s,{month:i})}function o(e,t,i={}){if(null==e)return"";const{intl:s,useRecurringTimeLabel:n}=i;if(n&&s&&!Array.isArray(e)){const i=t.unit?.toLowerCase().trim(),n=function(e){return"StdTime"===e.name&&!!e.recurring}(t)&&("months"===i||"quarters"===i);if(n)return"months"===i?r(e,s):function(e,t){return`${r(3*(e-1)+1,t,"short")} - ${r(3*e,t,"short")}`}(e,s)}const o=t.values?.[t.values.length-1];if(i.useStartOrEndForRangedValue&&Array.isArray(e)&&2===e.length&&Array.isArray(o)){const t=e.join("-")===o.join("-");e=t?e[1]:e[0]}if(!u(t))return Array.isArray(e)?e.map((e=>s?.formatNumber(e)??String(e))).join(" - "):s?.formatNumber(e)??String(e);if(i.useFriendlyIsoFormat&&!i.format){const e=function(e){let t=e.intervalUnit?.toLowerCase().trim()??"";const{extent:i}=e,s=e.interval??0,n=e.values?.length;if(!["years","months","days","hours"].includes(t)&&i?.length&&n){const e=(i[1]-i[0])/n,s=864e5;t=e>=365*s?"years":e>=28*s?"months":t}switch(t){case"months":t=s>11?"years":t;break;case"days":t=s>364?"years":s>27?"months":t;break;case"hours":t="days"}return"years"===t?"year":"months"===t?"short-month-year":"short-date"}(t);i={format:e,...i}}return Array.isArray(e)?e.map((e=>a(e,i))).join(" - "):a(e,i)}function l(e,t){const i=t?.dimensions?.find((({name:t})=>t===e.name));if(!i?.extent)return e;const s=[...i.extent],{values:n}=e;if(n?.length){const t=n.filter((e=>Array.isArray(e)?null==s[1]||s[0]===s[1]?e[0]===s[0]:e[0]>=s[0]&&e[0]<=s[1]&&e[1]>=s[0]&&e[1]<=s[1]:e>=s[0]&&e<=s[1]));if(0===t.length){const e=n[n.length-1];Array.isArray(e)&&e[1]===s[0]&&t.push(e)}return{...e,extent:s,values:t}}return{...e,extent:s}}function c(e){const{values:t,extent:i,name:s}=e;let n=t?.[0]??i?.[0];return"stdz"===s.toLowerCase()&&!e.hasRanges&&i&&Math.abs(i[1])<=Math.abs(i[0])&&(n=t?.length?t[t.length-1]:i[1]),n}function m(e){return"imagery-tile"===e.type||"wcs"===e.type?e.multidimensionalDefinition:(e.mosaicRule??e.defaultMosaicRule)?.multidimensionalDefinition}async function h(e,t=!1){if("imagery-tile"===e.type||"wcs"===e.type)return e.serviceRasterInfo?.multidimensionalInfo;const{rasterFunction:i,version:n}=e;if(t||n<=s||!i||"none"===i.functionName?.toLowerCase())return e.serviceRasterInfo.multidimensionalInfo;return(await e.generateRasterInfo(e.rasterFunction).catch((()=>e.serviceRasterInfo))).multidimensionalInfo}function u(e,t=!1){return"StdTime"===e.name&&(t||!e.recurring)}function d(e,t,i){t=l(t,i);const s=o(e.values[0],t),n=t.values?.some((e=>s===o(e,t)));if(!n){const i=c(t);e.values=null!=i?[i]:[]}}function f(e){return Array.isArray(e[0])}function g(e){return e.variables.map((({name:e,unit:t,description:i})=>({name:e,label:t?`${e} (${t})`:e,description:i})))}},67455:(e,t,i)=>{i.d(t,{g:()=>r,r:()=>a,s:()=>n});const s="arcgisImageryComponents";function n(e,t){const i=o();i[e]=t,function(e){const t=JSON.stringify(e);"{}"===t?localStorage.removeItem(s):localStorage.setItem(s,t)}(i)}function a(e){n(e,void 0)}function r(e){return o()[e]}function o(){const e=localStorage.getItem(s);return e?JSON.parse(e):{}}},20353:(e,t,i)=>{i.d(t,{u:()=>a});var s=i(14886),n=i(41126);const a=(0,s.m)(n.a)}}]);