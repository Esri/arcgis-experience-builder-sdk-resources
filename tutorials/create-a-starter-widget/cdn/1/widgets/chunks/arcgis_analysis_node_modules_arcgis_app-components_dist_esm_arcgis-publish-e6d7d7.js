/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-publish-e6d7d7.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-publish-e6d7d7"],{82669:(e,t,s)=>{s.d(t,{a:()=>r,b:()=>a,c:()=>i,d:()=>n});const n=(0,s(23505).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),r=n.state,i=n.state,a=n.state},88431:(e,t,s)=>{s.r(t),s.d(t,{arcgis_publish_item:()=>c});var n=s(35110),r=s(46710),i=s(1984),a=s(12856),o=s(7803),l=s(64510);s(23505),s(63280),s(86587),s(21104),s(73838),s(70392),s(91659),s(56086),s(66913),s(91306),s(82669),s(84873),s(17752);const c=class{constructor(e){(0,n.r)(this,e),this.portal=void 0,this.user=void 0,this.api=4,this.scale="m",this.itemId=void 0,this.telemetry=void 0,this.primaryButtonText=void 0,this.firstPage={element:"arcgis-publish-item-pages-item-properties"}}handlePageUpdate(e){this.primaryButtonText=l.p.i18n.next,"arcgis-publish-item-pages-item-properties"===e.detail.element&&(this.primaryButtonText=l.p.i18n.publish)}async componentWillLoad(){const{portal:e,user:t,itemId:s,api:n,scale:c}=this,u=await(0,i.g)(this.el);l.p.i18n=Object.assign(Object.assign({},o.w.i18n),u[0]),r.c.portal=e,r.c.user=t,r.c.api=n,r.c.scale=c;const{result:p,error:d}=await(0,a.a)(s,e);d?console.warn("No item found, workflow unavailable"):l.p.sourceItem=p}componentDidLoad(){l.p.sourceItem&&this.routeFirstPage(l.p.sourceItem.type)}routeFirstPage(e){const{i18n:t}=l.p;["CSV","Microsoft Excel","GeoJson"].includes(e)?(this.firstPage={element:"arcgis-publish-item-pages-item-properties"},this.primaryButtonText=t.next):(this.firstPage={element:"arcgis-publish-item-pages-item-properties",props:{item:l.p.sourceItem}},this.primaryButtonText=t.publish)}render(){const{i18n:e}=l.p;return(0,n.h)(n.H,null,(0,n.h)("arcgis-workflow",{headerText:e.publishItem,primaryButtonText:this.primaryButtonText,firstPage:this.firstPage,onArcgisWorkflowUpdatePage:this.handlePageUpdate}))}get el(){return(0,n.d)(this)}}},64209:(e,t,s)=>{s.d(t,{a:()=>r,f:()=>i,s:()=>o});var n=s(88703);const r=e=>(null==e?void 0:e.replace(/(\s+|:)/g,"_"))||"",i=e=>{const t=e=>e.split(",").map((e=>e.trim())).filter((e=>e));return e?"string"==typeof e?(0,n.b)(t(e)):(0,n.b)(e.flatMap((e=>[...t(e)]))):[]},a=async e=>new Promise(((t,s)=>{for(let n=0;n<e.length;n++)e[n].then((s=>{const r=[...e];r.splice(n,1),t({remainingPromises:r,result:s})})).catch(s)}));async function o(e,t){var s,n;const r=[],{getBatchSize:i,onPromiseCompleted:o,onPromiseThrow:l,shouldContinue:c}=null!=t?t:{};let u=[];for(let t=0;t<(null!==(s=null==i?void 0:i())&&void 0!==s?s:1);t++)try{const t=e();t&&u.push(t)}catch(e){null==l||l(e)}let p=null;for(;u.length>0&&(!c||c(p));)try{const{remainingPromises:t,result:s}=await a(u);u=t,p=s,s&&r.push(s),null==o||o(s);const l=null!==(n=null==i?void 0:i())&&void 0!==n?n:1;for(;u.length<l;){const t=e();if(t&&u.push(t),null==t)break}}catch(e){null==l||l(e)}return r}},91306:(e,t,s)=>{s.d(t,{a:()=>n,i:()=>r});const n=(0,s(23505).c)({title:"",snippet:"",tags:[],categories:[]}),r=n.state},12856:(e,t,s)=>{s.d(t,{a:()=>y,b:()=>U,c:()=>k,d:()=>v,e:()=>w,f:()=>d,g:()=>h,h:()=>m,i:()=>g,j:()=>j,k:()=>f,l:()=>P,m:()=>b,n:()=>x,s:()=>I,u:()=>$});var n=s(70392),r=s(46710),i=s(91659),a=s(66913),o=s(91306),l=s(82669),c=s(84873),u=s(64209),p=s(17752);function d({title:e,snippet:t,tags:s}){return{title:e,snippet:t,tags:(0,u.f)(s).join(",")}}const m=(e,t,s)=>{var n,r;const{file:i,type:a,extension:o,dataUrl:l,properties:c,typeKeywords:u,existingItem:m}=t,g=d(e);if(s){const e=m;g.title=(null===(n=null==e?void 0:e.sourceData)||void 0===n?void 0:n.title)||e.title||g.title||""}const f=[...null===(r=p.a[a])||void 0===r?void 0:r.typeKeywords,...u?[u]:[],o].join(", "),h=Object.assign({type:a,extension:o},c?{properties:JSON.stringify(c)}:{}),y=i?{file:i}:{dataUrl:l.includes('httpHeaders={"Authorization"')?l:encodeURI(l)};return Object.assign(Object.assign(Object.assign(Object.assign({},h),y),g),{typeKeywords:f})},g=(e,t,s)=>{const n=!!s,r=!!t.addAsUniqueFile,i=m(e,t,n),a=new FormData;return a.append("f","json"),a.append("async","true"),Object.keys(i).forEach((e=>{if(r&&"file"===e){const s=t.fileName;a.append(e,i[e],s)}else a.append(e,i[e])})),a},f=(e,t)=>{const s=(null==t?void 0:t.id)&&!function(e){return["all","recycle"].includes(e.id)||e.id===e.username}(t)?`/${t.id}`:"";return`${e.userContentUrl}${s}/addItem`},h=(e,t)=>`${(0,n.g)(t)}content/items/${e}`,y=async(e,t)=>{try{const s=h(e,t);return{result:await(0,a.r)(s)}}catch(e){return console.warn("error getting item",e),{error:{code:"unhandledError"}}}},w=async(e,t)=>{const s=new FormData;switch(t.type){case"base64":s.append("data",t.data);break;case"url":s.append("url",t.url);break;case"file":s.append("file",t.file)}return s.append("f","json"),s.append("token",(0,a.g)(r.c.portal)),await(0,a.a)(`${(0,n.g)()}content/users/${r.c.user.username}/items/${e}/updateThumbnail`,s,{},"post")};async function b(e,t){const s=`${r.c.user.userContentUrl}/moveItems`;return await(0,a.r)(s,{items:e,folder:t},{},"post")}async function v(e,{permanentDelete:t=!1}={}){const s=`${r.c.user.userContentUrl}/items/${e}/delete`;return await(0,a.r)(s,{permanentDelete:t},{},"post")}async function $(e,t,s){var n;const i=null!==(n=null!=s?s:r.c.user)&&void 0!==n?n:r.c.portal.user,o=`${"append"===c.u.workflow?l.a.existingItem.itemOwner.userContentUrl:i.userContentUrl}/items/${e}/update`;return(0,a.r)(o,t,{},"post")}const x=(e,t)=>{const s=`${(0,n.g)(t)}content/items/${e}/data`;return(0,a.r)(s)},j=async(e,t,s)=>{const n=`${r.c.user.userContentUrl}/items/${e}/commit`,i=g(o.i,t,!!s);return i.delete("file"),await(0,a.a)(n,i,{},"post")},P=async e=>{const t=`${r.c.user.userContentUrl}/items/${e}/cancel`;return await(0,a.r)(t,{},{},"post")},U=async e=>{const t=f(r.c.user,o.i.folder),s=d(o.i),n=Object.assign({},e);return delete n.initialFolders,delete n.initialTitle,delete n.newItemMode,delete n.serviceInfo,delete n.allowStoredAuth,delete n.isSecured,delete n.checkAuth,delete n.agsType,delete n.developerCredentialsType,delete n.applicationEnvironment,delete n.apiKeyReferrerUrls,delete n.developerCredentialsRedirectUrls,delete n.developerPrivileges,await(0,a.r)(t,Object.assign(Object.assign(Object.assign(Object.assign({},n),(e=>e.url&&!!e.serviceInfo)(e)?{serviceInfo:JSON.stringify(e.serviceInfo)}:{}),{typeKeywords:JSON.stringify(e.typeKeywords)}),s),{},"post")};async function I(e,t,s,o,l,c){null!=l||(l=r.c.user),null!=c||(c=r.c.portal);const u=s&&s.id!==l.username?s.id:"root",p=e.replace(`.${o}`,"");if("featurecollection"===o||"Microsoft Excel"===t)return null;const d=[`title: "${p}"`,`type: "${t}"`,`owner: "${l.username}"`,`ownerfolder: "${u}"`],m=await(0,a.r)(`${(0,n.g)(c)}search`,{filter:d.join(" AND "),num:1});return(null==m?void 0:m.total)>0?{num:m.num,itemURLList:m.results.map((e=>(0,i.g)(e.id,r.c.config.baseUrl)))}:null}async function k(e,t){const s=(0,u.a)(e),{user:l,config:c,portal:p}=r.c,{folder:d}=o.i,m=d&&d.id!==l.username?d.id:"root",g=[`owner: "${l.username}"`,`ownerfolder: "${m}"`];t&&g.push(`type: "${t}"`);let f,h=1;for(let e=0;e<10&&!f&&h>-1;e++){const{nextStart:e,results:t}=await(0,a.r)(`${(0,n.g)()}search`,{[p.isPortal?"q":"filter"]:g.join(" AND "),num:100,start:h});f=t.find((e=>e.name===s)),h=e}return f?(0,i.g)(f.id,c.baseUrl):null}},7803:(e,t,s)=>{s.d(t,{w:()=>n});const n=(0,s(23505).c)({portal:null,user:null,i18n:null,scale:"m",api:4,nextText:null,uploadProgress:0}).state},64510:(e,t,s)=>{s.d(t,{p:()=>n});const n=(0,s(23505).c)({sourceItem:null,i18n:null}).state},84873:(e,t,s)=>{s.d(t,{a:()=>n,u:()=>r});const n=(0,s(23505).c)({nextText:"next",workflow:"content",scale:"m",disableScroll:!1,featureFlags:{}}),r=n.state}}]);