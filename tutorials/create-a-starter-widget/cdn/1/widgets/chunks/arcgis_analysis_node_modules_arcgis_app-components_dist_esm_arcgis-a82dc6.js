/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a82dc6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a82dc6"],{84154:(e,i,t)=>{t.r(i),t.d(i,{arcgis_raster_multidimensional_info:()=>l});var n=t(35110),s=t(1984),a=t(6859),o=t(68558);t(63280),t(86587),t(21104),t(73838),t(89393),t(2137);const l=class{constructor(e){(0,n.r)(this,e),this.keepActiveDimension=!0,this.showFilterLength=10,this.showRawSourceInfo=!0,this.layer=void 0,this.open=!0,this.showStatistics=!1,this.useTable=!0,this.multidimensionalInfo=void 0,this.selectedVariableNames=[]}watchLayer(e,i){this.closePopover(),this.multidimensionalInfo=null,this.selectedVariableNames=[],this.initLayer(e)}async componentWillLoad(){[this.strings]=await(0,s.g)(this.hostElement),this.initLayer(this.layer)}disconnectedCallback(){this.closePopover()}async done(){this.closePopover()}render(){var e,i,t;const{layer:s,multidimensionalInfo:a,strings:l}=this;if(!a){const e=!(null==s?void 0:s.loaded);return(0,n.h)(n.H,null,(0,n.h)("calcite-block",{class:"info",heading:l.multidimensionalInfo.info,collapsible:!0,open:!!this.open,loading:e},e?(0,n.h)("div",{class:"info-content"}):(0,n.h)("div",null,l.general.unsupported)))}const{variables:r}=a,c=null!==(i=null===(e=("imagery"===s.type?s.serviceRasterInfo:s.rasterInfo).keyProperties)||void 0===e?void 0:e.DefaultVariable)&&void 0!==i?i:r[0].name,d=[];r.forEach((({dimensions:e})=>e.forEach((e=>{d.some((i=>i.name===e.name))||d.push(e)}))));const m=d.map((({name:e,values:i})=>{const t="StdTime"===e?l.multidimensionalInfo.timeValues:"StdZ"===e?l.multidimensionalInfo.zValues:l.multidimensionalInfo.generalValues.replace("${dimensionName}",e),n=null==i?void 0:i.length;return n?`${t}: ${n}`:t})).join("; "),u=r.map((({name:e,dimensions:i})=>({name:e,dimensionNames:i.map((e=>e.name))}))),h=(null===(t=this.selectedVariableNames)||void 0===t?void 0:t.length)?r.filter((({name:e})=>this.selectedVariableNames.includes(e))):r,v=r.length>=this.showFilterLength&&(0,n.h)("calcite-filter",{items:u,messageOverrides:{clear:l.general.clear,label:l.multidimensionalInfo.searchVariables},placeholder:l.multidimensionalInfo.searchVariables,onCalciteFilterChange:e=>{const i=e.target.filteredItems;this.selectedVariableNames=i.map((({name:e})=>e))}}),f=(0,n.h)("div",{ref:e=>this.variableEL=e},(0,n.h)("calcite-label",null,`${l.multidimensionalInfo.variables}: ${r.length}; ${m}`),v,(0,n.h)("calcite-list",null,h.map((e=>this.renderVariableListItem(e,e.name===c))))),I=!(0,o.g)(o.l.ARCGIS_COMPONENT_NOTIFICATIONS,o.a.MULTIDIMENSIONAL_INFO_TIP_DISMISSED)&&(0,n.h)("calcite-notice",{open:!0,closable:!0,icon:!0,scale:"s",class:"notice",onCalciteNoticeClose:()=>{(0,o.s)(o.l.ARCGIS_COMPONENT_NOTIFICATIONS,{key:o.a.MULTIDIMENSIONAL_INFO_TIP_DISMISSED,value:"true"})}},(0,n.h)("div",{slot:"message"}," ",l.multidimensionalInfo.tip));return(0,n.h)(n.H,null,(0,n.h)("calcite-block",{class:"info",heading:l.multidimensionalInfo.info,collapsible:!0,open:!!this.open,onCalciteBlockToggle:e=>!e.target.open&&this.closePopover()},I,f,(0,n.h)("slot",null)))}renderVariableListItem(e,i){const{name:t,unit:s,description:a}=e,o=s?`${t} (${s})`:`${t}`;return(0,n.h)("calcite-list-item",{label:o,description:a,key:t,onClick:()=>this.renderPickListPopover(e)},(0,n.h)("calcite-action",{icon:"information",scale:"s",text:this.strings.general.close,slot:"actions-start",onClick:()=>this.renderPickListPopover(e)}),i?(0,n.h)("calcite-chip",{slot:"actions-end",value:void 0},(0,n.h)("span",{class:"default-variable"},this.strings.general.default)):null)}renderPickListPopover(e){if(this.popOver)return this.popOver.keepActiveDimension=this.keepActiveDimension,this.popOver.variableInfo=e,void this.popOver.setFocus("dismiss-button");const i=document.createElement("arcgis-raster-multidimensional-variable-info");i.keepActiveDimension=this.keepActiveDimension,i.variableInfo=e,i.showStatistics=this.showStatistics,i.useTable=this.useTable,i.strings=this.strings;let t=0;this.variableEL&&(t=this.variableEL.getBoundingClientRect().top-this.hostElement.getBoundingClientRect().top),i.popoverProps={refElement:this.hostElement,placement:"leading-start",offsetDistance:0,offsetSkidding:t,popoverWidth:100},i.addEventListener("arcgisRasterMultidimensionalVariableInfoDismiss",(e=>{this.closePopover()})),document.body.appendChild(i),i.componentOnReady().then((()=>{requestAnimationFrame((()=>i.setFocus("dismiss-button")))})),this.popOver=i}closePopover(){this.popOver&&(document.body.removeChild(this.popOver),this.popOver=null)}async initLayer(e){e&&(e.loaded||await e.load(),this.multidimensionalInfo=await(0,a.a)(e,this.showRawSourceInfo))}get hostElement(){return(0,n.d)(this)}static get watchers(){return{layer:["watchLayer"]}}};l.style=":host{display:flex;flex:1 1 auto}.info{width:100%}.info-content{height:var(--calcite-loader-size, 64px)}.default-variable{font-size:var(--calcite-font-size--2)}.notice{margin-bottom:10px}"},68558:(e,i,t)=>{var n,s;t.d(i,{a:()=>s,g:()=>l,l:()=>n,s:()=>o}),function(e){e.ARCGIS_COMPONENT_NOTIFICATIONS="arcgisComponent_notifications"}(n||(n={})),function(e){e.FEATURE_REDUCTION_WARNING_DISMISSED="arcgis_feature_reduction_warning_dismissed",e.POPUP_WARNING_DISMISSED="arcgis_popup_warning_dismissed",e.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED="arcgis_symbol_styler_incompatible_vector_symbols_dismissed",e.EFFECTS_TIP_DISMISSED="arcgis_effects_tip_dismissed",e.LAYER_VIEW_DEFINITION_DISMISSED="arcgis_layer_view_definition_dismissed",e.LAYER_OVERRIDE_STATUS_TIP_DISMISSED="arcgis_layer_override_status_tip_dismissed",e.SMART_MAPPING_TIP1_DISMISSED="arcgis_smart_mapping_tip1_dismissed",e.SMART_MAPPING_TIP2_DISMISSED="arcgis_smart_mapping_tip2_dismissed",e.LAYER_VIEW_JOIN_TIP_DISMISSED="arcgis_layer_view_join_tip_dismissed",e.MULTIDIMENSIONAL_INFO_TIP_DISMISSED="arcgis_multidimensional_info_tip_dismissed"}(s||(s={}));const a=e=>JSON.parse((e=>localStorage.getItem(e))(e))||{},o=(e,i)=>{const t=a(e);t[i.key]=i.value,((e,i)=>{localStorage.setItem(e,i)})(e,JSON.stringify(t))},l=(e,i)=>{const t=a(e);return(null==t?void 0:t.hasOwnProperty(i))?t[i]:null}},6859:(e,i,t)=>{t.d(i,{a:()=>m,b:()=>c,c:()=>d,f:()=>l,g:()=>r,i:()=>u,m:()=>s,u:()=>h});var n=t(89393);const s=10.9;function a(e,i){const t=new Date(e),{useFriendlyISOFormat:n,intl:s,format:a}=i;if(n&&s)return s.formatDate(t,Object.assign(Object.assign({},s.convertDateFormatToIntlOptions(null!=a?a:"short-date-long-time")),{timeZone:"UTC"}));let o=new Date(e).toISOString();return o=o.slice(0,o.indexOf("."))+"Z",o}function o(e,i,t="long"){const n=new Date(2022,9,10);return n.setMonth(e-1),i.formatDate(n,{month:t})}function l(e,i,t={}){var n,s,l,r;if(null==e)return"";const{intl:c,useRecurringTimeLabel:d}=t;if(d&&c&&!Array.isArray(e)){const t=null===(n=i.intervalUnit)||void 0===n?void 0:n.toLowerCase().trim(),s=function(e){return"StdTime"===e.name&&!!e.recurring}(i)&&("months"===t||"quarters"===t);if(s)return"months"===t?o(e,c):function(e,i){return`${o(3*(e-1)+1,i,"short")} - ${o(3*e,i,"short")}`}(e,c)}const m=null===(s=i.values)||void 0===s?void 0:s[i.values.length-1];if(t.useStartOrEndForRangedValue&&Array.isArray(e)&&2===e.length&&Array.isArray(m)){const i=e.join("-")===m.join("-");e=i?e[1]:e[0]}if(!u(i))return Array.isArray(e)?e.map((e=>{var i;return null!==(i=null==c?void 0:c.formatNumber(e))&&void 0!==i?i:String(e)})).join(" - "):null!==(l=null==c?void 0:c.formatNumber(e))&&void 0!==l?l:String(e);if(t.useFriendlyISOFormat&&!t.format){let e=null===(r=i.intervalUnit)||void 0===r?void 0:r.toLowerCase().trim(),{interval:n,extent:s}=i;if("months"===e?n>11&&(e="year"):"days"===e?n>364?e="year":n>27&&(e="months"):"hours"===e&&(e="days"),!["years","months","days"].includes(e)&&(null==s?void 0:s.length)){const t=(s[1]-s[0])/i.values.length,n=864e5;t>=365*n?e="years":t>=28*n&&(e="months")}const a="years"===e?"year":"months"===e?"short-month-year":"short-date";t=Object.assign({format:a},t)}return Array.isArray(e)?e.map((e=>a(e,t))).join(" - "):a(e,t)}function r(e,i){var t;const s=null===(t=null==i?void 0:i.dimensions)||void 0===t?void 0:t.find((({name:i})=>i===e.name));if(!(null==s?void 0:s.extent))return e;const a=[...s.extent],o=e.values.filter((e=>Array.isArray(e)?(0,n.i)(a[1])&&a[0]!==a[1]?e[0]>=a[0]&&e[0]<=a[1]&&e[1]>=a[0]&&e[1]<=a[1]:e[0]===a[0]:e>=a[0]&&e<=a[1]));if(0===o.length){const i=e.values[e.values.length-1];Array.isArray(i)&&i[1]===a[0]&&o.push(i)}return Object.assign(Object.assign({},e),{extent:a,values:o})}function c(e){var i;const{values:t,extent:n,name:s}=e;let a=null!==(i=null==t?void 0:t[0])&&void 0!==i?i:n[0];return"stdz"===s.toLowerCase()&&!e.hasRanges&&Math.abs(n[1])<=Math.abs(n[0])&&(a=(null==t?void 0:t.length)?t[t.length-1]:n[1]),a}function d(e){var i,t;return"imagery-tile"===e.type?e.multidimensionalDefinition:null===(t=null!==(i=e.mosaicRule)&&void 0!==i?i:e._defaultServiceMosaicRule)||void 0===t?void 0:t.multidimensionalDefinition}async function m(e,i){var t,n;if("imagery-tile"===e.type)return e.rasterInfo.multidimensionalInfo;const{rasterFunction:a,version:o}=e;return i||o<=s||!a||"none"===(null===(t=a.functionName)||void 0===t?void 0:t.toLowerCase())?e.serviceRasterInfo.multidimensionalInfo:(null!==(n=await e.generateRasterInfo(e.rasterFunction))&&void 0!==n?n:e.serviceRasterInfo).multidimensionalInfo}function u(e,i=!1){return"StdTime"===e.name&&(i||!e.recurring)}function h(e,i,t){i=r(i,t);const n=l(e.values[0],i);if(!i.values.some((e=>n===l(e,i)))){const t=c(i);e.values=[t]}}}}]);