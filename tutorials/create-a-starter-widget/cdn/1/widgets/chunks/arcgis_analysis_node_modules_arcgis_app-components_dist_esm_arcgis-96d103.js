/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103"],{82669:(e,t,i)=>{i.d(t,{a:()=>s,b:()=>a,c:()=>o,d:()=>r});const r=(0,i(23505).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),s=r.state,o=r.state,a=r.state},25989:(e,t,i)=>{i.r(t),i.d(t,{arcgis_categories_picker:()=>f,arcgis_folder_picker:()=>w,arcgis_item_properties:()=>y,arcgis_summary_input:()=>x,arcgis_tags_picker:()=>C,arcgis_title_input:()=>T});var r=i(35110),s=i(76338),o=i(26077),a=i(46710),l=i(88703),n=i(1984),c=i(91306),d=i(79233),h=i(6895),u=i(12856),p=i(64209),g=i(70392),m=i(66913),v=i(37526);i(75858),i(91659),i(56086),i(23505),i(63280),i(86587),i(21104),i(73838),i(82669),i(84873),i(17752);const f=class{constructor(e){(0,r.r)(this,e),this.arcgisCategoriesPickerChange=(0,r.c)(this,"arcgisCategoriesPickerChange",7),this.renderCombobox=()=>{const{i18n:e,scale:t,schema:i,label:s}=this;return(0,r.h)("calcite-combobox",{label:null!=s?s:e.categories,maxItems:5,selectionMode:"ancestors",placeholder:e.assignCategories,scale:t,ref:e=>this.combobox=e},this.renderNestedCategories(i))},this.api=void 0,this.portal=void 0,this.scale=void 0,this.label=void 0,this.hideLabel=void 0,this.categories=void 0,this.schema=[],this.rootCategoryPath=o.U}async componentWillLoad(){var e,t,i,r;const s=await(0,n.g)(this.el);this.i18n=s[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.scale)&&void 0!==t||(this.scale=a.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=a.c.api),null!==(r=this.categories)&&void 0!==r||(this.categories=c.i.categories),c.a.on("reset",(()=>{this.categories=c.i.categories}))}async componentDidLoad(){var e,t,i;const{portal:r,schema:a}=this;if(r&&!(null==a?void 0:a.length))if(r.categories)this.schema=null===(e=r.categories[0])||void 0===e?void 0:e.categories;else{const e=await(0,s.f)(r);this.schema=null===(i=null===(t=e.categorySchema)||void 0===t?void 0:t[0])||void 0===i?void 0:i.categories,this.rootCategoryPath=(0,o.g)(e.categorySchema)}}updateCategories(){this.arcgisCategoriesPickerChange.emit(this.categories)}categoriesPickerChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];(0,l.f)(r,this.categories)||(this.categories=r)}renderNestedCategories(e,t){return e.map((e=>{const i=t?`${t}/${e.title}`:`${this.rootCategoryPath}/${e.title}`;return(0,r.h)("calcite-combobox-item",{value:i,textLabel:e.title,selected:this.categories.some((e=>e===i||e.toLocaleLowerCase()===i.toLocaleLowerCase()))},e.categories&&this.renderNestedCategories(e.categories,i))}))}render(){const{i18n:e,scale:t,schema:i,hideLabel:s,label:o,renderCombobox:a}=this;return s?a():!!i&&(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:"label"},null!=o?o:e.categories),a())}get el(){return(0,r.d)(this)}static get watchers(){return{categories:["updateCategories"]}}};f.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}";const w=class{constructor(e){(0,r.r)(this,e),this.arcgisFolderPickerChange=(0,r.c)(this,"arcgisFolderPickerChange",7),this.arcgisFolderPickerLoad=(0,r.c)(this,"arcgisFolderPickerLoad",7),this.renderItem=e=>{const{id:t,username:i,title:s}=e,o=this.folders.map((e=>e.id)).includes(this.folder.id)?this.folder:this.getHomeFolder(),a="all"!==(null==o?void 0:o.id)?t===(null==o?void 0:o.id):t===i,l=t===i?"home":"folder";return this.alwaysOpen?(0,r.h)("calcite-list-item",{key:t,value:t,selected:a,class:"list-item",label:s},(0,r.h)("calcite-icon",{slot:"content-start",scale:"s",icon:l})):(0,r.h)("calcite-combobox-item",{key:t,"data-id":t,value:t,textLabel:s,selected:a,icon:l})},this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.folder=void 0,this.folders=[],this.alwaysOpen=void 0,this.newFolderActive=!1,this.emptyFilterList=!1,this.filterText=void 0,this.newFolderInput=void 0,this.createFolderText=void 0,this.showError=!1,this.errorString=void 0,this.newFolderInputElement=void 0,this.loading=!1}async componentWillLoad(){var e,t,i,r,s,o,l,d;const h=await(0,n.g)(this.el);this.i18n=h[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=a.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=a.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=a.c.api),null!==(s=this.folder)&&void 0!==s||(this.folder=null!==(l=null!==(o=c.i.folder)&&void 0!==o?o:a.c.initialFolder)&&void 0!==l?l:null===(d=this.folders)||void 0===d?void 0:d[0]),this.createFolderText=this.i18n.createNewFolder,c.a.on("reset",(()=>{var e,t,i;this.folder=null!==(t=null!==(e=c.i.folder)&&void 0!==e?e:a.c.initialFolder)&&void 0!==t?t:null===(i=this.folders)||void 0===i?void 0:i[0]}))}async componentDidLoad(){this.folders.length||await this.loadFolders(this.user)}async handleUserChange(e,t){t&&e.username!==t.username&&(await this.loadFolders(e),this.folder=this.getHomeFolder())}handleFolderChange(){this.arcgisFolderPickerChange.emit(this.folder)}async loadFolders(e){var t;this.loading=!0,this.folders=await(0,d.g)(e),this.arcgisFolderPickerLoad.emit([...this.folders]),(null===(t=this.folder)||void 0===t?void 0:t.id)||(this.folder=this.getHomeFolder()),this.loading=!1}getHomeFolder(){return this.folders.find((e=>e.title===e.id))}setNewFolderActive(){var e;null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),this.newFolderInputElement||(this.showError=!1,this.newFolderInput="")}checkForEmptySuggestions(e){var t,i;e.stopPropagation();const r=this.comboboxElement.shadowRoot.querySelector("input").value,{i18n:s}=this;this.emptyFilterList=(null===(t=this.comboboxElement.filteredItems)||void 0===t?void 0:t.length)<=1&&""!==r.trim(),this.createFolderText=this.emptyFilterList?s.noFoldersFoundCreate.replace("${folder}",r):s.createNewFolder,this.filterText=r,null===(i=this.createItem)||void 0===i||i.removeAttribute("hidden")}handleComboboxChange(e){var t,i,r;e.stopPropagation();const s=null===(t=this.comboboxElement)||void 0===t?void 0:t.value;if("create-folder"===s)return this.showError=!1,void(this.emptyFilterList?this.createNewFolder(this.filterText):this.newFolderActive=!0);this.folder=null!==(r=null!==(i=this.folders.find((e=>e.id===s)))&&void 0!==i?i:this.folder)&&void 0!==r?r:this.getHomeFolder()}handleListChange(e){var t,i,r,s,o;e.stopPropagation();const a=null===(r=null===(i=null===(t=this.listElement)||void 0===t?void 0:t.selectedItems)||void 0===i?void 0:i[0])||void 0===r?void 0:r.value;this.folder=null!==(o=null!==(s=this.folders.find((e=>e.id===a)))&&void 0!==s?s:this.folder)&&void 0!==o?o:this.getHomeFolder()}closeNewFolderInput(e){e.stopPropagation(),this.newFolderActive=!1}async saveActiveFolder(){if(!this.newFolderActive)return!0;try{await this.createNewFolder(this.newFolderInput)}catch(e){return this.errorString}return!this.showError}async setFocus(){this.comboboxElement&&(this.comboboxElement.setFocus(),this.comboboxElement.open=!0)}getFolderNameError(e){var t;const{i18n:i}=this,r=(0,h.g)(e,this.folders);return!!r&&(null===(t=i.error[r])||void 0===t?void 0:t.replace("${folder}",e))}async createNewFolder(e){var t,i;const r=(null==e?void 0:e.trim())||"",s=this.getFolderNameError(r);if(s)throw this.errorString=s,this.showError=!0,new Error;try{const{result:e}=await(0,d.c)(r,this.user);this.folder=null==e?void 0:e.folder,this.folders=[this.folder,...this.folders],a.c.folders=this.folders,this.newFolderActive=!1,this.showError=!1,await(0,l.t)(100);const s=null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector(`calcite-combobox-item[data-id="${null===(i=this.folder)||void 0===i?void 0:i.id}"]`);s&&(this.createItem&&(this.createItem.selected=!1),s.selected=!0)}catch(e){throw this.errorString=e.message,this.showError=!0,e}}renderError(){const{scale:e}=this;return(0,r.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError,scale:e},this.errorString)}renderNewFolder(){const{i18n:e,scale:t}=this;return(0,r.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{var e;try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(t){throw null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),t}},scale:t},(0,r.h)("calcite-input",{placeholder:e.enterFolder,value:this.newFolderInput,maxLength:250,scale:t,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:async e=>{var t;switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(e){null===(t=this.newFolderInputElement)||void 0===t||t.setFocus()}break;case"Escape":this.newFolderActive=!1,this.showError=!1}},ref:e=>this.newFolderInputElement=e,status:this.showError?"invalid":"idle"}))}renderCombobox(){var e;const{i18n:t,scale:i}=this;return(0,r.h)("calcite-label",{scale:i,class:"input-height"},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.folder),(0,r.h)("div",null,this.newFolderActive?this.renderNewFolder():(0,r.h)("div",{class:"combobox-wrapper"},this.loading&&(0,r.h)("calcite-progress",{type:"indeterminate",class:"progress"}),(0,r.h)("calcite-combobox",{label:t.folder,selectionMode:"single-persist",maxItems:5,placeholder:this.loading?t.loading:t.searchFolders,scale:i,ref:e=>this.comboboxElement=e,disabled:this.loading,clearDisabled:!0,onCalciteComboboxChange:e=>this.handleComboboxChange(e),onCalciteComboboxBeforeClose:()=>{var e;this.comboboxElement&&!(null===(e=this.comboboxElement.selectedItems)||void 0===e?void 0:e.length)&&(this.comboboxElement.value=this.folder.id)}},!this.loading&&(0,r.h)(r.F,null,this.user&&(0,r.h)("calcite-combobox-item",{class:"create-folder",value:"create-folder",textLabel:this.createFolderText,selected:!1,icon:"folder-plus",filterDisabled:!0,key:"create",ref:e=>{this.createItem=e}}),this.folders.map(this.renderItem))))),this.renderError())}renderList(){const{i18n:e}=this;return(0,r.h)(r.F,null,(0,r.h)("calcite-list",{class:"list",selectionMode:"single-persist",selectionAppearance:"icon",ref:e=>this.listElement=e,onCalciteListChange:e=>{this.handleListChange(e)},onCalciteListFilter:t=>{var i;const r=t.target;this.emptyFilterList=(null===(i=r.filteredItems)||void 0===i?void 0:i.length)<1,this.createFolderText=e.create.replace("${folder}",r.filterText),this.filterText=r.filterText},filterEnabled:!0},this.emptyFilterList&&(0,r.h)("div",{class:"no-folders-found"},e.noFoldersFound," ",(0,r.h)("calcite-link",{onClick:async()=>{this.showError=!1,await this.createNewFolder(this.filterText),this.listElement.filterText="",this.emptyFilterList=!1}},this.createFolderText)),this.folders.map(this.renderItem)),(0,r.h)("div",{class:"below"},this.newFolderActive?this.renderNewFolder():(0,r.h)("calcite-button",{iconStart:"folder-plus",appearance:"transparent",onClick:()=>{this.showError=!1,this.newFolderActive=!0}},e.createNewFolder),this.renderError()))}render(){return(0,r.h)(r.H,null,this.alwaysOpen?this.renderList():this.renderCombobox())}get el(){return(0,r.d)(this)}static get watchers(){return{user:["handleUserChange"],folder:["handleFolderChange"],newFolderInputElement:["setNewFolderActive"]}}};var b;w.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.create-folder{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}.combobox-wrapper{position:relative}.progress{position:absolute;top:0px;z-index:1}.below{margin-top:1.25rem}.list{max-height:15rem;overflow:auto;--tw-shadow:0 2px 12px -4px rgba(0, 0, 0, 0.2), 0 2px 4px -2px rgba(0, 0, 0, 0.16);--tw-shadow-colored:0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.list-item{min-width:0px;max-width:100%;text-overflow:ellipsis}.no-folders-found{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:3.5rem;padding-right:3.5rem;font-size:0.75rem;color:var(--calcite-color-text-1)}",function(e){e.arcgisTitleInputChange="title",e.arcgisFolderPickerChange="folder",e.arcgisSummaryInputChange="snippet",e.arcgisTagsPickerChange="tags",e.arcgisCategoriesPickerChange="categories"}(b||(b={}));const y=class{constructor(e){(0,r.r)(this,e),this.arcgisItemPropertiesChange=(0,r.c)(this,"arcgisItemPropertiesChange",7),this.portal=void 0,this.user=void 0,this.api=void 0,this.config=void 0,this.itemId=void 0,this.type=void 0,this.scale=void 0}async resetItemPropertiesStore(){c.a.reset()}handleItemPropertiesChange(e){const{detail:t,type:i}=e;c.i[b[i]]=t,this.arcgisItemPropertiesChange.emit(Object.assign({},c.i))}async componentWillLoad(){var e,t;this.portal&&(a.c.portal=this.portal),this.user&&(a.c.user=this.user),this.api&&(a.c.api=this.api),this.config&&(a.c.config=this.config),this.itemId&&({result:c.i.item}=await(0,u.a)(this.itemId,this.portal)),this.type&&(c.i.type=null!==(e=this.type)&&void 0!==e?e:null===(t=c.i.item)||void 0===t?void 0:t.type),this.scale&&(a.c.scale=this.scale)}render(){return(0,r.h)(r.H,null,(0,r.h)("slot",null))}disconnectedCallback(){c.a.reset()}get el(){return(0,r.d)(this)}},x=class{constructor(e){(0,r.r)(this,e),this.arcgisSummaryInputChange=(0,r.c)(this,"arcgisSummaryInputChange",7),this.updateLiveRegion=(0,l.d)((e=>{this.liveRegionText=this.getCharactersText(e)}),1500),this.scale=void 0,this.label=void 0,this.summary=void 0,this.liveRegionText=void 0,this.valid=!0}async getErrorMessage(){return this.valid?null:{code:"summaryInvalid",translatedMessage:this.i18n.invalid}}async componentWillLoad(){var e,t;const i=await(0,n.g)(this.el);this.i18n=i[0],null!==(e=this.scale)&&void 0!==e||(this.scale=a.c.scale),null!==(t=this.summary)&&void 0!==t||(this.summary=c.i.snippet),this.liveRegionText=this.getCharactersText(this.summary),c.a.on("reset",(()=>{this.summary=c.i.snippet}))}componentDidRender(){var e,t,i;const r=null===(i=null===(t=null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("calcite-input"))||void 0===t?void 0:t.shadowRoot)||void 0===i?void 0:i.querySelector("textarea");r&&(r.style.resize="vertical")}getCharactersText(e){return this.i18n.charactersLeft.replace("${num}",""+(2048-e.length))}validate(){this.valid=!/>|</.test(this.summary)}render(){const{i18n:e,summary:t,label:i,scale:s,liveRegionText:o,valid:a}=this;return(0,r.h)("div",{class:`container-${s}`},(0,r.h)("calcite-label",{scale:s,class:"label"},(0,r.h)("p",{class:"label-text"},null!=i?i:e.summary),(0,r.h)("calcite-input",{type:"textarea",id:"summary-input",placeholder:e.addSummary,value:t,maxLength:2048,scale:s,status:a?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation();const t=e.target;this.summary=t.value,this.arcgisSummaryInputChange.emit(this.summary),this.updateLiveRegion(t.value),this.validate()}}),(0,r.h)("calcite-input-message",{hidden:a,icon:!0,scale:s,status:a?"idle":"invalid"},e.invalid),(0,r.h)("span",{class:"screen-readers-only","aria-live":"polite"},o)),a&&(0,r.h)("span",{class:"count","aria-hidden":"true"},this.getCharactersText(t)))}get el(){return(0,r.d)(this)}};async function F(e){null!=e||(e=a.c.user);const t=e.url+"/tags";try{return(await(0,m.r)(t)).tags}catch(e){console.error(e)}}x.style=":host{--arcgis-label-margin-bottom:1rem}.container-s{margin-bottom:0.5rem}.container-m{margin-bottom:0.75rem}.container-l{margin-bottom:1rem}.label{--calcite-label-margin-bottom:0}.label-text{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}.count{font-size:0.75rem;color:var(--calcite-color-text-1);opacity:0.75}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const C=class{constructor(e){(0,r.r)(this,e),this.arcgisTagsPickerChange=(0,r.c)(this,"arcgisTagsPickerChange",7),this.isTag=e=>void 0!==e.tag&&void 0!==e.count,this.controlledTags=[],this.mapItemValue=e=>e.map((e=>e.value)),this.handleKeydown=e=>{var t;if(","===e.key){const i=e.target,r=null===(t=null==i?void 0:i.shadowRoot)||void 0===t?void 0:t.querySelector("input");if(null==r?void 0:r.value){e.preventDefault();const t=i.querySelector(`calcite-combobox-item[value="${r.value}"]`);if(t)t.selected=!0;else{const e=document.createElement("calcite-combobox-item");e.value=r.value,e.textLabel=r.value,e.selected=!0,null==i||i.appendChild(e)}r.value=""}}},this.api=void 0,this.user=void 0,this.scale=void 0,this.activeTags=void 0,this.knownTags=[],this.label=void 0,this.placeholder=void 0,this.hideLabel=void 0}async componentWillLoad(){var e,t,i,r,s,o;const l=await(0,n.g)(this.el);this.i18n=l[0],null!==(e=this.user)&&void 0!==e||(this.user=a.c.user),null!==(t=this.scale)&&void 0!==t||(this.scale=a.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=a.c.api),null!==(r=this.activeTags)&&void 0!==r||(this.activeTags=c.i.tags),this.activeTags=(0,p.f)(this.activeTags),this.knownTags=(0,p.f)([...null!==(s=this.knownTags)&&void 0!==s?s:[],...null!==(o=this.activeTags)&&void 0!==o?o:[]]),c.a.on("reset",(()=>{this.activeTags=c.i.tags}))}async componentDidLoad(){var e,t,i;const{user:r}=this;if(r){const s=null!==(e=r.contentTags)&&void 0!==e?e:r.tags;!(null==s?void 0:s.length)||(null==s?void 0:s.length)>0&&!this.isTag(s[0])?this.knownTags=[...this.knownTags,...(await F(r)).map((e=>e.tag))]:this.knownTags=[...this.knownTags,...s.map((e=>e.tag))],this.knownTags=(0,p.f)([...null!==(t=this.activeTags)&&void 0!==t?t:[],...null!==(i=this.knownTags)&&void 0!==i?i:[]])}}itemPropertiesTagsChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];this.arcgisTagsPickerChange.emit((0,p.f)(r));const s=Array.from(this.combobox.children),o=this.combobox.selectedItems;s.forEach((e=>{this.controlledTags.includes(e.value)||e.remove()})),this.knownTags=this.mapItemValue(s),this.activeTags=this.mapItemValue(o)}renderFormattedTags(){const{i18n:e,scale:t,handleKeydown:i,placeholder:s}=this;this.knownTags.forEach((e=>{this.controlledTags.includes(e)||this.controlledTags.push(e)}));const o=this.knownTags.map((e=>{var t;return(0,r.h)("calcite-combobox-item",{key:e,value:e,textLabel:e.length>36?`${e.slice(0,36)}...`:e,selected:(null===(t=this.activeTags)||void 0===t?void 0:t.indexOf(e))>=0})}));return(0,r.h)("calcite-combobox",{label:e.tags,maxItems:5,"allow-custom-values":!0,placeholder:null!=s?s:e.addTags,scale:t,onKeyDown:i,ref:e=>this.combobox=e},o)}async setFocus(){var e;null===(e=this.combobox)||void 0===e||e.setFocus()}render(){const{i18n:e,scale:t,hideLabel:i,label:s}=this;return(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:{label:!0,"screen-reader-only":i}},null!=s?s:e.tags),this.renderFormattedTags())}get el(){return(0,r.d)(this)}};C.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const T=class{constructor(e){(0,r.r)(this,e),this.arcgisTitleInputChange=(0,r.c)(this,"arcgisTitleInputChange",7),this.debouncedInput=(0,l.d)((()=>this.handleTitleValidation()),400),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.itemTitle=void 0,this.currentFolder=void 0,this.type=void 0,this.update=!1,this.enablePublishing=void 0,this.titleError=void 0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async validateTitle(){return this.debouncedInput.invoke()}async handleTitleValidation(){const{type:e,itemTitle:t,enablePublishing:i,portal:r,user:s,update:o}=this,{extension:a}=(0,v.a)(t);if(e)return this.titleError=await async function({portal:e,user:t,title:i,itemType:r,folder:s,extension:o,enablePublishing:a=!1,update:l=!1}){if(!t||!e)return{code:"missingUserOrPortal"};if(!i||i.length<=0)return{code:"titleRequired"};if("Data Store"===r&&(/[\s.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"dataStoreTitleInvalid"};if(!a&&(/<|>/gi.test(i)||i.length>250))return{code:"titleInvalid"};if(a&&(/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"serviceNameInvalid"};const n=a?function(e){switch(e){case"CSV":case"Microsoft Excel":case"GeoJson":case"Shapefile":case"File Geodatabase":case"Image Collection":case"GeoPackage":case"Service Definition":case"Feature Collection":return"Feature Service";case"Tile Package":return"Map Service";case"Vector Tile Package":return"Vector Tile Service";case"Scene Package":return"Scene Service";case"3DTiles Package":return"3DTiles Service"}return e}(r):r,{itemURLList:c}=await(0,u.s)(i,n,s,o,t,e)||{};if(c&&!l)return{code:"itemExists",itemUrl:c[0]};if(a){const t=await(0,m.r)(`${(0,g.g)(e)}portals/${e.id}/isServiceNameAvailable`,{name:i.replace(/\s/g,"_"),type:n});if(!(null==t?void 0:t.available))return{code:"titleInUseService",layerName:i}}return null}({portal:r,user:s,title:t,itemType:e,folder:this.currentFolder,extension:a,enablePublishing:i,update:o}),this.getErrorMessage();console.error("No item type found. Skipping title validation")}getErrorMessage(){const{itemTitle:e,titleError:t,i18n:i}=this;return e||(this.titleError={code:"titleRequired",translatedMessage:this.i18n.validation.titleRequired}),t&&(t.translatedMessage=i.validation[this.titleError.code].replace("${name}",e)),t}async componentWillLoad(){var e,t,i,r,s,o,l;const d=await(0,n.g)(this.el);this.i18n=d[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=a.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=a.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=a.c.api),null!==(s=this.type)&&void 0!==s||(this.type=c.i.type),null!==(o=this.itemTitle)&&void 0!==o||(this.itemTitle=c.i.title),null!==(l=this.currentFolder)&&void 0!==l||(this.currentFolder=c.i.folder),this.itemTitle&&this.handleTitleValidation(),c.i.title=this.itemTitle,c.a.on("reset",(()=>{this.itemTitle=c.i.title}))}render(){var e;const{i18n:t,itemTitle:i,scale:s}=this,{translatedMessage:o,code:a}=this.titleError||{},l=!o;return(0,r.h)("calcite-label",{scale:s},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.title),(0,r.h)("calcite-input",{id:"item-properties-title",placeholder:t.addTitle,value:i,scale:s,onInput:this.debouncedInput,max:250,ref:e=>this.mainInputRef=e,status:l?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation(),this.itemTitle=e.target.value,this.arcgisTitleInputChange.emit(this.itemTitle)}}),(0,r.h)("calcite-input-message",{icon:!0,hidden:l,status:l?"idle":"invalid"},o||t[a]||t.title))}get el(){return(0,r.d)(this)}static get watchers(){return{currentFolder:["handleTitleValidation"]}}};T.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}"},26077:(e,t,i)=>{i.d(t,{U:()=>r,a:()=>a,b:()=>s,g:()=>o});const r="/Categories",s=(e,t,i=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function o(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||r}const a=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},76338:(e,t,i)=>{i.d(t,{a:()=>u,b:()=>h,c:()=>g,f:()=>d,g:()=>c,u:()=>p});var r=i(66913),s=i(26077),o=i(46710),a=i(75858),l=i(91659),n=i(70392);const c=async({portal:e,user:t,group:i,useCache:r=!1})=>{var s;try{const o=await(i?h(i.id,e,r):d(e,t,r));return{result:null!==(s=null==o?void 0:o.categorySchema)&&void 0!==s?s:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function d(e,t,i=!0){if(null!=e||(e=o.c.portal),null!=t||(t=o.c.user),!(null==e?void 0:e.id)||t&&(0,l.d)(t))return null;const s=()=>(0,r.r)(`${(0,n.g)(e)}portals/${e.id}/categorySchema`);return i?(0,r.f)(s,"categorySchema",e.id):s()}async function h(e,t,i=!0){if(null!=t||(t=null===o.c||void 0===o.c?void 0:o.c.portal),!e||!t)return null;const s=()=>(0,r.r)(`${(0,a.g)(t,{id:e})}categorySchema`);return i?(0,r.f)(s,"categorySchema",e):s()}async function u(e,t,i=!0){const s=()=>async function(e,t){var i;const s=(0,n.g)(e),o=await(0,r.r)(`${s}portals/self`),l=await(0,r.r)(`${s}community/groups?q=${o.contentCategorySetsGroupQuery}`),c=null===(i=null==l?void 0:l.results)||void 0===i?void 0:i[0],d=(await(0,r.r)((0,a.a)(e,c),{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${s}content/items/${d.id}/data`)}(e,t);return i?(0,r.f)(s,"categorySchema",t):s()}async function p({categories:e,itemIds:t,portal:i}){try{const s=`${(0,n.g)(i)}/content/updateItems`,o=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,r.r)(s,{items:o},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const g=async({path:e,portal:t,group:i,updateInfo:r})=>{try{const o=(await m({category:e,portal:t,group:i,num:1})).total;if(0===o)return console.warn(`No items found with category ${e} when updating schema`),{};const a=100,l=Math.ceil(o/a),n=[];for(let o=0;o<l;o++)n.push(m({category:e,portal:t,group:i,start:o*a,num:a}).then((({results:t})=>{const i={};return t.forEach((t=>{const o="change-title"===r.type?t.categories.map((t=>{const i=(0,s.a)(e,r.newTitle);return t===e?i:t.replace(`${e}/`,`${i}/`)})):t.categories.filter((t=>!t.startsWith(e)));i[t.id]=o})),i})));const c=await Promise.all(n);return await Promise.all(c.map((e=>p({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${r.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},m=({category:e,num:t=100,start:i=0,portal:s,group:o})=>{const l={start:i,num:t,categories:JSON.stringify([e])},c=o?(0,a.a)(s,o):`${(0,n.g)(s)}search`;return(0,r.r)(c,Object.assign(Object.assign({},l),{q:o?void 0:`orgid: ${s.id}`}))}},37526:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>c,g:()=>n,s:()=>a,v:()=>l});var r=i(17752),s=i(15059);function o(e,t){const i=/(?:\.([^.]+))?$/;let r=e.replace(/^.*(\\|\/|:)/,""),o=r&&i.exec(r)[1]?i.exec(r)[1].toLowerCase():"",a="";if(r.indexOf(".rft.")>-1){const[e,t]=r.split(".rft.");o=`rft.${t}`,a=e}return r&&!a&&(a=-1===r.lastIndexOf(".")?r:r.substring(0,r.lastIndexOf("."))),a=a.replace(/\.|-/g,"_"),t&&(a=function(e){return`${e}_${(0,s.g)()}`}(a),r=`${a}.${o}`),{title:a,fileName:r,extension:o}}function a(e,t){return o(e.name,!!t)}function l(e,t){let i=e;const r=e.lastIndexOf("\\");return r>-1&&(i=i.substring(r+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function n(e){return r.a[e]?r.a[e]:r.a[Object.keys(r.a).find((t=>r.a[t].type===e))]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},64209:(e,t,i)=>{i.d(t,{a:()=>s,f:()=>o,s:()=>l});var r=i(88703);const s=e=>(null==e?void 0:e.replace(/(\s+|:)/g,"_"))||"",o=e=>{const t=e=>e.split(",").map((e=>e.trim())).filter((e=>e));return e?"string"==typeof e?(0,r.b)(t(e)):(0,r.b)(e.flatMap((e=>[...t(e)]))):[]},a=async e=>new Promise(((t,i)=>{for(let r=0;r<e.length;r++)e[r].then((i=>{const s=[...e];s.splice(r,1),t({remainingPromises:s,result:i})})).catch(i)}));async function l(e,t){var i,r;const s=[],{getBatchSize:o,onPromiseCompleted:l,onPromiseThrow:n,shouldContinue:c}=null!=t?t:{};let d=[];for(let t=0;t<(null!==(i=null==o?void 0:o())&&void 0!==i?i:1);t++)try{const t=e();t&&d.push(t)}catch(e){null==n||n(e)}let h=null;for(;d.length>0&&(!c||c(h));)try{const{remainingPromises:t,result:i}=await a(d);d=t,h=i,i&&s.push(i),null==l||l(i);const n=null!==(r=null==o?void 0:o())&&void 0!==r?r:1;for(;d.length<n;){const t=e();if(t&&d.push(t),null==t)break}}catch(e){null==n||n(e)}return s}},75858:(e,t,i)=>{i.d(t,{a:()=>o,g:()=>s});var r=i(70392);const s=(e,t)=>(0,r.a)(`${(0,r.g)(e)}community/groups/${t.id}`),o=(e,t)=>`${((e,t)=>(0,r.a)(`${(0,r.g)(e)}content/groups/${t.id}`))(e,t)}search`},15059:(e,t,i)=>{i.d(t,{g:()=>r});const r=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},91306:(e,t,i)=>{i.d(t,{a:()=>r,i:()=>s});const r=(0,i(23505).c)({title:"",snippet:"",tags:[],categories:[]}),s=r.state},12856:(e,t,i)=>{i.d(t,{a:()=>f,b:()=>$,c:()=>E,d:()=>y,e:()=>w,f:()=>u,g:()=>v,h:()=>p,i:()=>g,j:()=>C,k:()=>m,l:()=>T,m:()=>b,n:()=>F,s:()=>I,u:()=>x});var r=i(70392),s=i(46710),o=i(91659),a=i(66913),l=i(91306),n=i(82669),c=i(84873),d=i(64209),h=i(17752);function u({title:e,snippet:t,tags:i}){return{title:e,snippet:t,tags:(0,d.f)(i).join(",")}}const p=(e,t,i)=>{var r,s;const{file:o,type:a,extension:l,dataUrl:n,properties:c,typeKeywords:d,existingItem:p}=t,g=u(e);if(i){const e=p;g.title=(null===(r=null==e?void 0:e.sourceData)||void 0===r?void 0:r.title)||e.title||g.title||""}const m=[...null===(s=h.a[a])||void 0===s?void 0:s.typeKeywords,...d?[d]:[],l].join(", "),v=Object.assign({type:a,extension:l},c?{properties:JSON.stringify(c)}:{}),f=o?{file:o}:{dataUrl:n.includes('httpHeaders={"Authorization"')?n:encodeURI(n)};return Object.assign(Object.assign(Object.assign(Object.assign({},v),f),g),{typeKeywords:m})},g=(e,t,i)=>{const r=!!i,s=!!t.addAsUniqueFile,o=p(e,t,r),a=new FormData;return a.append("f","json"),a.append("async","true"),Object.keys(o).forEach((e=>{if(s&&"file"===e){const i=t.fileName;a.append(e,o[e],i)}else a.append(e,o[e])})),a},m=(e,t)=>{const i=(null==t?void 0:t.id)&&!function(e){return["all","recycle"].includes(e.id)||e.id===e.username}(t)?`/${t.id}`:"";return`${e.userContentUrl}${i}/addItem`},v=(e,t)=>`${(0,r.g)(t)}content/items/${e}`,f=async(e,t)=>{try{const i=v(e,t);return{result:await(0,a.r)(i)}}catch(e){return console.warn("error getting item",e),{error:{code:"unhandledError"}}}},w=async(e,t)=>{const i=new FormData;switch(t.type){case"base64":i.append("data",t.data);break;case"url":i.append("url",t.url);break;case"file":i.append("file",t.file)}return i.append("f","json"),i.append("token",(0,a.g)(s.c.portal)),await(0,a.a)(`${(0,r.g)()}content/users/${s.c.user.username}/items/${e}/updateThumbnail`,i,{},"post")};async function b(e,t){const i=`${s.c.user.userContentUrl}/moveItems`;return await(0,a.r)(i,{items:e,folder:t},{},"post")}async function y(e,{permanentDelete:t=!1}={}){const i=`${s.c.user.userContentUrl}/items/${e}/delete`;return await(0,a.r)(i,{permanentDelete:t},{},"post")}async function x(e,t,i){var r;const o=null!==(r=null!=i?i:s.c.user)&&void 0!==r?r:s.c.portal.user,l=`${"append"===c.u.workflow?n.a.existingItem.itemOwner.userContentUrl:o.userContentUrl}/items/${e}/update`;return(0,a.r)(l,t,{},"post")}const F=(e,t)=>{const i=`${(0,r.g)(t)}content/items/${e}/data`;return(0,a.r)(i)},C=async(e,t,i)=>{const r=`${s.c.user.userContentUrl}/items/${e}/commit`,o=g(l.i,t,!!i);return o.delete("file"),await(0,a.a)(r,o,{},"post")},T=async e=>{const t=`${s.c.user.userContentUrl}/items/${e}/cancel`;return await(0,a.r)(t,{},{},"post")},$=async e=>{const t=m(s.c.user,l.i.folder),i=u(l.i),r=Object.assign({},e);return delete r.initialFolders,delete r.initialTitle,delete r.newItemMode,delete r.serviceInfo,delete r.allowStoredAuth,delete r.isSecured,delete r.checkAuth,delete r.agsType,delete r.developerCredentialsType,delete r.applicationEnvironment,delete r.apiKeyReferrerUrls,delete r.developerCredentialsRedirectUrls,delete r.developerPrivileges,await(0,a.r)(t,Object.assign(Object.assign(Object.assign(Object.assign({},r),(e=>e.url&&!!e.serviceInfo)(e)?{serviceInfo:JSON.stringify(e.serviceInfo)}:{}),{typeKeywords:JSON.stringify(e.typeKeywords)}),i),{},"post")};async function I(e,t,i,l,n,c){null!=n||(n=s.c.user),null!=c||(c=s.c.portal);const d=i&&i.id!==n.username?i.id:"root",h=e.replace(`.${l}`,"");if("featurecollection"===l||"Microsoft Excel"===t)return null;const u=[`title: "${h}"`,`type: "${t}"`,`owner: "${n.username}"`,`ownerfolder: "${d}"`],p=await(0,a.r)(`${(0,r.g)(c)}search`,{filter:u.join(" AND "),num:1});return(null==p?void 0:p.total)>0?{num:p.num,itemURLList:p.results.map((e=>(0,o.g)(e.id,s.c.config.baseUrl)))}:null}async function E(e,t){const i=(0,d.a)(e),{user:n,config:c,portal:h}=s.c,{folder:u}=l.i,p=u&&u.id!==n.username?u.id:"root",g=[`owner: "${n.username}"`,`ownerfolder: "${p}"`];t&&g.push(`type: "${t}"`);let m,v=1;for(let e=0;e<10&&!m&&v>-1;e++){const{nextStart:e,results:t}=await(0,a.r)(`${(0,r.g)()}search`,{[h.isPortal?"q":"filter"]:g.join(" AND "),num:100,start:v});m=t.find((e=>e.name===i)),v=e}return m?(0,o.g)(m.id,c.baseUrl):null}},84873:(e,t,i)=>{i.d(t,{a:()=>r,u:()=>s});const r=(0,i(23505).c)({nextText:"next",workflow:"content",scale:"m",disableScroll:!1,featureFlags:{}}),s=r.state},79233:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>c,c:()=>g,d:()=>u,e:()=>p,f:()=>a,g:()=>h,u:()=>m});var r=i(66913),s=i(46710),o=i(70392);async function a(e,t){return(0,r.r)(`${(0,o.g)(t)}/community/users/${e}`)}async function l(){return(0,r.r)(`${(0,o.g)()}/community/self`)}async function n(e,t){var i;if(null!=e||(e=null===s.c||void 0===s.c?void 0:s.c.user),!e)return[];const o=await(0,r.f)((()=>l()),"communitySelf",e.username);return(null!==(i=null==o?void 0:o.groups)&&void 0!==i?i:[]).sort(((e,i)=>{var r;return null===(r=e.title)||void 0===r?void 0:r.localeCompare(i.title,t||"en",{sensitivity:"base"})}))}async function c(){const e=null===s.c||void 0===s.c?void 0:s.c.user;return e?(await(0,r.f)((()=>l()),"communitySelf",e.username)).favGroupId:null}function d(e,t){var i;return null!==(i=null==e?void 0:e.userContentUrl)&&void 0!==i?i:`${null==t?void 0:t.restUrl}/content/users/${e.username}`}async function h(e){var t;const i=null!==(t=null!=e?e:s.c.user)&&void 0!==t?t:s.c.portal.user,{folders:o}=await async function(e){var t;const i=d(null!==(t=null!=e?e:s.c.user)&&void 0!==t?t:s.c.portal.user,s.c.portal),o=await(0,r.r)(i,{num:1});return Promise.resolve(o)}(i),{username:a}=i;return[{username:a,id:a,title:a,created:"now"},...o.sort(((e,t)=>e.title.localeCompare(t.title)))]}async function u(e,t){var i;const r=null!==(i=null!=t?t:s.c.user)&&void 0!==i?i:s.c.portal.user;return(await h(r)).find((t=>t.id===e))}function p(e){return{username:e,id:e,title:e,created:"now"}}async function g(e,t){var i,o;try{const o=`${d(null!==(i=null!=t?t:s.c.user)&&void 0!==i?i:s.c.portal.user,s.c.portal)}/createFolder`;return{result:await(0,r.r)(o,{title:e},{},"post")}}catch(e){return console.error(e),(null===(o=e.details)||void 0===o?void 0:o.messages).some((e=>e.includes("not available")))?{error:{code:"folderNameExists"}}:{error:{code:"unhandledError"}}}}async function m(e,t,i){var o;const a=`${d(null!==(o=null!=i?i:s.c.user)&&void 0!==o?o:s.c.portal.user,s.c.portal)}/${e}/updateFolder`;try{return{result:await(0,r.r)(a,{newTitle:t},{},"post")}}catch(e){return{error:{code:"unhandledError"}}}}},6895:(e,t,i)=>{function r(e,t){return e&&0!==e.trim().length?function(e,t){return null==t?void 0:t.some((t=>t.title===e))}(e,t)?"folderAlreadyExists":!(!e.includes(">")&&!e.includes("<"))&&"invalidCharacters":"noName"}i.d(t,{g:()=>r})}}]);