/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-61b3c2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-61b3c2"],{14928:(e,o,i)=>{i.r(o),i.d(o,{arcgis_smart_mapping_relationship_focus_button:()=>a});var t=i(35110),n=i(59503),s=i(61886),l=(i(21104),i(2137),i(41565));i(86587),i(63280),i(1984),i(23505),i(89393),i(73838);const a=class{constructor(e){(0,t.r)(this,e),this.arcgisSmartMappingRelationshipFocusButtonChange=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonChange",7),this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonBeforeOpen",7),this.arcgisSmartMappingRelationshipFocusButtonError=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonError",7),this.open=!1,this.flowItemNode=void 0,this.selectedFocusInfo=void 0}async setFocus(){this.buttonNode.focus()}componentWillLoad(){const{layer:e,strings:o}=n.s,i=(0,n.j)(e);this.focusInfos=[{focus:"HH",title:o.relationshipFocusButton.focusHighHigh,msg:o.relationshipFocusButton.focusHighHighMsg,selected:!1,iconPath:null},{focus:"HL",title:o.relationshipFocusButton.focusHighLow,msg:o.relationshipFocusButton.focusHighLowMsg,selected:!1,iconPath:null},{focus:"LH",title:o.relationshipFocusButton.focusLowHigh,msg:o.relationshipFocusButton.focusLowHighMsg,selected:!1,iconPath:null},{focus:"LL",title:o.relationshipFocusButton.focusLowLow,msg:o.relationshipFocusButton.focusLowLowMsg,selected:!1,iconPath:null},{focus:"none",title:o.relationshipFocusButton.none,msg:o.relationshipFocusButton.focusNoneMsg,selected:!this.selectedFocusInfo,iconPath:null}],this.setSelectedFocus(i.authoringInfo.focus||"none")}render(){const{strings:e}=n.s;return(0,t.h)(t.H,null,(0,t.h)("calcite-label",{class:"focus-margin"},e.relationshipFocusButton.focus,(0,t.h)("div",{class:"focus-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.relationshipFocusButton.focus,ref:e=>{e&&(this.buttonNode=e)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openFocusDropdown())},onClick:()=>this.openFocusDropdown()},(0,t.h)("div",{class:"focus-content"},(0,t.h)("div",{class:"focus-button-text"},(0,t.h)("div",{class:"focus-button-title"},this.selectedFocusInfo.title),(0,t.h)("div",{class:"focus-button-msg"},this.selectedFocusInfo.msg)),(0,t.h)("div",null,(0,t.h)("calcite-icon",{scale:"s",icon:"chevron-down"}))))))}closePopover(){var e;this.open=!1,this.dropdownNode&&(null===(e=this.dropdownNode.parentNode)||void 0===e||e.removeChild(this.dropdownNode),this.dropdownNode=null,this.buttonNode.classList.remove("active"))}openFocusDropdown(){if(this.open)this.open=!1;else{this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen.emit();const e=document.createElement("arcgis-smart-mapping-dropdown");e.buttonNode=this.buttonNode,e.infos=this.focusInfos,this.dropdownNode=e,e.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closePopover(),"Escape"===e.detail&&this.setFocus()})),e.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setNewFocus(e.detail))),e.addEventListener("arcgisSmartMappingDropdownDisconnected",(()=>this.closePopover())),this.buttonNode.classList.add("active"),document.body.appendChild(e),this.open=!0}}setNewFocus(e){const{layer:o}=n.s,i=(0,n.j)(o).authoringInfo.focus,t=e.focus;if(t===i)return this.closePopover(),void setTimeout((()=>this.setFocus()),300);(0,s.r)((0,l.u)({focus:t}),this.flowItemNode).then((i=>{this.setSelectedFocus(e.focus),(0,n.j)(o).uniqueValueInfos.forEach((e=>{i.uniqueValueInfos.find((o=>e.value===o.value)).label=e.label})),(0,n.e)(i,o),(0,n.ab)(),setTimeout((()=>this.setFocus()),300),this.arcgisSmartMappingRelationshipFocusButtonChange.emit()})),this.closePopover()}setSelectedFocus(e){this.focusInfos.forEach((o=>{o.focus===e?(this.selectedFocusInfo=o,o.selected=!0):o.selected=!1}))}get hostElement(){return(0,t.d)(this)}};a.style=".focus-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:2px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.focus-button:active{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.focus-button:focus{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.focus-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.focus-content{justify-content:space-between;display:flex;align-items:center;width:100%}.focus-button-text{display:inline-block;padding:0 10px}.focus-button-title{font-weight:bold}.focus-button-msg{font-size:80%;line-height:16px}.focus-margin{margin:12px 0}"},61886:(e,o,i)=>{let t,n;function s(e){e.loading=!1}function l(e,o){return function(e){e.loading=!0,n=!1,t&&clearTimeout(t),t=setTimeout((()=>{s(e),n=!0}),6e4)}(o),e.then((e=>(s(o),n?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(s(o),Promise.reject(e))))}i.d(o,{r:()=>l})},41565:(e,o,i)=>{i.d(o,{a:()=>l,c:()=>s,u:()=>a});var t=i(59503),n=(i(21104),i(89393));function s(e){var o,i;const{layer:s,useFeatureReduction:l,mapImageSublayer:a,mapView:r,modules:u}=t.s,c=s,d=(0,t.g)();let f=e.relationshipScheme;if(!f&&["relationship","relationship-size"].indexOf(d)>-1&&(f=(0,t.a1)()),e=e||{},"relationship-size"===d){const i=(0,t.j)(c).clone(),n=i.authoringInfo;if(n&&(null===(o=e.fieldInfos)||void 0===o?void 0:o.length)>1&&e.fieldInfos[0].field==n.field1.field&&e.fieldInfos[1].field==n.field2.field){if(i.visualVariables=(0,t.q)(i,"size"),i.authoringInfo.visualVariables=(0,t.r)(i,"size"),(0,t.u)(c)){const e=(0,t.T)(c,r),o=i.uniqueValueInfos.slice();o.map((o=>{const i=(0,t.w)(o.symbol);o.symbol=e.clone(),(0,t.v)(o.symbol,i)})),i.uniqueValueInfos=o}return Promise.resolve({renderer:i})}}const p=(0,t.p)((0,t.j)(c)),h={layer:c,view:r,field1:{field:e.fieldInfos[0].field},field2:{field:e.fieldInfos[1].field},classificationMethod:"quantile",numClasses:3,focus:"HH",relationshipScheme:f,outlineOptimizationEnabled:!a&&(!(0,n.i)(e.outlineOptimizationEnabled)||e.outlineOptimizationEnabled),sizeOptimizationEnabled:!a&&(!(0,n.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(i=c.featureReduction)||void 0===i?void 0:i.type)&&l};return u.RelationshipCreator.createRenderer(h).then((e=>((0,t.o)(p,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function l(e){var o;const{layer:i,useFeatureReduction:s,mapImageSublayer:l,mapView:a,modules:r}=t.s,u=i;e=e||{};const c=(0,t.j)(u),d=(0,t.g)(),f=c.authoringInfo,p=(0,t.a)(c,"size");if(e.fieldInfos&&e.fieldInfos.length>1&&e.fieldInfos[0].field==f.field1.field&&e.normalizationField1===f.field1.normalizationField&&e.fieldInfos[1].field==f.field2.field&&e.normalizationField2===f.field2.normalizationField&&(delete e.fieldInfos,delete e.normalizationField1,delete e.normalizationField2,(0,t.S)(e)&&!p))return Promise.resolve({renderer:c.clone()});let h=e.relationshipScheme;!h&&["relationship","relationship-size"].indexOf(d)>-1&&(h=(0,t.a1)());const m=(0,t.p)(c);let g=e.fieldInfos?e.fieldInfos[0]:{field:f.field1.field,simpleFieldType:t.z.NUMBER},b=e.fieldInfos?e.fieldInfos[1]:{field:f.field2.field,simpleFieldType:t.z.NUMBER};const v=void 0!==e.normalizationField1?e.normalizationField1:f.field1.normalizationField,F=void 0!==e.normalizationField2?e.normalizationField2:f.field2.normalizationField,w=c.uniqueValueInfos&&c.uniqueValueInfos.length?c.uniqueValueInfos[0].symbol:null,z=c.defaultSymbol,I=c.defaultLabel,y=e.numClasses?e.numClasses:f.numClasses;return r.RelationshipCreator.createRenderer({layer:u,view:a,field1:{field:g?g.field:c.field,normalizationField:v},field2:{field:b?b.field:c.field,normalizationField:F},classificationMethod:e.classificationMethod?e.classificationMethod:"manual"!==f.classificationMethod?f.classificationMethod:"quantile",numClasses:y,focus:e.focus?e.focus:f.focus,relationshipScheme:h,outlineOptimizationEnabled:!l&&((0,n.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!m.sizeOutlineVisVar),sizeOptimizationEnabled:!l&&((0,n.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!m.sizeAutoVisVar),legendOptions:e.legendOptions?e.legendOptions:c.legendOptions,defaultSymbolEnabled:(0,n.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!c.defaultSymbol,forBinning:"binning"===(null===(o=u.featureReduction)||void 0===o?void 0:o.type)&&s}).then((e=>((0,t.o)(m,e.renderer),w&&e.renderer.uniqueValueInfos.forEach((e=>{const o=w.clone();(0,t.v)(o,(0,t.w)(e.symbol)),e.symbol=o})),(0,t.j)(u).uniqueValueInfos.forEach((o=>{const i=e.renderer.uniqueValueInfos.find((e=>o.value===e.value));i&&(i.label=o.label)})),z&&(e.renderer.defaultSymbol=z,e.renderer.defaultLabel=I),Promise.resolve(e))),(e=>Promise.reject(e)))}function a(e){const{layer:o,modules:i}=t.s;e=e||{};const n=(0,t.j)(o),s=n.authoringInfo;return i.RelationshipCreator.updateRenderer({field1:s.field1,field2:s.field2,numClasses:e.numClasses?e.numClasses:s.numClasses,focus:e.focus?"none"===e.focus?null:e.focus:s.focus,colors:e.colors,renderer:n})}}}]);