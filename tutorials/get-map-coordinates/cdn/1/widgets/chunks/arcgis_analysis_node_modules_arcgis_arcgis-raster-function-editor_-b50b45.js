"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-b50b45"],{60764:(e,t,a)=>{a.d(t,{R:()=>i});const i={CORE:"CORE",STANDARD:"STANDARD"}},14233:(e,t,a)=>{a.d(t,{R:()=>i});const i={header:"header",content:"content"}},55694:(e,t,a)=>{a.d(t,{E:()=>i});const i={newTemplate:"new-template",openTemplate:"open-template",addFunction:"add-function",addConstant:"add-constant",addRaster:"add-raster",deleteSelected:"delete-selected"}},98029:(e,t,a)=>{a.r(t),a.d(t,{rfx_editor_app:()=>S});var i=a(14947),o=a(74656),n=a(55694),r=a(86578),s=a(59498),l=a(92123),d=a(95166),c=a(70049),h=(a(99248),a(16888),a(95323),a(43278),a(22760),a(46574),a(86944),a(83345),a(27703)),m=a(78816),p=a(10724),u=a(43327),v=a(60764),f=a(14233);function C(e,t){return(0,l.m)(t)?e:{...e,thumbnailEx:t.thumbnail,name:t.name,description:t.description,functionType:t.functionType,definition:t.definitionQuery,properties:t.properties}}function g(e){if((0,l.m)(e))return void console.warn("RFT Handler get RFT Blob: No model provided.");const t=JSON.stringify(e,null,2);return new Blob([t],{type:"text/json"})}const S=class{constructor(e){(0,i.r)(this,e),this.analysisRFTLaunch=(0,i.c)(this,"analysisRFTLaunch",7),this.analysisTemplateNameChanged=(0,i.c)(this,"analysisTemplateNameChanged",7),this.analysisRFTEditorClose=(0,i.c)(this,"analysisRFTEditorClose",7),this.rfxCoreServices={diagramZoomInCommand:void 0,diagramZoomOutCommand:void 0,diagramAutoLayoutCommand:void 0,diagramStretchCommand:void 0,diagramPanCommand:void 0,diagramSelectCommand:void 0,addRFxFunctionCommand:void 0,addRasterNodeCommand:void 0,addScalarNodeCommand:void 0,addRFTPortalItemCommand:void 0,getModelCommand:void 0,refreshDiagramViewCommand:void 0,deleteSelectedItemsCommand:void 0},this.overlayElementsConfig={leftToolBar:{slot:"left",visible:!0,builder:()=>(({handleDiagramZoomIn:e,handleDiagramZoomOut:t,handleDiagramAutoLayout:a,handleDiagramStretch:o,handleDiagramSelect:n,handleDiagramPan:r,handleDiagramDeleteSelected:s,slot:l})=>(0,i.h)("div",{slot:l},(0,i.h)("rfx-diagram-interaction-toolbar",{handleDiagramZoomIn:e,handleDiagramZoomOut:t,handleDiagramAutoLayout:a,handleDiagramStretch:o,handleDiagramSelect:n,handleDiagramPan:r,handleDiagramDeleteSelected:s})))({handleDiagramZoomIn:this.handleDiagramZoomIn,handleDiagramZoomOut:this.handleDiagramZoomOut,handleDiagramAutoLayout:this.handleDiagramAutoLayout,handleDiagramStretch:this.handleDiagramStretch,handleDiagramSelect:this.handleDiagramSelect,handleDiagramPan:this.handleDiagramPan,handleDiagramDeleteSelected:this.handleDiagramDeleteSelected,slot:"left"}),type:"static"},rightToolBar:{slot:"right",visible:!0,builder:()=>(({handleRFTLaunch:e,handleRFTSave:t,handleRFTSaveAs:a,handleOpenTemplateEditor:o,handleRFTShare:n,slot:r})=>(0,i.h)("div",{slot:r},(0,i.h)("rfx-rft-interaction-toolbar",{handleRFTLaunch:e,handleRFTSave:t,handleRFTSaveAs:a,handleOpenTemplateEditor:o,handleRFTShare:n})))({handleRFTLaunch:this.handleRFTLaunch,handleRFTSave:this.handleRFTSave,handleRFTSaveAs:this.handleRFTSaveAs,handleOpenTemplateEditor:this.handleOpenTemplateEditor,handleRFTShare:this.handleRFTShare,slot:"right"}),type:"static"},rfxListView:{slot:"left",visible:!1,builder:({addRasterFunctionTitle:e})=>(({slot:e,handleTriggerSelectFunction:t,handlePanelClose:a,heading:o})=>(0,i.h)("div",{slot:e,class:"list-wrapper"},(0,i.h)("rfx-panel",{heading:o,closable:!0,showFooter:!1,closed:!1,class:{"overlay-element":!0,"overlay-panel":!0},onCalcitePanelClose:a},(0,i.h)("rfx-list-view",{mode:v.R.CORE,onTriggerSelectFunction:t}))))({slot:"left",heading:e,handleTriggerSelectFunction:this.handleRFxListViewTriggerSelectFunction,handlePanelClose:this.handleRFxListViewPanelClose}),type:"static"}},this.showUnsavedChangesDialog=()=>void 0!==this.closeWithoutSavingModalElement?Promise.resolve(!1):new Promise((e=>{const t=document.createElement("rfx-close-without-saving-modal");t.rftTitle=u.s.rftProperties?.name||this.strings.newTemplate,t.handleCancel=()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,e(!1)},t.handleDontSave=()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,this.clearState(),e(!0)},t.handleSave=async()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,e(await this.handleRFTSaveAs())},this.closeWithoutSavingModalElement=t,document.body.appendChild(t)})),this.showCloseWithoutSavingModal=(e,t)=>{const a=document.createElement("rfx-close-without-saving-modal");a.rftTitle=u.s.rftProperties?.name||this.strings.newTemplate,a.handleCancel=()=>{a.remove(),this.closeWithoutSavingModalElement=void 0},a.handleDontSave=e??this.handleDontSaveClick,a.handleSave=t??this.handleRFTSaveOnClose,this.closeWithoutSavingModalElement=a,document.body.appendChild(a)},this.handleRFTSaveOnClose=()=>{this.handleRFTSaveAs(),this.closeWithoutSavingModalElement.remove(),this.closeWithoutSavingModalElement=void 0},this.initializeRFxEditorCore=e=>{const t=e;var a;this.rfxEditorCoreElement=e,this.rfxCoreServices.diagramZoomInCommand=(a=t,{execute:async()=>{await a.zoomIn()}}),this.rfxCoreServices.diagramZoomOutCommand=(e=>({execute:async()=>{await e.zoomOut()}}))(t),this.rfxCoreServices.diagramAutoLayoutCommand=(e=>({execute:async()=>{await e.autoLayout()}}))(t),this.rfxCoreServices.diagramStretchCommand=(e=>({execute:async()=>{await e.stretch()}}))(t),this.rfxCoreServices.diagramPanCommand=(e=>({execute:async()=>{await e.pan()}}))(t),this.rfxCoreServices.diagramSelectCommand=(e=>({execute:async()=>{await e.select()}}))(t),this.rfxCoreServices.addRFxFunctionCommand=(e=>({execute:async t=>{await e.addRFxFunction(t)}}))(t),this.rfxCoreServices.addRasterNodeCommand=(e=>({execute:async t=>{const{value:a}=t||{};await e.addRasterNode({value:a})}}))(t),this.rfxCoreServices.addScalarNodeCommand=(e=>({execute:async t=>{const{value:a}=t||{};await e.addScalarNode({value:a})}}))(t),this.rfxCoreServices.addRFTPortalItemCommand=(e=>({execute:async t=>await e.addRFTPortalItem(t)}))(t),this.rfxCoreServices.getModelCommand=(e=>({execute:async()=>await e.getModel()}))(t),this.rfxCoreServices.refreshDiagramViewCommand=(e=>({execute:async()=>{await e.refreshDiagramView()}}))(t),this.rfxCoreServices.deleteSelectedItemsCommand=(e=>({execute:async()=>{await e.deleteSelected()}}))(t)},this.handleNewTemplateClick=()=>{if(!0===u.s.hasUnsavedChanges){const e=()=>{this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0,this.clearState()};this.showCloseWithoutSavingModal(e)}else this.clearState()},this.handleOpenTemplateClick=()=>{const{portal:e}=this;this.itemBrowserElement=(0,m.b)({modalStrings:{header:this.strings.browseRFT},portal:e,user:e.user,filter:'(type: "Raster function template")',onClose:this.closeItemBrowser,onSelection:this.handleItemBrowserSelection}),document.body.appendChild(this.itemBrowserElement)},this.handleItemBrowserSelection=async e=>{if(null!==e.detail){const t=e.detail.id;try{const e=await this.rfxCoreServices.addRFTPortalItemCommand.execute(t);null==u.s.rftJSON&&!1===u.s.hasUnsavedChanges?(u.s.rftJSON=e.toolFunction.toJSON(),u.s.rftProperties=function(e){if((0,l.m)(e))return;const{name:t,description:a,thumbnailEx:i,functionType:o,definition:n,properties:r}=e;return{name:t,description:a,thumbnail:i,functionType:o,definitionQuery:n,properties:r}}(u.s.rftJSON),u.s.portalItem=new o.default({id:t}),this.analysisTemplateNameChanged.emit(u.s.rftProperties.name)):u.s.hasUnsavedChanges=!0}catch(e){console.error("Unable to display selected Raster function template.")}}},this.createRfxDetailsEditor=({detailsEditorRfxTemplate:e,detailsEditorRfxSchema:t,detailsEditorRfxNode:a})=>{const i=(({rfxTemplate:e,mapLayers:t,schema:a,title:i,handlePanelClose:o,handlePanelOk:n,handlePanelCancel:r,createLayerBrowse:s})=>{const l=document.createElement("rfx-details-editor");l.rfxTemplate=e,l.schema=a,l.mapLayers=t,l.addEventListener("rfxDetailsEditorBrowseLayerClick",s);const d=(0,m.a)("rfx-modal","",{open:!0});d.setAttribute("style","--calcite-modal-height: 32rem"),d.addEventListener("rfxModalClose",(()=>{o()})),d.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await l.okClicked();n({rfxTemplate:e})})),d.addEventListener("rfxModalSecondaryClick",(()=>{r()}));const c=(0,m.a)("div",i,{slot:"header"});d.appendChild(c);const h=document.createElement("div");return h.slot=f.R.content,h.appendChild(l),d.appendChild(h),d})({rfxTemplate:e,schema:t,title:(0,d.q)(e,this.translatedRFTNamesMap,!0)??e?.name,mapLayers:this.mapLayers,createLayerBrowse:this.createLayerBrowse,handlePanelClose:()=>{i.remove()},handlePanelOk:e=>{const{rfxTemplate:t}=e;a?.read(t),i.remove()},handlePanelCancel:()=>{i.remove()}});document.body.appendChild(i)},this.createLayerBrowse=e=>{const t=e.detail;let a=(0,m.b)({modalStrings:{header:this.strings.browseLayer},portal:this.portal,user:this.portal.user,filter:t.filter||'(type: "Image Service")',selectionMode:"single-sublayer",onClose:()=>{a.remove(),a=void 0},onSelection:e=>{this.updateLayerValue(t.isFeatureSelectElement,t.referenceElement,e)}});document.body.appendChild(a)},this.updateLayerValue=(e,t,a)=>{if(null!==a.detail&&void 0!==a.detail){const e=a.detail;t.updateBrowsedLayer(e)}},this.handleAddFunctionClick=()=>{this.visibilityReducer({key:"rfxListView",visible:!0})},this.handleAddConstantClick=e=>{const{value:t}=e||{};this.rfxCoreServices.addScalarNodeCommand.execute({value:t}),u.s.hasUnsavedChanges=!0},this.handleAddRasterClick=e=>{const{value:t}=e||{};this.rfxCoreServices.addRasterNodeCommand.execute({value:t}),u.s.hasUnsavedChanges=!0},this.handleDontSaveClick=()=>{this.handleCloseClick(),this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0},this.handleRunClick=()=>{},this.handleSaveClick=()=>{},this.handleCloseClick=()=>{this.clearState(),this.analysisRFTEditorClose.emit()},this.clearState=()=>{u.s.hasUnsavedChanges=!1,u.s.rftJSON=void 0,u.s.rftProperties=void 0,u.s.portalItem=void 0,this.rfxEditorCoreElement.clearAll(),this.analysisTemplateNameChanged.emit()},this.handleDiagramZoomIn=()=>{this.rfxCoreServices.diagramZoomInCommand.execute()},this.handleDiagramZoomOut=()=>{this.rfxCoreServices.diagramZoomOutCommand.execute()},this.handleDiagramAutoLayout=()=>{this.rfxCoreServices.diagramAutoLayoutCommand.execute()},this.handleDiagramStretch=()=>{this.rfxCoreServices.diagramStretchCommand.execute()},this.handleDiagramPan=()=>{this.rfxCoreServices.diagramPanCommand.execute()},this.handleDiagramDeleteSelected=()=>{this.rfxCoreServices.deleteSelectedItemsCommand.execute()},this.handleRFTLaunch=async()=>{try{let e=await this.rfxCoreServices.getModelCommand.execute();e=(0,l.m)(u.s.rftProperties)?{...e,name:this.strings.defaultTemplateName,description:""}:C(e,u.s.rftProperties),void 0!==u.s.portalItem&&(e.sourceItemId=u.s.portalItem.id);const t=()=>{this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0,this.analysisRFTLaunch.emit(e)},a=()=>{this.handleRFTSaveOnClose()};void 0!==e&&(!0===u.s.hasUnsavedChanges?(this.showCloseWithoutSavingModal(t,a),u.s.rftJSON=e):this.analysisRFTLaunch.emit(e))}catch{this.showErrorModal()}},this.handleDiagramSelect=()=>{this.rfxCoreServices.diagramSelectCommand.execute()},this.handleRFTSave=async()=>{try{let e=await this.rfxCoreServices.getModelCommand.execute();e=C(e,u.s.rftProperties),u.s.rftJSON=e;const t=g(e),a=u.s.portalItem?.toJSON(),i=await(0,m.u)(u.s.portalItem,{itemProperties:{...a,title:u.s.rftProperties.name,snippet:u.s.rftProperties.description,thumbnail:u.s.rftProperties.thumbnail},itemData:t});i.success&&(u.s.portalItem=i.item,u.s.hasUnsavedChanges=!1,document.body.appendChild((0,m.d)({modalStrings:{content:this.strings.saveSuccess.replace("${template}",i.item.title)}})),this.analysisTemplateNameChanged.emit(i.item.title))}catch{this.showErrorModal()}},this.showErrorModal=()=>{const e=(0,m.e)({modalStrings:{header:this.strings.templateInvalidModalTitle,content:this.strings.templateInvalidModalMsg,cancel:this.strings.cancel}});!1===document.body.contains(e)&&(document.body.appendChild(e),e.open=!0)},this.closeSaveModal=()=>{void 0!==this.saveModalElement&&(this.saveModalElement.removeEventListener("cancelClick",this.closeSaveModal),this.saveModalElement.remove(),this.saveModalElement=void 0)},this.saveAsItem=async e=>{const t=e.detail.itemProperties;u.s.rftProperties={...u.s.rftProperties,name:t.title,description:t.snippet};const a=C(u.s.rftJSON,u.s.rftProperties);u.s.rftJSON=a;const i=g(a);t.fileType="json";const o=await(0,m.c)({itemProperties:{...t,thumbnail:u.s.rftProperties.thumbnail},itemData:i},this.portal);o.success&&(u.s.portalItem=o.item,u.s.hasUnsavedChanges=!1,document.body.appendChild((0,m.d)({modalStrings:{content:this.strings.saveSuccess.replace("${template}",o.item.title)}})),this.analysisTemplateNameChanged.emit(o.item.title)),this.closeSaveModal()},this.closeItemBrowser=()=>{void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("rfxItemBrowserClose",this.closeItemBrowser),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0)},this.handleRFTSaveAs=async()=>new Promise((async e=>{const{portal:t,closeSaveModal:a,saveAsItem:i}=this;this.saveModalElement?.remove();try{const o=await this.rfxEditorCoreElement.getModel();u.s.rftJSON=o,void 0!==o&&(this.saveModalElement=(0,m.f)({portal:t,portalItem:u.s.portalItem,itemProps:void 0!==u.s.rftProperties?{title:u.s.rftProperties.name,snippet:u.s.rftProperties.description}:void 0,onCancel:()=>{a(),e(!1)},onSave:t=>{i(t),e(!0)}}),document.body.appendChild(this.saveModalElement))}catch{this.showErrorModal(),e(!1)}})),this.handleRFxTemplateEditorPanelClose=()=>{void 0!==this.templateEditorElement&&(this.templateEditorElement.remove(),this.templateEditorElement=void 0)},this.handleRFxTemplateEditorPanelSave=e=>{u.s.rftProperties=e,u.s.hasUnsavedChanges=!0,this.templateEditorElement?.remove()},this.handleOpenTemplateEditor=()=>{this.templateEditorElement=(0,m.g)({templateProperties:u.s.rftProperties,modalStrings:{header:this.strings.templatePropertiesTitle},onCancel:this.handleRFxTemplateEditorPanelClose,onSave:this.handleRFxTemplateEditorPanelSave}),document.body.appendChild(this.templateEditorElement)},this.handleRFTShare=()=>{const{portal:e}=this;this.shareModalElement?.remove(),this.shareModalElement=(0,m.h)({portal:e,portalItem:u.s.portalItem}),this.shareModalElement.addEventListener("rfxShareSuccessful",(()=>{this.shareModalElement?.remove(),this.shareModalElement=void 0})),document.body.appendChild(this.shareModalElement)},this.handleRFxListViewTriggerSelectFunction=async e=>{e.stopPropagation();const{detail:t}=e,a=await(0,r.b)(t);this.rfxCoreServices.addRFxFunctionCommand.execute(a),u.s.hasUnsavedChanges=!0},this.handleRFxListViewPanelClose=e=>{e.stopPropagation(),this.visibilityReducer({key:"rfxListView",visible:!1})},this.createRasterNodeEditor=(e,t)=>{const a=(0,m.i)({heading:this.strings.browseLayerDialogTitle,inputLayers:(0,c.q)(this.mapLayers).imageryLayers,layerValue:t,handlePanelOk:t=>{e.value=t.rasterValue,a?.remove()},handlePanelClose:()=>{a?.remove()},createLayerBrowse:this.createLayerBrowse});document.body.appendChild(a)},this.handlePopoverClose=()=>{(0,p.r)(this.toolHelpPopover)},this.showRfxList=!1,this.mapView=void 0,this.mapLayers=void 0,this.portal=void 0,this.portalItem=void 0,this.renderFlag=!1}handleActionBarClick(e){switch(e.detail.actionId){case n.E.newTemplate:this.handleNewTemplateClick();break;case n.E.openTemplate:this.handleOpenTemplateClick();break;case n.E.addFunction:this.handleAddFunctionClick();break;case n.E.addConstant:this.handleAddConstantClick();break;case n.E.addRaster:this.handleAddRasterClick()}}async onPanelClose(){return new Promise((async e=>{!0===u.s.hasUnsavedChanges?e(await this.showUnsavedChangesDialog()):(this.handleCloseClick(),e(!0))}))}async componentWillLoad(){({strings:this.strings,dir:this.direction,locale:this.locale}=await(0,s.b)(this.hostElement,(0,i.g)("."))),this.translatedRFTNamesMap=await async function(){const e=new Map,{rfxFunctions:t}=await(0,r.a)();for(const a of t)(0,l.m)(a)||e.set(a.name,a.title);return e}()}disconnectedCallback(){(0,p.r)(this.toolHelpPopover)}visibilityReducer({key:e,visible:t}){const a=this.overlayElementsConfig[e];if(a.visible!==t){if(!0===t){const e=Object.values(this.overlayElementsConfig).filter((e=>e.slot===a.slot));e.length>=2&&e.slice(1).forEach((e=>{e.visible=!1}))}a.visible=t,this.scheduleRenderer()}}scheduleRenderer(){this.renderFlag=!this.renderFlag}renderOverlayElements(){const e={addRasterFunctionTitle:this.strings.addRasterFunctionTitle,templatePropertiesTitle:this.strings.templatePropertiesTitle,browseLayerDialogTitle:this.strings.browseLayerDialogTitle},t=this.overlayElementsConfig;return Object.keys(t).map((a=>{const i=t[a];if(!i.visible)return[];const o=i?.builder?.(e);return o}))}_renderEditorCoreUI(){return(0,i.h)("rfx-editor-core",{ref:this.initializeRFxEditorCore,onRfxCoreNodeEditProperties:e=>{e.stopPropagation();const{detail:t}=e;switch(this.handlePopoverClose(),t.dataType){case"Raster":this.createRasterNodeEditor(t.node,t.json);break;case"Tool":if((0,u.i)({category:t.schema?.category}))return;this.createRfxDetailsEditor({detailsEditorRfxTemplate:t.json,detailsEditorRfxSchema:t.schema,detailsEditorRfxNode:t.node})}},onRfxCoreNodeDuplicate:async e=>{e.stopPropagation();const{detail:t}=e;switch(t.dataType){case"Raster":this.handleAddRasterClick({value:t.value});break;case"Scalar":this.handleAddConstantClick({value:t.value.value});break;case"Tool":const e=(0,r.e)(t.json),a=await(0,r.b)(e);this.rfxCoreServices.addRFxFunctionCommand.execute(a)}},onRfxCoreDeprecatedFunctionFound:e=>{e.stopPropagation();const t=this.portal?.sourceJSON?.helpBase||r.i.learnMoreDocBaseURL,a=r.i.learnMoreDocDeprecatedHelpID,i=(0,s.f)(a,t,this.locale),{detail:o}=e,n=`${this.strings.deprecatedFunctions}${o}`;document.body.appendChild((0,m.j)({modalStrings:{content:(0,h.f)(this.strings.deprecatedFunctionAlertContent,{docLink:i}),header:this.strings.deprecatedFunctionAlertHeader,functionNames:n}}))}},this.renderOverlayElements())}render(){return(0,i.h)(i.H,{class:"host"},(0,i.h)("div",{class:{content:!0,"arcgis--rtl":"rtl"===this.direction}},(0,i.h)("slot",{name:"action-bar"}),(0,i.h)("calcite-panel",{heading:""},this._renderEditorCoreUI())))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,i.a)(this)}};S.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.host{height:100%;width:100%}.content{height:100%;display:flex;overflow:hidden}.action-bar{height:100%;border-width:0 1px 0 0;border-style:solid;border-color:var(--calcite-color-border-2)}.menu-actions{display:inline-flex;justify-self:stretch}.header-actions{height:100%}.tooltip{white-space:nowrap}.arcgis--rtl .action-bar{border-width:0 0 0 1px}.editor-container{position:relative;}.overlay-element{z-index:3;box-shadow:0 0 5px rgba(0, 0, 0, 0.2);border-radius:0.25rem}.overlay-panel{max-height:30rem;max-width:22rem;width:22rem}.list-wrapper{display:flex}",a(34319),a(25829),a(826),a(46717),a(55139),a(57098),a(91123),a(78979),a(46869),a(90949)},78816:(e,t,a)=>{a.d(t,{I:()=>l,a:()=>x,b:()=>g,c:()=>m,d:()=>R,e:()=>T,f:()=>f,g:()=>S,h:()=>C,i:()=>P,j:()=>F,k:()=>u,l:()=>p,m:()=>v,u:()=>h});var i=a(74656),o=a(27703),n=a(92123),r=a(90949);const s={JSON:"json",XML:"xml"},l={RASTER_FUNCTION_TEMPLATE:"Raster function template"};function d(e){const t=new FormData,{itemProperties:a,itemData:i}=e,{title:o,description:r,tags:d,type:c,snippet:h,properties:m,categories:p}=a,u=a.fileType||s.JSON;if(t.append("title",o),(0,n.m)(i)){let e="";c===l.RASTER_FUNCTION_TEMPLATE&&(e="rft");const a=`${o}.${void 0!==e?e+".":""}${u}`;t.append("file",i,a),t.append("name",a)}return t.append("type",c),void 0!==r&&t.append("description",r),void 0!==h&&t.append("snippet",h),void 0!==d&&t.append("tags",d.join(",")),void 0!==m&&t.append("properties",JSON.stringify(m)),void 0!==p&&t.append("categories",p.join(",")),t.append("f","json"),t}async function c(e,t,a){const{thumbnail:o,shareOptions:r}=a,s={success:!0,errors:[]};if(e.data){const a=e.data.id,l=new i.default({id:a,portal:t});return s.item=l,l.load().then((()=>(void 0!==o&&l.updateThumbnail({thumbnail:o}),(0,n.m)(r),Promise.resolve(s))))}}function h(e,t){((0,n.m)(t)||(0,n.m)(e))&&Promise.reject(new Error("Item data or item not present"));const a=e.portal,i=`${a.user.userContentUrl}/items/${e.id}/update`;return(0,o.r)(`${i}`,{body:d(t)}).then((e=>c(e,a,t.itemProperties)),(e=>({success:!1,errors:[e]})))}function m(e,t){((0,n.m)(e)||(0,n.m)(t))&&Promise.reject(new Error("Item data or portal not present"));const{itemProperties:a}=e,i=t.user;if((0,n.m)(i))return;const{ownerFolder:r}=a,s=void 0!==r&&r.id!==r.title?r.id:void 0,l=(0,n.m)(s)?`${i.userContentUrl}/addItem`:`${i.userContentUrl}/${s}/addItem`;return(0,o.r)(l,{body:d(e)}).then((e=>c(e,t,a)),(e=>({success:!1,errors:[e]})))}const p=({label:e,open:t})=>{const a=document.createElement("rfx-section");return a.label=e,a.open=t,a},u=({content:e,unsupportedWarningComponent:t,title:a,isFunctionChain:i})=>{const o=document.createElement("calcite-block");return o.open=!0,!0===i&&(o.heading=a,o.collapsible=!0,o.headingLevel=3),(0,n.m)(t)||o.appendChild(t),o.appendChild(e),o},v=({label:e,hideHelp:t=!1,onHelpActionClick:a})=>{const i=document.createElement("rfx-label");return i.label=e,i.hideHelp=t,i.addEventListener("rfxLabelHelpActionClick",a),i},f=({portal:e,portalItem:t,itemProps:a,onCancel:i,onSave:o})=>{const n=document.createElement("rfx-save-modal");return n.portal=e,n.portalItem=t,n.itemProps=a,n.addEventListener("cancelClick",i),n.addEventListener("saveClick",o),n},C=({portal:e,portalItem:t})=>{const a=document.createElement("rfx-share-modal");return a.portal=e,a.portalItem=t,a},g=({modalStrings:{header:e},portal:t,user:a,filter:i,selectionMode:o,onClose:n,onSelection:r})=>{const s=document.createElement("rfx-item-browser");return s.portal=t,s.user=a,s.header=e,s.filter=i,s.selectionMode=o??"single",s.addEventListener("rfxItemBrowserClose",n),s.addEventListener("rfxItemBrowserSelection",r),s},S=({templateProperties:e,modalStrings:{header:t},onCancel:a,onSave:i})=>{const o=document.createElement("rfx-modal"),n=document.createElement("div");n.innerHTML=t,n.slot="header",o.appendChild(n);const r=document.createElement("rfx-template-editor");r.value=e;const s=document.createElement("div");return s.slot="content",s.style.height="50vh",s.appendChild(r),o.appendChild(s),o.addEventListener("rfxModalSecondaryClick",a),o.addEventListener("rfxModalPrimaryClick",(()=>{i(r.value)})),o},x=(e,t,a)=>{const i=document.createElement(e);var o,n;return o=i,n=a,Object.keys(n).forEach((e=>{o.setAttribute(e,n[e])})),i.innerHTML=t,i},y={kind:"warning"},E={slot:"header",style:"\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    "},w={icon:"exclamation-mark-triangle-f",style:"\n      margin: 0 1rem;\n      --calcite-ui-icon-color: var(--calcite-color-status-warning);\n    "},b={slot:"content"},T=({modalStrings:{header:e,content:t}})=>{const a=x("rfx-modal","",y);a.showPrimaryButton=!1;const i=x("div","",E),o=x("div",e,{}),n=x("calcite-icon","",w);i.appendChild(n),i.appendChild(o);const r=x("div","",b);return r.appendChild(x("p",t,{})),a.appendChild(i),a.appendChild(r),a.addEventListener("rfxModalSecondaryClick",(()=>{a.remove(),a.open=!1})),a},R=({modalStrings:{content:e}})=>{const t=x("calcite-alert",e,{kind:"success",scale:r.C.l,open:!0,label:"save success"});t.autoClose=!0;const a=x("div",e,{slot:"message"});return t.appendChild(a),t},F=({modalStrings:{content:e,header:t,functionNames:a}})=>{const i=x("calcite-alert",e,{kind:"warning",scale:r.C.m,open:!0,label:"deprecate function"});i.autoClose=!0;const o=x("div",t,{slot:"title"}),n=x("div",e,{slot:"message"}),s=x("p",a,{});return n.appendChild(s),i.appendChild(n),i.appendChild(o),i},P=({heading:e,handlePanelClose:t,handlePanelOk:a,inputLayers:i,layerValue:o,createLayerBrowse:n})=>{let r;const s=x("rfx-modal","",{open:!0});s.addEventListener("rfxModalClose",t),s.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await(r?.getRasterValue());a({rasterValue:e})})),s.addEventListener("rfxModalSecondaryClick",t);const l=x("div",e,{slot:"header"}),d=x("div","",{slot:"content"});return s.appendChild(l),r=document.createElement("rfx-select-layer-panel"),r.value=o?.value,r.inputLayers=i,s.addEventListener("rfxlayerSelectBrowseLayerClick",n),d.appendChild(r),s.appendChild(d),s}}}]);