/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-7cc88f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-7cc88f"],{68927:(e,t,i)=>{i.r(t),i.d(t,{arcgis_smart_mapping_panels_color:()=>c});var o=i(35110),r=i(59503),s=i(37192),n=i(61886),a=(i(21104),i(2137),i(28642)),l=i(86587);i(1984),i(63280),i(23505),i(89393),i(73838);const c=class{constructor(e){(0,o.r)(this,e),this.smartMappingCompleteClose=(0,o.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsColorClose=(0,o.c)(this,"arcgisSmartMappingPanelsColorClose",7),this.arcgisSmartMappingPanelsColorBackClick=(0,o.c)(this,"arcgisSmartMappingPanelsColorBackClick",7),this.arcgisSmartMappingPanelsColorError=(0,o.c)(this,"arcgisSmartMappingPanelsColorError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsColorClose.emit("save")},this.handleCancel=()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,r.k)(e,t),this.arcgisSmartMappingPanelsColorClose.emit("cancel")},this.hideTransparency=!1,this.hideRotation=!1,this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.visualizationOpen=!1}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:t}=r.s,i=(0,r.j)(e);this.originalRendererJSON=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,s.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){const{layer:e,hideLayerTitle:t,isRTL:i,strings:s}=r.s;return(0,o.h)(o.H,{class:"calcite-match-height"},(0,o.h)("calcite-flow-item",{heading:s.panels.styleOptions,description:t?void 0:e.title,class:{"flow-item":!0,[l.C.rtl]:i},closable:(0,r.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsColorBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:t}=r.s;return e?(0,o.h)("calcite-button",{slot:"footer",label:t.done,onClick:this.handleDone,appearance:"solid",width:"half"},t.done):null}renderCancelButton(){const{layer:e,strings:t}=r.s;return e?(0,o.h)("calcite-button",{slot:"footer",label:t.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},t.cancel):null}renderVisualization(){var e,t;const{visualizationOpen:i,hideTransparency:s,hideRotation:n}=this,{layer:a,strings:l}=r.s,c=(0,r.g)(),d=["color-age","color-age-size"].indexOf(c)>-1,h=(0,r.j)(a),p=(0,r.a)(h,"color"),g=p?p.field?null===(e=(0,r.x)(p.field))||void 0===e?void 0:e.label:p.valueExpressionTitle||l.expression:h.field?null===(t=(0,r.x)(h.field))||void 0===t?void 0:t.label:h.valueExpressionTitle||l.expression,m=(0,r.h)(a)[0].simpleFieldType===r.z.DATE;return(0,o.h)("calcite-block",{class:"color-block",heading:d?l.panels.color.colorAgeStyle:m?l.panels.color.colorStyleDate:l.panels.color.colorStyle,collapsible:!s||!n,open:i,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},d?null:(0,o.h)("calcite-label",{class:"attribute-name"},g),this.renderAge(),this.renderTheme(),this.renderDividedBy(),this.renderSymbol(),this.renderColorSlider(),this.renderBackgroundStyle(),this.renderDefaultSymbol(),this.renderShowInLegend(),this.renderClassify())}renderAge(){const e=(0,r.g)();return["color-age","color-age-size"].indexOf(e)>-1?(0,o.h)("arcgis-smart-mapping-age",{rendererSubtype:"color",onArcgisSmartMappingAgeChange:()=>this.sliderNode.updateStatistics(),onArcgisSmartMappingAgeError:e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)}):null}renderTheme(){const{layer:e}=r.s,t=(0,r.j)(e);if(!(0,r.a)(t,"color"))return null;const i=(0,r.g)();return(0,o.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:"color",onArcgisSmartMappingThemeButtonBeforeOpen:()=>(0,r.l)(),onArcgisSmartMappingThemeButtonChange:t=>{let s=a.b;["color-age","color-age-size"].indexOf(i)>-1&&(s=a.d),(0,n.r)(s({theme:t.detail,discardMinMax:!0}),this.flowItemNode).then((t=>{const i=(0,r.j)(e);i.visualVariables=(0,r.q)(i,"color")||[],i.visualVariables.push((0,r.a)(t.renderer,"color")),i.authoringInfo.visualVariables=(0,r.r)(i,"color")||[],i.authoringInfo.visualVariables.push((0,r.t)(t.renderer,"color")),(0,r.ab)(),(0,o.f)(this.hostElement),this.themeButtonNode&&(0,o.f)(this.themeButtonNode),this.sliderNode&&((0,o.f)(this.sliderNode),this.sliderNode.updateStatistics())}),(e=>{(0,o.f)(this.themeButtonNode),this.arcgisSmartMappingPanelsColorError.emit(e)}))}})}renderDividedBy(){const{layer:e,fields:t}=r.s,i=(0,r.j)(e),s=(0,r.g)();if(["color-age","color-age-size"].indexOf(s)>-1)return null;if((0,r.K)(t).number<2)return null;const n=(0,r.a)(i,"color");if(n){const e=(0,r.x)(n.field),t={field:n.field,expression:n.valueExpression,expressionTitle:n.valueExpressionTitle,simpleFieldType:e?e.simpleFieldType:r.z.NUMBER};if(t.expression||t.simpleFieldType!==r.z.NUMBER)return null}return(0,o.h)("arcgis-smart-mapping-divided-by",{rendererSubtype:"color",normalizationField:n?n.normalizationField:i.normalizationField,onArcgisSmartMappingDividedByChange:()=>{(0,o.f)(this.hostElement),this.sliderNode.updateStatistics(),this.classifyNode&&(0,o.f)(this.classifyNode)},onArcgisSmartMappingDividedByError:e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)})}renderSymbol(){const{layer:e}=r.s,t=(0,r.j)(e),i=(0,r.a)(t,"color"),s=t.classBreakInfos,n=s[0].symbol;let a;return i?a=i.stops.map((e=>{const t=e.color.clone();return t.a=1,t})):(null==s?void 0:s.length)&&(a=s.map((e=>(0,r.w)(e.symbol)))),(0,o.h)("arcgis-smart-mapping-symbol-button",{symbol:n,colors:a,type:"color-ramp",rampType:i?"continuous":"discrete",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,o.f)(this.hostElement),this.sliderNode&&(0,o.f)(this.sliderNode),this.classifyNode&&(0,o.f)(this.classifyNode),this.rotationNode&&(0,o.f)(this.rotationNode)}})}renderColorSlider(){return(0,o.h)("arcgis-smart-mapping-color-slider",{ref:e=>{e&&(this.sliderNode=e)},onArcgisSmartMappingColorSliderChange:()=>{(0,o.f)(this.hostElement),this.sliderNode&&(0,o.f)(this.sliderNode),this.classifyNode&&(0,o.f)(this.classifyNode),this.rotationNode&&(0,o.f)(this.rotationNode)},onArcgisSmartMappingColorSliderError:e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)})}renderBackgroundStyle(){const{layer:e}=r.s,t=(0,r.g)();return(0,r.u)(e)&&-1!==["color-size"].indexOf(t)?(0,o.h)("arcgis-smart-mapping-background-symbol",null):null}renderDefaultSymbol(){return(0,o.h)("arcgis-smart-mapping-default-symbol",{ref:e=>{e&&(this.defaultSymbolNode=e)},onArcgisSmartMappingDefaultSymbolBeforeToggle:()=>(0,r.l)(),onArcgisSmartMappingDefaultSymbolChange:()=>(0,o.f)(this.symbolButtonNode)})}renderShowInLegend(){const{layer:e,strings:t}=r.s,i=(0,r.j)(e),s=(0,r.a)(i,"color");if(!s)return null;const n=s.legendOptions,a=!n||!1!==n.showLegend;return(0,o.h)("calcite-label",{class:"legend-toggle-padding",layout:"inline-space-between"},t.panels.color.includeInLegend,(0,o.h)("calcite-switch",{scale:"s",checked:a,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderClassify(){const{layer:e}=r.s,t=(0,r.j)(e),i=(0,r.g)(),s=(0,r.h)(e)[0].simpleFieldType===r.z.DATE,n=["color-age","color-age-size"].indexOf(i)>-1;if("color"!==i||s||n)return null;const a=t.classBreakInfos;return(0,o.h)("arcgis-smart-mapping-classify",{ref:e=>this.classifyNode=e,onArcgisSmartMappingClassifyChange:e=>{const t=e.detail;((null==t?void 0:t.closePopovers)||(null==t?void 0:t.classesChange))&&(0,r.l)(),((null==t?void 0:t.classesChange)||(null==t?void 0:t.symbolChange))&&(this.symbolButtonNode.colors=a.map((e=>(0,r.w)(e.symbol)))),(0,o.f)(this.hostElement),this.sliderNode&&(0,o.f)(this.sliderNode),((null==t?void 0:t.toggle)||!(null==t?void 0:t.symbolChange)&&!(null==t?void 0:t.closePopovers))&&this.sliderNode.updateStatistics(),this.classifyNode&&(0,o.f)(this.classifyNode),this.symbolButtonNode&&(0,o.f)(this.symbolButtonNode),this.defaultSymbolNode&&(0,o.f)(this.defaultSymbolNode)},onArcgisSmartMappingClassifyError:e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)})}renderTransparency(){const{hideTransparency:e}=this;if(e)return;const{layer:t}=r.s,i=(0,r.j)(t),s=(0,r.a)(i,"opacity");return(0,o.h)("arcgis-smart-mapping-transparency",{open:!!s,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsColorError.emit(e)})}renderRotation(){const{hideRotation:e}=this;if(e)return;const{layer:t}=r.s,i=(0,r.j)(t),s=(0,r.a)(i,"opacity"),n=(0,r.a)(i,"rotation");return(0,o.h)("arcgis-smart-mapping-rotation",{open:!s&&!!n,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsColorError.emit(e)})}handleIncludeInLegendToggle(){const{layer:e}=r.s,t=(0,r.j)(e),i=(0,r.a)(t,"color"),o=i.legendOptions;o&&!1===o.showLegend?o.title?o.showLegend=!0:i.legendOptions=void 0:(i.legendOptions=o||{},i.legendOptions.showLegend=!1),(0,r.ab)()}get hostElement(){return(0,o.d)(this)}};c.style=":host{width:100%}.flow-item{height:100%}.color-block{overflow-x:hidden}.attribute-name{word-break:break-all}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}"},37192:(e,t,i)=>{i.d(t,{w:()=>r});var o=i(59503);function r(e,t){const{layer:i,mapView:r,useFeatureReduction:n}=o.s;if(!n||!("featureReduction"in i)||"binning"!==i.featureReduction.type)return;const a=o.s.modules.reactiveUtils.watch((()=>r.scale),(()=>{const n=i.featureReduction;r.scale<=n.maxScale&&!e.disabled?((0,o.l)(),function(e,t){const i=document.createElement("arcgis-smart-mapping-scale-alert-popover");i.refElement=e,i.addEventListener("arcgisSmartMappingScaleAlertPopoverBack",(()=>{s(),t()})),document.body.append(i)}(e,t),(0,o.m)(e,!0)):r.scale>n.maxScale&&e.disabled&&(s(),(0,o.m)(e,!1),e.setFocus())}));return a}function s(){document.querySelectorAll("arcgis-smart-mapping-scale-alert-popover").forEach((e=>{var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e),e=null}))}i(21104),i(2137)},61886:(e,t,i)=>{let o,r;function s(e){e.loading=!1}function n(e,t){return function(e){e.loading=!0,r=!1,o&&clearTimeout(o),o=setTimeout((()=>{s(e),r=!0}),6e4)}(t),e.then((e=>(s(t),r?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(s(t),Promise.reject(e))))}i.d(t,{r:()=>n})}}]);