/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-098f78.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-098f78"],{21629:(e,t,i)=>{i.r(t),i.d(t,{arcgis_image_display_order:()=>h});var a=i(35110),s=i(88703),l=i(1984),n=i(86587);i(63280),i(21104),i(73838);const r=["center","northwest","lock-raster","attribute","nadir","viewpoint","seamline","none"],o=["first","last","min","max","mean","blend","sum"],c=["double","single","long","integer","small-integer","oid","date","big-integer","date-only"],u=e=>"seamline"===e?["first","blend"]:o,h=class{constructor(e){(0,a.r)(this,e),this.arcgisImageDisplayOrderClose=(0,a.c)(this,"arcgisImageDisplayOrderClose",7),this.mosaicMethodList=r,this.attributeFieldList=[],this.handleMosaicMethodChange=e=>{var t,i,a;const s=null===(t=e.target.selectedOption)||void 0===t?void 0:t.value,{lockRasterIds:l,operation:n}=this.activeMosaicRule,r="attribute"===s?null===(a=null===(i=this.attributeFieldList)||void 0===i?void 0:i[0])||void 0===a?void 0:a.name:null,o="lock-raster"!==s?null:l,c="seamline"!==s||null,h=u("seamline"),d="seamline"===s&&h.includes(n)?n:"first";this.activeMosaicRule.method=s,this.activeMosaicRule.sortField=r,this.activeMosaicRule.sortValue=null,this.activeMosaicRule.lockRasterIds=o,this.activeMosaicRule.ascending=c,this.activeMosaicRule.operation=d,this.updateActiveMosaicRule()},this.handleAttributeFieldChange=e=>{var t;const i=null===(t=e.target.selectedOption)||void 0===t?void 0:t.value;this.activeMosaicRule.sortField=i,this.updateActiveMosaicRule()},this.debouncedHandleAttributeValueChange=(0,s.d)((e=>{this.activeMosaicRule.sortValue=e,this.updateActiveMosaicRule()}),300),this.handleDateAttributeValueChange=e=>{const t=e.target,i=(null==t?void 0:t.value).replace(/\-/g,"/");this.debouncedHandleAttributeValueChange(i)},this.handleAttributeValueChange=e=>{const t=e.target,i=+(null==t?void 0:t.value);this.debouncedHandleAttributeValueChange(i)},this.debouncedHandleRasterIDsChange=(0,s.d)((e=>{this.activeMosaicRule.lockRasterIds=e,this.updateActiveMosaicRule()}),300),this.handleRasterIDsChange=e=>{const t=e.target,i=null==t?void 0:t.value;if(!/^[0-9]+(,[0-9]+)*$/.test(i))return;const a=i.split(",").map((e=>parseInt(e,10)));this.debouncedHandleRasterIDsChange(a)},this.debouncedHandleReverseOrderChange=(0,s.d)((e=>{this.activeMosaicRule.ascending=!e,this.updateActiveMosaicRule()}),300),this.handleReverseOrderChange=e=>{const t=e.target,i=null==t?void 0:t.checked;this.debouncedHandleReverseOrderChange(i)},this.handleMosaicOperatorChange=e=>{var t;const i=null===(t=e.target.selectedOption)||void 0===t?void 0:t.value;this.activeMosaicRule.operation=i,this.updateActiveMosaicRule()},this.handleDone=()=>{this.arcgisImageDisplayOrderClose.emit("save")},this.handleCancel=()=>{this.layer.mosaicRule=this.originalMosaicRule,this.activeMosaicRule=this.originalMosaicRule.clone(),this.arcgisImageDisplayOrderClose.emit("cancel")},this.layer=void 0,this.dismissible=!1,this.activeMosaicRule=null}watchStateHandler(e,t){e&&t&&(this.layer.mosaicRule=e)}async componentWillLoad(){const[e]=await(0,l.g)(this.hostElement);this.strings=e,this.init()}render(){const e="rtl"===(0,n.g)(this.hostElement);return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-panel",{heading:this.strings.imageDisplayOrder,closable:this.dismissible,loading:!this.activeMosaicRule,onCalcitePanelClose:this.handleCancel,class:{panel:!0,[n.C.rtl]:e}},this.renderMosaicRule(),this.renderFooterActions()))}renderMosaicRule(){if(!this.activeMosaicRule)return null;const e=this.activeMosaicRule.method,t="attribute"===e,i="lock-raster"===e,s="seamline"!==e;return(0,a.h)("calcite-block",{heading:"",open:!0},this.renderMosaicMethodSelection(),t&&this.renderAttributeFilter(),i&&this.renderRasterId(),s&&this.renderReverseOrder(),this.renderMosaicOperatorSelection())}renderMosaicMethodSelection(){const{method:e}=this.activeMosaicRule,{mosaicMethod:t,componentLabel:i,mosaicMethodLabel:s}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-select",{label:i.methodSelect,onCalciteSelectChange:this.handleMosaicMethodChange},this.mosaicMethodList.map((t=>(0,a.h)("calcite-option",{key:t,value:t,label:s[t],selected:t===e})))))}renderAttributeFilter(){var e;const{sortField:t}=this.activeMosaicRule,i=null===(e=this.attributeFieldList.find((({name:e})=>e===t)))||void 0===e?void 0:e.type,s="date"===i||"date-only"===i;return(0,a.h)("div",null,this.renderAttributeMethodSelection(),s?this.renderAttributeDatePicker():this.renderAttributeSortValue())}renderAttributeMethodSelection(){const{sortField:e}=this.activeMosaicRule,{attribute:t,componentLabel:i}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-select",{label:i.attributeFieldSelect,onCalciteSelectChange:this.handleAttributeFieldChange},this.attributeFieldList.map((({name:t,alias:i})=>(0,a.h)("calcite-option",{key:t,value:t,label:i,selected:t===e})))))}renderAttributeDatePicker(){const{sortValue:e}=this.activeMosaicRule,{highestPriorityValue:t}=this.strings,i=(null==e?void 0:e.toString().indexOf("/"))>-1?e.replace(/\//g,"-"):"";return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-input-date-picker",{placement:"bottom-end","overlay-positioning":"fixed",value:i,onCalciteInputDatePickerChange:this.handleDateAttributeValueChange}))}renderAttributeSortValue(){const{sortValue:e}=this.activeMosaicRule,{highestPriorityValue:t}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-input",{type:"number",step:.001,value:null==e?void 0:e.toString(),onCalciteInputInput:this.handleAttributeValueChange}))}renderRasterId(){const{lockRasterIds:e}=this.activeMosaicRule,t=null==e?void 0:e.join(",");return(0,a.h)("calcite-label",null,this.strings.imageIDs,(0,a.h)("calcite-input",{class:"image-display-order-lock-input",placeholder:this.strings.useCommaDelimiter,value:t,onCalciteInputInput:this.handleRasterIDsChange}))}renderReverseOrder(){const{ascending:e}=this.activeMosaicRule;return(0,a.h)("calcite-label",{layout:"inline-space-between"},this.strings.reverserOrder,(0,a.h)("calcite-switch",{checked:!e,onCalciteSwitchChange:this.handleReverseOrderChange}))}renderMosaicOperatorSelection(){const{method:e,operation:t}=this.activeMosaicRule,i=u(e),{mosaicOperator:s,componentLabel:l,mosaicOperatorLabel:n}=this.strings;return(0,a.h)("calcite-label",null,s,(0,a.h)("calcite-select",{label:l.operatorSelect,onCalciteSelectChange:this.handleMosaicOperatorChange},i.map((e=>(0,a.h)("calcite-option",{key:e,value:e,label:n[e],selected:e===t})))))}renderFooterActions(){return(0,a.h)(a.F,null,this.renderDoneButton(),this.renderCancelButton())}renderDoneButton(){return(0,a.h)("calcite-button",{slot:"footer",appearance:"solid",color:"blue",width:"half",disabled:!this.activeMosaicRule,onClick:this.handleDone},this.strings.done)}renderCancelButton(){return(0,a.h)("calcite-button",{slot:"footer",appearance:"outline-fill",width:"half",disabled:!this.activeMosaicRule,onClick:this.handleCancel},this.strings.cancel)}async init(){await this.layer.load(),this.originalMosaicRule=this.getOriginalMosaicRule(),this.activeMosaicRule=this.originalMosaicRule.clone(),this.mosaicMethodList=this.getMosaicMethodList(),this.attributeFieldList=this.getAttributeFieldList()}updateActiveMosaicRule(){this.activeMosaicRule=this.activeMosaicRule.clone()}getOriginalMosaicRule(){const{mosaicRule:e,defaultMosaicRule:t}=this.layer;return null!=e?e:t}getAllowedAttributeFieldList(){const{fields:e,sourceJSON:t}=this.layer,i=e.filter((({type:e})=>c.includes(e)));i.sort(((e,t)=>e.alias.localeCompare(t.alias)));const{sortableFields:a}=t||{};if(!(null==a?void 0:a.length))return i;const s=null==a?void 0:a.split(",").map((e=>e.toLowerCase()));return i.filter((e=>s.includes(e.name.toLocaleLowerCase())))}filterAttributeFieldList(e){var t,i;return"category"!==(null===(i=null===(t=this.layer.sourceJSON)||void 0===t?void 0:t.sortField)||void 0===i?void 0:i.toLowerCase())?e.filter((e=>"category"!==e.name.toLocaleLowerCase())):e}getAttributeFieldList(){const e=this.getAllowedAttributeFieldList();return this.filterAttributeFieldList(e)}getAllowedMosaicMethodList(){const{sourceJSON:e}=this.layer;if(!e)return r;const{currentVersion:t,allowedMosaicMethods:i}=e,a=t&&t>=10.1,s=(null==i?void 0:i.length)>1;if(!a||!s)return r;const l=i.split(",").map((e=>(e=>{switch(e=e.toLowerCase()){case"lockraster":case"lock-raster":return"lock-raster";case"byattribute":return"attribute";default:return e}})(e.toLowerCase()))),n="none";return l.includes(n)||l.push(n),l}filteredMosaicMethodList(e){return e.filter((e=>"viewpoint"!==e))}getMosaicMethodList(){const e=this.getAllowedMosaicMethodList();return this.filteredMosaicMethodList(e)}get hostElement(){return(0,a.d)(this)}static get watchers(){return{activeMosaicRule:["watchStateHandler"]}}};h.style=":host{display:flex;height:100%}.image-display-order-lock-input{margin-top:var(--arcgis-app-cap-spacing-half)}"},88703:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>d,c:()=>s,d:()=>a,e:()=>l,f:()=>u,g:()=>g,i:()=>n,m:()=>r,t:()=>o,u:()=>h});const a=(e,t)=>{let i,a="idle";const s=(...s)=>new Promise((l=>{switch(a){case"flushed":a="idle",i?(clearTimeout(i),l(e(...s))):l(null);break;case"invoked":clearTimeout(i),a="idle",l(e(...s));break;case"cancelled":clearTimeout(i),a="idle",l(null);break;default:i&&clearTimeout(i),a="pending",i=setTimeout((()=>(a="idle",l(e(...s)))),t)}}));return s.flush=function(...e){return a="flushed",s(...e)},s.invoke=function(...e){return a="invoked",s(...e)},s.cancel=function(...e){return a="cancelled",s(...e)},s.getStatus=function(){return a},s},s=(e,t)=>{let i;return(...a)=>new Promise((s=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,s(e(...a))}),t))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function r(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:a}=t(e);return[i,a]}))),u=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function h(e,t){const i=[],a={};return e.forEach((e=>{const s=t(e);null==a[s]&&(a[s]=e,i.push(e))})),i}function d(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let a=typeof e;return a in t?!t[a].hasOwnProperty(e)&&(t[a][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const g=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,a)=>e.slice(t*a,t+t*a)))}}]);