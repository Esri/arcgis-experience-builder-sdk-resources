/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-image-u-54d642.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-image-u-54d642"],{16041:(e,t,a)=>{a.r(t),a.d(t,{arcgis_image_upload_from_map:()=>r});var i=a(35110),s=a(21104),o=a(86587),l=a(1984);a(73838),a(63280);const r=class{constructor(e){(0,i.r)(this,e),this.arcgisImageUploadFromMapReady=(0,i.c)(this,"arcgisImageUploadFromMapReady",7),this.isRTL=!1,this.lang="en",this.handleBasemapToggle=()=>{const e=this.container.querySelector(".esri-basemap-gallery");"block"===e.style.display?e.style.display="none":e.style.display="block"},this.portal=void 0,this.itemId=void 0,this.changeBasemapText=void 0,this.loadingText=void 0,this.jsapiUrl=void 0,this.loading=!0}async componentWillLoad(){this.isRTL="rtl"===(0,o.g)(this.el),this.lang=(0,l.a)(this.el)}async componentDidLoad(){this.el.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${this.jsapiUrl}/themes/light/main.css" />`);try{const[e,t,a,i,o]=await(0,s.l)(["esri/portal/PortalItem","esri/Map","esri/WebMap","esri/layers/Layer","esri/layers/GraphicsLayer"]);if(this.map=new t({basemap:"streets-vector"}),this.item=new e({id:this.itemId}),await this.item.load(),["Feature Service","Feature Collection","Map Service","Vector Tile Service"].includes(this.item.type)){const e=await i.fromPortalItem({portalItem:this.item});e.visible=!0,this.map.add(e),e.when((()=>{e.popupEnabled=!1}))}let l="gray";if(this.portal.defaultBasemap&&(l=this.portal.useVectorBasemaps?this.portal.defaultVectorBasemap:this.portal.defaultBasemap),this.map.basemap=l,"Web Map"!==this.item.type)this.makeMapView();else{this.webMap=new a({portalItem:{id:this.item.id}});const e=await this.item.fetchData();if(parseFloat(e.version)<2)this.makeMapView(!0);else try{await this.webMap.load();const e=new o({id:"areaGraphics"});this.map.add(e),this.makeMapView()}catch(e){this.makeMapView(!0)}}}catch(e){console.error(e)}}async makeMapView(e){try{const[t]=await(0,s.l)(["esri/views/MapView"]),a=e||!this.webMap?this.map:this.webMap;this.mapView=new t({map:a,zoom:2,center:[0,0],container:this.container}),a.watch("basemap.title",(()=>{this.container.querySelector(".esri-basemap-gallery").style.display="none"})),this.mapView.when((()=>{const e=this.item.extent||this.portal.defaultExtent;e&&(this.mapView.extent=e),this.addWidgets(),this.loading=!1}))}catch(e){}}async addWidgets(){try{const[e,t,a]=await(0,s.l)(["esri/widgets/Search","esri/widgets/BasemapGallery","esri/intl"]);this.lang&&a.setLocale(this.lang);const i=new e({view:this.mapView,popupEnabled:!1,resultGraphicEnabled:!1}),o=i.viewModel;i.viewModel.allSources.on("change",(()=>{o.allSources.forEach((e=>{e.zoomScale=null}))})),this.mapView.ui.add(i,this.isRTL?"top-left":"top-right"),i.on("select-result",(e=>{this.mapView.goTo(e.result.extent)}));const l=new t({view:this.mapView,source:{portal:this.portal}});this.mapView.ui.add(l),this.arcgisImageUploadFromMapReady.emit(this.mapView)}catch(e){}}render(){return(0,i.h)(i.H,null,(0,i.h)("div",{class:{"from-map-wrapper":!0,"is-rtl":this.isRTL}},(0,i.h)("div",{class:"map-container",ref:e=>this.container=e}),this.loading?(0,i.h)("div",{class:"loader-container"},(0,i.h)("calcite-loader",{label:this.loadingText})):(0,i.h)("div",{class:"basemap-toggle",onClick:this.handleBasemapToggle},this.changeBasemapText)))}get el(){return(0,i.d)(this)}};r.style=".from-map-wrapper{position:relative;padding:0.5rem}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.map-container{width:600px;height:400px}.esri-zoom{position:absolute;top:50px;left:538px}.is-rtl .esri-zoom{left:0}.basemap-toggle{position:absolute;cursor:pointer;background-color:var(--calcite-color-foreground-1);padding:0.5rem;font-size:0.875rem;top:1.5rem;left:1.5rem;max-width:50%;box-shadow:0 1px 2px rgba(0, 0, 0, 0.3)}.is-rtl .basemap-toggle{right:1.5rem;left:auto}:host .esri-basemap-gallery{display:none;overflow-y:auto;max-height:310px;top:57px;left:15px;min-width:0}.is-rtl .esri-basemap-gallery{left:auto;right:15px}.esri-basemap-gallery__item-thumbnail{display:none}"}}]);