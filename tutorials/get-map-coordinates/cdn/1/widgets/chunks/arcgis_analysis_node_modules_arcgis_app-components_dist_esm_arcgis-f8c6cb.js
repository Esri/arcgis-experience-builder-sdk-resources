/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb"],{73838:(e,t,i)=>{i.d(t,{a:()=>a,c:()=>r,g:()=>s});var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t,i){return e(i={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},i.exports),i.exports}},92851:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_data_store_database_credentials:()=>h});var a=i(35110),s=i(46710),r=i(37526),n=i(77429),o=i(82669),l=i(84873),c=i(57983),d=i(91306),u=i(76272);i(23505),i(17752),i(70392),i(67148),i(66913),i(21104),i(73838),i(52299),i(73208),i(35105),i(16082),i(56086),i(79233),i(64307),i(76743),i(63280),i(9657),i(12856),i(91659),i(53040),i(51287),i(20982),i(7803);const h=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.authenticationType="serviceAuthentication",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.refreshToken=void 0,this.keyFileContents=void 0,this.projectId=void 0,this.defaultDataset=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.validJson=!0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.error=void 0}async handleNext(){o.a.authenticationType=this.authenticationType,o.a.refreshToken=this.refreshToken,o.a.projectID=this.projectId,o.a.defaultDataset=this.defaultDataset,o.a.snowflakeServer=this.server,o.a.snowflakeUsername=this.user,o.a.snowflakePassword=this.password,o.a.role=this.role,o.a.database=this.database,o.a.schema=this.schema,o.a.warehouse=this.warehouse,this.checkValidFields()?(o.a.databaseConnectionPath=this.createDatabaseConnectionPath(),await this.validateConnection()):this.handleError({code:"unhandledError"})}async componentWillLoad(){this.dataStoreConnectionType=o.a.databaseProvider,this.i18n=l.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{projectId:e,keyFileName:t,server:i,database:a,schema:s,warehouse:r,role:n,user:o,password:l,dataStoreConnectionType:c}=this,d="snowflake"===c?[i,a,s,r,n,o,l]:[t,e];return this.emptyFieldsExist=d.some((e=>!e)),!this.emptyFieldsExist}populateFields(){var e;this.server=o.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=o.a.authenticationType),this.projectId=o.a.projectID,this.defaultDataset=o.a.defaultDataset,this.role=o.a.role,this.database=o.a.database,this.schema=o.a.schema,this.warehouse=o.a.warehouse}createDatabaseConnectionPath(){const{dataStoreConnectionType:e,authenticationType:t,projectId:i,defaultDataset:a,server:s,user:r,role:n,database:l,schema:c,warehouse:d}=this;let u;switch(e){case"bigQuery":u=`${this.i18n.bigQuery}/${"serviceAuthentication"===t?this.i18n.serviceAuthentication:this.i18n.userAuthentication}/${i}/${a}`;break;case"snowflake":u=`${s}/${r}/${n}/${l}/${c}/${d}`}return o.a.databaseConnectionPath=u,u}async validateConnection(){const{dataStoreConnectionType:e,projectId:t,defaultDataset:i,keyFileContents:a,refreshToken:r,user:l,password:h,database:p,role:v,server:m,warehouse:f,schema:g}=this;let y;const{orgId:w}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const b=a||"",k=r||"";if("bigQuery"===e){const e=await(0,c.l)(t,i,b,k);if(null==e?void 0:e.error)return"invalidJSON"===e.error.code&&(this.validJson=!1),void this.handleError({code:e.error.code});y=e.result,o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection)}else y=(0,c.m)({user:l,password:h,database:p,role:v,server:m,warehouse:f,schema:g}),o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection),o.a.typeKeywords=[...o.a.typeKeywords,"CDW","snowflake"];const I="bigQuery"===e?t:p;d.i.title=(0,u.f)(e,I);const{result:F,error:x}=await(0,n.v)(w,s.c.portal,y);"success"===(null==F?void 0:F.status)?this.newItemUpdatePage.emit("itemProperties"):this.handleError({code:x.code})}processFile(e){if(!e)return;const{extension:t,fileName:i}=(0,r.s)(e);if(this.keyFileName=i,"json"!==t)return void(this.validJson=!1);this.validJson=!0;const a=new FileReader;a.onload=e=>{this.keyFileContents=String(e.target.result)},a.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let t=this.i18n.errors.validationFailedTitle,i=this.i18n.errors.invalidConnection;switch(e.code){case"invalidJSON":t=l.u.i18n.itemProperties.invalidJSON.title,i=l.u.i18n.itemProperties.invalidJSON.description;break;case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidBigQueryProjectId":case"invalidCredentials":i=this.i18n.errors[e.code]}this.error={title:t,description:i}}render(){const{dataStoreConnectionType:e,i18n:t,server:i,authenticationType:s,projectId:r,defaultDataset:n,role:o,database:l,schema:c,warehouse:d,validJson:u,error:h,invalidLogin:p}=this;return(0,a.h)("div",null,(0,a.h)("arcgis-new-item-loader",{type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,a.h)("arcgis-new-item-description",{class:"header",header:t.dataStoreConnection,content:"bigQuery"===e?t.bigQuery:t.snowflake}),(0,a.h)("div",{class:"configure-form"},"snowflake"===e&&(0,a.h)("calcite-label",{class:"field"},t.server,(0,a.h)("calcite-input",{placeholder:"server_name.com",value:i,onInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noServer)),(0,a.h)("calcite-label",{class:"field"},t.authenticationType,(0,a.h)("calcite-select",{value:s,label:"authentication-type",disabled:!0,onCalciteSelectChange:e=>{this.authenticationType=e.target.selectedOption.value}},"bigQuery"===e?(0,a.h)("calcite-option",{value:"serviceAuthentication"},t.serviceAuthentication):(0,a.h)("calcite-option",{value:"userAuthentication"},t.userAuthentication))),"bigQuery"===e&&(0,a.h)("div",{class:"configureBigQuery"},"serviceAuthentication"===s?(0,a.h)("calcite-label",{class:"field keyFileInput"},t.keyFile,(0,a.h)("calcite-input",{status:!u||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid","read-only":!0,value:this.keyFileName,required:!0},(0,a.h)("calcite-button",{"icon-start":"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},t.selectKeyFile)),(0,a.h)("input",{class:"hidden",type:"file",id:"snowflake-key-file",accept:".json",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,a.h)("calcite-input-message",{icon:!u||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!u||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?t.errors.noKeyFile:u?t.jsonOnly:t.notJson)):(0,a.h)("calcite-label",{class:"field refreshTokenInput"},t.refreshToken,(0,a.h)("calcite-input",{type:"password",status:"valid",onInput:e=>{this.refreshToken=e.target.value}})),(0,a.h)("calcite-label",{class:"field"},t.projectId,(0,a.h)("calcite-input",{value:r,onInput:e=>{this.projectId=this.trimInput(e.target.value)},required:!0}),!this.projectId&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noProjectId)),"userAuthentication"===s&&(0,a.h)("calcite-label",{class:"field"},t.defaultDataset,(0,a.h)("calcite-input",{value:n,onInput:e=>{this.defaultDataset=this.trimInput(e.target.value)}}))),"snowflake"===e&&(0,a.h)("div",{class:"configureSnowflake"},(0,a.h)("div",{class:"field fill-credentials"},(0,a.h)("calcite-label",{class:"credentials"},(0,a.h)("div",{class:"username"},t.username," ",(!this.user&&this.emptyFieldsExist||p)&&(0,a.h)("span",{class:"asterisk"},"*")),(0,a.h)("calcite-input",{onInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||p)&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.incorrectLogin)),(0,a.h)("calcite-label",{class:"credentials"},(0,a.h)("div",{class:"password"},t.password," ",(!this.password&&this.emptyFieldsExist||p)&&(0,a.h)("span",{class:"asterisk"},"*")),(0,a.h)("calcite-input",{class:"credentials password",type:"password",onInput:e=>{this.password=this.trimInput(e.target.value)},required:!0}))),(0,a.h)("calcite-label",{class:"field"},t.database,(0,a.h)("calcite-input",{value:l,onInput:e=>{this.database=this.trimInput(e.target.value)},required:!0}),!this.database&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noDatabase)),(0,a.h)("calcite-label",{class:"field"},t.schema,(0,a.h)("calcite-input",{value:c,onInput:e=>{this.schema=this.trimInput(e.target.value)},required:!0}),!this.schema&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noSchema)),(0,a.h)("calcite-label",{class:"field"},t.warehouse,(0,a.h)("calcite-input",{value:d,onInput:e=>{this.warehouse=this.trimInput(e.target.value)},required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noWarehouse)),(0,a.h)("calcite-label",{class:"field"},t.role,(0,a.h)("calcite-input",{value:o,onInput:e=>{this.role=this.trimInput(e.target.value)},required:!0}),!this.role&&this.emptyFieldsExist&&(0,a.h)("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noRole)))),(0,a.h)("arcgis-new-item-alert",{heading:null==h?void 0:h.title,description:null==h?void 0:h.description,active:!!h,onAlertDismiss:()=>this.error=null}))}};h.style=".configure-form{margin-top:1.5rem}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}.info-icon{color:var(--calcite-color-brand)}.hidden{display:none}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},76272:(e,t,i)=>{i.d(t,{f:()=>a});const a=(e,t)=>{let i;const a=null!=t?t:"";switch(e){case"amazon":i=`AmazonS3_${a}`;break;case"azure":i=`Microsoft_Azure_Storage_${a}`;break;case"bigQuery":i=`BigQuery_${a}`;break;case"snowflake":i=`Snowflake_${a}`}return i.replace(/ /g,"_").replace(/-/g,"_")}},21104:(e,t,i)=>{i.d(t,{l:()=>r});var a=i(73838),s=(0,a.c)((function(e,t){a.a,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},i="4.24",a="next";function s(e){if(e.toLowerCase()===a)return a;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=i),"https://js.arcgis.com/".concat(e,"/")}function n(e){return!e||s(e)?function(e){void 0===e&&(e=i);var t=r(e),n=s(e);if(n!==a&&3===n.major){var o=n.minor<=10?"js/":"";return"".concat(t).concat(o,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}(e):e}function o(e,t){var i=n(e),a=function(e){return document.querySelector('link[href*="'.concat(e,'"]'))}(i);return a||function(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}(a=function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}(i),t),a}var l={};function c(e,t,i){var a;i&&(a=function(e,t){var i=function(a){t(a.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",i,!1)};return e.addEventListener("error",i,!1),i}(e,i));var s=function(){t(e),e.removeEventListener("load",s,!1),a&&e.removeEventListener("error",a,!1)};e.addEventListener("load",s,!1)}function d(){return document.querySelector("script[data-esri-loader]")}function u(){var e=window.require;return e&&e.on}function h(e){void 0===e&&(e={});var i={};[l,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])}));var a=i.version,s=i.url||r(a);return new t.Promise((function(e,t){var r=d();if(r){var n=r.getAttribute("src");n!==s?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):u()?e(r):c(r,e,t)}else if(u())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var l=i.css;l&&o(!0===l?a:l,i.insertCssBefore),c(r=function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}(s),(function(){r.setAttribute("data-esri-loader","loaded"),e(r)}),t),document.body.appendChild(r)}}))}function p(e){return new t.Promise((function(t,i){var a=window.require.on("error",i);window.require(e,(function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];a.remove(),t(e)}))}))}e.utils=t,e.loadModules=function(e,t){if(void 0===t&&(t={}),u())return p(e);var i=d(),a=i&&i.getAttribute("src");return!t.url&&a&&(t.url=a),h(t).then((function(){return p(e)}))},e.getScript=d,e.isLoaded=u,e.loadScript=h,e.setDefaultOptions=function(e){void 0===e&&(e={}),l=e},e.loadCss=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)}));const r=async(e,t)=>(await s.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))}}]);