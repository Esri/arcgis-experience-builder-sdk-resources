/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6c32d8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6c32d8"],{24300:(e,t,i)=>{i.r(t),i.d(t,{arcgis_smart_mapping_field_pick_list:()=>f,arcgis_smart_mapping_panels_chart_size:()=>v,arcgis_smart_mapping_panels_color_size:()=>b,arcgis_smart_mapping_panels_color_size_univariate:()=>y,arcgis_smart_mapping_panels_compare:()=>C,arcgis_smart_mapping_panels_dot_density:()=>k,arcgis_smart_mapping_panels_heatmap:()=>w,arcgis_smart_mapping_panels_predominance_size:()=>M,arcgis_smart_mapping_panels_relationship_size:()=>B,arcgis_smart_mapping_panels_simple:()=>E,arcgis_smart_mapping_panels_type_size:()=>N});var s=i(35110),a=i(2137),l=i(59503),n=(i(21104),i(37192)),o=i(86587),r=i(61886),c=i(70467),d=i(51298),h=i(34448),p=i(75076);function m(e,t){let i,s,a,l,n,o,r,c,d,h,p=e.slice(0),m=0,f=t&&null!=t.tolerance?t.tolerance:2,v=t&&t.indexes,b=!(!t||null==t.strictBounds)&&t.strictBounds;if(v)v.sort(((e,t)=>e-t));else for(v=[],r=0;r<p.length;r++)v.push(r);for(r=0;r<v.length;r++)if(h=v[r],i=p[h],s=0===h?void 0:p[h-1],a=h===p.length-1?void 0:p[h+1],l=u(i),n=l.fractional,n){for(c=0,d=!1;c<=n&&!d;)o=g(i,c),m=b&&0===r?o[1]:o[0],d=S(i,m,s,a,f),c++;d&&(p[h]=m)}return p}function u(e){let t=String(e),i=t.match(/^-?(\d+)(\.(\d+))?$/i),s={integer:0,fractional:0};if(i&&i[1])s.integer=i[1].split("").length,s.fractional=i[3]?i[3].split("").length:0;else if(t.toLowerCase().indexOf("e")>-1){let e,i,a=t.split("e"),l=a[0],n=a[1];if(l&&n){const t=Number(l);let a=Number(n);i=a>0,i||(a=Math.abs(a)),e=u(t),i?(e.integer+=a,a>e.fractional?e.fractional=0:e.fractional-=a):(e.fractional+=a,a>e.integer?e.integer=1:e.integer-=a),s=e}}return s}function g(e,t){let i,s;return i=Number(e.toFixed(t)),i<e?s=i+1/Math.pow(10,t):(s=i,i-=1/Math.pow(10,t)),i=Number(i.toFixed(t)),s=Number(s.toFixed(t)),[i,s]}function S(e,t,i,s,a){let l,n,o,r=function(e,t,i,s){let a,l,n,o={prev:null,next:null};return null!=i&&(a=e-i,l=t-i,n=l-a,o.prev=Math.floor(Math.abs(100*n/a))),null!=s&&(a=s-e,l=s-t,n=l-a,o.next=Math.floor(Math.abs(100*n/a))),o}(e,t,i,s);return l=null==r.prev||r.prev<=a,n=null==r.next||r.next<=a,o=l&&n||r.prev+r.next<=2*a,o}i(1984),i(63280),i(23505),i(89393),i(73838),i(28642),i(50478);const f=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingFieldPickListClose=(0,s.c)(this,"arcgisSmartMappingFieldPickListClose",7),this.arcgisSmartMappingFieldPickListChange=(0,s.c)(this,"arcgisSmartMappingFieldPickListChange",7),this.arcgisSmartMappingFieldPickListSortByChange=(0,s.c)(this,"arcgisSmartMappingFieldPickListSortByChange",7),this.maxNumberFieldCount=10,this.selectedFields=[],this.fields=void 0,this.fieldToReplace=void 0,this.popoverProps=void 0,this.singleEditMode=!1,this.heading=void 0,this.okBtnText=void 0,this.filterPlaceholderText=void 0,this.lastSortBy=a.L.default,this.filterFields=null,this.isOpen=!1,this.width=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async componentWillLoad(){var e;this.isOpen=!0,this.rendererFieldInfosMap=null===(e=l.s.selectedFields)||void 0===e?void 0:e.reduce(((e,t)=>(e[t.field]=t,e)),{})}componentDidLoad(){var e;this.setUpObservers(),null===(e=this.resizeObserver)||void 0===e||e.observe(this.popoverProps.refElement),this.checkDisabledListItems().forEach((e=>this.listNode.removeChild(e))),requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){var e,t;null===(e=this.mutationObserver)||void 0===e||e.disconnect(),null===(t=this.resizeObserver)||void 0===t||t.unobserve(this.popoverProps.refElement)}render(){const e=this.popoverProps,{strings:t}=l.s;return(0,s.h)(s.H,{class:"js-app-flyout"},(0,s.h)("calcite-popover",{dir:l.s.isRTL?"rtl":"ltr",class:"popover",placement:e.placement||"leading-start",open:this.isOpen,pointerDisabled:!0,referenceElement:e.refElement,offsetDistance:e.offsetDistance||10-(e.popoverWidth||this.width),offsetSkidding:e.offsetSkidding||0,overlayPositioning:e.overlayPositioning,triggerDisabled:e.triggerDisabled,label:this.heading||(this.singleEditMode?t.replaceField:t.fieldPickList.selectFields),ref:e=>this.popoverNode=e},(0,s.h)("calcite-flow",{ref:e=>this.flowNode=e,style:{width:`${this.width||e.popoverWidth}px`}},(0,s.h)("calcite-flow-item",{ref:e=>this.flowItemNode=e,class:"panel",heading:this.heading||(this.singleEditMode?t.replaceField:t.fieldPickList.selectFields),closable:!0,onCalciteFlowItemClose:()=>this.arcgisSmartMappingFieldPickListClose.emit()},!this.singleEditMode&&this.renderAddButton(),this.renderCancelButton(),this.renderList()))))}renderAddButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",appearance:"solid",width:"half",scale:"m",onClick:()=>this.arcgisSmartMappingFieldPickListClose.emit({selectedFields:this.selectedFields})},this.okBtnText||e.add)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",appearance:"outline-fill",width:this.singleEditMode?"full":"half",scale:"m",onClick:()=>this.arcgisSmartMappingFieldPickListClose.emit()},e.cancel)}renderList(){var e;const{strings:t}=l.s;return(0,s.h)("calcite-list",{selectionMode:this.singleEditMode?"single-persist":"multiple",ref:e=>this.listNode=e,class:"content",filterEnabled:this.fields.length>=10,filterPlaceholder:null!==(e=this.filterPlaceholderText)&&void 0!==e?e:t.fieldPickList.searchFields,onCalciteListFilter:()=>{var e,t;this.filterFields=null===(t=null===(e=this.listNode)||void 0===e?void 0:e.filteredItems)||void 0===t?void 0:t.map((e=>e.value))}},this.renderSortDropdown(),this.renderListItems())}renderListItems(){return this.lastSortBy===a.L.type?this.renderItemsSortedByType():[a.L.display,a.L.field].includes(this.lastSortBy)?[...this.getSortedList()].map((e=>this.renderListItem(e))):[...this.fields].map((e=>this.renderListItem(e)))}renderItemsSortedByType(){const e=[...this.getSortedList()];return e.filter((e=>e.simpleFieldType===l.z.NUMBER)).map((e=>this.renderListItem(e))).concat(e.filter((e=>e.simpleFieldType===l.z.STRING)).map((e=>this.renderListItem(e)))).concat(e.filter((e=>e.simpleFieldType===l.z.DATE)).map((e=>this.renderListItem(e)))).concat(e.filter((e=>e.simpleFieldType===l.z.OID)).map((e=>this.renderListItem(e)))).concat(e.filter((e=>e.simpleFieldType===l.z.GUID)).map((e=>this.renderListItem(e)))).concat(e.filter((e=>e.simpleFieldType===l.z.UNKNOWN)).map((e=>this.renderListItem(e))))}renderListItem(e){var t;const{layer:i,useFeatureReduction:a,mapView:n,strings:o}=l.s,r="featureReduction"in i&&"binning"===(null===(t=i.featureReduction)||void 0===t?void 0:t.type)&&a;return(0,s.h)("calcite-list-item",{key:e.layerField.name,label:e.label||e.layerField.name,"data-type":e.simpleFieldType,value:e.layerField.name,selected:this.singleEditMode&&e.layerField.name===this.fieldToReplace.field,metadata:{label:e.label,fieldName:e.layerField.name},onCalciteListItemSelect:()=>{this.selectedFields=this.listNode.selectedItems.map((e=>e.value)),this.singleEditMode?this.selectedFields[0]!==this.fieldToReplace.field&&this.arcgisSmartMappingFieldPickListClose.emit({selectedFields:this.selectedFields}):(this.checkDisabledListItems(),this.arcgisSmartMappingFieldPickListChange.emit({selectedFields:this.selectedFields}))}},!r&&(0,s.h)("calcite-action",{slot:"actions-end",text:o.fieldPickList.info,scale:"s",icon:"information",onClick:t=>{var s;t.stopPropagation();const a=t.target,o=document.createElement("calcite-flow-item");o.heading=null!==(s=e.label)&&void 0!==s?s:e.layerField.name,o.description=e.layerField.name;const r=document.createElement("arcgis-field-info");r.lang=l.s.fullLocale,r.fieldName=e.layerField.name,r.layer=i,r.view=n,r.classList.add("content"),o.appendChild(r),o.addEventListener("calciteFlowItemBack",(()=>{requestAnimationFrame((()=>a.setFocus())),o.removeChild(r),this.flowNode.removeChild(o)})),this.flowNode.appendChild(o),requestAnimationFrame((()=>o.setFocus()))}}))}renderSortDropdown(){const{strings:e}=l.s;return this.fields.length>10?(0,s.h)("calcite-dropdown",{placement:"bottom-end",overlayPositioning:"fixed",slot:"filter-actions-end",ref:e=>this.dropdownNode=e,onCalciteDropdownOpen:()=>{var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect(),this.mutationObserver.observe(this.popoverNode,{attributes:!0})},onCalciteDropdownClose:()=>{var e;return null===(e=this.mutationObserver)||void 0===e?void 0:e.disconnect()},onCalciteDropdownSelect:()=>{var e;this.lastSortBy=a.L[null===(e=this.dropdownNode.selectedItems[0])||void 0===e?void 0:e.label],this.arcgisSmartMappingFieldPickListSortByChange.emit(this.lastSortBy)}},(0,s.h)("calcite-action",{slot:"trigger",text:e.fieldPickList.sort,title:e.fieldPickList.sort},(0,s.h)("calcite-icon",{scale:"s",icon:"sortDescending"})),(0,s.h)("calcite-dropdown-group",null,(0,s.h)("calcite-dropdown-item",{label:a.L.default,selected:this.lastSortBy===a.L.default},e.fieldPickList.default),(0,s.h)("calcite-dropdown-item",{label:a.L.display,selected:this.lastSortBy===a.L.display},e.fieldPickList.displayName),(0,s.h)("calcite-dropdown-item",{label:a.L.type,selected:this.lastSortBy===a.L.type},e.fieldPickList.type),(0,s.h)("calcite-dropdown-item",{label:a.L.field,selected:this.lastSortBy===a.L.field},e.fieldPickList.fieldName))):null}checkDisabledListItems(){if(!this.listNode)return;const e=(0,l.F)();this.singleEditMode?e[this.fieldToReplace.simpleFieldType]--:this.selectedFields.forEach((t=>{const i=(0,l.x)(t);if(i)switch(i.simpleFieldType){case"number":e.number++;break;case"string":e.string++;break;case"date":e.date++}}));const t=[];return this.listNode.querySelectorAll("calcite-list-item").forEach((e=>this.enableListItem(e))),l.s.mapImageSublayer&&!l.s.supportsArcade&&e.number+e.string+e.date+e.unknown===1?this.listNode.querySelectorAll('[data-type="string"], [data-type="number"], [data-type="date"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})):l.s.mapImageSublayer&&e.number+e.string+e.date+e.unknown===1&&1===e.date?this.listNode.querySelectorAll('[data-type="date"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})):1===e.string?(this.listNode.querySelectorAll('[data-type="string"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})),1!==e.number&&1!==e.date&&1!==e.unknown||this.listNode.querySelectorAll('[data-type="number"], [data-type="date"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))}))):e.number+e.date+e.unknown>1&&(e.expression>0&&(1!==e.expression||3!==this.selectedFields.length||!this.rendererFieldInfosMap[this.selectedFields[2]].expression)||e.date>0&&2===e.number&&!this.singleEditMode||2===e.date||l.s.mapImageSublayer&&e.date>0?this.listNode.querySelectorAll("calcite-list-item").forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})):(this.listNode.querySelectorAll('[data-type="string"]').forEach((e=>{this.disableListItem(e),t.push(e),this.selectedFields.indexOf(e.value)>-1&&(e.selected=!1)})),(e.number>2||l.s.mapImageSublayer)&&this.listNode.querySelectorAll('[data-type="date"]').forEach((e=>{this.disableListItem(e),t.push(e),this.selectedFields.indexOf(e.value)>-1&&(e.selected=!1)})),1===e.date&&this.listNode.querySelectorAll('[data-type="date"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})),e.number>=this.maxNumberFieldCount&&this.listNode.querySelectorAll('[data-type="number"], [data-type="date"]').forEach((e=>{-1===this.selectedFields.indexOf(e.value)&&(this.disableListItem(e),t.push(e))})))),t}disableListItem(e){e.disabled=!0;const t=e.querySelector("calcite-action");t&&(t.disabled=!0)}enableListItem(e){e.disabled=!1;const t=e.querySelector("calcite-action");t&&(t.disabled=!1)}getSortedList(){const e=[...this.fields];return this.lastSortBy===a.L.field?e.sort(((e,t)=>"_"===e.layerField.name.charAt(0)?1:"_"===t.layerField.name.charAt(0)?-1:e.layerField.name.localeCompare(t.layerField.name))):e.sort(((e,t)=>"_"===e.label.charAt(0)?1:"_"===t.label.charAt(0)?-1:e.label.localeCompare(t.label))),e}setUpObservers(){this.mutationObserver=new MutationObserver((e=>{for(const t of e)"style"===t.attributeName&&"hidden"===this.popoverNode.style.visibility&&(this.dropdownNode.open=!1)})),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.width=1.05*t.contentRect.width}))}get hostElement(){return(0,s.d)(this)}};f.style=".popover{z-index:100}.panel{min-height:300px}.content{max-height:60vh}.selection-button-div{padding:4px 10px}";const v=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsChartSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsChartSizeBackClick",7),this.arcgisSmartMappingPanelsChartSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsChartSizeClose",7),this.arcgisSmartMappingPanelsChartSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsChartSizeError",7),this.tileNodes=[],this.handleOptionsClick=e=>{const{flowNode:t}=this;switch(e){case"size":{const e=document.createElement("arcgis-smart-mapping-panels-size");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsSizeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsSizeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsSizeError",(({detail:e})=>this.arcgisSmartMappingPanelsChartSizeError.emit(e))),t.appendChild(e);break}case"chart":{const e=document.createElement("arcgis-smart-mapping-panels-chart");e.addEventListener("arcgisSmartMappingPanelsChartClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsChartBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsChartError",(({detail:e})=>this.arcgisSmartMappingPanelsChartSizeError.emit(e))),t.appendChild(e);break}}},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.lastClick=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t,useFeatureReduction:i}=l.s,s=(0,l.j)(e);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.flowNode=i?(0,l.f)(this.hostElement,"arcgis-smart-mapping"):(0,l.f)(this.hostElement,"calcite-flow")}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{hideLayerTitle:t,isRTL:i,mapImageSublayer:a,layer:n,strings:r}=l.s,c=t?void 0:null!==(e=null==a?void 0:a.title)&&void 0!==e?e:n.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{class:{"flow-item":!0,[o.C.rtl]:i},closable:(0,l.H)(this.hostElement),heading:r.panels.styleOptions,description:c,menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,ref:e=>this.flowItemNode=e,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsChartSizeBackClick.emit(),onCalciteFlowItemClose:()=>this.arcgisSmartMappingPanelsChartSizeClose.emit()},this.renderChartTile(),this.renderSizeTile(),this.renderDoneButton(),this.renderCancelButton()))}renderChartTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"chart",selected:"chart"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="chart",this.handleOptionsClick("chart")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("chart"),ref:e=>{e&&(this.tileNodes.chart=e)}})}renderSizeTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"size",selected:"size"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="size",this.handleOptionsClick("size")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("size"),ref:e=>{e&&(this.tileNodes.size=e)}})}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:()=>this.arcgisSmartMappingPanelsChartSizeClose.emit(),appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{(0,l.k)(this.originalRendererJSON,this.originalFeatureReduction),this.arcgisSmartMappingPanelsChartSizeClose.emit()},appearance:"outline-fill",width:"half"},e.cancel)}focusSelectedTile(){setTimeout((()=>requestAnimationFrame((()=>this.tileNodes[this.lastClick].setFocus()))),300)}get hostElement(){return(0,s.d)(this)}};v.style=":host{width:100%}.flow-item{height:100%}";const b=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsColorSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeClose",7),this.arcgisSmartMappingPanelsColorSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeBackClick",7),this.arcgisSmartMappingPanelsColorSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeError",7),this.tileNodes=[],this.handleOptionsClick=e=>{const{flowNode:t}=this;switch(e){case"size":{const e=document.createElement("arcgis-smart-mapping-panels-size");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsSizeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsSizeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsSizeError",(({detail:e})=>this.arcgisSmartMappingPanelsColorSizeError.emit(e))),t.appendChild(e);break}case"color":{const e=document.createElement("arcgis-smart-mapping-panels-color");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsColorClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsColorBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsColorError",(({detail:e})=>this.arcgisSmartMappingPanelsColorSizeError.emit(e))),t.appendChild(e);break}}},this.handleDone=()=>{this.arcgisSmartMappingPanelsColorSizeClose.emit("save")},this.handleCancel=()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,l.k)(e,t),this.arcgisSmartMappingPanelsColorSizeClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.lastClick=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){const{layer:e,modules:t,useFeatureReduction:i}=l.s,s=(0,l.j)(e);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.flowNode=i?(0,l.f)(this.hostElement,"arcgis-smart-mapping"):(0,l.f)(this.hostElement,"calcite-flow")}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){const{layer:e,hideLayerTitle:t,isRTL:i,strings:a}=l.s;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.styleOptions,description:t?void 0:e.title,class:{"flow-item":!0,[o.C.rtl]:i},closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsColorSizeBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderColorTile(),this.renderSizeTile(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}renderColorTile(){const{lastClick:e}=this,t="color-age-size"===(0,l.g)()?"color-age":"color",i=(0,l.L)("color");return(0,s.h)("arcgis-smart-mapping-tile",{key:`tile-${t}-${i}`,type:t,selected:"color"===e,onArcgisSmartMappingTileSelect:()=>{this.lastClick=t,this.handleOptionsClick("color")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("color"),onArcgisSmartMappingTileError:e=>this.arcgisSmartMappingPanelsColorSizeError.emit(e.detail),ref:e=>{e&&(this.tileNodes[t]=e)}})}renderSizeTile(){const{lastClick:e}=this,t="color-size-age"===(0,l.g)()?"size-age":"size",i=(0,l.L)("size");return(0,s.h)("arcgis-smart-mapping-tile",{key:`tile-${t}-${i}`,type:t,selected:"size"===e,onArcgisSmartMappingTileSelect:()=>{this.lastClick=t,this.handleOptionsClick("size")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("size"),onArcgisSmartMappingTileError:e=>this.arcgisSmartMappingPanelsColorSizeError.emit(e.detail),ref:e=>{e&&(this.tileNodes[t]=e)}})}renderTransparency(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!i,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsColorSizeError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity"),a=(0,l.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!i&&!!a,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsColorSizeError.emit(e)})}focusSelectedTile(){setTimeout((()=>requestAnimationFrame((()=>this.tileNodes[this.lastClick].setFocus()))),300)}get hostElement(){return(0,s.d)(this)}};b.style=":host{width:100%}.flow-item{height:100%}";const y=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsColorSizeUnivariateClose=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeUnivariateClose",7),this.arcgisSmartMappingPanelsColorSizeUnivariateBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeUnivariateBackClick",7),this.arcgisSmartMappingPanelsColorSizeUnivariateError=(0,s.c)(this,"arcgisSmartMappingPanelsColorSizeUnivariateError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsColorSizeUnivariateClose.emit("save")},this.handleCancel=()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,l.k)(e,t),this.arcgisSmartMappingPanelsColorSizeUnivariateClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.visualizationOpen=!1}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:t}=l.s,i=(0,l.j)(e);this.originalRendererJSON=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){const{layer:e,hideLayerTitle:t,isRTL:i,strings:a}=l.s;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.styleOptions,description:t?void 0:e.title,class:{"flow-item":!0,[o.C.rtl]:i},closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsColorSizeUnivariateBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.done,onClick:this.handleDone,appearance:"solid",width:"half"},t.done):null}renderCancelButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},t.cancel):null}renderVisualization(){var e,t;const{visualizationOpen:i}=this,{layer:a,strings:n}=l.s,o=(0,l.j)(a),r=(0,l.a)(o,"color"),c=r?r.field?null===(e=(0,l.x)(r.field))||void 0===e?void 0:e.label:r.valueExpressionTitle||n.expression:o.field?null===(t=(0,l.x)(o.field))||void 0===t?void 0:t.label:o.valueExpressionTitle||n.expression;return(0,s.h)("calcite-block",{class:"color-size-univariate-block",heading:n.panels.colorSizeUnivariate.colorSizeStyle,collapsible:!0,open:i,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},(0,s.h)("calcite-label",{class:"attribute-name"},c),this.renderTheme(),this.renderDividedBy(),this.renderSymbolPairButton(),this.renderAboveAndBelowSymbols(),this.renderColorScheme(),this.renderSymbol(),this.renderColorSizeSlider(),this.renderSizeRange(),this.renderBackgroundStyle(),this.renderDefaultSymbol(),this.renderShowInLegend())}renderTheme(){const{layer:e}=l.s;return(0,s.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:"colorSize",onArcgisSmartMappingThemeButtonBeforeOpen:()=>(0,l.l)(),onArcgisSmartMappingThemeButtonChange:t=>{const i="above-and-below"===(0,l.j)(e).authoringInfo.univariateTheme,a="above-and-below"===t.detail;let n=c.a;!i&&a&&(n=c.c),(0,r.r)(n({theme:t.detail,fieldInfos:(0,l.h)(e),discardMinMax:!0}),this.flowItemNode).then((t=>{(0,l.e)(t.renderer,e),(0,l.ab)(),(0,s.f)(this.hostElement),this.themeButtonNode&&(0,s.f)(this.themeButtonNode),this.rotationNode&&(0,s.f)(this.rotationNode),(0,s.f)(this.sizeRangeSliderNode),this.sliderNode&&((0,s.f)(this.sliderNode),this.sliderNode.updateStatistics())}),(e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e)}))}})}renderDividedBy(){const{layer:e,fields:t}=l.s,i=(0,l.j)(e),a=(0,l.g)();if(["color-age","color-age-size"].indexOf(a)>-1)return null;const n=(0,l.h)(e)[0];if(n.expression||n.simpleFieldType!==l.z.NUMBER)return null;if((0,l.K)(t).number<2)return null;const o=(0,l.a)(i,"color");return(0,s.h)("arcgis-smart-mapping-divided-by",{rendererSubtype:"color",normalizationField:(null==o?void 0:o.normalizationField)||i.normalizationField,onArcgisSmartMappingDividedByChange:()=>{(0,s.f)(this.hostElement),this.sliderNode.updateStatistics()},onArcgisSmartMappingDividedByError:e=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e.detail)})}renderSymbolPairButton(){const{layer:e}=l.s;return(0,l.E)(e)?null:"above-and-below"===(0,l.j)(e).authoringInfo.univariateTheme?(0,s.h)("arcgis-smart-mapping-symbol-pair-button",{onArcgisSmartMappingSymbolPairButtonBeforeOpen:()=>(0,l.l)(),onArcgisSmartMappingSymbolPairButtonChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode),this.symbolPairButtonNode&&(0,s.f)(this.symbolPairButtonNode)},onArcgisSmartMappingSymbolPairButtonError:e=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e.detail),ref:e=>{e&&(this.symbolPairButtonNode=e)}}):null}renderAboveAndBelowSymbols(){var e;const{layer:t,strings:i}=l.s,a=(0,l.j)(t),n=a.authoringInfo;if("above-and-below"!==n.univariateTheme)return null;if(!n.univariateSymbolStyle||2!==(null===(e=a.classBreakInfos)||void 0===e?void 0:e.length))return null;const o=(0,l.a)(a,"color"),r=(0,l.x)((null==o?void 0:o.field)||a.field),c=(null==r?void 0:r.simpleFieldType)===l.z.DATE,d=a.classBreakInfos[1].symbol,h=a.classBreakInfos[0].symbol;return(0,s.h)("div",{class:"symbol-above-and-below"},(0,s.h)("arcgis-smart-mapping-symbol-button",{class:"above-below-symbol-button",popoverReferenceElement:this.flowItemNode,symbol:h,type:"below",label:c?i.panels.colorSizeUnivariate.before:i.panels.colorSizeUnivariate.below,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.symbolPairButtonNode&&(0,s.f)(this.symbolPairButtonNode),this.sliderNode&&(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode)}}),(0,s.h)("arcgis-smart-mapping-symbol-button",{class:"above-below-symbol-button",popoverReferenceElement:this.flowItemNode,symbol:d,type:"above",label:c?i.panels.colorSizeUnivariate.after:i.panels.colorSizeUnivariate.above,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.symbolPairButtonNode&&(0,s.f)(this.symbolPairButtonNode),this.sliderNode&&(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode)}}))}renderColorScheme(){const{layer:e,strings:t}=l.s,i=(0,l.j)(e);if("above-and-below"!==i.authoringInfo.univariateTheme)return null;const a=(0,l.a)(i,"color");return(0,s.h)("calcite-label",null,t.panels.colorSizeUnivariate.colorScheme,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{e.stopPropagation(),this.handleColorSchemeChange(e.target.selectedItem.value)}},(0,s.h)("calcite-segmented-control-item",{checked:!!a,value:"continuous",ref:e=>this.continuousNode=e},t.panels.colorSizeUnivariate.continuous),(0,s.h)("calcite-segmented-control-item",{checked:!a,value:"binary",ref:e=>this.binaryNode=e},t.panels.colorSizeUnivariate.binary)))}renderSymbol(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"color"),a=t.classBreakInfos;let n;return i?n=i.stops.map((e=>{const t=e.color.clone();return t.a=1,t})):(null==a?void 0:a.length)&&(n=a.map((e=>(0,l.w)(e.symbol)))),(0,s.h)("arcgis-smart-mapping-symbol-button",{colors:n,type:"color-ramp",rampType:i?"continuous":"discrete",ref:e=>this.symbolButtonNode=e,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode)}})}renderColorSizeSlider(){return(0,s.h)("arcgis-smart-mapping-color-size-slider",{ref:e=>{e&&(this.sliderNode=e)},onArcgisSmartMappingColorSizeSliderChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode)},onArcgisSmartMappingColorSizeSliderError:e=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e.detail)})}renderSizeRange(){return(0,s.h)("arcgis-smart-mapping-size-range-slider",{onArcgisSmartMappingSizeRangeSliderError:e=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e.detail),ref:e=>this.sizeRangeSliderNode=e})}renderBackgroundStyle(){const{layer:e}=l.s,t=(0,l.g)();return(0,l.u)(e)&&-1!==["color-size"].indexOf(t)?(0,s.h)("arcgis-smart-mapping-background-symbol",null):null}renderDefaultSymbol(){return(0,s.h)("arcgis-smart-mapping-default-symbol",{ref:e=>{e&&(this.defaultSymbolNode=e)},onArcgisSmartMappingDefaultSymbolBeforeToggle:()=>(0,l.l)(),onArcgisSmartMappingDefaultSymbolChange:()=>(0,s.f)(this.symbolButtonNode)})}renderShowInLegend(){const{layer:e,strings:t}=l.s,i=(0,l.j)(e),a=(0,l.a)(i,"color"),n=null==a?void 0:a.legendOptions,o=!n||!1!==n.showLegend;return(0,s.h)("calcite-label",{class:"legend-toggle-padding",layout:"inline-space-between"},t.panels.colorSizeUnivariate.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:o,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderTransparency(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!i,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity"),a=(0,l.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!i&&!!a,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e)})}handleColorSchemeChange(e){const{layer:t}=l.s;(0,r.r)((0,c.a)({isContinuous:"continuous"===e}),this.flowItemNode).then((e=>{(0,l.e)(e.renderer,t),(0,l.ab)(),(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),(0,l.l)()}),(e=>{this.continuousNode.checked?(this.continuousNode.checked=!1,this.binaryNode.checked=!0):(this.binaryNode.checked=!1,this.continuousNode.checked=!0),this.arcgisSmartMappingPanelsColorSizeUnivariateError.emit(e)}))}handleIncludeInLegendToggle(){var e;const{layer:t}=l.s,i=(0,l.j)(t),s=(0,l.a)(i,"color"),a=(0,l.a)(i,"size"),n=a.legendOptions;n&&!1===n.showLegend?(n.title?n.showLegend=!0:a.legendOptions=void 0,(null===(e=null==s?void 0:s.legendOptions)||void 0===e?void 0:e.title)?s.legendOptions.showLegend=!0:s&&(s.legendOptions=void 0)):(a.legendOptions=n||{},a.legendOptions.showLegend=!1,s&&(s.legendOptions=n||{},s.legendOptions.showLegend=!1)),(0,l.ab)()}get hostElement(){return(0,s.d)(this)}};y.style=":host{width:100%}.flow-item{height:100%}.color-size-univariate-block{overflow-x:hidden}.attribute-name{word-break:break-all}.symbol-above-and-below{display:flex;justify-content:space-between}.above-below-symbol-button{width:49%}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}";const C=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsCompareClose=(0,s.c)(this,"arcgisSmartMappingPanelsCompareClose",7),this.arcgisSmartMappingPanelsCompareBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsCompareBackClick",7),this.arcgisSmartMappingPanelsCompareError=(0,s.c)(this,"arcgisSmartMappingPanelsCompareError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsCompareClose.emit("save")},this.handleCancel=()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,l.k)(e,t),this.arcgisSmartMappingPanelsCompareClose.emit("cancel")},this.hideRotation=!1,this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.visualizationOpen=!1,this.statisticsStatus=l.b.MISSING}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:t}=l.s,i=(0,l.j)(e);this.originalRendererJSON=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.getStatistics()}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){const{layer:e,hideLayerTitle:t,isRTL:i,strings:a}=l.s;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:a.panels.styleOptions,description:t?void 0:e.title,class:{"flow-item":!0,[o.C.rtl]:i},closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsCompareBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.done,onClick:this.handleDone,appearance:"solid",width:"half"},t.done):null}renderCancelButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},t.cancel):null}renderVisualization(){const{layer:e,strings:t}=l.s,{visualizationOpen:i,hideRotation:a}=this,n=(0,l.D)(e)&&!a,o=(0,l.j)(e),r=(0,l.a)(o,"color"),c=(0,l.t)(o,"color"),d=(0,l.x)(r.field),h=(0,l.x)(r.normalizationField),p=("ratio"===c.style?t.panels.compare.ratioTitle:"percent"===c.style?t.panels.compare.percentTitle:t.panels.compare.percentTotalTitle).replace(/\$\{field1\}/g,d.label).replace("${field2}",h.label);return(0,s.h)("calcite-block",{class:"compare-block",heading:t.panels.compare.compareStyle,collapsible:n,open:i,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},(0,s.h)("calcite-label",null,p),this.renderSymbol(),this.renderColorSlider(),this.renderLabels(),this.renderCenterAt(),this.renderDefaultSymbol(),this.renderShowInLegend())}renderSymbol(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"color"),a=t.classBreakInfos[0].symbol,n=i.stops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:a,colors:n,type:"color-ramp",rampType:"continuous",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode)}})}renderColorSlider(){return(0,s.h)("arcgis-smart-mapping-color-slider",{ref:e=>{e&&(this.sliderNode=e)},onArcgisSmartMappingColorSliderChange:()=>{const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"color"),a=(0,l.t)(t,"color"),n=!!a&&"percent"===a.style,o=!!a&&"percent-of-total"===a.style;i.stops[0].label=`< ${(0,d.g)(i.stops[0].value,n,o)}`,i.stops[2].label=`${(0,d.g)(i.stops[2].value,n,o)}`,i.stops[4].label=`> ${(0,d.g)(i.stops[4].value,n,o)}`,this.segmentedControlNode&&(1===i.stops[2].value?(this.equalNode.checked=!0,this.averageNode.checked=!1):(this.equalNode.checked=!1,this.averageNode.checked=!0)),(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode)},onArcgisSmartMappingColorSliderError:e=>this.arcgisSmartMappingPanelsCompareError.emit(e.detail)})}renderLabels(){const{layer:e,strings:t}=l.s,i=(0,l.j)(e),a=(0,l.t)(i,"color"),n=a?a.style:void 0;return(0,s.h)("calcite-label",null,t.panels.compare.labels,(0,s.h)("calcite-select",{width:"full",role:"button",label:t.panels.compare.labels,onCalciteSelectChange:e=>this.handleLabelChange(e)},(0,s.h)("calcite-option",{value:t.panels.compare.ratioLabel,label:t.panels.compare.ratioLabel,selected:"ratio"===n}),(0,s.h)("calcite-option",{value:t.panels.compare.percentTotalLabel,label:t.panels.compare.percentTotalLabel,selected:"percent-of-total"===n}),(0,s.h)("calcite-option",{value:t.panels.compare.percentLabel,label:t.panels.compare.percentLabel,selected:"percent"===n})))}renderCenterAt(){const{statistics:e,statisticsStatus:t}=this,{layer:i,strings:a}=l.s;if(t!==l.b.SUCCESS)return null;const n=(0,l.j)(i),o=(0,l.a)(n,"color");if(!(0,l.ac)(e.min)||!(0,l.ac)(e.max)||e.min>=1||e.max<=1)return null;const r=1===o.stops[2].value?"equal":"average";return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,a.panels.compare.centerAt),(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{e.stopPropagation(),this.handleCenterAtChange(e.target.selectedItem.value)},ref:e=>{e&&(this.segmentedControlNode=e)}},(0,s.h)("calcite-segmented-control-item",{checked:"equal"===r,value:"equal",ref:e=>{e&&(this.equalNode=e)}},a.panels.compare.centerEqualValues),(0,s.h)("calcite-segmented-control-item",{checked:"average"===r,value:"average",ref:e=>{e&&(this.averageNode=e)}},a.panels.compare.centerAverageValue)))}renderDefaultSymbol(){return(0,s.h)("arcgis-smart-mapping-default-symbol",{ref:e=>{e&&(this.defaultSymbolNode=e)},onArcgisSmartMappingDefaultSymbolBeforeToggle:()=>(0,l.l)(),onArcgisSmartMappingDefaultSymbolChange:()=>(0,s.f)(this.symbolButtonNode)})}renderShowInLegend(){const{layer:e,strings:t}=l.s,i=(0,l.j)(e),a=(0,l.a)(i,"color").legendOptions,n=!a||!1!==a.showLegend;return(0,s.h)("calcite-label",{class:"legend-toggle-padding",layout:"inline-space-between"},t.panels.compare.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:n,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderRotation(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity"),a=(0,l.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!i&&!!a,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsCompareError.emit(e)})}handleLabelChange(e){const t=e.currentTarget.value,{strings:i}=l.s,a=t===i.panels.compare.ratioLabel?"ratio":t===i.panels.compare.percentTotalLabel?"percent-of-total":"percent",{layer:n}=l.s,o=(0,l.j)(n),r=(0,l.a)(o,"color");(0,l.t)(o,"color").style=a,"percent"===a?(r.stops[0].label=`< ${(0,d.g)(r.stops[0].value,!0,!1)}`,r.stops[2].label=(0,d.g)(r.stops[2].value,!0,!1),r.stops[4].label=`> ${(0,d.g)(r.stops[4].value,!0,!1)}`):"percent-of-total"===a?(r.stops[0].label=`< ${(0,d.g)(r.stops[0].value,!1,!0)}`,r.stops[2].label=(0,d.g)(r.stops[2].value,!1,!0),r.stops[4].label=`> ${(0,d.g)(r.stops[4].value,!1,!0)}`):(r.stops[0].label=`< ${(0,d.g)(r.stops[0].value,!1,!1)}`,r.stops[2].label=(0,d.g)(r.stops[2].value,!1,!1),r.stops[4].label=`> ${(0,d.g)(r.stops[4].value,!1,!1)}`),(0,l.ab)(),(0,s.f)(this.hostElement)}getStatistics(){var e;const{layer:t,useFeatureReduction:i,mapView:s,modules:a}=l.s,n=t,o=(0,l.j)(n),r=this.getFieldInfo(),c=(0,l.a)(o,"color"),d=c?c.normalizationField:o.normalizationField,h=(0,l.t)(o,"color")||{};this.statisticsStatus=l.b.IN_PROGRESS,this.statistics||a.summaryStatistics({layer:n,view:s,field:r.field,valueExpression:r.expression,normalizationField:d,forBinning:"featureReduction"in n&&"binning"===(null===(e=n.featureReduction)||void 0===e?void 0:e.type)&&i}).then((e=>{if(0===e.count){const[t,i]=this.getDefaultDataRange(r),s=h.minSliderValue||t,a=h.maxSliderValue||i;e.min=s,e.max=a,e.avg=(a+s)/2,(0,l.ac)(h.minSliderValue)||(h.minSliderValue=s,h.maxSliderValue=a)}else if(!(0,l.ac)(e.avg)||!(0,l.ac)(e.min)||!(0,l.ac)(e.max))return void(this.statisticsStatus=l.b.FAILED);e=(0,l.ad)(e),this.statistics=e,this.statisticsStatus=l.b.SUCCESS}),(e=>{console.log(e),this.statisticsStatus=l.b.FAILED}))}getDefaultDataRange(e){if(e.simpleFieldType===l.z.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"color"),s=(0,l.x)(i?i.field:t.field);return{field:(null==i?void 0:i.field)||t.field,expression:(null==i?void 0:i.valueExpression)||t.valueExpression,expressionTitle:(null==i?void 0:i.valueExpressionTitle)||t.valueExpressionTitle,simpleFieldType:s?s.simpleFieldType:l.z.NUMBER}}handleCenterAtChange(e){const{statistics:t,statisticsStatus:i}=this,{layer:a}=l.s;if(i!==l.b.SUCCESS)return;const n=(0,l.j)(a),o=(0,l.a)(n,"color"),r=(0,l.t)(n,"color"),c=!!r&&"percent"===r.style,h=!!r&&"percent-of-total"===r.style;let p;if("average"===e){const e=t.avg;let i=Math.max(e-t.stddev,t.min),s=Math.min(e+t.stddev,t.max);0===t.count&&(i=t.min,s=t.max),p=m([i,s]),i=p[0],s=p[1],p=[Math.max(i,t.min),Math.max(i+(e-i)/2,t.min),e,Math.min(e+(s-e)/2,t.max),Math.min(s,t.max)],p=m(p)}else{let e=Math.max(1-t.stddev,t.min),i=Math.min(1+t.stddev,t.max);p=m([e,i]),e=p[0],i=p[1],p=[Math.max(e,t.min),Math.max(e+(1-e)/2,t.min),1,Math.min(1+(i-1)/2,t.max),Math.min(i,t.max)],p=m(p)}o.stops[0].value=p[0],o.stops[0].label=`< ${(0,d.g)(p[0],c,h)}`,o.stops[1].value=p[1],o.stops[1].label=null,o.stops[2].value=p[2],o.stops[2].label=(0,d.g)(p[2],c,h),o.stops[3].value=p[3],o.stops[3].label=null,o.stops[4].value=p[4],o.stops[4].label=`> ${(0,d.g)(p[4],c,h)}`,(0,l.ab)(),(0,s.f)(this.symbolButtonNode),this.sliderNode&&(0,s.f)(this.sliderNode)}handleIncludeInLegendToggle(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"color"),s=i.legendOptions;s&&!1===s.showLegend?s.title?s.showLegend=!0:i.legendOptions=void 0:(i.legendOptions=s||{},i.legendOptions.showLegend=!1),(0,l.ab)()}get hostElement(){return(0,s.d)(this)}};C.style=":host{width:100%}.flow-item{height:100%}.compare-block{overflow-x:hidden}.attribute-name{word-break:break-all}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}";const k=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsDotDensityBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsDotDensityBackClick",7),this.arcgisSmartMappingPanelsDotDensityClose=(0,s.c)(this,"arcgisSmartMappingPanelsDotDensityClose",7),this.labelNodes=[],this.inputNodes=[],this.legendSwatchNodes=[],this.popoverSettings={index:null,popoverNode:null},this.handleDone=()=>{this.arcgisSmartMappingPanelsDotDensityClose.emit("save")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.dotValue=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,mapView:t,modules:i}=l.s,s=(0,l.j)(e);this.dotValue=s.dotValue,(0,l.ac)(s.referenceScale)&&(this.dotValue=Math.round(s.calculateDotValue(t.scale)),this.tickDotValue=this.dotValue),this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?i.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}));const{config:e,mapView:t,modules:i}=l.s;this.mapViewWatchHandle=i.reactiveUtils.watch((()=>t.scale),(e=>{var t;const i=(0,l.j)(l.s.layer);if((0,l.ac)(i.referenceScale)){let s=Math.round(i.calculateDotValue(e));this.dotValue=s,this.handleDotValueChange(this.dotValue),null===(t=this.dotValueSlider)||void 0===t||t.set({values:[this.getSliderStepsPos(this.dotValue)]})}})),this.hostElement.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${e.jsapiUrl}/themes/light/main.css" />`),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e,t,i;null===(e=this.dotWatchHandle)||void 0===e||e.remove(),null===(t=this.mapViewWatchHandle)||void 0===t||t.remove(),null===(i=this.scaleHandle)||void 0===i||i.remove()}render(){var e;const{hideLayerTitle:t,isRTL:i,layer:a,mapImageSublayer:n,strings:r}=l.s,c=t?void 0:null!==(e=null==n?void 0:n.title)&&void 0!==e?e:a.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{class:{"flow-item":!0,[o.C.rtl]:i},heading:r.panels.dotDensity.styleOptions,description:c,closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,ref:e=>this.flowItemNode=e,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsDotDensityBackClick.emit()},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization()))}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,l.l)(),(0,l.k)(e,t),this.arcgisSmartMappingPanelsDotDensityClose.emit("cancel")},appearance:"outline-fill",width:"half"},e.cancel)}renderVisualization(){const{strings:e}=l.s;return(0,s.h)("calcite-block",{class:"dot-density-block",heading:e.panels.dotDensity.dotDensityStyle,open:!0},this.renderDotStyle(),this.renderLegend(),this.renderUnits(),this.renderDotValue(),this.renderDotSize(),this.renderBackgroundStyle(),this.renderOptions())}renderDotStyle(){const{layer:e}=l.s,t=(0,l.j)(e).attributes.map((e=>e.color));return(0,s.h)("arcgis-smart-mapping-symbol-button",{type:"dot-density-ramp",rampType:"discrete",colors:t,onArcgisSmartMappingSymbolButtonSymbolChange:()=>(0,s.f)(this.hostElement)})}renderLegend(){const{layer:e,strings:t}=l.s,i=(0,l.j)(e);return(0,s.h)("calcite-label",null,t.panels.dotDensity.legend,(0,s.h)("calcite-list",{class:"top-grey-border",dragEnabled:!0,onCalciteListOrderChange:e=>{let t=Array.from(e.target.children);this.handleSortLegend(t)}},i.attributes.map(((e,t)=>this.renderLegendItem(e,t)))))}renderLegendItem(e,t){const{layer:i,modules:a,selectedAttribute:n,strings:o}=l.s,r=(0,l.j)(i);return(0,s.h)("calcite-list-item",{value:e.field,key:`item-${e.field}`},(0,s.h)("div",{class:"symbol",slot:"content-start",tabIndex:0,role:"button","aria-label":o.panels.dotDensity.editSymbolFor.replace("${fieldName}",e.label),"aria-haspopup":"true","aria-expanded":n==t,onClick:()=>{var e;(null===(e=this.popoverSettings)||void 0===e?void 0:e.popoverNode)?(this.legendSwatchNodes[t].classList.remove("selected"),this.popoverSettings.index===t?((0,l.l)(),this.popoverSettings.popoverNode=null,this.popoverSettings.index=null):(this.popoverSettings.index=t,this.openSymbolStylerForLegendSwatch(t))):(this.popoverSettings.index=t,this.openSymbolStylerForLegendSwatch(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openSymbolStylerForLegendSwatch(t))},ref:e=>this.legendSwatchNodes[t]=e},(0,s.h)("img",{src:a.symbolUtils.renderDotDensityPreviewHTML(r,new a.esriColor([e.color.r,e.color.g,e.color.b]),{swatchSize:16}).src,"aria-hidden":"true"})),this.renderTextNode(e,t))}renderTextNode(e,t){const{strings:i}=l.s;return(0,s.h)(s.F,null,(0,s.h)("div",{"aria-label":i.panels.dotDensity.editLabelFor.replace("${fieldName}",e.label),class:"label text-wrap",slot:"content",tabIndex:0,onClick:e=>{e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus()},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus())},ref:e=>this.labelNodes[t]=e},e.label),(0,s.h)("calcite-input",{class:"hidden",slot:"content",tabIndex:0,value:e.label,placeholder:e.label,onFocusout:e=>{const i=e.target;this.handleLegendItemTextChange(t,i.value)},onKeyDown:e=>{if(e.stopPropagation(),"Escape"===e.key||"Enter"===e.key){e.preventDefault();const i=e.currentTarget;this.handleLegendItemTextChange(t,i.value)}},ref:e=>this.inputNodes[t]=e}))}renderUnits(){var e;const{layer:t,strings:i}=l.s,a=(0,l.j)(t);return(0,s.h)("calcite-label",null,i.panels.dotDensity.dotsRepresent,(0,s.h)("calcite-input",{value:(null===(e=a.legendOptions)||void 0===e?void 0:e.unit)||"",onCalciteInputInput:e=>{const{layer:t}=l.s,i=(0,l.j)(t),s=e.target;i.legendOptions=i.legendOptions||{},i.legendOptions.unit=s.value||"",this.updateDotValueEquation(),(0,l.ab)()}}))}renderDotValue(){var e;const{layer:t,modules:i,strings:a}=l.s,n=(0,l.j)(t),o=n.authoringInfo,{tickDotValue:r}=this;if(!o)return null;const c=this.initSliderSteps(),d=[{mode:"position",visibleElements:{labels:!0},labelsVisible:!0,values:[this.getSliderStepsPos(r)],tickCreatedFunction:(e,t,i)=>{t.onclick=()=>{var e;this.handleDotValueChange(r),null===(e=this.dotValueSlider)||void 0===e||e.set({values:[this.getSliderStepsPos(r)]})},i.onclick=()=>{var e;this.handleDotValueChange(r),null===(e=this.dotValueSlider)||void 0===e||e.set({values:[this.getSliderStepsPos(r)]})}}}];if(this.dotValueSlider){let e={values:[this.getSliderStepsPos(this.dotValue)]};(c||this.dotValueSlider.tickConfigs[0].values[0]!==d[0].values[0])&&(e={min:0,max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(this.dotValue)],labelFormatFunction:e=>this.sliderSteps[e],tickConfigs:d}),this.dotValueSlider.set(e)}else{const e={min:0,max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(this.dotValue)],visibleElements:{labels:!0,rangeLabels:!0},rangeLabelInputsEnabled:!1,precision:0,labelInputsEnabled:!0,labelFormatFunction:e=>this.sliderSteps[e],inputFormatFunction:e=>this.sliderSteps[e],inputParseFunction:e=>{var t,i,s;let a=parseInt(e);return isNaN(a)?this.dotValueSlider.values[0]:(0===a&&(a=1),-1===this.sliderSteps.indexOf(a)&&(null===(t=this.sliderSteps)||void 0===t||t.push(a),null===(i=this.sliderSteps)||void 0===i||i.sort(((e,t)=>e-t)),null===(s=this.dotValueSlider)||void 0===s||s.set({max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(a)]})),this.sliderSteps[this.getSliderStepsPos(a)])},tickConfigs:d};this.dotValueSlider=new i.Slider(e),this.dotWatchHandle=this.dotValueSlider.watch("values",(e=>{this.dotValue=this.sliderSteps[e[0]],this.handleDotValueChange(this.dotValue)}))}const h=o.minSliderValue!==o.maxSliderValue,p=o.minSliderValue.toString().length>5||o.maxSliderValue.toString().length>5;return h?(0,s.h)("calcite-label",null,a.panels.dotDensity.dotValue,(0,s.h)("div",{class:"dot-value-content"},(0,s.h)("div",{class:"slider dot-value-slider "+(p?"slider-bottom-label":""),ref:e=>{setTimeout((()=>{this.dotValueSlider&&(this.dotValueSlider.container=e)}),1)}}),(0,s.h)("calcite-label",{alignment:"center",ref:e=>this.dotValueEquationNode=e},a.panels.dotDensity.dotValueEquation.replace("${value}",this.dotValue.toString()).replace("${units}",(null===(e=n.legendOptions)||void 0===e?void 0:e.unit)||"")))):null}renderDotSize(){const{layer:e,mapImageSublayer:t,strings:i}=l.s;if(t&&e.version<11.1)return;const a=(0,l.j)(e),n=Math.round(a.dotSize/.75*10)/10;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,i.panels.dotDensity.dotSize),(0,s.h)("arcgis-smart-mapping-slider-input",{min:.5,max:4,values:[n],precision:1,suffixText:i.panels.dotDensity.px,onArcgisSmartMappingSliderInputChange:t=>{const i=(0,l.j)(e),s=Math.round(.75*t.detail*10)/10;s!==i.dotSize&&(i.dotSize=s,(0,l.ab)())}}))}renderBackgroundStyle(){return(0,s.h)("arcgis-smart-mapping-background-symbol",{onArcgisSmartMappingBackgroundSymbolChange:()=>(0,s.f)(this.hostElement)})}renderOptions(){const{mapImageSublayer:e,mapView:t,layer:i,strings:a}=l.s,n=(0,l.j)(i);return(0,s.h)(s.F,null,(0,s.h)("calcite-label",{layout:"inline-space-between",class:"top-margin"},a.panels.dotDensity.varyDotByScale,(0,s.h)("calcite-switch",{scale:"s",checked:n.referenceScale===t.scale,onCalciteSwitchChange:e=>{const s=e.target;(0,l.j)(i).referenceScale=s.checked?t.scale:void 0,(0,l.ab)()}})),!e&&(0,s.h)("calcite-label",{layout:"inline-space-between"},a.panels.dotDensity.blendOverlappingColors,(0,s.h)("calcite-switch",{scale:"s",checked:n.dotBlendingEnabled,onCalciteSwitchChange:e=>{const t=e.target;(0,l.j)(i).dotBlendingEnabled=t.checked,(0,l.ab)()}})))}getSliderStepsPos(e){let t=0;return this.sliderSteps.forEach(((i,s)=>{(e>=i||e-this.sliderSteps[t]>i-e)&&(t=s)})),t}handleLegendItemTextChange(e,t){const{layer:i}=l.s,s=(0,l.j)(i);t.length||(t=this.originalRendererJSON.attributes.find((t=>t.field===s.attributes[e].field)).label),s.attributes[e].label=t,this.inputNodes[e].classList.add("hidden"),this.labelNodes[e].classList.remove("hidden"),this.labelNodes[e].innerHTML=t,setTimeout((()=>this.labelNodes[e].focus()),300),(0,l.ab)()}handleDotValueChange(e){const{layer:t,mapView:i}=l.s;let s=(0,l.j)(t);s.dotValue=Math.round(e),s.referenceScale=(0,l.ac)(s.referenceScale)?i.scale:void 0,this.updateDotValueEquation(),(0,l.ab)()}handleSortLegend(e){const{layer:t}=l.s,i=(0,l.j)(t),a=i.attributes.map((e=>e.clone())),n=e.map((e=>e.value));a.sort(((e,t)=>n.indexOf(e.field)-n.indexOf(t.field))),i.attributes=a,(0,l.ab)(),(0,s.f)(this.hostElement)}initSliderSteps(){const{layer:e}=l.s,t=(0,l.j)(e).authoringInfo,i=t.minSliderValue,s=Math.max(t.maxSliderValue,this.dotValue);if(this.sliderSteps&&this.sliderSteps.indexOf(this.dotValue)>-1)return!1;let a=(s-i)/Math.pow(2,19);a=Math.max(a,1);const n=[i];for(let e=0;e<79;e++){let t=Math.round(i+Math.pow(2,e/4)*a);if(t<i+(e+1)&&(t=i+(e+1)),this.dotValue<t&&this.dotValue>n[n.length-1]&&n.push(this.dotValue),t>=s){n.push(s);break}n.push(t)}return this.sliderSteps=n,!0}openSymbolStylerForLegendSwatch(e){(0,l.l)();const t=this.legendSwatchNodes[e];document.createElement("div").className="symbol-styler-div",this.popoverSettings.popoverNode=(0,h.c)({referenceElement:this.flowItemNode,heading:l.s.strings.styler.symbolStyle}),this.popoverSettings.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,h.r)(this.popoverSettings.popoverNode),setTimeout((()=>null==t?void 0:t.focus()),300),t.classList.remove("selected")})),this.popoverSettings.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,h.r)(this.popoverSettings.popoverNode),t.classList.remove("selected"),this.popoverSettings.popoverNode=null})),(0,h.b)({selectedAttribute:e,popoverNode:this.popoverSettings.popoverNode,onChange:()=>{(0,l.ab)(),(0,s.f)(this.hostElement)}}),t.classList.add("selected")}updateDotValueEquation(){var e;const{layer:t,strings:i}=l.s,s=(0,l.j)(t);this.dotValueEquationNode.innerHTML=i.panels.dotDensity.dotValueEquation.replace("${value}",this.dotValue.toString()).replace("${units}",this.htmlEncode((null===(e=s.legendOptions)||void 0===e?void 0:e.unit)||""))}htmlEncode(e){const t=document.createElement("textarea");return t.innerText=e,t.innerHTML.split("<br>").join("\n")}get hostElement(){return(0,s.d)(this)}};k.style=":host{width:100%}.flow-item{height:100%}.dot-density-block{overflow-x:hidden}.hidden{display:none}img{width:16px;height:16px}.label{font-size:var(--calcite-font-size--1);padding-top:5px;padding-bottom:5px}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.selected{outline:1px solid var(--calcite-color-brand)}.symbol{width:16px;height:16px;margin:2px}.top-margin{margin-block-start:var(--calcite-label-margin-bottom, 0.75rem)}.top-grey-border{border-top:1px solid #e0e0e0}.text-wrap{overflow-wrap:anywhere}.dot-value-content{display:flex;flex-direction:column}.dot-value-slider{width:100%;height:70px;position:relative;margin:0 auto 10px auto}.dot-value-slider.esri-slider--horizontal .esri-slider__tick-label{cursor:pointer}.dot-value-slider.slider-bottom-label .esri-slider__max,.dot-value-slider.slider-bottom-label .esri-slider__min{width:-moz-fit-content;width:fit-content;position:absolute;bottom:11px}.dot-value-slider.slider-bottom-label .esri-slider__max{right:0;text-align:right}.dot-value-slider.slider-bottom-label .esri-slider__min{left:0;text-align:left}.dot-value-slider.esri-slider--horizontal .esri-slider__label{text-decoration:underline}.dot-value-slider.esri-slider--horizontal .esri-slider__label:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}";const w=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsHeatmapClose=(0,s.c)(this,"arcgisSmartMappingPanelsHeatmapClose",7),this.arcgisSmartMappingPanelsHeatmapBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsHeatmapBackClick",7),this.arcgisSmartMappingPanelsHeatmapError=(0,s.c)(this,"arcgisSmartMappingPanelsHeatmapError",7),this.handleDone=()=>{(0,l.l)(),this.arcgisSmartMappingPanelsHeatmapClose.emit("save")},this.handleCancel=()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,l.k)(e,t),this.arcgisSmartMappingPanelsHeatmapClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=l.s,i=(0,l.j)(e);this.originalRendererJSON=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;(0,l.ae)(),null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{hideLayerTitle:t,isRTL:i,layer:a,mapImageSublayer:n,strings:r}=l.s,c=t?void 0:null!==(e=null==n?void 0:n.title)&&void 0!==e?e:a.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{class:{"flow-item":!0,[o.C.rtl]:i},heading:r.panels.heatmap.styleOptions,description:c,closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsHeatmapBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderVisualization(){var e;const{layer:t,strings:i}=l.s,a=(0,l.j)(t),n=a.field?null===(e=(0,l.x)(a.field))||void 0===e?void 0:e.label:void 0;return(0,s.h)("calcite-block",{class:"heatmap-block",heading:i.panels.heatmap.heatmapStyle,open:!0},n?(0,s.h)("calcite-label",{class:"attribute-name"},n):null,this.renderSymbol(),this.renderHeatmapSlider(),this.renderSoftEdges(),this.renderInfluenceValue(),this.renderLock(),this.renderRegenerate())}renderSymbol(){const{layer:e}=l.s,t=(0,l.j)(e).colorStops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,s.h)("arcgis-smart-mapping-symbol-button",{type:"heatmap-ramp",rampType:"continuous",colors:t,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode)}})}renderHeatmapSlider(){return(0,s.h)("arcgis-smart-mapping-heatmap-slider",{ref:e=>{e&&(this.sliderNode=e)}})}renderSoftEdges(){var e;const{strings:t,modules:i}=l.s,a=i.rendererJsonUtils.fromJSON(this.originalRendererJSON);return(0,s.h)("div",null,(0,s.h)("calcite-label",null," ",t.panels.heatmap.softenEdges," "),(0,s.h)("calcite-slider",{min:0,max:1,minLabel:t.panels.heatmap.less,maxLabel:t.panels.heatmap.more,step:.01,value:(null===(e=a.authoringInfo)||void 0===e?void 0:e.fadeRatio)||0,onCalciteSliderInput:e=>{var t;const i=e.target.value,{layer:a}=l.s;if((null===(t=(0,l.j)(a).authoringInfo)||void 0===t?void 0:t.fadeRatio)===i)return;const n=(0,p.u)(i);(0,l.e)(n,a),(0,l.ab)(),this.sliderNode&&(0,s.f)(this.sliderNode)}}),(0,s.h)("div",{class:"slider-labels","aria-hidden":"true"},(0,s.h)("calcite-label",null,t.panels.heatmap.less),(0,s.h)("calcite-label",null,t.panels.heatmap.more)))}renderInfluenceValue(){const{strings:e,modules:t}=l.s,i=t.rendererJsonUtils.fromJSON(this.originalRendererJSON);return(0,s.h)("div",{class:"top-bottom-margin-small"},(0,s.h)("calcite-label",null,e.panels.heatmap.areaOfInfluence),(0,s.h)("calcite-slider",{min:1,max:60,minLabel:e.panels.heatmap.smaller,maxLabel:e.panels.heatmap.larger,value:i.radius||0,onCalciteSliderInput:e=>{const t=e.target,{layer:i}=l.s;(0,l.j)(i).radius=t.value||10,(0,l.ab)()}}),(0,s.h)("div",{class:"slider-labels","aria-hidden":"true"},(0,s.h)("calcite-label",null,e.panels.heatmap.smaller),(0,s.h)("calcite-label",null,e.panels.heatmap.larger)))}renderLock(){const{layer:e,mapImageSublayer:t,strings:i}=l.s;if(t)return;const a=(0,l.j)(e),{referenceScale:n}=a;return(0,s.h)("div",{class:"top-margin-medium"},(0,s.h)("calcite-label",{layout:"inline-space-between"},i.panels.heatmap.lock,(0,s.h)("calcite-switch",{scale:"s",checked:!!n,onCalciteSwitchChange:()=>{const{layer:e,mapView:t}=l.s,i=(0,l.j)(e);i.referenceScale=i.referenceScale?0:t.scale,(0,l.ab)()},ref:e=>{this.calciteSwitchNode=e},onMouseOver:()=>(0,l.af)(this.calciteSwitchNode,i.panels.heatmap.lockHelp),onMouseOut:()=>(0,l.ae)(),onFocus:()=>(0,l.af)(this.calciteSwitchNode,i.panels.heatmap.lockHelp),onFocusout:()=>(0,l.ae)()})))}renderRegenerate(){const{mapImageSublayer:e,strings:t}=l.s;if(!e)return(0,s.h)("div",{class:"top-bottom-margin-small"},(0,s.h)("calcite-button",{appearance:"outline-fill",kind:"neutral",width:"full",onClick:()=>{(0,r.r)((0,p.a)(),this.flowItemNode).then((()=>{(0,l.ab)()}),(e=>this.arcgisSmartMappingPanelsHeatmapError.emit(e)))},label:t.panels.heatmap.regenerate},t.panels.heatmap.regenerate))}get hostElement(){return(0,s.d)(this)}};w.style=":host{width:100%}.flow-item{height:100%}.heatmap-block{overflow-x:hidden}.attribute-name{word-break:break-all}.slider-labels{display:flex;justify-content:space-between}.top-bottom-margin-small{margin:10px 0}.top-margin-medium{margin-top:18px}";const M=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsPredominanceSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsPredominanceSizeBackClick",7),this.arcgisSmartMappingPanelsPredominanceSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsPredominanceSizeClose",7),this.arcgisSmartMappingPanelsPredominanceSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsPredominanceSizeError",7),this.tileNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsPredominanceSizeClose.emit("save")},this.handleOptionsClick=e=>{const{flowNode:t}=this;switch(e){case"size":{const e=document.createElement("arcgis-smart-mapping-panels-size");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsSizeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsSizeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsSizeError",(({detail:e})=>this.arcgisSmartMappingPanelsPredominanceSizeError.emit(e))),t.appendChild(e);break}case"predominance":{const e=document.createElement("arcgis-smart-mapping-panels-predominance");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsPredominanceClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsPredominanceBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsPredominanceError",(({detail:e})=>this.arcgisSmartMappingPanelsPredominanceSizeError.emit(e))),t.appendChild(e);break}}},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.lastClick=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t,useFeatureReduction:i}=l.s,s=(0,l.j)(e);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.flowNode=i?(0,l.f)(this.hostElement,"arcgis-smart-mapping"):(0,l.f)(this.hostElement,"calcite-flow")}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{layer:t,hideLayerTitle:i,isRTL:a,mapImageSublayer:n,strings:r}=l.s,c=i?void 0:null!==(e=null==n?void 0:n.title)&&void 0!==e?e:t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{class:{"flow-item":!0,[o.C.rtl]:a},heading:r.panels.styleOptions,description:c,closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,ref:e=>this.flowItemNode=e,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsPredominanceSizeBackClick.emit()},this.renderPredominanceTile(),this.renderSizeTile(),this.renderTransparency(),this.renderRotation(),this.renderDoneButton(),this.renderCancelButton()))}renderPredominanceTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"predominance",selected:!1,onArcgisSmartMappingTileSelect:()=>{this.lastClick="predominance",this.handleOptionsClick("predominance")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("predominance"),ref:e=>{e&&(this.tileNodes.predominance=e)}})}renderSizeTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"size",selected:"size"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="size",this.handleOptionsClick("size")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("size"),ref:e=>{e&&(this.tileNodes.size=e)}})}renderTransparency(){const{layer:e}=l.s,t=(0,l.a)((0,l.j)(e),"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!t,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsPredominanceSizeError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.a)((0,l.j)(e),"opacity"),i=(0,l.a)((0,l.j)(e),"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!t&&!!i,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsPredominanceSizeError.emit(e)})}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{(0,l.k)(this.originalRendererJSON,this.originalFeatureReduction),this.arcgisSmartMappingPanelsPredominanceSizeClose.emit("cancel")},appearance:"outline-fill",width:"half"},e.cancel)}focusSelectedTile(){setTimeout((()=>requestAnimationFrame((()=>this.tileNodes[this.lastClick].setFocus()))),300)}get hostElement(){return(0,s.d)(this)}};M.style=":host{width:100%}.flow-item{height:100%}";const B=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsRelationshipSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsRelationshipSizeClose",7),this.arcgisSmartMappingPanelsRelationshipSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRelationshipSizeBackClick",7),this.arcgisSmartMappingPanelsRelationshipSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsRelationshipSizeError",7),this.tileNodes=[],this.handleOptionsClick=e=>{const{flowNode:t}=this;switch(e){case"size":{const e=document.createElement("arcgis-smart-mapping-panels-size");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsSizeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsSizeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsSizeError",(({detail:e})=>this.arcgisSmartMappingPanelsRelationshipSizeError.emit(e))),t.appendChild(e);break}case"relationship":{const e=document.createElement("arcgis-smart-mapping-panels-relationship");e.hideTransparency=!0,e.hideRotation=!0,e.addEventListener("arcgisSmartMappingPanelsRelationshipClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsRelationshipBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsRelationshipError",(({detail:e})=>this.arcgisSmartMappingPanelsRelationshipSizeError.emit(e))),t.appendChild(e);break}}},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.lastClick=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){const{layer:e,modules:t,useFeatureReduction:i}=l.s,s=(0,l.j)(e);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.flowNode=i?(0,l.f)(this.hostElement,"arcgis-smart-mapping"):(0,l.f)(this.hostElement,"calcite-flow")}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{layer:t,mapImageSublayer:i,hideLayerTitle:a,isRTL:n,strings:r}=l.s,c=a?void 0:null!==(e=null==i?void 0:i.title)&&void 0!==e?e:t.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:r.panels.styleOptions,description:c,class:{"flow-item":!0,[o.C.rtl]:n},closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:()=>this.arcgisSmartMappingPanelsRelationshipSizeClose.emit("save"),onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsRelationshipSizeBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderRelationshipTile(),this.renderSizeTile(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:()=>this.arcgisSmartMappingPanelsRelationshipSizeClose.emit("save"),appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{(0,l.k)(this.originalRendererJSON,this.originalFeatureReduction),this.arcgisSmartMappingPanelsRelationshipSizeClose.emit("cancel")},appearance:"outline-fill",width:"half"},e.cancel)}renderRelationshipTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"relationship",selected:"relationship"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="relationship",this.handleOptionsClick("relationship")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("relationship"),ref:e=>{e&&(this.tileNodes.relationship=e)}})}renderSizeTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"size",selected:"size"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="size",this.handleOptionsClick("size")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("size"),ref:e=>{e&&(this.tileNodes.size=e)}})}renderTransparency(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!i,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsRelationshipSizeError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity"),a=(0,l.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!i&&!!a,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsRelationshipSizeError.emit(e)})}focusSelectedTile(){setTimeout((()=>requestAnimationFrame((()=>this.tileNodes[this.lastClick].setFocus()))),300)}get hostElement(){return(0,s.d)(this)}};B.style=":host{width:100%}.flow-item{height:100%}";const E=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsSimpleClose=(0,s.c)(this,"arcgisSmartMappingPanelsSimpleClose",7),this.arcgisSmartMappingPanelsSimpleBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsSimpleBackClick",7),this.arcgisSmartMappingPanelsSimpleError=(0,s.c)(this,"arcgisSmartMappingPanelsSimpleError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsSimpleClose.emit("save")},this.handleCancel=()=>{const{originalRenderer:e,originalFeatureReduction:t}=this,{layer:i}=l.s;"geo-rss"===i.type?(i.pointSymbol=e[0],i.lineSymbol=e[1],i.polygonSymbol=e[2]):(0,l.k)(e,t),this.arcgisSmartMappingPanelsSimpleClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.visualizationOpen=!1}async setFocus(){var e,t;null===(e=this.flowItemNode)||void 0===e||e.setFocus();const{layer:i}=l.s;"geo-rss"===i.type||"wfs"===i.type?null===(t=document.getElementById("simple-panel-dismiss-button"))||void 0===t||t.setFocus():document.getElementById("simple-panel").setFocus()}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:t}=l.s;if("geo-rss"===e.type){const t=e;this.originalRenderer=[t.pointSymbol.clone(),t.lineSymbol.clone(),t.polygonSymbol.clone()]}else{const i=(0,l.j)(e);this.originalRenderer=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,await(0,l.d)()}}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{layer:t,useFeatureReduction:i,hideLayerTitle:a,isRTL:n,strings:r}=l.s,c=i?r.panels.gallery.binStyles:"featureReduction"in t&&"cluster"===(null===(e=t.featureReduction)||void 0===e?void 0:e.type)?r.panels.gallery.clusterStyles:r.panels.gallery.styles;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:c,description:a?void 0:t.title,class:{"flow-item":!0,[o.C.rtl]:n},closable:(0,l.H)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsSimpleBackClick.emit()},ref:e=>{this.flowItemNode=e}},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.done,onClick:this.handleDone,appearance:"solid",width:"half"},t.done):null}renderCancelButton(){const{layer:e,strings:t}=l.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},t.cancel):null}renderVisualization(){const{visualizationOpen:e}=this,{layer:t,strings:i}=l.s;return(0,s.h)("calcite-block",{class:"simple-block",heading:i.panels.simple.simpleStyle,collapsible:"geo-rss"!==t.type&&(0,l.ag)(),open:e,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},"geo-rss"===t.type?this.renderGeoRssSymbols():this.renderSymbol())}renderSymbol(){const{layer:e}=l.s,t=(0,l.j)(e).symbol;return(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:t,type:"simple",onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.rotationNode&&(0,s.f)(this.rotationNode)}})}renderGeoRssSymbols(){return(0,s.h)("div",null,this.renderGeoRssSymbol("point"),this.renderGeoRssSymbol("line"),this.renderGeoRssSymbol("polygon"))}renderGeoRssSymbol(e){const{layer:t,strings:i}=l.s,a=t;let n="point"===e?a.pointSymbol:"line"===e?a.lineSymbol:a.polygonSymbol;const o="point"===e?i.panels.simple.pointSymbolStyle:"line"===e?i.panels.simple.lineSymbolStyle:i.panels.simple.polygonSymbolStyle;return(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:n,type:"point"===e?"geo-rss-point":"line"===e?"geo-rss-line":"geo-rss-polygon",label:o,onArcgisSmartMappingSymbolButtonSymbolChange:()=>(0,s.f)(this.hostElement)})}renderTransparency(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!i,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsSimpleError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.j)(e),i=(0,l.a)(t,"opacity"),a=(0,l.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!i&&!!a,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsSimpleError.emit(e)})}get hostElement(){return(0,s.d)(this)}};E.style=":host{width:100%}.flow-item{height:100%}.simple-block{overflow-x:hidden}";const N=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsTypeSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsTypeSizeBackClick",7),this.arcgisSmartMappingPanelsTypeSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsTypeSizeClose",7),this.arcgisSmartMappingPanelsTypeSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsTypeSizeError",7),this.tileNodes=[],this.handleDone=()=>{(0,l.l)(),this.arcgisSmartMappingPanelsTypeSizeClose.emit("save")},this.handleOptionsClick=e=>{const{flowNode:t}=this;switch(e){case"size":{const e=document.createElement("arcgis-smart-mapping-panels-size");e.hideRotation=!0,e.hideTransparency=!0,e.addEventListener("arcgisSmartMappingPanelsSizeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsSizeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsSizeError",(({detail:e})=>this.arcgisSmartMappingPanelsTypeSizeError.emit(e))),t.appendChild(e);break}case"type":{const e=document.createElement("arcgis-smart-mapping-panels-type");e.hideRotation=!0,e.hideTransparency=!0,e.addEventListener("arcgisSmartMappingPanelsTypeClose",(()=>{t.removeChild(e),this.focusSelectedTile()})),e.addEventListener("arcgisSmartMappingPanelsTypeBackClick",(()=>this.focusSelectedTile())),e.addEventListener("arcgisSmartMappingPanelsTypeError",(({detail:e})=>this.arcgisSmartMappingPanelsTypeSizeError.emit(e))),t.appendChild(e);break}}},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.lastClick=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t,useFeatureReduction:i}=l.s,s=(0,l.j)(e);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0,this.flowNode=i?(0,l.f)(this.hostElement,"arcgis-smart-mapping"):(0,l.f)(this.hostElement,"calcite-flow")}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.scaleHandle=(0,n.w)(this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")))}disconnectedCallback(){var e;null===(e=this.scaleHandle)||void 0===e||e.remove()}render(){var e;const{hideLayerTitle:t,isRTL:i,layer:a,mapImageSublayer:n,strings:r}=l.s,c=t?void 0:null!==(e=null==n?void 0:n.title)&&void 0!==e?e:a.title;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{class:{"flow-item":!0,[o.C.rtl]:i},closable:(0,l.H)(this.hostElement),heading:r.panels.styleOptions,description:c,menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,ref:e=>this.flowItemNode=e,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsTypeSizeBackClick.emit(),onCalciteFlowItemClose:this.handleDone},this.renderTypeTile(),this.renderSizeTile(),this.renderTransparency(),this.renderRotation(),this.renderDoneButton(),this.renderCancelButton()))}renderTypeTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"type",selected:"type"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="type",this.handleOptionsClick("type")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("type"),ref:e=>{e&&(this.tileNodes.type=e)}})}renderSizeTile(){return(0,s.h)("arcgis-smart-mapping-tile",{type:"size",selected:"size"===this.lastClick,onArcgisSmartMappingTileSelect:()=>{this.lastClick="size",this.handleOptionsClick("size")},onArcgisSmartMappingTileOptions:()=>this.handleOptionsClick("size"),ref:e=>{e&&(this.tileNodes.size=e)}})}renderTransparency(){const{layer:e}=l.s,t=(0,l.a)((0,l.j)(e),"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!t,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsTypeSizeError.emit(e)})}renderRotation(){const{layer:e}=l.s,t=(0,l.a)((0,l.j)(e),"opacity"),i=(0,l.a)((0,l.j)(e),"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!t&&!!i,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsTypeSizeError.emit(e)})}renderDoneButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=l.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{(0,l.k)(this.originalRendererJSON,this.originalFeatureReduction),this.arcgisSmartMappingPanelsTypeSizeClose.emit("cancel")},appearance:"outline-fill",width:"half"},e.cancel)}focusSelectedTile(){setTimeout((()=>requestAnimationFrame((()=>this.tileNodes[this.lastClick].setFocus()))),300)}get hostElement(){return(0,s.d)(this)}};N.style=":host{width:100%}.flow-item{height:100%}"},37192:(e,t,i)=>{i.d(t,{w:()=>a});var s=i(59503);function a(e,t){const{layer:i,mapView:a,useFeatureReduction:n}=s.s;if(!n||!("featureReduction"in i)||"binning"!==i.featureReduction.type)return;const o=s.s.modules.reactiveUtils.watch((()=>a.scale),(()=>{const n=i.featureReduction;a.scale<=n.maxScale&&!e.disabled?((0,s.l)(),function(e,t){const i=document.createElement("arcgis-smart-mapping-scale-alert-popover");i.refElement=e,i.addEventListener("arcgisSmartMappingScaleAlertPopoverBack",(()=>{l(),t()})),document.body.append(i)}(e,t),(0,s.m)(e,!0)):a.scale>n.maxScale&&e.disabled&&(l(),(0,s.m)(e,!1),e.setFocus())}));return o}function l(){document.querySelectorAll("arcgis-smart-mapping-scale-alert-popover").forEach((e=>{var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e),e=null}))}i(21104),i(2137)},51298:(e,t,i)=>{i.d(t,{a:()=>n,c:()=>l,g:()=>o});var s=i(59503),a=(i(21104),i(89393));function l(e){var t;const{layer:i,useFeatureReduction:l,mapImageSublayer:n,mapView:o,modules:r}=s.s,c=i;e=e||{};const d=(0,s.p)((0,s.j)(c));return r.ColorCreator.createContinuousRenderer({layer:c,view:o,field:e.fieldInfos[0].field,theme:"above-and-below",colorScheme:(0,s.Q)("above-and-below"),normalizationField:e.fieldInfos[1].field,outlineOptimizationEnabled:!n&&((0,a.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:(0,s.u)(c)),sizeOptimizationEnabled:!n&&(!(0,a.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(t=c.featureReduction)||void 0===t?void 0:t.type)&&l}).then((e=>(((0,s.t)(e.renderer,"color")||{}).style="ratio",(0,s.o)(d,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function n(e){var t,i,l,n;const{layer:r,useFeatureReduction:c,mapImageSublayer:d,mapView:h,modules:p}=s.s,m=r;e=e||{};const u=(0,s.j)(m),g=(0,s.a)(u,"color");if(g&&e.fieldInfo&&e.fieldInfo.field==g.field&&e.normalizationField===g.normalizationField&&(delete e.fieldInfos,(0,s.S)(e)))return Promise.resolve({renderer:u.clone()});const S=(0,s.t)(u,"color"),f=(0,s.p)(u);let v=e.fieldInfos?e.fieldInfos[0]:g?{field:g.field,expression:g.valueExpression,expressionTitle:g.valueExpressionTitle,simpleFieldType:s.z.NUMBER}:{field:u.field,expression:u.valueExpression,expressionTitle:u.valueExpressionTitle,simpleFieldType:s.z.NUMBER};const b=e.normalizationField?e.normalizationField:g?g.normalizationField:u.normalizationField,y=u.classBreakInfos&&u.classBreakInfos.length?u.classBreakInfos[0].symbol:null,C=u.defaultSymbol,k=u.defaultLabel;let w=!1;(null===e.normalizationField||e.normalizationField||e.fieldInfo)&&(w=!0);const M=e.discardMinMax?void 0:(0,a.i)(e.min)?e.min:w?void 0:S?S.minSliderValue:u.classBreakInfos[0].minValue,B=e.discardMinMax?void 0:(0,a.i)(e.max)?e.max:w?void 0:S?S.maxSliderValue:u.classBreakInfos[u.classBreakInfos.length-1].maxValue;return p.ColorCreator.createContinuousRenderer({layer:m,view:h,field:v?v.field:u.field,theme:"above-and-below",colorScheme:(0,s.Q)("above-and-below"),normalizationField:b,minValue:M,maxValue:B,outlineOptimizationEnabled:!d&&((0,a.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!f.sizeOutlineVisVar),sizeOptimizationEnabled:!d&&((0,a.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!f.sizeAutoVisVar),legendOptions:(null===(t=e.legendOptions)||void 0===t?void 0:t.toJSON())||(null===(i=null==g?void 0:g.legendOptions)||void 0===i?void 0:i.toJSON())||(null===(l=u.legendOptions)||void 0===l?void 0:l.toJSON()),defaultSymbolEnabled:(0,a.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!u.defaultSymbol,forBinning:"binning"===(null===(n=m.featureReduction)||void 0===n?void 0:n.type)&&c}).then((t=>{if(e.discardMinMax){const e=(0,s.a)(u,"color"),i=(0,s.a)(t.renderer,"color");e.stops.forEach(((e,t)=>e.value=i.stops[t].value));const a=!!S&&"percent"===S.style,l=!!S&&"percent-of-total"===S.style;e.stops[0].label=`< ${o(e.stops[0].value,a,l)}`,e.stops[2].label=`${o(e.stops[2].value,a,l)}`,e.stops[4].label=`> ${o(e.stops[4].value,a,l)}`}return((0,s.t)(t.renderer,"color")||{}).style="ratio",(0,s.o)(f,t.renderer),y&&t.renderer.classBreakInfos&&t.renderer.classBreakInfos.length&&(t.renderer.classBreakInfos[0].symbol=y),C&&(t.renderer.defaultSymbol=C,t.renderer.defaultLabel=k),Promise.resolve(t)}),(e=>Promise.reject(e)))}function o(e,t,i){return i?Math.round(e/(1+e)*1e4)/100+"%":t?Math.round(1e4*e)/100+"%":`${e}`}},75076:(e,t,i)=>{i.d(t,{a:()=>n,c:()=>a,u:()=>l});var s=i(59503);function a(e){var t;const{layer:i,mapView:a,modules:l}=s.s,n=i,o=(0,s.j)(n);return e=e||{},"heatmap"===(0,s.g)()&&(e.radius=e.radius||o.radius,e.heatmapScheme=e.heatmapScheme||(0,s.W)()),(null===(t=e.fieldInfos)||void 0===t?void 0:t.length)&&(0,s.P)([e.fieldInfos[0].field]),l.HeatmapCreator.createRenderer({layer:n,view:a,field:e.fieldInfos&&e.fieldInfos.length?e.fieldInfos[0].field:null,radius:e.radius||10,heatmapScheme:e.heatmapScheme||void 0})}function l(e){const{layer:t,modules:i}=s.s,a=(0,s.j)(t);return i.HeatmapCreator.updateRenderer({renderer:a,fadeRatio:e})}function n(e){const{layer:t,mapView:i,modules:a}=s.s,l=t,n=(0,s.j)(l);return e=e||{},a.heatmapStatistics({layer:l,view:i,field:n.field,radius:e.radius||n.radius||10}).then((e=>(n.minDensity=e.min,n.maxDensity=e.max,Promise.resolve(e))),(e=>Promise.reject(e)))}i(21104),i(2137)}}]);