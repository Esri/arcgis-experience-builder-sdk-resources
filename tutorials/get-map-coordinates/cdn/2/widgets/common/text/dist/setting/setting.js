System.register(["jimu-core","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/rich-text-editor","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder"],(function(e,t){var o={},a={},n={},r={},l={},i={},s={};return{setters:[function(e){o.AllDataSourceTypes=e.AllDataSourceTypes,o.Immutable=e.Immutable,o.React=e.React,o.ReactRedux=e.ReactRedux,o.classNames=e.classNames,o.css=e.css,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jsx=e.jsx},function(e){a.builderAppSync=e.builderAppSync},function(e){n.SettingRow=e.SettingRow,n.SettingSection=e.SettingSection},function(e){r.RichTextFormatKeys=e.RichTextFormatKeys,r.RichTextFormats=e.RichTextFormats,r.richTextEditorUtils=e.richTextEditorUtils,r.useEditorSelectionFormats=e.useEditorSelectionFormats},function(e){l.Button=e.Button,l.Switch=e.Switch,l.TextArea=e.TextArea,l.defaultMessages=e.defaultMessages,l.richTextUtils=e.richTextUtils},function(e){i.DataSourceSelector=e.DataSourceSelector},function(e){s.ExpressionInput=e.ExpressionInput,s.ExpressionInputType=e.ExpressionInputType}],execute:function(){e((()=>{var e={9759:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.5 2a.5.5 0 0 0 0 1H7l-1.868 8.406a.488.488 0 0 0 .953.212L8 3h3.5a.5.5 0 0 0 0-1zm-1 11a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm6.64-3.86a.477.477 0 0 1 .674 0l1.686 1.686 1.686-1.686a.477.477 0 1 1 .674.674L12.174 11.5l1.686 1.686a.477.477 0 1 1-.674.674L11.5 12.174 9.814 13.86a.477.477 0 1 1-.674-.674l1.686-1.686L9.14 9.814a.477.477 0 0 1 0-.674" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=o},4108:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=l},13089:e=>{"use strict";e.exports=i},84845:e=>{"use strict";e.exports=s},33949:e=>{"use strict";e.exports=r},79298:e=>{"use strict";e.exports=n}},t={};function c(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{__set_webpack_public_path__:()=>E,default:()=>w});var e=c(79244),t=c(4108),o=c(79298),a=c(33949),n=c(14321),r=c(13089);const l={verticalAlignment:"Vertical alignment"};var i=c(84845);var s=c(9759),p=c.n(s),d=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o};const m=t=>{const o=window.SVG,{className:a}=t,n=d(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",a);return o?e.React.createElement(o,Object.assign({className:r,src:p()},n)):e.React.createElement("svg",Object.assign({className:r},n))};var g=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o};const S=e.css`
  > * {
    user-select: none;
  }
`,y=t=>{const{editor:o,onChange:r}=t,l=g(t,["editor","onChange"]),[,i]=(0,a.useEditorSelectionFormats)(o,!0),s=e.hooks.useTranslation(n.defaultMessages);return(0,e.jsx)(n.Button,Object.assign({css:S},l,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{a.richTextEditorUtils.clearFormats(o,i),null==r||r(null==o?void 0:o.root.innerHTML)},title:s("clearAllFormats"),"aria-label":s("clearAllFormats")}),(0,e.jsx)(m,null))};var b=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o};const x=t=>{const{editor:o,defaultColor:n}=t,r=b(t,["editor","defaultColor"]),[l,i]=(0,a.useEditorSelectionFormats)(o,!0),s=e.React.useMemo((()=>{var e;let t=l;return null!=(null===(e=null==t?void 0:t.link)||void 0===e?void 0:e.link)&&(t=Object.assign(Object.assign({},t),{link:t.link.link})),!t.color&&n&&(t=Object.assign(Object.assign({},t),{color:n})),t}),[l,n]);return e.React.createElement(a.RichTextFormats,Object.assign({editor:o,formats:s,selection:i},r))},f=(0,e.Immutable)([e.AllDataSourceTypes.FeatureLayer,e.AllDataSourceTypes.SceneLayer,e.AllDataSourceTypes.BuildingComponentSubLayer,e.AllDataSourceTypes.OrientedImageryLayer,e.AllDataSourceTypes.ImageryLayer,e.AllDataSourceTypes.SubtypeGroupLayer,e.AllDataSourceTypes.SubtypeSublayer]),v=(0,e.Immutable)([i.ExpressionInputType.Static,i.ExpressionInputType.Attribute,i.ExpressionInputType.Statistics,i.ExpressionInputType.Expression]),h=(0,e.Immutable)([]),w=s=>{var c,u,p,d,m,g,S,b,w;const{id:E,config:R,useDataSources:T,useDataSourcesEnabled:O,onSettingChange:j}=s,I="Web Experience Template"===(null===(u=null===(c=(0,e.getAppStore)().getState().appStateInBuilder)||void 0===c?void 0:c.appInfo)||void 0===u?void 0:u.type),A=null===(d=null===(p=R.style)||void 0===p?void 0:p.wrap)||void 0===d||d,D=R.text,C=R.placeholder,M=e.React.useMemo((()=>{var e;return null!==(e=n.richTextUtils.getHTMLTextContent(C))&&void 0!==e?e:""}),[C]),F=R.tooltip,P=e.ReactRedux.useSelector((e=>e.appStateInBuilder)),k=null===(g=null===(m=null==P?void 0:P.widgetsMutableStateVersion)||void 0===m?void 0:m[E])||void 0===g?void 0:g.editor,L=null===(b=null===(S=null==P?void 0:P.widgetsRuntimeInfo)||void 0===S?void 0:S[E])||void 0===b?void 0:b.isInlineEditing,_=O&&(null==T?void 0:T.length)>0,[U,N]=e.React.useState(null),[B,V]=e.React.useState(!1);e.React.useEffect((()=>{var e;const t=window._appWindow._mutableStoreManager,o=null!==(e=null==t?void 0:t.getStateValue([E,"editor"]))&&void 0!==e?e:null;N(o)}),[k,E]);const H=e.hooks.useTranslation(l,n.defaultMessages),W=(e,t,o)=>{const r=n.richTextUtils.isBlankRichText(D)&&!!C,l=!L&&r?"placeholder":"text";let i=R.set(l,e);L||t!==a.RichTextFormatKeys.Color||(i=i.setIn(["style","color"],o)),j({id:E,config:i})},z=e.React.useMemo((()=>_?v:(0,e.Immutable)([i.ExpressionInputType.Static])),[_]);return e.React.createElement("div",{className:"widget-setting-text jimu-widget-setting"},e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,null,e.React.createElement(r.DataSourceSelector,{isMultiple:!0,types:f,useDataSources:T,useDataSourcesEnabled:O,onToggleUseDataEnabled:()=>{t.builderAppSync.publishWidgetToolbarStateChangeToApp(E,["text-expression"]);const e=!O;j(F&&!e?{id:E,config:R.without("tooltip"),useDataSourcesEnabled:e}:{id:E,useDataSourcesEnabled:e})},onChange:e=>{t.builderAppSync.publishWidgetToolbarStateChangeToApp(E,["text-expression"]),null!=e&&j({id:E,useDataSources:e})},widgetId:E}))),e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,{flow:"no-wrap",tag:"label",label:H("wrap")},e.React.createElement(n.Switch,{checked:A,onChange:()=>{j({id:E,config:R.setIn(["style","wrap"],!A)})}})),e.React.createElement(o.SettingRow,{label:H("tooltip"),flow:"wrap",role:"group","aria-label":H("tooltip")},e.React.createElement("div",{className:"w-100"},e.React.createElement(i.ExpressionInput,{"aria-label":H("tooltip"),autoHide:!0,useDataSources:_?T:h,onChange:e=>{null!=e&&(j({id:E,config:R.set("tooltip",e)}),V(!1))},openExpPopup:()=>{V(!0)},expression:"object"==typeof F?F:null,isExpPopupOpen:B,closeExpPopup:()=>{V(!1)},types:z,widgetId:E}))),I&&e.React.createElement(o.SettingRow,{flow:"wrap",label:H("placeholder")},e.React.createElement(n.TextArea,{"aria-label":H("placeholder"),defaultValue:M,onAcceptValue:e=>{e=e.replace(/\n/gm,"");const t=((e,t)=>{const o=n.richTextUtils.getHTMLTextContent(e);return e.replace(null==o?void 0:o.trim(),t)})(C,e);j({id:E,config:R.set("placeholder",t)})}}))),null!=U&&e.React.createElement(o.SettingSection,null,e.React.createElement(o.SettingRow,{flow:"no-wrap",label:H("textFormat"),role:"group","aria-label":H("textFormat")},e.React.createElement(y,{editor:U,onChange:W})),e.React.createElement(o.SettingRow,null,e.React.createElement(x,{widgetId:E,editor:U,defaultColor:null===(w=R.style)||void 0===w?void 0:w.color,useDataSources:T,onChange:W}))))};function E(e){c.p=e}})(),u})())}}}));