/*! For license information please see arcgis_processing-templates_node_modules_arcgis_imagery-components_dist_es-4e7eb8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_processing-templates_node_modules_arcgis_imagery-components_dist_es-4e7eb8"],{49530:(e,t,i)=>{i.r(t),i.d(t,{arcgis_imagery_display_order:()=>h});var a=i(41126),s=i(14886),l=i(20353);const r=["center","northwest","lock-raster","attribute","nadir","viewpoint","seamline","none"],c=["first","last","min","max","mean","blend","sum"],n=["double","single","long","integer","small-integer","oid","date","big-integer","date-only"],o=e=>"seamline"===e?["first","blend"]:c,h=class{constructor(e){(0,a.r)(this,e),this.arcgisClose=(0,a.c)(this,"arcgisClose",7),this.manager=(0,s.u)(this),this.mosaicMethodList=r,this.attributeFieldList=[],this.strings=(0,l.u)({blocking:!0}),this.handleMosaicMethodChange=e=>{const t=e.target,i=t.selectedOption?.value,{lockRasterIds:a,operation:s}=this.activeMosaicRule,l="attribute"===i?this.attributeFieldList?.[0]?.name:null,r="lock-raster"!==i?null:a,c="seamline"!==i||null,n=o("seamline"),h="seamline"===i&&null!=s&&n.includes(s)?s:"first";this.activeMosaicRule&&(this.activeMosaicRule.method=i,this.activeMosaicRule.sortField=l,this.activeMosaicRule.sortValue=null,this.activeMosaicRule.lockRasterIds=r,this.activeMosaicRule.ascending=c,this.activeMosaicRule.operation=h),this.updateActiveMosaicRule()},this.handleAttributeFieldChange=e=>{const t=e.target,i=t.selectedOption?.value;this.activeMosaicRule&&(this.activeMosaicRule.sortField=i),this.updateActiveMosaicRule()},this.debouncedHandleAttributeValueChange=(0,s.d)((e=>{this.activeMosaicRule&&(this.activeMosaicRule.sortValue=e),this.updateActiveMosaicRule()}),300),this.handleDateAttributeValueChange=e=>{const t=e.target,i=t?.value,a=i.replace(/-/gu,"/");this.debouncedHandleAttributeValueChange(a)},this.handleAttributeValueChange=e=>{const t=e.target,i=t?.value,a=+i;this.debouncedHandleAttributeValueChange(a)},this.debouncedHandleRasterIDsChange=(0,s.d)((e=>{this.activeMosaicRule&&(this.activeMosaicRule.lockRasterIds=e),this.updateActiveMosaicRule()}),300),this.handleRasterIDsChange=e=>{const t=e.target,i=t?.value;if(!/^[0-9]+(,[0-9]+)*$/.test(i))return;const a=i.split(",").map((e=>Number.parseInt(e,10)));this.debouncedHandleRasterIDsChange(a)},this.debouncedHandleReverseOrderChange=(0,s.d)((e=>{this.activeMosaicRule&&(this.activeMosaicRule.ascending=!e),this.updateActiveMosaicRule()}),300),this.handleReverseOrderChange=e=>{const t=e.target,i=t?.checked;this.debouncedHandleReverseOrderChange(i)},this.handleMosaicOperatorChange=e=>{const t=e.target,i=t.selectedOption?.value;this.activeMosaicRule&&(this.activeMosaicRule.operation=i),this.updateActiveMosaicRule()},this.handleDone=()=>{this.arcgisClose.emit("save")},this.handleCancel=()=>{this.layer.mosaicRule=this.originalMosaicRule,this.activeMosaicRule=this.originalMosaicRule.clone(),this.arcgisClose.emit("cancel")},this.layer=void 0,this.closable=!1,this.activeMosaicRule=void 0}watchStateHandler(e,t){e&&t&&(this.layer.mosaicRule=e)}async componentWillLoad(){this.init()}render(){return(0,a.h)(a.H,{key:"d7f591d169ca44a264feb6592659c60dd3395504",class:"calcite-match-height"},(0,a.h)("calcite-panel",{key:"02166c02b02886f8ab3b45946fd3247217b9dcae",heading:this.strings.imageDisplayOrder,closable:this.closable,loading:!this.activeMosaicRule,onCalcitePanelClose:this.handleCancel,class:{panel:!0}},this.renderMosaicRule(),this.renderFooterActions()))}renderMosaicRule(){if(!this.activeMosaicRule)return null;const e=this.activeMosaicRule.method,t="attribute"===e,i="lock-raster"===e,s="seamline"!==e;return(0,a.h)("calcite-block",{heading:"",open:!0},this.renderMosaicMethodSelection(),t&&this.renderAttributeFilter(),i&&this.renderRasterId(),s&&this.renderReverseOrder(),this.renderMosaicOperatorSelection())}renderMosaicMethodSelection(){const{method:e}=this.activeMosaicRule,{mosaicMethod:t,componentLabel:i,mosaicMethodLabel:s}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-select",{label:i.methodSelect,onCalciteSelectChange:this.handleMosaicMethodChange},this.mosaicMethodList.map((t=>(0,a.h)("calcite-option",{key:t,value:t,label:s[t],selected:t===e})))))}renderAttributeFilter(){const{sortField:e}=this.activeMosaicRule,t=this.attributeFieldList.find((({name:t})=>t===e))?.type,i="date"===t||"date-only"===t;return(0,a.h)("div",null,this.renderAttributeMethodSelection(),i?this.renderAttributeDatePicker():this.renderAttributeSortValue())}renderAttributeMethodSelection(){const{sortField:e}=this.activeMosaicRule,{attribute:t,componentLabel:i}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-select",{label:i.attributeFieldSelect,onCalciteSelectChange:this.handleAttributeFieldChange},this.attributeFieldList.map((({name:t,alias:i})=>(0,a.h)("calcite-option",{key:t,value:t,label:i??"",selected:t===e})))))}renderAttributeDatePicker(){const{sortValue:e}=this.activeMosaicRule,{highestPriorityValue:t}=this.strings,i=e?.toString()?.includes("/")?e.replace(/\//gu,"-"):"";return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-input-date-picker",{placement:"bottom-end","overlay-positioning":"fixed",value:i,onCalciteInputDatePickerChange:this.handleDateAttributeValueChange}))}renderAttributeSortValue(){const{sortValue:e}=this.activeMosaicRule,{highestPriorityValue:t}=this.strings;return(0,a.h)("calcite-label",null,t,(0,a.h)("calcite-input",{type:"number",step:.001,value:e?.toString(),onCalciteInputInput:this.handleAttributeValueChange}))}renderRasterId(){const{lockRasterIds:e}=this.activeMosaicRule,t=e?.join(",");return(0,a.h)("calcite-label",null,this.strings.imageIDs,(0,a.h)("calcite-input",{class:"image-display-order-lock-input",placeholder:this.strings.useCommaDelimiter,value:t,onCalciteInputInput:this.handleRasterIDsChange}))}renderReverseOrder(){const{ascending:e}=this.activeMosaicRule;return(0,a.h)("calcite-label",{layout:"inline-space-between"},this.strings.reverserOrder,(0,a.h)("calcite-switch",{checked:!e,onCalciteSwitchChange:this.handleReverseOrderChange}))}renderMosaicOperatorSelection(){const{method:e,operation:t}=this.activeMosaicRule,i=o(e),{mosaicOperator:s,componentLabel:l,mosaicOperatorLabel:r}=this.strings;return(0,a.h)("calcite-label",null,s,(0,a.h)("calcite-select",{label:l.operatorSelect,onCalciteSelectChange:this.handleMosaicOperatorChange},i.map((e=>(0,a.h)("calcite-option",{key:e,value:e,label:r[e]??"",selected:e===t})))))}renderFooterActions(){return(0,a.h)(a.F,null,this.renderDoneButton(),this.renderCancelButton())}renderDoneButton(){return(0,a.h)("calcite-button",{slot:"footer",appearance:"solid",color:"blue",width:"half",disabled:!this.activeMosaicRule,onClick:this.handleDone},this.strings.done)}renderCancelButton(){return(0,a.h)("calcite-button",{slot:"footer",appearance:"outline-fill",width:"half",disabled:!this.activeMosaicRule,onClick:this.handleCancel},this.strings.cancel)}async init(){await this.layer.load(),this.originalMosaicRule=this.getOriginalMosaicRule(),this.activeMosaicRule=this.originalMosaicRule.clone(),this.mosaicMethodList=this.getMosaicMethodList(),this.attributeFieldList=this.getAttributeFieldList()}updateActiveMosaicRule(){this.activeMosaicRule=this.activeMosaicRule?.clone()}getOriginalMosaicRule(){const{mosaicRule:e,defaultMosaicRule:t}=this.layer;return e??t}getAllowedAttributeFieldList(){const{fields:e,sourceJSON:t}=this.layer,i=e.filter((({type:e})=>n.includes(e)));i.sort(((e,t)=>e.alias.localeCompare(t.alias)));const{sortableFields:a}=t||{};if(!a?.length)return i;const s=a?.split(",").map((e=>e.toLowerCase()));return i.filter((e=>s.includes(e.name.toLocaleLowerCase())))}filterAttributeFieldList(e){return"category"!==this.layer.sourceJSON?.sortField?.toLowerCase()?e.filter((e=>"category"!==e.name.toLocaleLowerCase())):e}getAttributeFieldList(){const e=this.getAllowedAttributeFieldList();return this.filterAttributeFieldList(e)}getAllowedMosaicMethodList(){const{sourceJSON:e}=this.layer;if(!e)return r;const{currentVersion:t,allowedMosaicMethods:i}=e;if(!(t&&t>=10.1)||!(i?.length>1))return r;const a=i.split(",").map((e=>(e=>{switch(e=e.toLowerCase()){case"lockraster":case"lock-raster":return"lock-raster";case"byattribute":return"attribute";default:return e}})(e.toLowerCase()))),s="none";return a.includes(s)||a.push(s),a}filteredMosaicMethodList(e){return e.filter((e=>"viewpoint"!==e))}getMosaicMethodList(){const e=this.getAllowedMosaicMethodList();return this.filteredMosaicMethodList(e)}static get assetsDirs(){return["assets"]}get el(){return(0,a.g)(this)}static get watchers(){return{activeMosaicRule:["watchStateHandler"]}}};h.style=":host{display:flex;height:100%}.image-display-order-lock-input{margin-top:0.5rem}"},20353:(e,t,i)=>{i.d(t,{u:()=>l});var a=i(14886),s=i(41126);const l=(0,a.m)(s.a)}}]);