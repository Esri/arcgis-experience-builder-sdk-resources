"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[52848],{52848:(e,n,t)=>{t.r(n),t.d(n,{createLabelFunction:()=>o,formatField:()=>c});var r=t(47817),s=t(83132),a=t(22649);t(58574),t(68700);const l=r.S.getLogger("esri.layers.support.labelFormatUtils"),i={type:"simple",evaluate:()=>null},u={getAttribute:(e,n)=>e.field(n)};async function o(e,n,o){if(!e||!e.symbol)return i;const p=e.where,f=(0,a.x)(e),x=p?await Promise.resolve().then(t.bind(t,64465)):null;let d;if("arcade"===f.type){const e=await(0,r.dC)(f.expression,o,n);d={type:"arcade",evaluate(n){try{const t=e.evaluate({$feature:"attributes"in n?e.repurposeFeature(n):e.repurposeAdapter(n)});if(null!=t)return t.toString()}catch(e){l.error(new r.s("bad-arcade-expression","Encountered an error when evaluating label expression for feature",{feature:n,expression:f}))}return null},needsHydrationToEvaluate:()=>null==(0,a._)(f.expression)}}else d={type:"simple",evaluate:e=>f.expression.replace(/{[^}]*}/g,(t=>{const s=t.slice(1,-1),a=(0,r.bI)(n,s);if(!a)return t;let l=null;return"attributes"in e?e&&e.attributes&&(l=e.attributes[a.name]):l=e.field(a.name),null==l?"":c(l,a)}))};if(p){let e;try{e=x.WhereClause.create(p,new s.e(n))}catch(e){return i}const t=d.evaluate;d.evaluate=n=>{const r="attributes"in n?void 0:u;return e.testFeature(n,r)?t(n):null}}return d}function c(e,n){if(null==e)return"";const t=n.domain;if(t)if("codedValue"===t.type||"coded-value"===t.type){const n=e;for(const e of t.codedValues)if(e.code===n)return e.name}else if("range"===t.type){const n=+e,r="range"in t?t.range[0]:t.minValue,s="range"in t?t.range[1]:t.maxValue;if(r<=n&&n<=s)return t.name}let s=e;return"date"===n.type||"esriFieldTypeDate"===n.type?s=(0,r.dD)(s,(0,r.dE)("short-date")):(0,r.cK)(n)&&(s=(0,r.dF)(+s)),s||""}},22649:(e,n,t)=>{t.d(n,{_:()=>h,f:()=>g,g:()=>b,u:()=>x,w:()=>w,x:()=>d});var r=t(47817);const s="__begin__",a="__end__",l=new RegExp(s,"ig"),i=new RegExp(a,"ig"),u=new RegExp("^"+s,"i"),o=new RegExp(a+"$","i"),c='"',p=c+" + ",f=" + "+c;function x(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function d(e){const n={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type="conventional"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type="arcade"):null!=e.labelExpression&&(n.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),n.type="conventional"),n}function g(e){const n=d(e);if(!n)return null;switch(n.type){case"conventional":return w(n.expression);case"arcade":return n.expression}return null}function b(e){const n=d(e);if(!n)return null;switch(n.type){case"conventional":return function(e){const n=e.match(y);return n&&n[1].trim()||null}(n.expression);case"arcade":return h(n.expression)}return null}function w(e){let n;return e?(n=(0,r.cf)(e,(e=>s+'$feature["'+e+'"]'+a)),n=u.test(n)?n.replace(u,""):c+n,n=o.test(n)?n.replace(o,""):n+c,n=n.replace(l,p).replace(i,f)):n='""',n}const y=/^\s*\{([^}]+)\}\s*$/i,m=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,v=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,E=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function h(e){if(!e)return null;let n=m.exec(e)||v.exec(e);return n?n[1]||n[3]:(n=E.exec(e),n?n[2]:null)}}}]);