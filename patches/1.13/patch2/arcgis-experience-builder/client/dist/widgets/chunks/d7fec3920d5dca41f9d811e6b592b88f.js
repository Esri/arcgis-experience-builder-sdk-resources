/*! For license information please see d7fec3920d5dca41f9d811e6b592b88f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[31932],{82463:(e,t,r)=>{r.d(t,{a:()=>n,i:()=>i});const n={FeatureServer:"Feature Service",GeocodeServer:"Geocoding Service",GeoDataServer:"Geodata Service",GeometryServer:"Geometry Service",GeoenrichmentServer:"Geoenrichment Service",GPServer:"Geoprocessing Service",GlobeServer:"Globe Service",ImageServer:"Image Service",MapServer:"Map Service",NAServer:"Network Analysis Service",ElevationServer:"Image Service",VectorTileServer:"Vector Tile Service",SceneServer:"Scene Service",StreamServer:"Stream Service",WMServer:"Workflow Manager Service",TiledImageServer:"Image Service",VideoServer:"Video Service"},i=e=>!!Object.values(n).includes(e)},31932:(e,t,r)=>{r.r(t),r.d(t,{arcgis_layers_and_tables_summary_popup:()=>u});var n=r(28384),i=r(62727),o=r(27010),s=r(76134),a=r(48711),l=r(26426),c=r(92967);r(18869),r(81068),r(66716),r(41171),r(62381),r(48507),r(82463);const d=(0,o.c)({}).state,u=class{constructor(e){(0,n.r)(this,e),this.handleClick=async()=>{var e;const{layers:t,item:r}=this;null===(e=this.button)||void 0===e||e.focus(),t||(this.loading=!0),d[r.id]||(d[r.id]=this.fetchServiceInfo());const n=await d[r.id];n.error&&(this.error=this.i18n.error,"serviceNotExist"===n.error.code&&(this.error.message=this.i18n.error.noServiceMessage)),n.result?this.sublayers=(0,c.s)(n.result,t):this.sublayers=t,this.loading=!1},this.handleWindowClick=({target:e})=>{this.el.contains(e)||(this.popoverNode.open=!1)},this.handleKeyPress=({key:e})=>{switch(e){case"Esc":case"Escape":this.popoverNode&&(this.popoverNode.open=!1)}},this.api=4,this.config=void 0,this.user=void 0,this.item=void 0,this.portal=void 0,this.layers=void 0,this.searchTerm=void 0,this.border=void 0,this.tooltip=void 0,this.telemetry=void 0,this.button=void 0,this.loading=!0,this.error=void 0,this.sublayers=void 0}async componentWillLoad(){const e=await(0,i.g)(this.el);this.i18n=e[0],s.c.api=this.api,s.c.portal=this.portal,s.c.config=this.config,s.c.user=this.user,this.layers||(this.loading=!0)}async fetchServiceInfo(){const{item:e,portal:t,layers:r}=this;return await(0,l.m)((0,c.f)({item:e,portal:t,layers:r,isSecure:!1}),500)}render(){const{i18n:e,portal:t,user:r,item:i,handleClick:o,handleKeyPress:s,loading:c,searchTerm:d,error:u,tooltip:v,telemetry:p}=this,h=this.sublayers||this.layers;return(0,n.h)(n.H,{onFocusout:e=>{e.relatedTarget&&!this.el.contains(e.relatedTarget)&&(this.popoverNode.open=!1)}},(0,n.h)("calcite-popover-manager",{autoClose:!0},(0,n.h)("button",Object.assign({class:{button:!0,"button--border":this.border},ref:e=>this.button=e,onClick:o,onTouchStart:o,onKeyPress:s},v?{title:v}:{}),(0,n.h)("span",{class:"button-text"},(0,n.h)("slot",null),(0,n.h)("calcite-icon",{icon:"caret-down",scale:"s",class:"button--icon"}))),(0,n.h)("calcite-popover",{ref:e=>this.popoverNode=e,label:e.layersAndTables,pointerDisabled:!0,referenceElement:this.button,closable:!0,class:"popover",placement:"bottom",overlayPositioning:"fixed",heading:e.layersAndTables,onCalcitePopoverOpen:()=>{var e;null===(e=this.telemetry)||void 0===e||e.logEvent({category:"preview popup",action:"click",pageName:(0,a.g)(),pageUrl:window.location.href}),window.addEventListener("click",this.handleWindowClick)},onCalcitePopoverClose:(0,l.d)((()=>{var e;null===(e=this.telemetry)||void 0===e||e.logEvent({category:"preview popup",action:"close",pageName:(0,a.g)(),pageUrl:window.location.href}),window.removeEventListener("click",this.handleWindowClick)}),200)},(0,n.h)("div",{class:"popover-content"},c?(0,n.h)("div",{class:"skeleton"},(0,n.h)("div",{class:"skeleton-content"},(0,n.h)("div",{class:"skeleton-left"}),(0,n.h)("div",{class:"skeleton-main"},(0,n.h)("div",{class:"skeleton-title"}),(0,n.h)("div",{class:"skeleton-subtitle"})),(0,n.h)("div",{class:"skeleton-right"}))):(0,n.h)("arcgis-layers-and-tables-summary",{portal:t,user:r,item:i,layers:h,showMatched:d&&!!this.layers,error:u,loading:!this.sublayers,telemetry:p,onLayersAndTablesFocusEnd:()=>{this.popoverNode.open=!1}})))))}get el(){return(0,n.d)(this)}};u.style=":host{max-width:100%}arcgis-layers-and-tables-summary:not(.hydrated){visibility:hidden}.popover-content{width:380px;min-height:6rem;background-color:var(--calcite-ui-background)}.skeleton{padding:0.5rem;margin:1rem;margin-bottom:3rem;animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;border:1px solid var(--calcite-ui-border-2)}.skeleton-content{display:flex}.skeleton-left,.skeleton-right{width:1rem;height:1rem;background-color:var(--calcite-ui-border-3)}.skeleton-main{flex:1 1 0%;margin-left:1rem;margin-right:1rem}.skeleton-title{height:1rem;background-color:var(--calcite-ui-border-2)}.skeleton-subtitle{height:1rem;margin-top:0.25rem;background-color:var(--calcite-ui-border-3)}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}.button{transition-property:all;padding:0;outline:2px solid transparent;outline-offset:2px;border-style:none;cursor:pointer;max-width:100%;color:inherit;background:transparent;font-family:inherit;font-size:inherit;line-height:1.5}.button:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:4px}.button--border{padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border:1px solid var(--calcite-ui-foreground-3)}.button--border:focus{outline-offset:0}.button-text{pointer-events:none;display:flex}.button--icon{vertical-align:-3px;-webkit-margin-start:0.25rem;margin-inline-start:0.25rem}"},76134:(e,t,r)=>{r.d(t,{c:()=>i,o:()=>o});const n=(0,r(27010).c)({portal:null,user:null,api:4,scale:"m"}),i=n.state,o=n.onChange},81068:(e,t,r)=>{r.d(t,{C:()=>a,a:()=>d,f:()=>l,g:()=>s,l:()=>o});var n=r(66716),i=r(18869);const o=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","nb"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function s(e){return function(e,t,r){const n=(0,i.c)(e,"[dir]");return n?n.getAttribute("dir"):"ltr"}(e)}const a={rtl:"arcgis--rtl"};async function l(e,t){const{api:r,type:i,places:o}=t||{};if(4===r){const[t]=await(0,n.l)(["esri/intl"]),r=t.convertNumberFormatToIntlOptions({places:o,style:i,digitSeparator:!0});return t.formatNumber(e,Object.assign(Object.assign({},r),{style:i}))}const[s]=await(0,n.l)(["dojo/number"]);return s.format(e,{type:i,places:o,pattern:null==t?void 0:t.pattern})}const c={};function d(e){const t=document.documentElement.lang;return c[t]||(c[t]=new Intl.DateTimeFormat(document.documentElement.lang,{year:"numeric",month:"short",day:"numeric"})),c[t].format(e)}},62727:(e,t,r)=>{r.d(t,{a:()=>s,g:()=>c});var n=r(18869),i=r(81068),o=r(28384);function s(e){var t,r,o;const s=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(r=e.shadowRoot)||void 0===r?void 0:r.ownerDocument)||void 0===o?void 0:o.documentElement,a=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return i.l.has(a)?i.l.get(a):i.l.has(a.slice(0,2))?i.l.get(a.slice(0,2)):"en"}const a={};function l(e,t){const r=`${e}${t}`;return a[r]||(a[r]=function(e,t){return new Promise(((r,n)=>{fetch((0,o.a)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then((e=>{e.ok?r(e.json()):n()}),(()=>n()))}))}(e,t)),a[r]}async function c(e,t){const r=t||e.tagName.toLowerCase(),o=s(e),a=function(e){var t,r,o;const s=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(r=e.shadowRoot)||void 0===r?void 0:r.ownerDocument)||void 0===o?void 0:o.documentElement,a=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return i.l.has(a)?i.l.get(a):i.l.has(a.slice(0,2))?a:"en"}(e);let c;try{c=await l(r,o)}catch(e){console.warn(`no locale for ${r} (${o}) loading default locale en.`),c=await l(r,"en")}return[c,o,a]}},41171:(e,t,r)=>{r.d(t,{a:()=>C,b:()=>T,c:()=>y,d:()=>S,e:()=>c,f:()=>g,g:()=>b,h:()=>a,i:()=>L,j:()=>m,k:()=>w,l:()=>O,p:()=>v,q:()=>x,r:()=>d});var n=r(66716),i=r(76134),o=r(62381),s=r(26426);function a(e){var t,r,n,o;return null!=e||(e=null===i.c||void 0===i.c?void 0:i.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(n=null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.credential)||void 0===n?void 0:n.token)||(null===(o=null==e?void 0:e.portalUser)||void 0===o?void 0:o.token)||""}function l(e){var t;const{config:r}=i.c;return"https:"===window.location.protocol||!0===(null===(t=null==r?void 0:r.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}async function c(e,t,r={},o){const[s]=await(0,n.l)(["esri/request"]),{api:c}=i.c;e.includes("f=")||t.append("f","json");const d=a();return d&&!t.has("token")&&t.append("token",d),new Promise(((n,i)=>{if(3===c){const a={url:!1===r.addSSL?e:l(e),form:t,timeout:r.timeout||0},c="post"===o?Object.assign({usePost:!0},r):r;s(a,c).then(n,i)}else s(e,Object.assign(Object.assign({body:t},r),{timeout:r.timeout||0,method:o||"auto"})).then((e=>{n(e.data)})).catch((e=>i(e)))}))}async function d(e,t={},r={},o,s){const[a]=await(0,n.l)(["esri/request"]),{api:c,portal:d}=i.c,u=Object.assign({},t);if(e.includes("f=")||!0===(null==s?void 0:s.excludeJson)||(u.f="json"),!1!==r.addTokenManually){const e=await S(d,c);u.token=e}const v=!1===r.addSSL?e:l(e);if(3===c)return a(Object.assign({url:v,content:u,timeout:r.timeout||0,withCredentials:r.withCredentials},null==s?void 0:s.v3Request),"post"===o?Object.assign({usePost:!0},r):r);{const e=Object.assign(Object.assign(Object.assign({query:u,method:o||"auto"},r),{timeout:r.timeout||0}),(null==r?void 0:r.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await a(v,e)).data}}const u=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120],v=async(e,t,r)=>{var n,i;const o=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],a=null!==(i=null==t?void 0:t.successStatuses)&&void 0!==i?i:["completed","Completed","COMPLETED"];let l=0;const c=async()=>{const n=await d(e,null==t?void 0:t.requestParams,{},r),i=n.status||n.jobStatus;if(o.includes(i))return await(0,s.t)((v=l++,1e3*u[v>-1&&v<u.length-1?v:u.length-1])),c();if(a.includes(i))return n;throw n;var v};try{return c()}catch(e){throw console.error(e),e}},p={},h={},f={};async function g(e,t,r,n){var i,o,s,a;const l=null===(o=null===(i=f[t])||void 0===i?void 0:i[r])||void 0===o?void 0:o.expireAt,c=!!l&&(new Date).getTime()>l;if((null===(s=p[t])||void 0===s?void 0:s[r])&&!c)return p[t][r];h[t]||(h[t]={}),h[t][r]&&!c||(h[t][r]=e());const d=await h[t][r];if(p[t]||(p[t]={}),f[t]||(f[t]={}),p[t][r]=d,n){const{expireAfter:e,getExpireAfterFromResult:i}=n,o=i||e?(new Date).getTime()+(null!==(a=null==i?void 0:i(d))&&void 0!==a?a:e):null;f[t][r]=Object.assign(Object.assign({},f[t][r]),{expireAt:o})}return d}function m(e,t){var r;return null===(r=null==p?void 0:p[e])||void 0===r?void 0:r[t]}const y=(e,t)=>{var r,n;t?(null===(r=p[e])||void 0===r||delete r[t],null===(n=h[e])||void 0===n||delete n[t]):(delete p[e],delete h[e])};function b(e){var t;const{portal:r,config:n}=i.c||{};return null!==(t=(0,o.d)(null==n?void 0:n.restBaseUrl))&&void 0!==t?t:w(e||r)}function w(e){var t;return(0,o.d)(null!==(t=e.restUrl)&&void 0!==t?t:e.portalUrl)}const S=async(e,t)=>{var r,n;if(!(null==e?void 0:e.isPortal)||!e.isWebTierAuth)return a(e);const{token:o}=await g((()=>k(e,null!=t?t:null===i.c||void 0===i.c?void 0:i.c.api)),"platformSelf",null!==(n=null===(r=e.user)||void 0===r?void 0:r.id)&&void 0!==n?n:e.id,{getExpireAfterFromResult:e=>e.expires_in});return o},k=async(e,t)=>{const r=await(async(e,t)=>{var r,i,o,s;const a=3===t,[l]=await n.e.loadModules([a?"esri/IdentityManager":"esri/identity/IdentityManager"]),c=await g((()=>l.getCredential(b(e),{oAuthPopupConfirmation:!1})),"credential",null===(r=e.user)||void 0===r?void 0:r.id);return null!==(s=a?null===(i=c._oAuthCred)||void 0===i?void 0:i.appId:null===(o=c.oAuthState)||void 0===o?void 0:o.appId)&&void 0!==s?s:"arcgisonline"})(e,t),i={"X-Esri-Auth-Client-Id":r,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return d(`${b(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:4===t?i:void 0,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:i}})};async function x(e={},t){return d(`${b(t)}/community/groups`,e)}const O=async(e,t)=>{var r;if(!e)return[];const n=`${(0,o.d)(null!==(r=t.restUrl)&&void 0!==r?r:t.portalUrl)}portals/self/servers`,i=await d(n);return null==i?void 0:i.servers},C=e=>T(w(e)),T=e=>{var t;const r=`${(0,o.d)(null!==(t=(0,o.l)(e))&&void 0!==t?t:e)}info`;return g((()=>d(r,{},{addTokenManually:!1})),"portalInfo",r)},L=async(e,t)=>{if(e.isBackedBySDS)return{result:!0};const r=(0,o.e)(t)||(0,o.f)(t)||(0,o.g)(t)||(0,o.h)(t)||(0,o.j)(t);if(e.isPortal&&t&&(r||(0,o.k)(t)))try{const r=await $(t,e);return{result:!!(null==r?void 0:r[0])}}catch(e){return console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)},result:!1}}return{result:!0}},$=async(e,t)=>{const r=await E(e,t);if(!r)return null;const n=`${r.adminUrl}/admin/data/findItems`;return(await d(n,{managed:!0})).items.filter((e=>{var t;return"arcgis data store"===(null===(t=e.provider)||void 0===t?void 0:t.toLowerCase())}))},E=async(e,t)=>{var r;return(null!==(r=await O(e,t))&&void 0!==r?r:[]).filter((e=>e.isHosted))[0]}},92967:(e,t,r)=>{r.d(t,{a:()=>u,f:()=>h,s:()=>p});var n=r(41171),i=r(76134),o=r(48507);function s(e,t,r){var n,i;return{description:e.description,fieldAliases:null===(n=e.fields)||void 0===n?void 0:n.map((e=>e.alias)),fields:e.fields,geometryType:r?"table":e.geometryType,id:e.id,title:e.name,type:e.type,matched:null===(i=null==t?void 0:t.find((t=>t.id===e.id)))||void 0===i?void 0:i.matched}}function a(e,t){const{config:r}=i.c,s=(0,o.a)(e),a=Object.assign(Object.assign({useProxy:!1,timeout:!1===r.isMultiTenant?6e4:5e3,addSSL:s},t?{}:{addTokenManually:!1}),{usePost:!0,disableIdentityLookup:!0});return(0,n.r)(e,{},a,"post")}function l(e){var t,r;return(null==e?void 0:e.code)||(null===(r=null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.raw)||void 0===r?void 0:r.code)}function c(e){const t=l(e);return[404,500].includes(t)||"Invalid URL"===(null==e?void 0:e.message)}function d(e,t){const r=l(t);return!e&&(499===r&&"Token Required"===(null==t?void 0:t.message)||403===r)&&!!i.c.user}async function u(e,t,r,n){const i={error:{code:"unhandledError"}};try{try{return{result:await a(`${r}/${t}`,n)}}catch(o){return d(n,o)?u(e,t,r,!0):(c(o)&&(i.error.code="serviceNotExist"),i)}}catch(e){return i}}function v(e,t,r,n){var i,o;const a=null==r?void 0:r.tables,l=(null===(i=null==r?void 0:r.layers)||void 0===i?void 0:i.length)>0||a,c=[...((null==r?void 0:r.layers)||[]).map((e=>e.id)),...null===(o=(null==r?void 0:r.tables)||[])||void 0===o?void 0:o.map((e=>e.id))];return(e||[]).filter((({id:e,type:t})=>!l||"Table"===t&&!a||c.includes(e))).map((e=>s(e,t,n)))}function p(e,t){return e.map((e=>{var r;return Object.assign(Object.assign({},e),{matched:null===(r=null==t?void 0:t.find((t=>t.id===e.id)))||void 0===r?void 0:r.matched})}))}async function h({item:e,portal:t,layers:r,isSecure:i,data:o,retry:l}){var u;const p={error:{code:"unhandledError"}};try{if(!o&&!l)try{const r=(0,n.h)(t),i=r?`&token=${r}`:"",s=`${(0,n.g)(t)}content/items/${e.id}/data?f=json${i}`,a=await fetch(s),l=await a.text();if(l&&(o=JSON.parse(l)),(null==o?void 0:o.error)&&403===o.error.code&&"SB_0006"===(null===(u=o.error)||void 0===u?void 0:u.messageCode))return p.error.code="serviceNotExist",p}catch(e){o=null}if("Feature Collection"===e.type&&(null==o?void 0:o.layers))return{result:o.layers.map((({layerDefinition:e},t)=>{var r;return{description:"",fields:e.fields,fieldAliases:null===(r=e.fields)||void 0===r?void 0:r.map((e=>e.alias)),geometryType:e.geometryType,type:e.type,id:t,matched:!1,title:e.name}}))};try{const{url:t}=e;return async function({serviceInfo:e,item:t,layers:r,isSecure:n,data:i}){var o,l;const{url:c}=t;if(!(null===(o=e.layers)||void 0===o?void 0:o.length)&&!(null===(l=e.tables)||void 0===l?void 0:l.length)&&(null==e?void 0:e.fields))return{result:[s(e,r)]};try{const{layers:e,tables:t}=await a(`${c}/layers`,n);return{result:[...v(e,r,i),...v(t,r,i,!0)].sort(((e,t)=>e.id-t.id))}}catch(e){return{error:{code:"unhandledError"}}}}({serviceInfo:await a(t,i),item:e,layers:r,isSecure:i,data:o})}catch(n){return d(i,n)?h({item:e,portal:t,layers:r,data:o,isSecure:!0}):(c(n)&&(p.error.code="serviceNotExist"),p)}}catch(e){return p}}},15859:(e,t,r)=>{r.d(t,{a:()=>o,b:()=>i,c:()=>l,d:()=>c,g:()=>a,s:()=>s});var n=r(26426);function i(e,t,r,n){!function(e,t,r){let n=null==(r=r||{})?void 0:r.expires;if("number"==typeof n){const e=new Date,t=24*n*60*60*1e3;e.setTime(Date.now()+t),n=r.expires=e}"string"!=typeof n&&(null==n?void 0:n.toUTCString)&&(r.expires=n.toUTCString());let i,o=`${e}=${encodeURIComponent(t)}`;for(i in r){o+=`; ${i}`;const e=r[i];!0!==e&&(o+=`=${e}`)}document.cookie=o}(e,n?JSON.stringify(t):t,r)}function o(e,t){const r=function(e){const t=document.cookie,r=new RegExp(`(?:^|; )${(0,n.e)(e)}=([^;]*)`),i=t.match(r);return i?decodeURIComponent(i[1]):void 0}(e);return r&&t?JSON.parse(r):r}function s(e,t,r){window.localStorage.setItem(e,r?JSON.stringify(t):t)}function a(e,t){const r=window.localStorage.getItem(e);return r&&t?JSON.parse(r):r}function l(e,t,r){window.sessionStorage.setItem(e,r?JSON.stringify(t):t)}function c(e,t){const r=window.sessionStorage.getItem(e);return r&&t?JSON.parse(r):r}},48711:(e,t,r)=>{function n(){const{hash:e,pathname:t}=window.location;if(t.includes("group.html"))return"group page";if(t.includes("search.html"))return"search result page";switch(e){case"#favorites":return"favorites";case"#groups":return"my groups content";case"#organization":return"my org content";case"#livingAtlas":return"living atlas";default:return"my content"}}r.d(t,{g:()=>n})},48507:(e,t,r)=>{r.d(t,{a:()=>h,b:()=>p,c:()=>d,d:()=>g,e:()=>f,f:()=>m,g:()=>y,i:()=>b,r:()=>c,s:()=>v,u:()=>u});var n=r(41171),i=r(62381),o=r(76134),s=r(66716),a=r(15859),l=r(82463);function c(e){return"/"===(null==e?void 0:e.slice(-1))?e.slice(0,e.length-1):e}async function d(e){var t;const r=null!==(t=null===o.c||void 0===o.c?void 0:o.c.api)&&void 0!==t?t:4,[n]=await(0,s.l)([4===r?"esri/core/urlUtils":"esri/urlUtils"]);let i=n.urlToObject(e);i.query=i.query||{};for(let e in i.query||{})i.query.hasOwnProperty(e)&&(Array.isArray(i.query[e])||(i.query[e]=i.query[e].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,"")));return i}function u(e){return(null==e?void 0:e.replace(/^.*\//,"").replace(/.[^.]*$/,""))||""}function v(e){return["WFS","GeoJson","CSV","GeoRSS","KML","OGCFeatureServer","WMS","WMTS"].includes(e)}function p(e){const{config:t,portal:r}=o.c;let n=!1;if(!e)return!1;if((t.httpsDomains||[]).forEach((t=>{(e.indexOf(`.${t}/`)>-1||e.indexOf(`/${t}/`)>-1)&&(n=!0)})),!n){let t=r.portalHostname;t.indexOf("/")>-1&&(t=t.substring(0,t.indexOf("/"))),e.indexOf(t)>-1&&(n=!0)}return n}function h(e){if(!e)return!1;const{config:t,portal:r}=o.c,i=(0,n.g)(r),s=new URL(i).hostname,a=!1===t.isMultiTenant,l=-1!==e.indexOf(".arcgis.com/"),c=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features")||-1!==e.indexOf("//locationservices"),d=r.supportsHostedServices&&-1!==e.indexOf(s)&&!a;return l&&c||!l&&d}function f(){var e;if(-1===window.location.protocol.toLowerCase().indexOf("https")){const t=(0,a.a)("esri_auth",!0);return"web"!==(null===(e=null==t?void 0:t.auth_tier)||void 0===e?void 0:e.toLowerCase())}return!0}function g(e){let t=e.toLowerCase();-1==t.indexOf("http://")&&-1==t.indexOf("https://")&&(t=(e="https://"+e).toLowerCase());let r=t.indexOf("//");r=t.indexOf("/",r+2),-1==r?t=(e+="/arcgis/rest/services").toLowerCase():r==t.length-1&&(t=(e+="arcgis/rest/services").toLowerCase());let n=t.indexOf("/arcgis",r);n==t.length-7?t=(e+="/rest/services").toLowerCase():n==t.length-8&&(t=(e+="rest/services").toLowerCase()),n=t.indexOf("/server",r),t.endsWith("/server")?t=(e+="/rest/services").toLowerCase():t.endsWith("/server/")&&(t=(e+="rest/services").toLowerCase());const i=t.indexOf("/rest/services",r),o=t.indexOf("/services",r),s=t.indexOf("/rest",r);return-1==i&&o>-1?t=(e=`${e.substring(0,o)}/rest/services${e.substring(o+9)}`).toLowerCase():-1==i&&s>-1&&(t=(e=`${e.substring(0,s)}/rest/services${e.substring(s+5)}`).toLowerCase()),t.indexOf("/rest/services"),e}const m=(e,t=!1)=>(e=c(e),/(http|https|ftp):\/\/?/.exec(e)||(e=`https://${e}`),!t&&"https:"!==location.protocol||!h(e)&&!p(e)||(e=e.replace("http:/","https:/")),e.indexOf("/dynamicLayer?")>-1?e.substring(0,e.indexOf("/dynamicLayer?")):e),y=(e,t=!1)=>{var r,n,o;if(!e)return{error:{code:"invalidUrl"}};if(b(e,t))return{error:{code:"httpWarning"}};const s=decodeURIComponent(e),a=s.replace(i.v,"").match(/((\.|\/)*(kml|kmz))/gi),c=s.replace(i.v,"").match(/((\/|\=)(wmts|wms|wfs))/gi),d=s.replace(i.v,"").match(/((\/|\=)(OGC|OGCFeatureServer))/gi),u=s.replace(i.v,"").match(/((\.|\/)*(rss))/gi),v=null===(r=s.replace(i.v,"").match(i.u))||void 0===r?void 0:r[1],p=s.replace(i.v,"").match(i.r),h=s.replace(i.v,"").match(/((\.|\/)*(csv))/gi),f=s.replace(i.v,"").match(/(\.|\/)((\$?{(z|level)})\/*(\$?{(x|col)})\/*(\$?{(y|row)}))/gi);let g=null;if(s.match(i.q))g="GeoJson";else if(!d||c||v)if(v&&!c)g=l.a[v];else if(p)g="Map Service";else if(c){const e="/"===(null==c?void 0:c[0].charAt(0))?"/":"=";g=null===(o=null===(n=null==c?void 0:c[0])||void 0===n?void 0:n.split(e)[1])||void 0===o?void 0:o.toUpperCase()}else a?g="KML":u?g="GeoRSS":h?g="CSV":f&&(g="Tile Layer");else g="OGCFeatureServer";return{result:g}},b=(e,t)=>!t&&e.includes("http://")}}]);