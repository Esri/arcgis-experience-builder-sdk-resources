/*! For license information please see 09d06f985f7ae70e24b9a723aa9687d3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[73023],{73023:(e,r,t)=>{t.r(r),t.d(r,{arcgis_new_item_pages_data_store_select_server_list:()=>c});var s=t(28384),i=t(72074),a=t(58892),n=t(54871),l=t(16665);t(41171),t(66716),t(76134),t(27010),t(62381),t(83397),t(83129),t(65508),t(24552),t(85142),t(72022),t(96729),t(58728),t(86739),t(31546),t(18869),t(46220),t(82463),t(48507),t(48333),t(86274);const c=class{constructor(e){(0,s.r)(this,e),this.newItemUpdatePage=(0,s.c)(this,"newItemUpdatePage",7),this.loading=!0,this.noValidServers=!0,this.serverTypes=[],this.serverStatusIcons={success:"check-circle-f",failure:"exclamation-mark-circle-f",error:"exclamation-mark-triangle-f",validating:"information"},this.selectedServers=[],this.serverList=[],this.allBoxesSelected=!1,this.error=null}async componentWillLoad(){this.i18n=n.u.i18n.serverSelection,this.dataStoreType=a.a.addDataStoreType,this.serverList=a.a.dataStoreSelectServerList||[],this.serverList=this.filterServers(!1,!1,!1,!1)}async componentDidLoad(){const e=await(0,i.c)(a.a,this.serverList,this.dataStoreType);this.serverList=[...e];const r=await(0,i.d)(this.serverList);this.serverList=[...r.servers],this.serverTypes=[...r.serverTypes],this.renderTable(),this.appendServerTypes(),this.loading=!1}filterServers(e,r,t,s){return(this.serverList||[]).filter((i=>{const a=(i.serverRole||"").toUpperCase(),n=["ARCGIS_NOTEBOOK_SERVER","ARCGIS_MISSION_SERVER","ARCGIS_VIDEO_SERVER"],c=i.serverFunction&&i.serverFunction.replace(/\s+/g,"").split(",")||[],o=["NOTEBOOKSERVER","WORKFLOWMANAGER","MISSIONSERVER","VIDEOSERVER"];let d="HOSTING_SERVER"===a;e&&-1===c.indexOf("GeoAnalytics")&&(n.push(a),d=!1),r&&-1===c.indexOf("KnowledgeServer")&&(n.push(a),d=!1),s&&(0,l.i)()&&(d=!0);let h=-1===n.indexOf(a);return t&&(h=!1),d||h&&(!c.length||c.some((function(e){return-1===o.indexOf(e.toUpperCase())})))}))}renderTable(){const e=this.dataStoreType,r="bdfs"===e,t="nosql"===e,s="nfsHostAndPath"===a.a.serverFolderPath&&"folder"===e,i=this.checkDatabaseClient();this.serverList=this.filterServers(r,t,i,s),s||["folder","fileshare"].includes(e)&&(this.serverList=this.filterServersByServerPath())}checkDatabaseClient(){const e=this.dataStoreType,r=a.a.publisherConnectionString;let t=!1;return"database"===e&&r&&r.split(";").forEach((function(e){e.indexOf("DBCLIENT")>-1&&["bigquery","snowflake","redshift"].indexOf(e.split("=")[1])>-1&&(t=!0)})),t}filterServersByServerPath(){const e=a.a.addDataStoreType,r=("folder"===e?a.a.newServerFolderPath||a.a.publisherFolderPath:a.a.publisherFileShareFolderPath)[0].indexOf("/")>-1?"Linux":"Windows",t="nfsHostAndPath"===a.a.serverFolderPath&&"folder"===e;return this.serverList.filter((e=>!!this.serverTypes.find((s=>(s.name===e.adminUrl||s.name===`${e.adminUrl}/admin`)&&(t?e.isHosted:s.type===r)))))}appendServerTypes(){const{serverList:e,i18n:r}=this;e.map((e=>{const t=e.serverFunction&&e.serverFunction.replace(/\s+/g,"").split(",")||[];let s="";"HOSTING_SERVER"===e.serverRole&&(s+=r.types.hostedSetting),t.indexOf("NotebookServer")>-1&&(s+=(s&&", ")+r.types.notebookServerSetting),t.indexOf("GeoAnalytics")>-1&&(s+=(s&&", ")+r.types.geoAnalyticsServerSetting),t.indexOf("RasterAnalytics")>-1&&(s+=(s&&", ")+r.types.rasterAnalysisSetting),t.indexOf("ImageHosting")>-1&&(s+=(s&&", ")+r.types.imageHostingSetting),t.indexOf("MissionServer")>-1&&(s+=(s&&", ")+r.types.missionServerSetting),e.serverType=s}))}convertStatusDisplayText(e){const r=this.i18n,t=e.serverStatus;return{success:r.status.success,failure:r.status.failure,error:r.status.error,validating:r.status.validating}[t]}checkValidServers(){this.noValidServers=!this.serverList.some((e=>"success"===e.serverStatus))}checkAllBoxes(){this.selectedServers=[],this.allBoxesSelected||this.serverList.forEach((e=>{this.selectedServers=[...this.selectedServers,e.id]})),this.allBoxesSelected=!this.allBoxesSelected}handleNext(){const e=this.selectedServers||[];0!==e.length?(a.a.dataStoreSelectedServers=e,this.newItemUpdatePage.emit("itemProperties")):this.error="noServerSelected"}render(){const{i18n:e,error:r,serverList:t,dataStoreType:i,loading:n,allBoxesSelected:l,noValidServers:c}=this;return(0,s.h)("div",null,(0,s.h)("arcgis-new-item-description",{header:"bdfs"===i&&["fileshare","cloud"].includes(a.a.bdfsType)?e.dataStoreServerSelect.bdfsHeading:e.dataStoreServerSelect.heading}),(0,s.h)("p",{class:"sub-heading"},e.dataStoreServerSelect.subHeading),n?(0,s.h)("calcite-loader",{label:"server-loader",text:e.loader.validating}):(0,s.h)(s.F,null,(0,s.h)("div",{class:"row-wrapper"},(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-checkbox",{disabled:c,checked:l,onCalciteCheckboxChange:()=>{this.checkAllBoxes()}}),e.list.title)),(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline"},e.list.status))),t.map((e=>(0,s.h)("div",{class:"row-wrapper row-divider"},(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline",class:"server-wrapper"},(0,s.h)("calcite-checkbox",{disabled:"success"!==e.serverStatus,value:e.id,onCalciteCheckboxChange:e=>{const r=e.target.value;-1===this.selectedServers.indexOf(r)?this.selectedServers=[...this.selectedServers,r]:this.selectedServers=this.selectedServers.filter((e=>e!==r))},checked:this.selectedServers.includes(e.id)}),e.url+(e.serverType&&` (${e.serverType})`))),(0,s.h)("div",{class:"half-row"},(0,s.h)("div",{class:"status-wrapper",title:e.errorMsg||e.serverStatus},(0,s.h)("calcite-icon",{class:{success:"success"===e.serverStatus,failure:"failure"===e.serverStatus,error:"error"===e.serverStatus,validating:"validating"===e.serverStatus},scale:"s",icon:this.serverStatusIcons[e.serverStatus]}),this.convertStatusDisplayText(e)))))),(0,s.h)("arcgis-new-item-alert",{heading:e.dataStoreServerSelect.noServerSelected.heading,description:e.dataStoreServerSelect.noServerSelected.description,active:null!==r&&!n,onAlertDismiss:()=>{this.error=null}})))}static get watchers(){return{serverList:["checkValidServers"]}}};c.style=".sub-heading {\n  color: var(--calcite-ui-text-3);\n  font-weight: 400;\n}\n\n.row-wrapper {\n  width: 100%;\n  padding-top: 0.75rem;\n  margin-top: 0.5rem;\n  margin-bottom: 0.5rem;\n  display: flex;\n}\n\n.row-divider {\n  box-shadow: 0 -1px 0 #eaeaea;\n}\n\n.title {\n  grid-gap: 0.5rem;\n  gap: 0.5rem;\n}\n\n.status-wrapper {\n  display: flex;\n  grid-gap: 0.5rem;\n  gap: 0.5rem;\n  line-height: 1rem;\n}\n\n.success {\n  --calcite-ui-icon-color: var(--calcite-ui-success);\n}\n\n.failure {\n  --calcite-ui-icon-color: var(--calcite-ui-danger);\n}\n\n.error {\n  --calcite-ui-icon-color: var(--calcite-ui-danger);\n}\n\n.validating {\n  --calcite-ui-icon-color: var(--calcite-ui-info);\n}\n\n.half-row {\n  width: 50%;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n}\n\n.server-wrapper {\n  &:hover {\n    cursor: pointer;\n  }\n}\n"}}]);