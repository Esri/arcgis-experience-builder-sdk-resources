/*! For license information please see 38511e5f73b159a61fc6a45adad48dfe.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[43863],{43863:(e,t,l)=>{l.r(t),l.d(t,{arcgis_new_item_pages_tile_layer_settings:()=>d});var i=l(28384),a=l(41171),s=l(76134),r=l(65508),n=l(83129),o=l(72796),c=l(58892),h=l(54871),u=l(99274);l(66716),l(62381),l(27010),l(24552),l(85142),l(72022),l(96729),l(58728),l(86739),l(31546),l(83397),l(18869),l(46220),l(82463),l(48507),l(48333),l(86274);const d=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.publishType="tiles",this.autoCreation=!0,this.basemapUrl="",this.featureLayerInfos=null,this.featureLayerLayers=null,this.serviceInfo=null,this.cacheOnDemandMinScale=u.T,this.calculatedScale={minScale:u.T,maxScale:u.e},this.curLods=[],this.ranges=[{level:0,label:"world"},{level:1,label:"continent"},{level:2,label:"countries"},{level:3,label:"countriesSmall"},{level:4,label:"states"},{level:5,label:"state"},{level:6,label:"counties"},{level:7,label:"county"},{level:8,label:"metropolitan"},{level:9,label:"cities"},{level:10,label:"city"},{level:11,label:"town"},{level:12,label:"neighborhood"},{level:13,label:"streets"},{level:14,label:"street"},{level:15,label:"buildings"},{level:16,label:"building"},{level:17,label:"small"},{level:18,label:"rooms"},{level:19,label:"room"}],this.tileLayerInfo=null,this.handleUrlInputError=e=>{const{error:t}=this.i18n;this.alertInfo={title:"invalidUrl"===e?this.invalidUrlString:t.urlErrorTitle,description:"invalidUrl"===e?void 0:t[e]}},this.getPublishTypeInfo=()=>{const{publishType:e}=this;switch(e){case"tiles":return"mapserver";case"scenes":return"sceneserver";case"features":return"featureserver";case"vectorTiles":return"vectortileserver";case"tiledImagery":case"dynamicImagery":return"imageserver";default:return e}},this.toggleAutoCreation=e=>{this.autoCreation=e.detail},this.handleBasemapChange=e=>{var t;const{tileLayerInfo:l,curLods:i}=this;this.basemapType=e;const a=e=>{e.length===i.length&&e.every(((e,t)=>{const l=i[t];return e.level===l.level&&e.resolution===l.resolution&&e.scale===l.scale&&e.label===l.label}))||(this.curLods=e)},s=null===(t=null==l?void 0:l.info)||void 0===t?void 0:t.lods;"standard"===e?a(u.g):s&&a(s)},this.fetchTileLayerInfo=async e=>{this.isProcessing=!0,this.alertInfo=null,this.tileLayerInfo=null;const{error:t,result:l}=await(0,o.b)(e,!1);return t?this.handleUrlInputError(t.code):l&&(this.tileLayerInfo={url:e,info:l}),this.isProcessing=!1,!t},this.onUrlInputBlur=async()=>{const{tileLayerInfo:e,basemapUrl:t}=this;if(!t)return this.tileLayerInfo=null,void(this.basemapUrl=null);(null==e?void 0:e.url)!==t&&this.fetchTileLayerInfo(t)},this.alertInfo=void 0,this.isProcessing=!1,this.showIncreaseScaleRangeWarning=!1,this.selectedItem=void 0,this.basemapType=void 0}async handleNext(){var e;if("3dTiles"===c.a.tileLayerPublishType)return;const{publishType:t,serviceInfo:l,autoCreation:i,cacheOnDemandMinScale:a,calculatedScale:r,tileLayerInfo:n,selectedItem:h,basemapType:u,basemapUrl:d,inputRef:p,handleUrlInputError:m,fetchTileLayerInfo:y}=this;if("custom"===u){if(!d)return m("invalidUrl"),void p.setFocus();if(!n&&!await y(d))return void p.setFocus()}const{publishContent:v}=(0,o.d)({id:h.id,title:h.title},{publishType:t,cacheOnDemand:"vectorTiles"!==t&&i,cacheOnDemandMinScale:a,tileInfo:null==n?void 0:n.info,scale:Object.assign({},r),layers:null===(e=c.a.tileLayerData)||void 0===e?void 0:e.layers},s.c.portal.isPortal);c.a.tileLayerPublishContent=v,c.a.tileAutoCreation=i,c.a.tileLayerBasemapType=u,c.a.tileLayerBasemapUrl=d,c.a.tileLayerPublishType=t,this.newItemUpdatePage.emit("itemProperties")}async componentWillLoad(){var e,t;if("3dTiles"===c.a.tileLayerPublishType)return;this.fromFeatureLayer=c.a.tileLayerFromFeatureLayer,this.publishType=c.a.tileLayerPublishType,this.i18n=h.u.i18n.tileLayerSettings,this.invalidUrlString=h.u.i18n.url.invalidUrl,this.autoCreation=null===(e=c.a.tileAutoCreation)||void 0===e||e,this.basemapUrl=c.a.tileLayerBasemapUrl,this.basemapType=null!==(t=c.a.tileLayerBasemapType)&&void 0!==t?t:"standard",c.a.tileLayerPublishContent=null;let l=c.a.item;l||(l=Object.assign(Object.assign({},c.a.existingItem),{id:c.a.id,title:c.a.sourceTitle,type:c.a.type,tags:r.i.tags}),c.a.item=l),c.a.type={vectorTiles:"Vector Tile Service",tiles:"Tile Layer",scenes:"Scene Service"}[c.a.tileLayerPublishType],r.i.title=l.title,this.selectedItem=l,(async()=>{var e;if("3dTiles"===c.a.tileLayerPublishType)return;this.isProcessing=!0;const t=l.url;let i=c.a.tileLayerLayers,r=c.a.tileLayerTables,h=c.a.tileLayerServiceInfo;if(!(s.c.portal.isPortal&&c.a.tileLayerFromFeatureLayer||i||r||h)){const e=await(0,n.g)(t,(0,a.g)(s.c.portal),!0);i=e.layers,r=e.tables,h=e.serviceInfo}this.serviceInfo=h,this.featureLayerInfos=[...i||[],...r||[]],this.featureLayerLayers=[...i||[]],await this.handleTileLayerScaleChange({minScale:u.T,maxScale:u.e}),"tiles"===this.publishType&&(0,o.h)(this.featureLayerLayers,null!==(e=s.c.config.tilesOnDemandEnabled)&&void 0!==e&&e),this.isProcessing=!1})()}async handleTileLayerScaleChange(e){var t,l;const{selectedItem:i,featureLayerInfos:a,tileLayerInfo:s,publishType:r}=this;if("tiles"!==r)return;const n=i.url,{cacheOnDemandMinScale:c,calculatedScale:h}=await(0,o.e)(e,null!==(l=null===(t=null==s?void 0:s.info)||void 0===t?void 0:t.lods)&&void 0!==l?l:u.a.lods,a,n);n&&(c&&(this.cacheOnDemandMinScale=c),this.calculatedScale=h)}render(){const{ranges:e,i18n:t,toggleAutoCreation:l,handleBasemapChange:a,onUrlInputBlur:r,isProcessing:n,autoCreation:o,basemapType:c,basemapUrl:h,alertInfo:d,publishType:p,fromFeatureLayer:m}=this;return(0,i.h)(i.H,null,(0,i.h)("arcgis-new-item-loader",{active:n}),(0,i.h)("div",{class:"title"},(0,i.h)("arcgis-new-item-description",{header:t.title,scale:"l"})),"tiles"===p&&(!s.c.portal.isPortal||!m)&&(0,i.h)("div",{class:"section"},(0,i.h)("arcgis-new-item-switch-card",{defaultChecked:o,header:t.autoCreateOption.title,description:t.autoCreateOption.description,onSwitchChange:l})),(0,i.h)("div",{class:"section"},(0,i.h)("p",{class:"section-title"},t.basemapOption),(0,i.h)("calcite-tile-select-group",{layout:"vertical"},u.f.map((e=>{const l="custom"===e?"customBasemap":"onlineBasemapOption";return(0,i.h)("calcite-tile-select",{key:e,checked:e===c,onCalciteTileSelectChange:()=>a(e),description:t[l].description,heading:t[l].title,name:e,"input-enabled":!0,"input-alignment":"start",type:"radio",value:e,width:"full",id:`${e}-input-option`})})))),"custom"===c&&(0,i.h)("div",{class:"section"},(0,i.h)("p",{class:"section-title"},t.customBasemapUrl),(0,i.h)("calcite-input",{scale:"m",disabled:n,value:h,onCalciteInputInput:e=>{this.basemapUrl=e.target.value,this.alertInfo=null},onBlur:r,placeholder:"https://webadaptorhost.domain.com/arcgis/rest/services/service/MapServer",ref:e=>this.inputRef=e})),(0,i.h)("arcgis-new-item-alert",{heading:null==d?void 0:d.title,description:null==d?void 0:d.description,active:!!d,onAlertDismiss:()=>this.alertInfo=null}))}get el(){return(0,i.d)(this)}};d.style=".title{margin-bottom:1.5rem}.section{margin-bottom:2rem}.section-title{font-size:1rem;font-weight:400;margin-bottom:0.25rem;margin-top:0}.description{margin-bottom:1rem;margin-top:0;font-size:0.75rem}"}}]);