/*! For license information please see 6d7888fa4d2191a9a23fefe6094825c8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[77257],{77257:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_feature_layer_from_scratch:()=>m});var r=a(28384),n=a(76134),i=a(26426),l=a(48680),s=a(65508),o=a(54871),c=a(46220),d=a(24552),y=a(71120),u=a(29162);a(27010),a(62381),a(85142),a(41171),a(66716),a(72022),a(96729),a(58728),a(86739),a(58892),a(31546),a(83397),a(18869);const m=class{constructor(e){(0,r.r)(this,e),this.newItemUpdatePage=(0,r.c)(this,"newItemUpdatePage",7),this.layerNameInputRefs={},this.nameFieldChangedByUser={},this.getDuplicateLayerNameId=()=>{const{layerInfos:e}=this,t={};for(let a=0;a<e.length;a++){const{name:r,id:n}=e[a];if(t[r])return n;t[r]=!0}return null},this.getDefaultName=e=>{const{layerInfos:t}=this,a=t.reduce(((t,a)=>{const r=(n=a.name,parseInt(n.split("_")[1]));var n;return!a.name.startsWith(e)||isNaN(r)?t:t<=r?r+1:t}),1);return`${e}_${a}`},this.addLayer=()=>{const{i18n:e,layerInfos:t,getDefaultName:a,layerNameInputRefs:r}=this,n=e.layer,s=(0,l.g)(),o=a(n);this.layerInfos=[...t,{id:s,type:"point",name:o}],(0,i.t)(100).then((()=>{var e;null===(e=r[s])||void 0===e||e.setFocus()}))},this.deleteLayer=(e,t)=>{const{layerNameInputRefs:a,layerInfos:r,nameFieldChangedByUser:n}=this;1!==r.length&&(this.layerInfos=function(e,t){const a=[...e];return a.splice(t,1),a}(r,t),delete a[e],delete n[e])},this.changeLayerName=(e,t)=>{const{layerInfos:a,nameFieldChangedByUser:r}=this,n=a[e];n.name=t,r[n.id]=!0},this.changeLayerType=(e,t,a)=>{const{layerInfos:r,nameFieldChangedByUser:n,i18n:i,getDefaultName:l}=this,s=Object.assign({},r[e]);n[s.id]||("table"===t&&"table"!==a?s.name=l(i.layer):"table"!==t&&"table"===a&&(s.name=l(i.table))),s.type=a,this.layerInfos=[...r.slice(0,e),s,...r.slice(e+1)]},this.setAlertMessage=e=>{this.alertInfo=this.i18n.error[e]},this.alertInfo=void 0,this.layerInfos=[],this.layerPreference={captureGPS:!1,enableZDefaults:!1,enableMDefaults:!1}}async componentWillLoad(){this.addCreateI18n=o.u.i18n,this.i18n=this.addCreateI18n.featureLayerFromScratch;const{layerPreference:e,newLayerInfos:t}=(0,d.a)();this.layerPreference=e,t.length<=0?this.addLayer():this.layerInfos=[...t]}async handleNext(){var e,t,a;const{layerInfos:r,layerNameInputRefs:i,setAlertMessage:l,getDuplicateLayerNameId:o,newItemUpdatePage:c,layerPreference:u}=this,{portal:m}=n.c,p=null===(e=r.find((e=>!e.name.trim())))||void 0===e?void 0:e.id;if(p)return(0,y.f)("Missing layer name"),null===(t=i[p])||void 0===t||t.setFocus(),void l("emptyName");const h=o();if(h)return(0,y.f)("Layer names must be unique"),null===(a=i[h])||void 0===a||a.setFocus(),void l("duplicateTitle");1===this.layerInfos.length&&(s.i.title=this.layerInfos[0].name),(0,d.b)(this.layerInfos,u,m),c.emit("itemProperties")}render(){const{i18n:e,alertInfo:t,addCreateI18n:a,addLayer:n,layerInfos:i,layerNameInputRefs:l,deleteLayer:s,layerPreference:o,changeLayerName:d,changeLayerType:m}=this;return(0,r.h)(r.H,null,(0,r.h)("arcgis-new-item-description",{header:e.header}),(0,r.h)("div",{class:"add-new-container"},(0,r.h)("div",{class:"layer-container"},i.map((({id:e,name:t,type:n},o)=>{const y=i[o];return(0,r.h)("li",{class:"info-card",key:e,value:e},(0,r.h)("calcite-input",{value:t,class:"layer-name-input",placeholder:a.featureLayer.placeholders[n],onCalciteInputInput:e=>{const t=e.target;d(o,t.value)},ref:t=>l[e]=t}),(0,r.h)("calcite-combobox",{label:a.featureLayer.type[y.type],class:"layer-type",selectionMode:"single",clearDisabled:!0,onCalciteComboboxChange:e=>{const t=e.target;m(o,y.type,t.selectedItems[0].value)}},c.f.filter((e=>"multipatch"!==e)).map((e=>(0,r.h)("calcite-combobox-item",{textLabel:a.featureLayer.type[e],icon:u.a[e],selected:y.type===e,value:e})))),i.length>1&&(0,r.h)("calcite-button",{appearance:"transparent",kind:"danger",scale:"m",href:"","icon-start":"trash",onClick:()=>s(e,o)}))}))),(0,r.h)("calcite-button",{appearance:"transparent",scale:"m","icon-start":"plus",class:"add-layer",onClick:n},e.add)),(0,r.h)("arcgis-new-item-layer-preference",{i18n:e,defaultPreference:o,onLayerPreferenceChange:e=>{const{layerPreference:t}=this,a=e.detail;!t.captureGPS&&a.captureGPS&&(0,y.e)("captureGPS"),!t.enableZDefaults&&a.enableZDefaults&&(0,y.e)("enableZDefaults"),!t.enableMDefaults&&a.enableMDefaults&&(0,y.e)("enableMDefaults"),this.layerPreference=e.detail}}),(0,r.h)("arcgis-new-item-alert",{heading:null==t?void 0:t.title,description:null==t?void 0:t.description,active:!!t,onAlertDismiss:()=>this.alertInfo=null}))}get el(){return(0,r.d)(this)}};m.style="p{margin-top:0;margin-bottom:0}button{cursor:pointer;transition-duration:200ms;border:none;box-shadow:none;background:transparent;line-height:16px}label{margin-bottom:0}.add-new-container{padding:1.5rem;padding-bottom:2.5rem;margin-top:1rem;margin-bottom:1.5rem;background-color:var(--calcite-ui-background)}.add-layer{margin-top:1rem;width:-moz-fit-content;width:fit-content}.info-card{--calcite-font-size--2:0.875rem;display:flex;align-items:center;flex-grow:1;border-style:solid;border-width:1px;background-color:var(--calcite-ui-foreground-1);border-color:var(--calcite-ui-border-1);padding:1rem}.info-card:not(:last-of-type){border-bottom-width:0}.info-card:first-child{border-top-left-radius:var(--calcite-border-radius);border-top-right-radius:var(--calcite-border-radius)}.info-card:last-child{border-bottom-right-radius:var(--calcite-border-radius);border-bottom-left-radius:var(--calcite-border-radius)}.layer-icon{-webkit-margin-end:1rem;margin-inline-end:1rem}.layer-name-input,.layer-type{flex-grow:1;flex-basis:100%;-webkit-margin-end:1rem;margin-inline-end:1rem}.layer-type:last-child{-webkit-margin-end:0;margin-inline-end:0}"},71120:(e,t,a)=>{a.d(t,{a:()=>u,b:()=>d,c:()=>y,e:()=>o,f:()=>m,i:()=>c});var r=a(76134),n=a(58892);const i="create feature layer",l="my content",s=e=>{switch(e){case"build":return"blank";case"existing":return"fs";case"template":return"template";case"link":return"url"}},o=e=>{const t=r.c.telemetry;null==t||t.stepWorkflow(i,"enable "+("captureGPS"===e?"gps":"enableZDefaults"===e?"z":"m"),{category:i,attribute:s(n.a.addFeatureLayerType),pageName:l})},c=e=>{const t=r.c.telemetry;null==t||t.stepWorkflow(i,`expand ${e} details`,{category:i,attribute:s(n.a.addFeatureLayerType),pageName:l})},d=()=>{const e=r.c.telemetry;null==e||e.stepWorkflow(i,"filter",{category:i,attribute:s(n.a.addFeatureLayerType),pageName:l})},y=e=>{const t=s(e),a=r.c.telemetry;null==a||a.stepWorkflow(i,"from option",{category:i,attribute:t,pageName:l})},u=()=>{const{addFeatureLayerType:e,serviceInfo:t}=n.a,a=t,o=r.c.telemetry;null==o||o.endWorkflow(i,{category:i,attribute:s(e),pageName:l,count:a.layers.length,number:a.tables.length})},m=e=>{var t;null===(t=r.c.telemetry)||void 0===t||t.logError({category:i,error:e})}},29162:(e,t,a)=>{a.d(t,{a:()=>r,e:()=>n,f:()=>i});const r={point:"point",line:"line",polygon:"polygon",multipatch:"cube",table:"table",multipoint:"layer-points"},n={esriGeometryPoint:"point",esriGeometryPolyline:"line",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"cube",esriGeometryMultipoint:"point",none:"table"},i={esriFieldTypeOID:"key",esriFieldTypeBoolean:"boolean",esriFieldTypeString:"string",esriFieldTypeSingle:"number",esriFieldTypeDouble:"number",esriFieldTypeInteger:"integer",esriFieldTypeSmallInteger:"integer",esriFieldTypeGlobalID:"key",esriFieldTypeDate:"date-time",esriFieldTypeBigInteger:"integer",esriFieldTypeDateOnly:"calendar",esriFieldTypeTimeOnly:"clock",esriFieldTypeTimestampOffset:"time-zone"}}}]);