/*! For license information please see 8012f0c70c1197f27775cbfebe87da72.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[14368],{14368:(e,t,i)=>{i.r(t),i.d(t,{arcgis_raster_multidimensional_variable_info:()=>a});var n=i(28384),o=i(66716),r=i(74746),s=i(81068);i(34077),i(72637),i(18869);const a=class{constructor(e){(0,n.r)(this,e),this.arcgisRasterMultidimensionalVariableInfoDismiss=(0,n.c)(this,"arcgisRasterMultidimensionalVariableInfoDismiss",7),this.variableInfo=void 0,this.popoverProps=void 0,this.showStatistics=!1,this.showDimensionSummary=!1,this.useTable=!0,this.keepActiveDimension=!0,this.strings=void 0,this.activeDimensionName=null,this.isOpen=!1}watchVariableInfo(e,t){if(this.keepActiveDimension&&this.dimensionEL&&t){const e=this.dimensionEL.querySelector("calcite-accordion-item[active]");if(e){const i=e.getAttribute("dimension-index"),n=t.dimensions[i];this.activeDimensionName=n.name}else this.activeDimensionName=null}else this.activeDimensionName=null}async componentWillLoad(){[this.intl]=await(0,o.l)(["esri/intl"]),this.messages=await this.intl.fetchMessageBundle("esri/core/t9n/Units")}componentDidLoad(){this.isOpen=!0}async setFocus(e){var t,i;"dismiss-button"!==e?null===(i=this.hostElement)||void 0===i||i.focus():null===(t=this.panelElement)||void 0===t||t.setFocus()}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}render(){const e=this.showStatistics&&this.renderStatistics(),t=this.renderDimensions(),i=(0,n.h)("calcite-accordion",{class:"info-section-container",selectionMode:"single",ref:e=>this.dimensionEL=e},e,t),{popoverProps:o,variableInfo:r}=this,a=`${o.refElement.getBoundingClientRect().width}px`,l=r.unit?`${r.name} (${r.unit})`:`${r.name}`,c=this.showDimensionSummary?r.dimensions.map((e=>`${e.name}: ${e.values.length}`)).join(", "):null,d=this.renderGeneralInfo(),m=(0,s.g)(this.hostElement);return(0,n.h)(n.H,{class:"js-app-flyout"},(0,n.h)("calcite-popover",{dir:m,placement:o.placement||"leading-start",open:this.isOpen,pointerDisabled:!0,referenceElement:o.refElement,offsetDistance:o.offsetDistance||0,offsetSkidding:o.offsetSkidding||0,triggerDisabled:!0,label:l,class:"popover",style:{width:a},ref:e=>this.popoverNode=e},(0,n.h)("calcite-panel",{ref:e=>this.panelElement=e,heading:l,description:c,class:{panel:!0,[s.C.rtl]:"rtl"===m},closable:!0,onCalcitePanelClose:()=>this.arcgisRasterMultidimensionalVariableInfoDismiss.emit()},d,i)))}renderGeneralInfo(){const e=this.strings.multidimensionalInfo,{unit:t,description:i}=this.variableInfo,n=!!this.variableInfo.colormap;return this.renderInfoSection([{name:e.description,description:i||e.none},{name:e.unit,description:t||e.none},{name:e.colormap,description:n?e.present:e.none}],null,"info-general")}renderInfoSection(e,t,i){return this.useTable?(0,n.h)("div",{class:i},(0,n.h)("table",{class:"table table-bordered"},t&&(0,n.h)("caption",null,t),e.map((({name:e,description:t})=>(0,n.h)("tr",null,(0,n.h)("td",null,e),(0,n.h)("td",null,t)))))):(0,n.h)("div",{class:`info-content ${null!=i?i:""}`},e.map((({name:e,description:t})=>(0,n.h)("calcite-label",{scale:"s"},e,(0,n.h)("div",{class:"info-block"},(0,n.h)("div",{class:"info-text"},t))))))}renderStatistics(){const{name:e,statistics:t}=this.variableInfo;if(!(null==t?void 0:t.length))return null;const i=this.strings.multidimensionalInfo,o=this._formatStats(t.map((({min:e})=>e))),r=this._formatStats(t.map((({max:e})=>e))),s=this._formatStats(t.map((({avg:e})=>e))),a=this._formatStats(t.map((({stddev:e})=>e)));return(0,n.h)("calcite-accordion-item",{"icon-position":"start",heading:i.statistics,key:`${e}-stats}`,class:"info-section"},this.renderInfoSection([{name:i.minimum,description:o},{name:i.maximum,description:r},{name:i.mean,description:s},{name:i.stddev,description:a}]))}renderDimensions(){const{multidimensionalInfo:e}=this.strings,{name:t,dimensions:i}=this.variableInfo;return i.map(((i,o)=>{const{name:s,values:a,interval:l,intervalUnit:c,hasRegularIntervals:d,extent:m}=i;let u="StdTime"===s?e.stdTimeDimension:"StdZ"===s?e.stdZDimension:e.generalDimension.replace("${dimensionName}",s);u+=` (${a.length})`;const h=this._formatUnit(c),f=l?`${l} (${d?e.regular:e.irregular})`:"",v=`${(0,r.f)(m[0],i,{intl:this.intl})} - ${(0,r.f)(m[1],i,{intl:this.intl})}`;return(0,n.h)("calcite-accordion-item",{"icon-position":"start",expanded:s===this.activeDimensionName,heading:u,"dimension-index":o,key:`${t}-${s}`,class:"info-section"},this.renderInfoSection([{name:e.interval,description:f},{name:e.intervalUnit,description:h},{name:e.extent,description:v}]))}))}_formatStats(e){return e.map((e=>this.intl.formatNumber(e))).join("; ")}_formatUnit(e){var t,i,n;if(e){const o=e.replace("esri","");e=o.toLowerCase(),e=null!==(n=null!==(t=this.strings.time[e])&&void 0!==t?t:null===(i=this.messages.units[e])||void 0===i?void 0:i.plural)&&void 0!==n?n:o}return null!=e?e:""}get hostElement(){return(0,n.d)(this)}static get watchers(){return{variableInfo:["watchVariableInfo"]}}};a.style=":host{display:flex;flex:1 1 auto}:host .accordion-item-content,:host .accordion-item-header{--calcite-accordion-item-border:transparent}.info-section-container{border:none;--calcite-ui-border-2:transparent}.info-section{padding-bottom:0.5rem;overflow-y:auto;--calcite-accordion-item-border:transparent;background-color:white}.info-general{padding:10px 15px;background-color:white}.info-content{margin:10px 10px}.info-content .info-block{color:var(--calcite-ui-text-3, gray);max-height:4rem;min-height:1rem;overflow:hidden}.info-content .info-block .info-text{width:100%;word-break:normal;text-overflow:ellipsis;font-size:var(--calcite-font-size--2)}.popover{z-index:100}.table{width:100%;background-color:#ffffff;border-collapse:collapse;border-spacing:0;border:1px solid var(--calcite-ui-border-1);text-align:left;overflow:auto;font-size:var(--calcite-font-size--2);color:var(--calcite-ui-text-1);line-height:1.5rem}.table caption{text-align:left;margin-top:5px}.table td{display:table-cell;vertical-align:inherit}.table td:first-child{width:30%}.table th,.table td{font-weight:300;padding:2px 5px;text-align:left}.table tr:nth-child(odd){background-color:#f8f8f8}.table.table-bordered tr{border-bottom:1px solid var(--calcite-ui-border-1)}.table.table-bordered tr:last-child{border-bottom:none}.table.table-bordered tr td:first-child{border-right:1px solid var(--calcite-ui-border-1)}.table.table-borderless{border:none}.arcgis--rtl .table.table-bordered tr td:first-child{border-left:1px solid var(--calcite-ui-border-1);border-right:none}"},74746:(e,t,i)=>{i.d(t,{a:()=>m,b:()=>c,c:()=>d,f:()=>a,g:()=>l,i:()=>u,m:()=>o,u:()=>h});var n=i(34077);const o=10.9;function r(e,t){const i=new Date(e),{useFriendlyISOFormat:n,intl:o,format:r}=t;if(n&&o)return o.formatDate(i,Object.assign(Object.assign({},o.convertDateFormatToIntlOptions(null!=r?r:"short-date-long-time")),{timeZone:"UTC"}));let s=new Date(e).toISOString();return s=s.slice(0,s.indexOf("."))+"Z",s}function s(e,t,i="long"){const n=new Date(2022,9,10);return n.setMonth(e-1),t.formatDate(n,{month:i})}function a(e,t,i={}){var n,o,a,l;if(null==e)return"";const{intl:c,useRecurringTimeLabel:d}=i;if(d&&c&&!Array.isArray(e)){const i=null===(n=t.intervalUnit)||void 0===n?void 0:n.toLowerCase().trim(),o=function(e){return"StdTime"===e.name&&!!e.recurring}(t)&&("months"===i||"quarters"===i);if(o)return"months"===i?s(e,c):function(e,t){return`${s(3*(e-1)+1,t,"short")} - ${s(3*e,t,"short")}`}(e,c)}const m=null===(o=t.values)||void 0===o?void 0:o[t.values.length-1];if(i.useStartOrEndForRangedValue&&Array.isArray(e)&&2===e.length&&Array.isArray(m)){const t=e.join("-")===m.join("-");e=t?e[1]:e[0]}if(!u(t))return Array.isArray(e)?e.map((e=>{var t;return null!==(t=null==c?void 0:c.formatNumber(e))&&void 0!==t?t:String(e)})).join(" - "):null!==(a=null==c?void 0:c.formatNumber(e))&&void 0!==a?a:String(e);if(i.useFriendlyISOFormat&&!i.format){let e=null===(l=t.intervalUnit)||void 0===l?void 0:l.toLowerCase().trim(),{interval:n,extent:o}=t;if("months"===e?n>11&&(e="year"):"days"===e?n>364?e="year":n>27&&(e="months"):"hours"===e&&(e="days"),!["years","months","days"].includes(e)&&(null==o?void 0:o.length)){const i=(o[1]-o[0])/t.values.length,n=864e5;i>=365*n?e="years":i>=28*n&&(e="months")}const r="years"===e?"year":"months"===e?"short-month-year":"short-date";i=Object.assign({format:r},i)}return Array.isArray(e)?e.map((e=>r(e,i))).join(" - "):r(e,i)}function l(e,t){var i;const o=null===(i=null==t?void 0:t.dimensions)||void 0===i?void 0:i.find((({name:t})=>t===e.name));if(!(null==o?void 0:o.extent))return e;const r=[...o.extent],s=e.values.filter((e=>Array.isArray(e)?(0,n.i)(r[1])&&r[0]!==r[1]?e[0]>=r[0]&&e[0]<=r[1]&&e[1]>=r[0]&&e[1]<=r[1]:e[0]===r[0]:e>=r[0]&&e<=r[1]));if(0===s.length){const t=e.values[e.values.length-1];Array.isArray(t)&&t[1]===r[0]&&s.push(t)}return Object.assign(Object.assign({},e),{extent:r,values:s})}function c(e){var t;const{values:i,extent:n,name:o}=e;let r=null!==(t=null==i?void 0:i[0])&&void 0!==t?t:n[0];return"stdz"===o.toLowerCase()&&!e.hasRanges&&Math.abs(n[1])<=Math.abs(n[0])&&(r=(null==i?void 0:i.length)?i[i.length-1]:n[1]),r}function d(e){var t,i;return"imagery-tile"===e.type?e.multidimensionalDefinition:null===(i=null!==(t=e.mosaicRule)&&void 0!==t?t:e._defaultServiceMosaicRule)||void 0===i?void 0:i.multidimensionalDefinition}async function m(e,t){var i,n;if("imagery-tile"===e.type)return e.rasterInfo.multidimensionalInfo;const{rasterFunction:r,version:s}=e;return t||s<=o||!r||"none"===(null===(i=r.functionName)||void 0===i?void 0:i.toLowerCase())?e.serviceRasterInfo.multidimensionalInfo:(null!==(n=await e.generateRasterInfo(e.rasterFunction))&&void 0!==n?n:e.serviceRasterInfo).multidimensionalInfo}function u(e,t=!1){return"StdTime"===e.name&&(t||!e.recurring)}function h(e,t,i){t=l(t,i);const n=a(e.values[0],t);if(!t.values.some((e=>n===a(e,t)))){const i=c(t);e.values=[i]}}}}]);