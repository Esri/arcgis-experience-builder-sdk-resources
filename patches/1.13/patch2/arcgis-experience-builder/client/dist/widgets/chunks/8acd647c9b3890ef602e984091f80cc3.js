"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[41570],{32226:(e,r,t)=>{t.d(r,{a:()=>n});var a=t(47817),i=(t(58574),t(99884));const n=e=>{let r=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf("Tilemap")>-1?new i.j({layer:this}):null}};return(0,a.Z)([(0,a._)({json:{read:{source:"copyrightText"}}})],r.prototype,"copyright",void 0),(0,a.Z)([(0,a._)()],r.prototype,"minScale",void 0),(0,a.Z)([(0,a.ab)("service","minScale")],r.prototype,"readMinScale",null),(0,a.Z)([(0,a._)()],r.prototype,"maxScale",void 0),(0,a.Z)([(0,a.ab)("service","maxScale")],r.prototype,"readMaxScale",null),(0,a.Z)([(0,a._)({type:a.O})],r.prototype,"spatialReference",void 0),(0,a.Z)([(0,a._)({readOnly:!0})],r.prototype,"supportsBlankTile",null),(0,a.Z)([(0,a._)(i.r)],r.prototype,"tileInfo",void 0),(0,a.Z)([(0,a._)()],r.prototype,"tilemapCache",void 0),(0,a.Z)([(0,a.ab)("service","tilemapCache",["capabilities"])],r.prototype,"readTilemapCache",null),(0,a.Z)([(0,a._)()],r.prototype,"version",void 0),r=(0,a.Z)([(0,a.a0)("esri.layers.mixins.ArcGISCachedService")],r),r}},41570:(e,r,t)=>{t.r(r),t.d(r,{default:()=>b});var a=t(47817),i=(t(58574),t(7390)),n=t(64646),s=t(3467),l=t(50542),o=t(52067),c=t(64033),u=t(19904),p=t(72124),d=t(45914),h=t(51568),f=t(32226),v=t(94845);t(68700),t(18608),t(29156),t(69764),t(72304),t(99884),t(18847),t(89684),t(77639),t(18204),t(32644),t(88191),t(37085),t(44386),t(3271),t(23110),t(19026),t(94474),t(33102),t(22649),t(88659),t(76791),t(62268),t(23723);const y=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let m=class extends((0,o.t)((0,v.h)((0,d.s)((0,p.o)((0,s.l)((0,u.u)((0,f.a)((0,v.y)((0,l.p)((0,i.l)((0,h.a)((0,c.e)(i.b))))))))))))){constructor(...e){super(...e),this.listMode="show",this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null}normalizeCtorArgs(e,r){return"string"==typeof e?{url:e,...r}:e}load(e){const r=(0,a.H)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then((()=>this._fetchService(r)),(()=>this._fetchService(r)))),Promise.resolve(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&a.O.fromJSON(e)}writeSublayers(e,r,t,a){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),n=[],s={writeSublayerStructure:!1,...a};i.forEach((e=>{const r=e.write({},s);n.push(r)})),n.some((e=>Object.keys(e).length>1))&&(r.layers=n)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>(0,a.j)(e).path)):null}fetchTile(e,r,t,i={}){const{signal:n,timestamp:s}=i,l=this.getTileUrl(e,r,t),o={responseType:"image",signal:n};return null!=s&&(o.query={_ts:i.timestamp}),(0,a.U)(l,o).then((e=>e.data))}getTileUrl(e,r,t){const i=!this.tilemapCache&&this.supportsBlankTile,n=(0,a.aA)({...this.parsedUrl.query,blankTile:!i&&null,...this.customParameters}),s=this.tileServers;return`${s&&s.length?s[r%s.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${n?"?"+n:""}`}_fetchService(e){return new Promise(((r,t)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new a.s("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void r({data:this.sourceJSON})}if(!this.parsedUrl)throw new a.s("tile-layer:undefined-url","layer's url is not defined");const i=(0,n.d)(this.parsedUrl.path);if((0,a.H)(i)&&"ImageServer"===i.serverType)throw new a.s("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");(0,a.U)(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters},responseType:"json",signal:e}).then(r,t)})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=r.data,this.read(r.data,{origin:"service",url:this.parsedUrl}),10.1===this.version&&!(0,n.w)(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,r){if(!(0,n.p)(e))return Promise.reject();const t=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return(0,a.U)(t,{query:{f:"json",...this.customParameters},responseType:"json",signal:r}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new a.s("tile-layer:version-not-available")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,i=y.length;t<i;t++)if(r=y[t],r.toLowerCase().indexOf(e)>-1)return(0,a.a9)("//static.arcgis.com/attribution/"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),t=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return r||t?[e,e.replace(r?/server\.arcgisonline/i:/services\.arcgisonline/i,r?"services.arcgisonline":"server.arcgisonline")]:[]}};(0,a.Z)([(0,a._)({readOnly:!0})],m.prototype,"attributionDataUrl",null),(0,a.Z)([(0,a._)({type:["show","hide","hide-children"]})],m.prototype,"listMode",void 0),(0,a.Z)([(0,a._)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],m.prototype,"isReference",void 0),(0,a.Z)([(0,a._)({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],m.prototype,"operationalLayerType",void 0),(0,a.Z)([(0,a._)({type:Boolean})],m.prototype,"resampling",void 0),(0,a.Z)([(0,a._)()],m.prototype,"sourceJSON",void 0),(0,a.Z)([(0,a._)({type:a.O})],m.prototype,"spatialReference",void 0),(0,a.Z)([(0,a.ab)("spatialReference",["spatialReference","tileInfo"])],m.prototype,"readSpatialReference",null),(0,a.Z)([(0,a._)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],m.prototype,"path",void 0),(0,a.Z)([(0,a._)({readOnly:!0})],m.prototype,"sublayers",void 0),(0,a.Z)([(0,a.aj)("sublayers",{layers:{type:[v.G]}})],m.prototype,"writeSublayers",null),(0,a.Z)([(0,a._)({json:{read:!1,write:!1}})],m.prototype,"popupEnabled",void 0),(0,a.Z)([(0,a._)()],m.prototype,"tileServers",null),(0,a.Z)([(0,a.$)("tileServers")],m.prototype,"castTileServers",null),(0,a.Z)([(0,a._)({readOnly:!0,json:{read:!1}})],m.prototype,"type",void 0),(0,a.Z)([(0,a._)(s.f)],m.prototype,"url",void 0),m=(0,a.Z)([(0,a.a0)("esri.layers.TileLayer")],m);const b=m},43961:(e,r,t)=>{function a(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function i(e){return null!=e&&!isNaN(e)&&isFinite(e)}function n(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function s(e,r){const t=r||n(e),a=e.valueUnit||"unknown";return"unknown"===t?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===a?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}t.d(r,{e:()=>i,i:()=>n,l:()=>s,n:()=>a})},23110:(e,r,t)=>{t.d(r,{N:()=>b,U:()=>y,V:()=>h,b:()=>d,d:()=>u,p:()=>c,v:()=>p}),t(58574);var a=t(47817),i=t(29156),n=t(43961);const s=a.S.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),l=new a.an,o=Math.PI,c=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function u(e,r,t){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(!i)return;if("esri.renderers.visualVariables.ColorVariable"!==i.declaredClass)return void s.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n="number"==typeof r,l=n?null:r,o=l&&l.attributes;let c=n?r:null;const u=i.field,{ipData:p,hasExpression:d}=i.cache;let h=i.cache.compiledFunc;if(!u&&!d){const e=i.stops;return e&&e[0]&&e[0].color}if("number"!=typeof c)if(d){if(!(0,a.H)(t)||!(0,a.H)(t.arcade))return void s.error("Use of arcade expressions requires an arcade context");const e={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},r=t.arcade.arcadeUtils,n=r.getViewInfo(e),o=r.createExecContext(l,n);if(!h){const e=r.createSyntaxTree(i.valueExpression);h=r.createFunction(e),i.cache.compiledFunc=h}c=r.executeFunction(h,o)}else o&&(c=o[u]);const f=i.normalizationField,v=o?parseFloat(o[f]):void 0;if(null!=c&&(!f||n||!isNaN(v)&&0!==v)){isNaN(v)||n||(c/=v);const e=m(c,p);if(e){const r=e[0],n=e[1],s=r===n?i.stops[r].color:a.bu.blendColors(i.stops[r].color,i.stops[n].color,e[2],(0,a.H)(t)?t.color:void 0);return new a.bu(s)}}}function p(e,r,t){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(!i)return;if("esri.renderers.visualVariables.OpacityVariable"!==i.declaredClass)return void s.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n="number"==typeof r,l=n?null:r,o=l&&l.attributes;let c=n?r:null;const u=i.field,{ipData:p,hasExpression:d}=i.cache;let h=i.cache.compiledFunc;if(!u&&!d){const e=i.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof c)if(d){if((0,a.t)(t)||(0,a.t)(t.arcade))return void s.error("Use of arcade expressions requires an arcade context");const e={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},r=t.arcade.arcadeUtils,n=r.getViewInfo(e),o=r.createExecContext(l,n);if(!h){const e=r.createSyntaxTree(i.valueExpression);h=r.createFunction(e),i.cache.compiledFunc=h}c=r.executeFunction(h,o)}else o&&(c=o[u]);const f=i.normalizationField,v=o?parseFloat(o[f]):void 0;if(null!=c&&(!f||n||!isNaN(v)&&0!==v)){isNaN(v)||n||(c/=v);const e=m(c,p);if(e){const r=e[0],t=e[1];if(r===t)return i.stops[r].opacity;{const a=i.stops[r].opacity;return a+(i.stops[t].opacity-a)*e[2]}}}}function d(e,r,t){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(!i)return;if("esri.renderers.visualVariables.RotationVariable"!==i.declaredClass)return void s.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=i.axis||"heading",l="heading"===n&&"arithmetic"===i.rotationType?90:0,o="heading"===n&&"arithmetic"===i.rotationType?-1:1,c="number"==typeof r?null:r,u=c&&c.attributes,p=i.field,{hasExpression:d}=i.cache;let h=i.cache.compiledFunc,f=0;if(!p&&!d)return f;if(d){if((0,a.t)(t)||(0,a.t)(t.arcade))return void s.error("Use of arcade expressions requires an arcade context");const e={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},r=t.arcade.arcadeUtils,n=r.getViewInfo(e),l=r.createExecContext(c,n);if(!h){const e=r.createSyntaxTree(i.valueExpression);h=r.createFunction(e),i.cache.compiledFunc=h}f=r.executeFunction(h,l)}else u&&(f=u[p]||0);return f="number"!=typeof f||isNaN(f)?null:l+o*f,f}function h(e,r,t){const l="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(!l)return;if("esri.renderers.visualVariables.SizeVariable"!==l.declaredClass)return void s.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const c=function(e,r,t,n,s){switch(r.transformationType){case"additive":return function(e,r,t,a){return e+(f(r.minSize,t,a)||r.minDataValue)}(e,r,t,n);case"constant":return function(e,r,t){const a=e.stops;let i=a&&a.length&&a[0].size;return null==i&&(i=e.minSize),f(i,r,t)}(r,t,n);case"clamped-linear":return function(e,r,t,i){const n=(e-r.minDataValue)/(r.maxDataValue-r.minDataValue),s=f(r.minSize,t,i),l=f(r.maxSize,t,i),c=(0,a.H)(i)?i.shape:void 0;if(e<=r.minDataValue)return s;if(e>=r.maxDataValue)return l;if("area"===r.scaleBy&&c){const e="circle"===c,r=e?o*(s/2)**2:s*s,t=r+n*((e?o*(l/2)**2:l*l)-r);return e?2*Math.sqrt(t/o):Math.sqrt(t)}return s+n*(l-s)}(e,r,t,n);case"proportional":return function(e,r,t,i){const n=(0,a.H)(i)?i.shape:void 0,s=e/r.minDataValue,l=f(r.minSize,t,i),o=f(r.maxSize,t,i);let c=null;return c="circle"===n?2*Math.sqrt(s*(l/2)**2):"square"===n||"diamond"===n||"image"===n?Math.sqrt(s*l**2):s*l,v(c,l,o)}(e,r,t,n);case"stops":return function(e,r,t,a,i){const[n,s,l]=m(e,i);if(n===s)return f(r.stops[n].size,t,a);{const e=f(r.stops[n].size,t,a);return e+(f(r.stops[s].size,t,a)-e)*l}}(e,r,t,n,s);case"real-world-size":return function(e,r,t,n){const s=((0,a.H)(n)&&n.resolution?n.resolution:1)*i.m[r.valueUnit],l=f(r.minSize,t,n),c=f(r.maxSize,t,n),{valueRepresentation:u}=r;let p=null;return p="area"===u?2*Math.sqrt(e/o)/s:"radius"===u||"distance"===u?2*e/s:e/s,v(p,l,c)}(e,r,t,n);case"identity":return e;case"unknown":return null}}(function(e,r,t){const i="number"==typeof r,l=i?null:r,o=l&&l.attributes;let c=i?r:null;const{isScaleDriven:u}=e.cache;let p=e.cache.compiledFunc;if(u){const r=(0,a.H)(t)?t.scale:void 0,i=(0,a.H)(t)?t.view:void 0;c=null==r||"3d"===i?function(e){let r=null,t=null;const a=e.stops;return a?(r=a[0].value,t=a[a.length-1].value):(r=e.minDataValue||0,t=e.maxDataValue||0),(r+t)/2}(e):r}else if(!i)switch(e.inputValueType){case"expression":{if((0,a.t)(t)||(0,a.t)(t.arcade))return void s.error("Use of arcade expressions requires an arcade context");const r={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},i=t.arcade.arcadeUtils,n=i.getViewInfo(r),o=i.createExecContext(l,n);if(!p){const r=i.createSyntaxTree(e.valueExpression);p=i.createFunction(r),e.cache.compiledFunc=p}c=i.executeFunction(p,o);break}case"field":o&&(c=o[e.field]);break;case"unknown":c=null}if(!(0,n.e)(c))return null;if(i||!e.normalizationField)return c;const d=o?parseFloat(o[e.normalizationField]):null;return(0,n.e)(d)&&0!==d?c/d:null}(l,r,t),l,r,t,l.cache.ipData);return null==c||isNaN(c)?0:c}function f(e,r,t){return null==e?null:(0,n.n)(e)?h(e,r,t):(0,n.e)(e)?e:null}function v(e,r,t){return(0,n.e)(t)&&e>t?t:(0,n.e)(r)&&e<r?r:e}function y(e,r,t){const{isScaleDriven:a}=e.cache;if(!(a&&"3d"===t||r))return null;const i={scale:r,view:t};let n=f(e.minSize,l,i),s=f(e.maxSize,l,i);if(null!=n||null!=s){if(n>s){const e=s;s=n,n=e}return{minSize:n,maxSize:s}}}function m(e,r){if(!r)return;let t=0,a=r.length-1;return r.some(((r,i)=>e<r?(a=i,!0):(t=i,!1))),[t,a,(e-r[t])/(r[a]-r[t])]}function b(e,r,t){const a=["proportional","proportional","proportional"];for(const i of e){const e=i.useSymbolValue?"symbol-value":h(i,r,t);switch(i.axis){case"width":a[0]=e;break;case"depth":a[1]=e;break;case"height":a[2]=e;break;case"width-and-depth":a[0]=e,a[1]=e;break;case"all":case void 0:case null:a[0]=e,a[1]=e,a[2]=e}}return a}}}]);