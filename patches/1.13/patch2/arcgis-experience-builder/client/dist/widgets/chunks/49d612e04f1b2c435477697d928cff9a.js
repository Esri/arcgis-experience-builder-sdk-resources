"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[3271],{3271:(e,t,s)=>{s.r(t),s.d(t,{a:()=>a,g:()=>b,i:()=>l,s:()=>S,t:()=>o});var n=s(47817),r=s(58574);function o(e,t,s,r){const o=function(e,t,s){if(!e)return null;if(s&&"web-scene"===s.origin&&!(e instanceof n.A)&&!(e instanceof n.b)){const r="cim"!==e.type?function(e,t=!1,s=!1,r=!0){if(!e)return{symbol:null};let o;if((0,n.c)(e)||e instanceof n.b)o=e.clone();else if("cim"===e.type)o=n.L.fromCIMSymbol(e);else if(e instanceof n.d)o=n.u.fromSimpleLineSymbol(e);else if(e instanceof n.y)o=n.L.fromSimpleMarkerSymbol(e);else if(e instanceof n.n)o=n.L.fromPictureMarkerSymbol(e);else if(e instanceof n.a)o=n.h.fromSimpleFillSymbol(e);else{if(!(e instanceof n.e))return{error:new n.s("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};o=r?n.f.fromTextSymbol(e):n.L.fromTextSymbol(e)}if(t&&(o.id=e.id),s&&(0,n.c)(o))for(let e=0;e<o.symbolLayers.length;++e)o.symbolLayers.getItemAt(e)._ignoreDrivers=!0;return{symbol:o}}(e):{symbol:null,error:new n.s("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:e})};return r.symbol?r.symbol.write(t,s):(s.messages&&s.messages.push(new n.s("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:s,error:r.error})),null)}return s&&"web-map"===s.origin&&"web-style"===e.type?(s.messages&&s.messages.push(new n.s("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:e,context:s})),null):e.write(t,s)}(e,{},r);o&&(t[s]=o)}function l(e,t){return(0,n.k)(e,null,t)}function a(e,t){return e&&(t=t||r.e.location.hostname)?null!=t.match(i)||null!=t.match(c)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(m)||null!=t.match(y)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}const i=/^devext.arcgis.com$/,m=/^qaext.arcgis.com$/,c=/^[\w-]*\.mapsdevext.arcgis.com$/,y=/^[\w-]*\.mapsqa.arcgis.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,i,m,/^jsapps.esri.com$/,c,y],f={};function b(e,t,s){return e.styleUrl?function(e,t){return w(e,t).then((t=>({data:t.data,baseUrl:(0,n.g)(e),styleUrl:e})))}(e.styleUrl,s):e.styleName?function(e,t,s){const r=t.portal||n.w.getDefault();let o;const l=`${r.url} - ${r.user&&r.user.username} - ${e}`;return f[l]||(f[l]=function(e,t,s){return t.load(s).then((()=>{const r=new n.i({disableExtraQuery:!0,query:`owner:${h} AND type:${g} AND typekeywords:"${e}"`});return t.queryItems(r,s)})).then((({results:t})=>{let r=null;const o=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t)if(e.typeKeywords.some((e=>e.toLowerCase()===o))&&e.type===g&&e.owner===h){r=e;break}if(!r)throw new n.s("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return r.load(s)}))}(e,r,s).then((e=>(o=e,e.fetchData()))).then((t=>({data:t,baseUrl:o.itemUrl,styleName:e})))),f[l]}(e.styleName,t,s):Promise.reject(new n.s("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function p(e,t,s,o,i){const m=e.data,c={portal:s.portal,url:(0,n.j)(e.baseUrl),origin:"portal-item"},y=m.items.find((e=>e.name===t));if(!y){const e=`The symbol name '${t}' could not be found`;return Promise.reject(new n.s("symbolstyleutils:symbol-name-not-found",e,{symbolName:t}))}let f=(0,n.l)(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!(0,r.t)("enable-feature:force-wosr"))for(const t of e.formatInfos)if("gltf"===t.type)return t.href;return e.webRef}(y,o),c),b=y.thumbnail&&y.thumbnail.href;const p=y.thumbnail&&y.thumbnail.imageData;var h;h=h||r.e.location.hostname,u.some((e=>{var t;return null!=(null==(t=h)?void 0:t.match(e))}))&&(f=a(f),b=a(b));const g={portal:s.portal,url:(0,n.j)((0,n.g)(f)),origin:"portal-item"};return w(f,i).then((r=>{const a=l("cimRef"===o?d(r.data):r.data,g);if(a&&(0,n.c)(a)){if(b){const e=(0,n.l)(b,c);a.thumbnail=new n.m({url:e})}else p&&(a.thumbnail=new n.m({url:`data:image/png;base64,${p}`}));e.styleUrl?a.styleOrigin=new n.p({portal:s.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(a.styleOrigin=new n.p({portal:s.portal,styleName:e.styleName,name:t}))}return a}))}function d(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function w(e,t){const s={responseType:"json",query:{f:"json"},...t};return(0,n.U)((0,n.z)(e),s)}const h="esri_en",g="Style",S=Object.freeze({__proto__:null,fetchStyle:b,fetchSymbolFromStyle:p,resolveWebStyleSymbol:function(e,t,s,r){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,s){const r="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json".replace(/\{SymbolName\}/gi,e.name);return w(r,s).then((e=>l(d(e.data),{portal:t.portal,url:(0,n.j)((0,n.g)(r)),origin:"portal-item"})))}(e,t,r):b(e,t,r).then((n=>p(n,e.name,t,s,r))):Promise.reject(new n.s("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))},styleNameFromItem:function(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}})}}]);