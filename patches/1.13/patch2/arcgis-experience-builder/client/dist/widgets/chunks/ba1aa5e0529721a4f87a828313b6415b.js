/*! For license information please see ba1aa5e0529721a4f87a828313b6415b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[552],{552:(e,i,t)=>{t.r(i),t.d(i,{arcgis_new_item_pages_data_upload:()=>h});var s=t(28384),a=t(76134),r=t(48333),n=t(65508),l=t(83247),o=t(58892),d=t(54871),c=t(51510);t(27010),t(31546),t(83129),t(62381),t(24552),t(85142),t(41171),t(66716),t(72022),t(96729),t(58728),t(86739),t(83397),t(18869),t(46220),t(82463),t(48507),t(86274),t(56482),t(99274),t(61099),t(59004),t(88009);const h=class{constructor(e){(0,s.r)(this,e),this.newItemUpdatePage=(0,s.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,s.c)(this,"workflowComplete",7),this.allowedExtensions=null,this.loading=!1,this.loaderMessage=void 0,this.loaderType="indeterminate",this.error=void 0}componentWillLoad(){const{existingItem:e,fileName:i}=o.a;this.i18n=d.u.i18n.appendUpload,this.item=e,this.header="Vector Tile Service"===e.type?this.i18n.editStyle:this.i18n.sameFileNameDescription.replace("${fileName}",i),"Vector Tile Service"===e.type&&(this.allowedExtensions=["json"])}async fileSelectHandler(e){var i;this.sourceName=(null===(i=o.a.existingItem.sourceData)||void 0===i?void 0:i.name)||o.a.existingItem.name;const t=e.detail.file,s=o.a.existingItem.type,{title:a,fileName:l,extension:d}=(0,r.s)(t);if("Vector Tile Service"===s){if("json"!==d)return void this.handleError({code:"invalidExtension"})}else if(l!==this.sourceName)return void this.handleError({code:"useSameFileName"});n.i.title=a,o.a.file=t,o.a.fileName=l,o.a.newItemMode="file",o.a.extension=d;const h=(0,c.f)(d);if(1===h.length){const e=h[0].type;o.a.type=e}"Layer Package"===s?this.newItemUpdatePage.emit("appendSelectUpdate"):"Vector Tile Service"===s?this.handleUpdateStyle():this.handleUpdate()}async handleUpdate(){this.loading=!0,this.loaderMessage=d.u.i18n.append.appendLoadingMessages.updating;const e=await(0,l.b)(o.a.existingItem,this.item.itemOwner.userContentUrl,{file:o.a.file,overwrite:!0,keepDescription:!0});e.success?this.workflowComplete.emit({success:e.success}):this.handleError({code:"unhandledError"})}async handleUpdateStyle(){this.loading=!0,this.loaderMessage=d.u.i18n.append.appendLoadingMessages.updating;const{result:e,error:i}=await(0,l.c)(o.a.existingItem,this.item.itemOwner.userContentUrl,{file:o.a.file});e.success&&this.workflowComplete.emit({success:e.success}),i&&this.handleError({code:i.code})}async handleError(e){let i=this.i18n.errors.errorWhileUpload;switch(this.loading=!1,e.code){case"invalidExtension":i=this.i18n.errors.invalidStyleFileExtension;case"useSameFileName":i=this.i18n.errors.sameFileName.replace("${x}",this.sourceName);break;case"unhandledError":i=this.i18n.errors.errorUpdate}this.error={title:d.u.i18n.error,description:i}}render(){const{header:e,loaderType:i,loading:t,loaderMessage:r,error:n,allowedExtensions:l}=this,{portal:o,config:d,user:c}=a.c;return(0,s.h)(s.H,null,(0,s.h)("arcgis-new-item-loader",{type:i,active:t,text:r}),(0,s.h)("arcgis-new-item-description",{header:e}),(0,s.h)("arcgis-file-browser",{class:"arcgis-file-browser",cloud:!1,insideModal:!0,fullHeight:!0,portal:o,config:d,user:c,allowedExtensions:l}),(0,s.h)("arcgis-new-item-alert",{heading:null==n?void 0:n.title,description:null==n?void 0:n.description,link:{href:null==n?void 0:n.link,title:null==n?void 0:n.linkText},active:!!n,onAlertDismiss:()=>this.error=null}))}};h.style=".arcgis-file-browser{display:block;height:95%}"},51510:(e,i,t)=>{t.d(i,{a:()=>o,f:()=>r,i:()=>l,m:()=>n});var s=t(26426),a=t(31546);function r(e,i){let t;t=i?i.map((e=>e.type)):Object.keys(a.a);let s=[];return t.forEach((i=>{var t;(null===(t=a.a[i].fileExt)||void 0===t?void 0:t.indexOf(e))>=0&&s.push(a.a[i])})),s}function n(e){return e?(0,s.b)(e.flatMap((e=>{var i;return null===(i=a.a[e])||void 0===i?void 0:i.fileExt})).filter((e=>!!e))):null}const l=e=>e/1024/1024>50,o=e=>e/1024/1024>20}}]);