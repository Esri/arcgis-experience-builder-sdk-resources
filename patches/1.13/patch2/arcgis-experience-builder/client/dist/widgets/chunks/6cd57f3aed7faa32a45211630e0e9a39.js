/*! For license information please see 6cd57f3aed7faa32a45211630e0e9a39.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[62669],{66683:(e,t,i)=>{i.d(t,{a:()=>d,s:()=>h});var a=i(42762),s=(i(72637),i(66716),i(58892)),l=i(88009),r=i(61099),n=i(59004),o=i(41171);function c(e,t,i,a){var s,l,r,n;const o=null!==(s=t.latitudeFieldName)&&void 0!==s?s:i.latitudeFieldName,c=null!==(l=t.longitudeFieldName)&&void 0!==l?l:i.longitudeFieldName,d=null!==(r=t.coordinateFieldName)&&void 0!==r?r:i.coordinateFieldName,h=null!==(n=t.coordinateFieldType)&&void 0!==n?n:i.coordinateFieldType;return a[e.name]?a[e.name]:e.name===d?null==h?void 0:h.toLowerCase():e.name===o?"latitude":e.name===c?"longitude":e.locationType||"unknown"}async function d({analyzeArgs:e,configArgs:t,itemArgs:i,initialize:d}){var u,m;const{config:g,lang:y,portal:f,user:v}=t,{itemType:w}=i;if(d&&(0,n.m)(v)){const e=(0,r.b)(null!==(m=null===(u=f.helperServices)||void 0===u?void 0:u.geocode)&&void 0!==m?m:[],v,f.isPortal);if(e&&(s.a.allowGeocode=e.allowGeocode,s.a.isAgoWorldGeocodeServer=e.isAgoWorldGeocodeServer,s.a.isServiceProxyAgoWorldGeocodeServer=e.isServiceProxyAgoWorldGeocodeServer,s.a.isWorldGeocodeServer=e.isWorldGeocodeServer,s.a.geocodeServers=e.geocodeServers,s.a.geocodeServiceUrl=e.geocodeServiceUrl),s.a.geocodeServers){s.a.sourceCountry=(0,r.d)(v.region,f.ipCntryCode);try{s.a.countryCodes=await async function(e,t,i){const a=(0,r.f)(e,i);let s;if(null==a?void 0:a.itemId){const e=`${t}/content/items/${a.itemId}`,i=await(0,o.r)(e),l=i.proxyFilter&&JSON.parse(i.proxyFilter).sourceCountry;l&&(s=l.split(",").map((e=>e.toLowerCase())),s.push("world"))}return Object.keys(r.c).map((e=>({label:r.c[e],value:e}))).filter((({value:e})=>!s||s.includes(e.toLowerCase()))).sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0))}(s.a.geocodeServiceUrl,g.restBaseUrl,s.a.geocodeServers),s.a.standardizedFieldNames=await p(s.a.geocodeServiceUrl,y)}catch(e){return console.error("Geocoder unavailable",e),{error:{code:"unavailableGeocoder"}}}}}const{locationType:b,isWorldGeocodeServer:S,geocodeServiceUrl:T,geocodeServers:C,isServiceProxyAgoWorldGeocodeServer:x,sourceCountry:L,analyzeResults:I,analyzedLocationTypes:k}=s.a,P=`${g.restBaseUrl}content/features/analyze`,{isPortal:M}=f;let F,A=!1;"item"===(null==e?void 0:e.type)&&"append"===e.workflow?(F=l.a[w],A=!0):F="Microsoft Excel"===w?"excel":w.toLowerCase();let U={filetype:F};switch(null==e?void 0:e.type){case"url":U.sourceUrl=e.sourceUrl;break;case"item":U.itemid=e.itemid;break;case"file":U=new FormData,U.append("file",e.file),U.append("filetype",F);break;case"text":U.text=e.text}const D={enableGlobalGeocoding:!0,sourceLocale:y,locationType:b,returnEstimatedRowCount:!0,returnSize:!0};if(M&&T||!M){if((M||!M&&(null==C?void 0:C.length))&&(D.geocodeServiceUrl=encodeURI(T)),I||M){const e="address"===b?"addressTypes":"locationTypes";-1===k.indexOf(e)&&k.push(e),D.locationType=b||"coordinates"}(!f.isPortal&&S||f.isPortal&&x)&&(D.sourceCountryHint=I?"":L.toLowerCase(),D.sourceCountry=I?L.toLowerCase():"");const e=JSON.stringify(D);U instanceof FormData?U.append("analyzeParameters",e):U.analyzeParameters=e}try{return async function({response:e,analyzeSelectedLayer:t,initialize:i,geocodeServiceUrl:l,lang:n,portal:d,itemType:p}){var u,m,g,y,f,v;const w=s.a,b=d.isPortal,S="Microsoft Excel"===p?null!==(m=null===(u=e.publishParameters.layers)||void 0===u?void 0:u[w.selectedSheet])&&void 0!==m?m:null===(g=e.publishParameters.layers)||void 0===g?void 0:g[0]:e.publishParameters;let T;if(!b&&w.isWorldGeocodeServer||b&&w.isServiceProxyAgoWorldGeocodeServer){const e=(0,a.a)(S.sourceCountry);T=w.sourceCountry||S.sourceCountry||"world",T="wo"===T?"world":T,s.a.isWorldGeocodeServer=e,s.a.sourceCountry=T}w.allowGeocode||"address"!==S.locationType||(s.a.locationType="none"),function(e){var t,i,a,l,r,n;const{selectedSheet:o}=s.a,{publishParameters:d}=e,h=null!==(l=null!==(i=null===(t=d.layers)||void 0===t?void 0:t[o])&&void 0!==i?i:null===(a=d.layers)||void 0===a?void 0:a[0])&&void 0!==l?l:d.layerInfo;if(!h)return e;const p=null!==(n=null!==(r=h.addressFields)&&void 0!==r?r:d.addressFields)&&void 0!==n?n:{},u=Object.keys(p).reduce(((e,t)=>Object.assign(Object.assign({},e),{[p[t]]:t})),{});h.fields=h.fields.map((e=>Object.assign(Object.assign({},e),{locationType:c(e,h,d,u)}))),s.a.selectedFields&&(s.a.selectedFields=Object.keys(s.a.selectedFields).reduce(((e,t)=>{const i=s.a.selectedFields[t];return e[t]=Object.assign(Object.assign({},i),{locationType:c(i,h,d,u)}),e}),{}))}(e);const C=function(e){return function(e,t){var i,a,s,l;const{selectedFields:r,type:n,selectedSheet:o}=t;if(!r)return e;const c=e.publishParameters;let d=null==c?void 0:c.layerInfo;switch(n){case"Microsoft Excel":d=null!==(a=null===(i=null==c?void 0:c.layers)||void 0===i?void 0:i[o])&&void 0!==a?a:null===(s=null==c?void 0:c.layers)||void 0===s?void 0:s[0];break;case"GeoJson":d=null===(l=null==c?void 0:c.layers)||void 0===l?void 0:l[0]}return d.fields=d.fields.reduce(((e,t)=>{const i=r[t.name];return i&&(t.alias=i.alias,e.push(t)),e}),[]),e}(e,s.a)}(e);s.a.analyzeResults=C,(null===(y=null==C?void 0:C.publishParameters)||void 0===y?void 0:y.layers)&&(s.a.excelLayers=null===(f=null==C?void 0:C.publishParameters)||void 0===f?void 0:f.layers);const x=(0,r.a)(e,t);var L;i?s.a.backupLayerFields=JSON.parse(JSON.stringify(x.fields)):S.standardizedFieldNames?s.a.standardizedFieldNames=S.standardizedFieldNames:h({lang:n,geocodeServiceUrl:l,locationType:s.a.locationType}),"address"===s.a.locationType||"address"===x.locationType||"address"===(null===(v=null==e?void 0:e.publishParameters)||void 0===v?void 0:v.locationType)?s.a.geocodeCost=await(L=x.estimatedRecordCount,(0,o.r)(`${(0,o.g)()}portals/self/cost`,{geocodeCount:L})):s.a.geocodeCost=null}({response:await(U instanceof FormData?(0,o.e)(P,U,{},"post"):(0,o.r)(P,U,{},"post")),initialize:d,analyzeSelectedLayer:A,geocodeServiceUrl:T,lang:y,portal:f,itemType:w}),{}}catch(e){console.error(e);const t=(null==e?void 0:e.message)||e||"";switch(!0){case t.includes("specify data to be analyzed"):return{error:{code:"emptyFile"}};case t.includes("Duplicate field names are not allowed"):return{error:{code:"duplicateFieldNames"}};case t.toLowerCase().includes("timeout"):return{error:{code:"timeout"}}}return{error:{code:"unhandledError"}}}}async function h({lang:e,geocodeServiceUrl:t,locationType:i}){"address"===i&&(s.a.standardizedFieldNames=await p(t,e))}async function p(e,t){return(await(0,o.r)(e,{},{addTokenManually:!1})).addressFields.reduce(((e,i)=>{var a;return"unknown"!==i.name&&(e[i.name]=(null===(a=null==i?void 0:i.localizedNames)||void 0===a?void 0:a[`${t}`])||i.alias||i.name),e}),{})}},88009:(e,t,i)=>{i.d(t,{A:()=>n,N:()=>s,a:()=>r,b:()=>l,c:()=>c,d:()=>o,u:()=>a});const a=["esriFieldTypeOID","esriFieldTypeGlobalID"],s="<None>",l={"file geodatabase":"filegeodatabase",shapefile:"shapefile",geojson:"geojson",csv:"CSV","microsoft excel":"excel",geopackage:"geoPackage"},r={Shapefile:"shapefile","File Geodatabase":"fileGeodatabase",CSV:"csv","Microsoft Excel":"excel",GeoJson:"geojson",GeoPackage:"geoPackage"},n={csv:"CSV",excel:"Microsoft Excel",shapefile:"Shapefile",fgdb:"File Geodatabase",geojson:"GeoJson",googlesheets:"Microsoft Excel"},o=["zip","csv","xls","xlsx","geojson","gpkg","json"],c=["zip","csv","xls","xlsx"]},62669:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item:()=>H,arcgis_new_item_create_layers_list:()=>W,arcgis_new_item_csv_field:()=>G,arcgis_new_item_custom_parameter:()=>B,arcgis_new_item_custom_parameters:()=>$,arcgis_new_item_input_readonly:()=>V,arcgis_new_item_layer_search:()=>Z,arcgis_new_item_pages_application:()=>J,arcgis_new_item_pages_auth:()=>q,arcgis_new_item_pages_bulk_layer_select:()=>Q,arcgis_new_item_pages_cloud:()=>Y,arcgis_new_item_pages_file_fields:()=>X,arcgis_new_item_pages_item_properties:()=>ee,arcgis_new_item_pages_publish_select:()=>te,arcgis_new_item_pages_single_layer_select:()=>ie,arcgis_new_item_pages_url_type:()=>ae,arcgis_new_item_pages_zip_select:()=>re,arcgis_new_item_timezone_dropdown:()=>oe,arcgis_new_item_url:()=>ce});var a=i(28384),s=i(41171),l=i(76134),r=i(26426),n=i(62727),o=i(96729),c=i(65508),d=i(58892),h=i(31546),p=i(99274),u=i(83129),m=i(72796),g=i(54871),y=i(76706),f=i(48333),v=i(86739),w=i(51510),b=i(59004),S=i(27099),T=i(55470),C=i(62381),x=i(61099),L=i(48680),I=i(48507),k=i(64171),P=i(72074),M=i(71249),F=i(56482),A=i(47682),U=i(71120),D=i(66683),N=i(82463);i(66716),i(27010),i(18869),i(81068),i(24552),i(85142),i(72022),i(58728),i(83397),i(46220),i(86274),i(16665),i(42762),i(72637),i(88009);const _=({directMode:e,newItemMode:t,itemType:i,cloud:a,isMultipageExcel:s,fromExistingItem:l,canPublishItemType:r})=>!(!l||s)||!(!e||(!a||s)&&(s&&"url"!==t||r&&("GeoJson"===i||"CSV"===i))),O={application:"arcgis-new-item-pages-application",auth:"arcgis-new-item-pages-auth",bulkLayerSelect:"arcgis-new-item-pages-bulk-layer-select",cloud:"arcgis-new-item-pages-cloud",csvLocationFields:"arcgis-new-item-pages-csv-location-fields",dataUpload:"arcgis-new-item-pages-data-upload",dataStoreBrowser:"arcgis-new-item-pages-data-store-browser",dataStoreList:"arcgis-new-item-pages-data-store-list",dataStoreSelect:"arcgis-new-item-pages-data-store-select",dataStoreSelectFolder:"arcgis-new-item-pages-data-store-select-folder",dataStoreSelectDatabase:"arcgis-new-item-pages-data-store-select-database",dataStoreSelectDatabaseType:"arcgis-new-item-pages-data-store-select-database-type",dataStoreSelectBdfs:"arcgis-new-item-pages-data-store-select-bdfs",dataStoreSelectBdfsCloud:"arcgis-new-item-pages-data-store-select-bdfs-cloud",dataStoreSelectBdfsFileshare:"arcgis-new-item-pages-data-store-select-bdfs-fileshare",dataStoreSelectBdfsHdfs:"arcgis-new-item-pages-data-store-select-bdfs-hdfs",dataStoreSelectBdfsHive:"arcgis-new-item-pages-data-store-select-bdfs-hive",dataStoreSelectCloud:"arcgis-new-item-pages-data-store-select-cloud",dataStoreSelectCloudCredentials:"arcgis-new-item-pages-data-store-select-cloud-credentials",dataStoreDatabaseCredentials:"arcgis-new-item-pages-data-store-database-credentials",dataStoreSelectNoSql:"arcgis-new-item-pages-data-store-select-nosql",dataStoreSelectNoSqlCredentials:"arcgis-new-item-pages-data-store-select-nosql-credentials",dataStoreSelectArangoCredentials:"arcgis-new-item-pages-data-store-select-arango-credentials",dataStoreSelectServerList:"arcgis-new-item-pages-data-store-select-server-list",developerCredentialsSelect:"arcgis-new-item-pages-developer-credentials-select",featureLayerFromExisting:"arcgis-new-item-pages-feature-layer-from-existing",featureLayerFromScratch:"arcgis-new-item-pages-feature-layer-from-scratch",featureLayerFromTemplate:"arcgis-new-item-pages-feature-layer-from-template",featureLayerFromURL:"arcgis-new-item-pages-feature-layer-from-url",featureLayerPreference:"arcgis-new-item-pages-feature-layer-preference",appendSelect:"arcgis-new-item-pages-append-select",appendUpload:"arcgis-new-item-pages-append-upload",appendSelectUpdate:"arcgis-new-item-pages-append-select-update",appendMatchFields:"arcgis-new-item-pages-append-match-fields",appendKeyPairSelect:"arcgis-new-item-pages-append-key-pair-select",appendSelectLayer:"arcgis-new-item-pages-append-select-layer",appendOverwrite:"arcgis-new-item-pages-append-overwrite",appendFinish:"arcgis-new-item-pages-append-job",featureLayerSelect:"arcgis-new-item-pages-feature-layer-select",featureLayerSummary:"arcgis-new-item-pages-feature-layer-summary",fileField:"arcgis-new-item-pages-file-fields",hybridImageSelect:"arcgis-new-item-pages-hybrid-image-select",itemProperties:"arcgis-new-item-pages-item-properties",layerUpload:"arcgis-new-item-pages-layer-upload",locatorSelect:"arcgis-new-item-pages-locator-select",publishSelect:"arcgis-new-item-pages-publish-select",sceneLayerSelect:"arcgis-new-item-pages-scene-layer-select",serverList:"arcgis-new-item-pages-server-list",serviceScope:"arcgis-new-item-pages-service-scope",singleLayerSelect:"arcgis-new-item-pages-single-layer-select",tileLayerFromExisting:"arcgis-new-item-pages-tile-layer-from-existing",tileLayerFromUrl:"arcgis-new-item-pages-tile-layer-from-url",tileLayerSelect:"arcgis-new-item-pages-tile-layer-select",tileLayerSettings:"arcgis-new-item-pages-tile-layer-settings",urlTypeSelect:"arcgis-new-item-pages-url-type",zipSelect:"arcgis-new-item-pages-zip-select",default:"arcgis-new-item-pages-home"},E="new item",R="my content",z=200,H=class{constructor(e){(0,a.r)(this,e),this.workflowCancel=(0,a.c)(this,"workflowCancel",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.showBackButton=!1,this.workflowCompleted=!1,this.closeDialog=()=>{const{id:e,existingItem:t}=d.a,i=!!t&&"append"!==g.u.workflow;!this.workflowCompleted&&this.handleCancel(e,i),this.workflowCompleted=!1,(0,y.r)(),this.pageHistory=["home"],g.u.nextText="next","register"===this.workflow&&(d.a.id=e,d.a.existingItem=t)},this.handleCancel=async(e,t)=>{let i;const{overwritePayload:a}=d.a;a?i=a:(await u.s.unsubscribeAll(),await(async(e,t)=>{try{e&&!t&&await(0,v.d)(e,{permanentDelete:!0})}catch(e){return}})(e,t)),this.workflowCancel.emit(i);const s=l.c.telemetry;(null==s?void 0:s.getWorkflow("new item upload"))&&(null==s||s.cancelWorkflow("new item upload",{details:d.a.type}))},this.user=void 0,this.portal=void 0,this.api=void 0,this.config=void 0,this.telemetry=void 0,this.file=void 0,this.firstStep=void 0,this.initialFolder=void 0,this.isActive=!0,this.layerId=void 0,this.layer=void 0,this.existingItem=void 0,this.existingItemType=void 0,this.existingItemPublishType=void 0,this.workflow=void 0,this.allowedItemTypes=void 0,this.allowedModes=[...h.A],this.allowPublish=!0,this.pageHistory=["home"],this.initialPage="default",this.navEnabled=!0,this.transition=void 0,this.targetHeight=void 0,this.outerHeight=void 0,this.primaryButtonText=void 0,this.noPadding=void 0,this.isLoading=!1,this.loadingText=void 0,this.disableCloseButton=!1,this.headerIconRef=void 0}disableNavButtons(e){this.navEnabled=e.detail}disableCloseButtons(e){this.isDisableClosePage(this.pageHistory[this.pageHistory.length-1])&&(this.disableCloseButton=e.detail)}handleRedirect({detail:e}){const t={response:{success:!0,id:null,folder:null},type:e.type};e.url&&(t.url=e.url,t.customParameters=e.customParameters,t.layers=e.layers),this.workflowComplete.emit(t),this.isActive=!1}handleWorkflowComplete(){this.workflowCompleted=!0,"map"===g.u.workflow?(this.isLoading=!0,this.loadingText=this.i18n.creatingLayer):this.isActive=!1}async goToNextPage(e){var t,i,a;g.u.nextText="next",this.transition="forward",this.pageHistory=[...this.pageHistory,e.detail],this.targetHeight=null,this.outerHeight=this.contentSlot.offsetHeight,this.cleanPageHistory();const s=this.currentScreen,l=O[e.detail],n=this.el.querySelector(s).clientHeight,o=null===(t=this.modalRef)||void 0===t?void 0:t.shadowRoot.querySelector(".content");o&&(o.style.overflow="hidden"),await(0,r.t)(z);const c=null===(i=this.el.querySelector(l))||void 0===i?void 0:i.clientHeight;c&&(this.targetHeight=n,this.outerHeight=null,await(0,r.t)(z),this.targetHeight=c),await(0,r.t)(z),this.targetHeight=null,this.transition=null,await(0,r.t)(z),o&&(o.style.overflowY="auto");const d=new CustomEvent("arcgisTransitionComplete");null===(a=this.currentPageEl)||void 0===a||a.dispatchEvent(d),this.focusFirstElement()}async goToPreviousPage(){var e,t,i;g.u.nextText="next";const{pageHistory:a}=this;this.transition="back",this.targetHeight=null,this.outerHeight=this.contentSlot.offsetHeight;const s=O[a[a.length-1]]||O.default,l=O[a[a.length-2]]||O.default,n=this.el.querySelector(s).clientHeight,o=null===(e=this.modalRef)||void 0===e?void 0:e.shadowRoot.querySelector(".content");o&&(o.style.overflow="hidden"),await(0,r.t)(z);const c=null===(t=this.el.querySelector(l))||void 0===t?void 0:t.clientHeight;c&&(this.targetHeight=n,this.outerHeight=null,await(0,r.t)(z),this.targetHeight=c),await(0,r.t)(z),this.targetHeight=null,this.transition=null,this.pageHistory=1===this.pageHistory.length?this.pageHistory.slice(0,1):this.pageHistory.slice(0,-1),await(0,r.t)(z),o&&(o.style.overflowY="auto");const d=new CustomEvent("arcgisTransitionComplete");null===(i=this.currentPageEl)||void 0===i||i.dispatchEvent(d),this.focusFirstElement()}updateActive(e){e&&this.firstStep&&(this.pageHistory=[this.firstStep])}updateFirstStep(e){this.pageHistory=[e]}initializeWithFile(){const{user:e,portal:t}=l.c,{file:i}=this;if(i){const a=(e=>{const{title:t,fileName:i,extension:a}=(0,f.s)(e);return c.i.title=t,d.a.file=e,d.a.fileName=i,d.a.newItemMode="file",d.a.extension=a,a})(i);if("zip"===a)return void(this.pageHistory=["home","zipSelect"]);const{nextStep:s,type:r}=(e=>{const t=(0,w.f)(e)[0],{type:i,nextStep:a}=t;return d.a.type=i,{nextStep:a,type:i}})(a);this.postprocessAddFromFile(r),(0,b.a)(e,r,t)||"publishSelect"!==s?this.pageHistory=["home",s]:(d.a.enablePublishing=!1,this.pageHistory=["home","itemProperties"]),(()=>{const{telemetry:e}=l.c;null==e||e.logEvent({eventType:"other",pageName:"my content",category:"content page drag drop",label:"content"}),g.u.telemetryDetails="drag drop"})()}}postprocessAddFromFile(e){d.a.tileLayerPublishType="3DTiles Package"===e?"3dTiles":void 0}updateInitialFolder(e){l.c.initialFolder=e}focusFirstElement(){var e;const t=this.currentPageEl;t&&!t.managedFocus&&(null===(e=this.modalRef)||void 0===e||e.setFocus())}removePageFromHistory(e){const{pageHistory:t}=this;t.length>1&&t.includes(e)&&t.at(-1)!==e&&t.splice(t.indexOf(e),1)}cleanPageHistory(){const{newItemMode:e,type:t,excelLayers:i,existingItem:a,cloudProviderResource:s}=d.a,r=this.pageHistory[this.pageHistory.length-2],n="Microsoft Excel"===t&&(null==i?void 0:i.length)>1,o="map"===g.u.workflow;_({directMode:o,isMultipageExcel:n,newItemMode:e,itemType:t,cloud:!!s,fromExistingItem:!!a,canPublishItemType:(0,b.a)(l.c.user,t,l.c.portal)})&&"publishSelect"===r&&this.removePageFromHistory("publishSelect")}async initializeWithExistingItem(){const e=this.existingItem,t=this.existingItemType;this.isLoading=!0,await(async(e,t)=>{var i;const{existingItemType:a,portal:r,existingItemPublishType:n}=t;l.c.initialFolder=null!==(i=await(0,o.d)(e.folderId,e.itemOwner))&&void 0!==i?i:(0,o.e)(e.itemOwner);let g=e.type;"GeoJSON"===g&&(g="GeoJson"),c.i.title=e.title,c.i.categories=e.categories;const y=e.tags;switch(Array.isArray(y)?c.i.tags=y||[]:c.i.tags=(null!=y?y:"").split(","),d.a.id=e.id,d.a.type=g,d.a.fileName=e.name,d.a.existingItem=e,d.a.enablePublishing="tileLayer"!==a,d.a.newItemMode=a,a){case"file":d.a.extension=h.a[g].fileExt[0];break;case"tileLayer":const{id:t,url:i,title:a}=e,[{layers:l,tables:o,serviceInfo:c}]=await Promise.all([(0,u.g)(i,(0,s.g)(r),!0)]),{result:y}=await(0,m.f)({itemId:t,itemUrl:i,publishType:"vectorTiles"===n?"vector":"raster",portal:r,fullLayers:l});if(d.a.sourceTitle=a,d.a.tileLayerPublishType=n,"3dTiles"===d.a.tileLayerPublishType){d.a.tilesLayer3dTilesLayerType=p.D;break}d.a.tileLayerData=y,d.a.tileAutoCreation=!0,d.a.tileLayerBasemapType="standard",d.a.tileLayerBasemapUrl="",d.a.tileLayerFromFeatureLayer=!0,d.a.tileLayerLayers=l,d.a.tileLayerTables=o,d.a.tileLayerServiceInfo=c}})(e,{existingItemType:t,portal:l.c.portal,existingItemPublishType:this.existingItemPublishType}),this.isLoading=!1;const i=e.type;"append"===this.workflow?(d.a.layerId=null==this?void 0:this.layerId,d.a.sublayer=null==this?void 0:this.layer,g.u.workflow="append",this.initialPage="appendSelect",this.pageHistory=[this.initialPage]):"update"===this.workflow?this.pageHistory=["dataUpload"]:["CSV","Microsoft Excel"].includes(i)?this.pageHistory=["publishSelect"]:"tileLayer"===t?this.pageHistory=["tileLayerSettings"]:"register"===this.workflow?this.pageHistory=["developerCredentialsSelect"]:this.pageHistory=["itemProperties"]}triggerPageTransition(e){var t;const i=new CustomEvent(e,{cancelable:!0});(null===(t=this.currentPageEl)||void 0===t?void 0:t.dispatchEvent(i))&&"arcgisNewItemPagePrev"===e&&this.goToPreviousPage()}displayPage(){if(!this.isActive)return;const{transition:e,pageHistory:t,initialPage:i}=this,s="forward"===e,l="back"===e,r=l?t[t.length-2]:t[t.length-1],n=`${O[r]||O[i]}`,o=this.currentScreen;if(o&&t.length>1&&e)return[(0,a.h)(o,{class:{stage:!0,"stage--fullscreen":this.isFullScreenPage(o),"stage-anim":!0,"stage-anim--leaving":!0,"stage-anim--left":s,"stage-anim--right":l}}),(0,a.h)(n,{class:{stage:!0,"stage--fullscreen":this.isFullScreenPage(n),"stage-anim":!0,"stage-anim--left":l,"stage-anim--right":s},style:{height:`${this.targetHeight}px`},ref:e=>{var t;this.currentPageEl=e,null===(t=this.modalRef)||void 0===t||t.updateFocusTrapElements()}})];this.currentScreen=n;const c=this.targetHeight?{height:`${this.targetHeight}px`}:{};return(0,a.h)(n,{class:{stage:!0,"stage--fullscreen":this.isFullScreenPage(n)},style:c,ref:e=>{this.currentPageEl=e}})}disconnectedCallback(){this.closeDialog()}async componentWillLoad(){var e,t,i;const{file:a,portal:r,api:o,user:c,config:d,telemetry:h,existingItem:p,firstStep:u,workflow:m,initialFolder:y}=this,f=await(0,n.g)(this.el);if(this.i18n=f[0],g.u.i18n=f[0],l.c.lang=f[1],this.primaryButtonText=this.i18n.next,g.u.workflow=m,l.c.portal=r,c){const{error:e,result:t}=await(0,s.f)((()=>(0,s.i)(r,c)),"isPortalBackedBySDS",r.id);e||(l.c.portal.isBackedBySDS=t)}if(l.c.api=o,l.c.config=d,l.c.allowedItemTypes=this.allowedItemTypes,l.c.allowedModes=this.allowedModes,l.c.allowPublish=this.allowPublish,l.c.telemetry=h,l.c.config.helpBase=null!==(e=null==d?void 0:d.helpBase)&&void 0!==e?e:r.helpBase,l.c.initialFolder=y,!(null===(t=l.c.config)||void 0===t?void 0:t.helpMap)){const e=await(0,s.r)(`${d.restBaseUrl}/portals/helpmap?culture=${l.c.lang}`);l.c.config.helpMap=null==e?void 0:e.helpMap.m}c&&(l.c.user=c,l.c.userLicensedItems=null!==(i=c.userLicensedItems)&&void 0!==i?i:await(0,b.f)(r)),a&&this.initializeWithFile(),p&&this.initializeWithExistingItem(),u&&(this.pageHistory=[this.firstStep]),g.a.onChange("disableScroll",(()=>{g.u.disableScroll?this.contentSlot.classList.add("stage--disable-scroll"):this.contentSlot.classList.remove("stage--disable-scroll")})),g.a.onChange("nextText",(()=>{const{i18n:e}=this;let t=e.next;switch(g.u.nextText){case"addToMap":t=e.common.addToMap;break;case"createAndAddToMap":t=e.common.createAndAddToMap;break;case"useAsBaseMap":t=e.urlType.useAsBaseMap;break;case"updateAppend":t=e.common.updateAndComplete;break;case"addAndComplete":t=e.common.addAndComplete;break;case"proceed":t=e.common.proceed;break;case"register":t=e.common.register;break;case"save":t=e.save;break;case"createConnection":t=e.common.createConnection;break;case"signInAndOverwrite":t=e.common.signInAndOverwrite;break;case"overwriteAndComplete":t=e.common.overwriteAndComplete}this.primaryButtonText=t}))}componentWillRender(){this.showBackButton=this.pageHistory.length>1}componentDidLoad(){this.modalRef.setFocus()}componentDidRender(){var e,t;const i=null===(e=this.modalRef)||void 0===e?void 0:e.shadowRoot;if(i){const e=i.querySelector(".header");e&&(e.style.zIndex="3");const t=i.querySelector(".footer"),a=i.querySelector(".content"),s=i.querySelector(".modal"),l=this.currentScreen===O.default,r=this.currentScreen===O[this.initialPage];t&&a&&(t.style.position="absolute",t.style.bottom="0",t.style.visibility=l?"hidden":"visible",s.style.position="relative",r?(a.style.paddingBottom="65px",s.style.paddingBottom="0"):(a.style.paddingBottom="0",s.style.paddingBottom="65px"))}this.noPadding=this.isFullScreenPage(this.currentScreen),null===(t=this.modalRef)||void 0===t||t.updateFocusTrapElements()}isFullScreenPage(e){return["arcgis-new-item-pages-feature-layer-from-template","arcgis-new-item-pages-feature-layer-from-existing","arcgis-new-item-pages-tile-layer-from-store","arcgis-new-item-pages-data-store-list","arcgis-new-item-pages-data-store-browser","arcgis-new-item-pages-tile-layer-from-existing","arcgis-new-item-pages-append-select-layer"].includes(e)}isDisableClosePage(e){return["appendSelectUpdate","csvLocationFields","appendMatchFields"].includes(e)}getHeaderTitle(){const{i18n:e,pageHistory:t}=this,{newItemMode:i,existingItem:a}=d.a;if("map"===g.u.workflow)return e.addLayer;if("register"===g.u.workflow&&a)return e.common.register;if("rasterFunctionTemplate"===i)return e.createRasterFunctionTemplate;const s=(t[t.length-1]||"").toLowerCase();switch(!0){case s.includes("featurelayer"):return e.createFeatureLayer;case s.includes("tilelayer"):return e.createTileLayer;case"update"===g.u.workflow&&"Vector Tile Service"===(null==a?void 0:a.type):return e.update;case"append"===g.u.workflow||"update"===g.u.workflow:return e.appendSelect.updateData;case"sceneLayer"===i:return e.createSceneLayer;case"tileLayer"===i:return e.createTileLayer;case"dataStore"===i:return e.addDataStore;default:return e.newItem}}renderOnboardingSection({title:e,content:t,background:i,path:s}){return(0,a.h)("div",{class:"onboarding__section"},(0,a.h)("h4",{class:"onboarding__title"},e),(0,a.h)("p",{class:"onboarding__description"},t),(0,a.h)("svg",{width:"255",height:"64",viewBox:"0 0 255 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.h)("rect",{width:"255",height:"64",fill:i,"fill-opacity":"0.1"}),s))}renderOnboarding(){if("map"===g.u.workflow)return null;const{i18n:e}=this,t=[{title:e.onboard.addDocumentTitle,content:e.onboard.addDocumentContent,background:"#007ac2",show:!0,path:(0,a.h)("path",{d:"M132.257 45.5566L146.318 31.4926L140 25.1736L141.368 21.5716L126.485 15.9196L122.666 12.0996H109.1V42.8996H113.611L116.756 44.0946L125.246 52.5646L129.054 48.7656L130.787 49.4246L132.043 46.1186H132.044L132.257 45.5566ZM145.187 31.4926L132.95 43.7296L139.686 25.9946L145.187 31.4926ZM122.9 13.4656L130.534 21.0996H122.9V13.4656ZM109.9 12.8996H122.334L122.434 12.9996H122.1V21.8996H131V21.5646L131.1 21.6656V42.0996H109.9V12.8996ZM125.246 51.4336L118.586 44.7896L128.233 48.4546L125.246 51.4336ZM130.324 48.3936L115.864 42.8996H131.9V21.3336L127.865 17.2976L140.335 22.0346L131.643 44.9216L130.324 48.3936Z",fill:"#3985B2"})},{title:e.onboard.publishLayerTitle,content:this.portal.isPortal?e.onboard.publishLayerEnterprise:e.onboard.publishLayerContent,show:(0,b.b)(this.user,this.portal),background:"#35AC46",path:(0,a.h)("path",{d:"M141.105 16.2537L140.876 16.1767C140.564 16.0727 133.164 13.6597 126.852 16.1857C120.814 18.5977 113.449 16.2007 113.376 16.1757L112.931 16.0287L107.808 47.2817L108.071 47.4137C110.922 48.6327 114.002 49.2205 117.101 49.1367C120.513 49.1139 123.898 48.5398 127.126 47.4367C138.069 43.7867 145.497 47.3767 145.571 47.4147L146.271 47.7627L141.105 16.2537ZM126.874 46.6767C117.087 49.9387 110.114 47.4137 108.694 46.8167L113.571 17.0727C115.303 17.5747 121.639 19.1327 127.148 16.9277C132.588 14.7537 139.104 16.4837 140.396 16.8657L145.236 46.3987C143.116 45.5657 136.336 43.5227 126.874 46.6767ZM137.68 18.4287C134.067 17.7098 130.328 17.9712 126.85 19.1857C125.996 19.5212 125.112 19.7751 124.21 19.9437L124.198 19.9467C121.662 20.3744 119.07 20.3616 116.538 19.9087L116.141 19.8427L112.111 44.4287L112.478 44.5117C114.342 44.9239 116.247 45.1288 118.156 45.1227C121.549 45.1021 124.915 44.5328 128.126 43.4367C131.17 42.4017 134.358 41.8503 137.573 41.8027H137.583C138.825 41.7881 140.066 41.8603 141.297 42.0187L141.832 42.0887L137.961 18.4767L137.68 18.4287ZM140.363 38.0717L137.891 40.5437C137.8 39.7207 137.658 38.9042 137.467 38.0987L139.959 35.6067L140.363 38.0717ZM139.799 34.6347L137.233 37.2007C137.023 36.4878 136.761 35.7916 136.448 35.1177L139.396 32.1687L139.799 34.6347ZM139.236 31.1977L136.061 34.3727C135.732 33.7679 135.335 33.2031 134.876 32.6897L138.832 28.7337L139.236 31.1977ZM138.672 27.7617L134.302 32.1317C133.848 31.7219 133.356 31.355 132.834 31.0357C132.858 30.9203 132.873 30.8033 132.88 30.6857L138.268 25.2967L138.672 27.7617ZM138.109 24.3247L132.747 29.6867C132.627 29.3574 132.437 29.0584 132.189 28.8106C131.941 28.5629 131.642 28.3724 131.313 28.2527L137.705 21.8607L138.109 24.3247ZM130.5 28.9007C130.817 28.9007 131.126 28.9945 131.389 29.1703C131.652 29.3461 131.857 29.596 131.978 29.8884C132.099 30.1807 132.131 30.5024 132.069 30.8128C132.008 31.1232 131.855 31.4083 131.631 31.632C131.408 31.8558 131.123 32.0082 130.812 32.0699C130.502 32.1317 130.18 32.1 129.888 31.9789C129.595 31.8578 129.346 31.6527 129.17 31.3896C128.994 31.1265 128.9 30.8171 128.9 30.5007C128.901 30.0765 129.069 29.6698 129.369 29.3699C129.669 29.0699 130.076 28.9012 130.5 28.9007ZM137.547 20.8877L130.316 28.1187C129.991 28.1436 129.675 28.2349 129.386 28.3869C129.098 28.539 128.844 28.7485 128.64 29.0027C128.195 28.7707 127.773 28.4971 127.38 28.1857L130.972 24.5947C131.336 24.8317 131.771 24.9365 132.203 24.8913C132.635 24.8461 133.039 24.6538 133.346 24.3465C133.653 24.0393 133.846 23.6357 133.891 23.2036C133.936 22.7714 133.831 22.3368 133.594 21.9727L136.502 19.0647C136.762 19.0987 137.022 19.1317 137.265 19.1707L137.547 20.8877ZM133.1 23.0007C133.1 23.2182 133.036 23.4309 132.915 23.6118C132.794 23.7927 132.622 23.9337 132.421 24.0169C132.22 24.1002 131.999 24.122 131.786 24.0795C131.572 24.0371 131.376 23.9323 131.222 23.7785C131.068 23.6246 130.964 23.4286 130.921 23.2153C130.879 23.0019 130.901 22.7807 130.984 22.5797C131.067 22.3787 131.208 22.2069 131.389 22.0861C131.57 21.9652 131.783 21.9007 132 21.9007C132.292 21.9009 132.571 22.0169 132.778 22.2231C132.984 22.4294 133.1 22.709 133.1 23.0007ZM135.481 18.9527L133.028 21.4067C132.664 21.1696 132.229 21.0649 131.797 21.11C131.365 21.1552 130.962 21.3476 130.654 21.6548C130.347 21.9621 130.155 22.3656 130.109 22.7978C130.064 23.2299 130.169 23.6645 130.406 24.0287L126.785 27.6507C126.533 27.3913 126.302 27.1113 126.096 26.8137C125.913 26.5372 125.757 26.2439 125.629 25.9377L132.706 18.8617C133.632 18.8364 134.559 18.8668 135.481 18.9527ZM127.893 19.6737C129.063 19.2898 130.273 19.0422 131.499 18.9357L125.323 25.1117C125.089 24.3363 124.924 23.5419 124.829 22.7377L127.893 19.6737ZM126.166 20.2687L124.726 21.7087C124.7 21.3618 124.684 21.0144 124.676 20.6667C125.193 20.5567 125.686 20.4207 126.166 20.2687ZM127.874 42.6767C123.113 44.3665 117.987 44.7579 113.024 43.8107L116.802 20.7607C119.145 21.1389 121.532 21.1571 123.88 20.8147C123.919 22.2727 124.157 25.4197 125.439 27.2687C126.163 28.2967 127.127 29.1318 128.248 29.7007C128.153 29.9568 128.103 30.2275 128.1 30.5007C128.099 31.0201 128.267 31.5258 128.579 31.9414C128.89 32.357 129.329 32.6601 129.827 32.8049C130.326 32.9497 130.859 32.9284 131.344 32.7442C131.83 32.56 132.243 32.2229 132.52 31.7837C133.084 32.1296 133.609 32.5368 134.084 32.9977C134.694 33.6027 136.674 35.9357 137.146 41.0097C133.99 41.1015 130.865 41.6633 127.874 42.6767ZM138.549 41.0177L140.523 39.0437L140.87 41.1607C140.099 41.0796 139.325 41.0319 138.55 41.0177H138.549ZM119 25.1007C118.624 25.1007 118.257 25.2121 117.945 25.4209C117.632 25.6297 117.389 25.9264 117.245 26.2736C117.101 26.6207 117.063 27.0028 117.137 27.3713C117.21 27.7399 117.391 28.0785 117.657 28.3442C117.922 28.6099 118.261 28.7908 118.629 28.8642C118.998 28.9375 119.38 28.8998 119.727 28.756C120.074 28.6122 120.371 28.3687 120.58 28.0563C120.789 27.7438 120.9 27.3765 120.9 27.0007C120.9 26.4969 120.699 26.014 120.343 25.6577C119.987 25.3015 119.504 25.1012 119 25.1007ZM119 28.1007C118.783 28.1007 118.57 28.0362 118.389 27.9153C118.208 27.7944 118.067 27.6226 117.984 27.4216C117.901 27.2206 117.879 26.9994 117.921 26.7861C117.964 26.5727 118.068 26.3767 118.222 26.2229C118.376 26.069 118.572 25.9642 118.786 25.9218C118.999 25.8794 119.22 25.9011 119.421 25.9844C119.622 26.0677 119.794 26.2086 119.915 26.3895C120.036 26.5704 120.1 26.7831 120.1 27.0007C120.1 27.2923 119.984 27.572 119.778 27.7782C119.571 27.9844 119.292 28.1004 119 28.1007ZM119.5 33.1007C119.223 33.1007 118.953 33.1828 118.722 33.3366C118.492 33.4904 118.313 33.7091 118.207 33.9649C118.101 34.2207 118.073 34.5022 118.127 34.7738C118.181 35.0454 118.314 35.2948 118.51 35.4906C118.706 35.6864 118.955 35.8197 119.227 35.8738C119.499 35.9278 119.78 35.9001 120.036 35.7941C120.292 35.6881 120.51 35.5087 120.664 35.2785C120.818 35.0482 120.9 34.7776 120.9 34.5007C120.9 34.1295 120.752 33.7737 120.489 33.5113C120.227 33.2489 119.871 33.1012 119.5 33.1007ZM119.5 35.1007C119.381 35.1007 119.265 35.0655 119.167 34.9995C119.068 34.9336 118.991 34.8399 118.946 34.7303C118.9 34.6206 118.888 34.5 118.912 34.3836C118.935 34.2672 118.992 34.1603 119.076 34.0764C119.16 33.9925 119.267 33.9353 119.383 33.9122C119.499 33.889 119.62 33.9009 119.73 33.9463C119.839 33.9918 119.933 34.0687 119.999 34.1673C120.065 34.266 120.1 34.382 120.1 34.5007C120.1 34.6598 120.037 34.8124 119.924 34.9249C119.812 35.0375 119.659 35.1007 119.5 35.1007ZM128 36.1007C127.624 36.1007 127.257 36.2121 126.945 36.4209C126.632 36.6297 126.389 36.9264 126.245 37.2736C126.101 37.6207 126.063 38.0028 126.137 38.3713C126.21 38.7399 126.391 39.0784 126.657 39.3442C126.922 39.6099 127.261 39.7908 127.629 39.8642C127.998 39.9375 128.38 39.8998 128.727 39.756C129.074 39.6122 129.371 39.3687 129.58 39.0563C129.789 38.7438 129.9 38.3765 129.9 38.0007C129.9 37.4969 129.699 37.014 129.343 36.6577C128.987 36.3015 128.504 36.1012 128 36.1007ZM128 39.1007C127.783 39.1007 127.57 39.0362 127.389 38.9153C127.208 38.7944 127.067 38.6226 126.984 38.4216C126.901 38.2206 126.879 37.9994 126.921 37.7861C126.964 37.5727 127.068 37.3767 127.222 37.2229C127.376 37.069 127.572 36.9642 127.786 36.9218C127.999 36.8794 128.22 36.9011 128.421 36.9844C128.622 37.0677 128.794 37.2086 128.915 37.3895C129.036 37.5704 129.1 37.7831 129.1 38.0007C129.1 38.2923 128.984 38.572 128.778 38.7782C128.571 38.9844 128.292 39.1004 128 39.1007Z",fill:"#35AC46"})},{title:e.onboard.linkLayerTitle,content:e.onboard.linkLayerContent,background:"#EDD317",show:!0,path:(0,a.h)("path",{d:"M145.887 31.4506C145.802 26.7994 143.986 22.347 140.792 18.9642C137.599 15.5814 133.258 13.5116 128.62 13.1596C128.253 13.1256 127.881 13.1016 127.5 13.1016C127.119 13.1016 126.747 13.1256 126.38 13.1596C121.741 13.5116 117.4 15.5816 114.207 18.9646C111.014 22.3475 109.197 26.8002 109.113 31.4516C109.113 31.4866 109.119 31.5186 109.122 31.5536C109.118 31.7036 109.1 31.8496 109.1 32.0006C109.063 36.377 110.556 40.6289 113.32 44.0221C116.084 47.4152 119.946 49.7367 124.24 50.5856C124.405 50.6186 124.577 50.6376 124.745 50.6656C125.079 50.7166 125.411 50.7756 125.752 50.8096C126.914 50.9309 128.086 50.9309 129.248 50.8096C129.588 50.7766 129.921 50.7166 130.255 50.6646C130.423 50.6376 130.595 50.6186 130.76 50.5856C135.053 49.7367 138.916 47.4152 141.68 44.0221C144.444 40.6289 145.937 36.377 145.9 32.0006C145.9 31.8506 145.882 31.7036 145.878 31.5536C145.881 31.5186 145.887 31.4866 145.887 31.4516V31.4506ZM142.534 41.3626L142.278 41.6666C141.704 42.2504 141.008 42.7004 140.24 42.9846C141.445 40.2196 142.049 37.2304 142.013 34.2146C143.102 33.9263 144.133 33.4509 145.06 32.8096C144.935 35.8251 144.067 38.7631 142.534 41.3626ZM112.722 41.6666L112.471 41.3586C110.936 38.7609 110.067 35.8242 109.941 32.8096C110.867 33.4508 111.898 33.9262 112.987 34.2146C112.951 37.2304 113.555 40.2196 114.76 42.9846C113.992 42.7003 113.296 42.2503 112.722 41.6666ZM112.298 22.9226C113.015 23.4313 113.838 23.773 114.705 23.9226C113.624 26.9623 113.044 30.1577 112.989 33.3836C111.124 32.8016 110.014 32.1466 109.923 31.5326C109.993 28.5107 110.809 25.553 112.298 22.9226ZM120.476 16.5126C121.232 16.9679 122.064 17.2811 122.933 17.4366C122.079 19.5294 121.455 21.7089 121.072 23.9366C119.301 23.8294 117.537 23.6203 115.79 23.3106C116.782 20.7007 118.39 18.3687 120.476 16.5126ZM139.216 23.3246C137.466 23.6264 135.701 23.8314 133.929 23.9386C133.546 21.7102 132.921 19.53 132.067 17.4366C132.935 17.2811 133.768 16.9679 134.524 16.5126C136.614 18.3723 138.223 20.7092 139.216 23.3246ZM145.076 31.5326C144.986 32.1466 143.876 32.8026 142.011 33.3836C141.955 30.1581 141.376 26.963 140.295 23.9236C141.162 23.774 141.984 23.4323 142.702 22.9236C144.191 25.5537 145.006 28.5111 145.077 31.5326H145.076ZM141.214 33.6156C139.159 34.1446 137.067 34.52 134.956 34.7386C134.919 31.3844 134.623 28.0381 134.071 24.7296C135.896 24.6268 137.713 24.4145 139.512 24.0936C140.608 27.15 141.183 30.3687 141.214 33.6156ZM127.9 17.8756C129.023 17.8623 130.143 17.7674 131.253 17.5916C132.117 19.6458 132.747 21.7906 133.133 23.9856C131.584 24.0756 129.843 24.1306 127.9 24.1376V17.8756ZM127.9 17.0756V13.9366C129.033 14.1396 130.038 15.1966 130.893 16.8406C129.901 16.9847 128.902 17.0626 127.9 17.0736V17.0756ZM127.1 17.0756C126.098 17.0642 125.098 16.9861 124.107 16.8416C124.962 15.1986 125.967 14.1406 127.1 13.9376V17.0756ZM127.1 17.8756V24.1376C125.354 24.1342 123.609 24.0832 121.867 23.9846C122.252 21.7899 122.883 19.6455 123.747 17.5916C124.856 17.7671 125.977 17.8617 127.1 17.8746V17.8756ZM127.1 24.9396V35.1446C125.011 35.1351 122.923 35.0289 120.844 34.8266C120.863 31.459 121.156 28.0986 121.721 24.7786C123.961 24.9056 126.001 24.9346 127.1 24.9386V24.9396ZM127.1 35.9446V45.0376C125.405 45.0269 123.711 44.9231 122.028 44.7266C121.214 41.7646 120.815 38.7041 120.842 35.6326C122.869 35.8276 124.999 35.9326 127.1 35.9446ZM127.1 45.8376V50.0786C124.722 49.8876 123.235 48.0046 122.313 45.5586C123.903 45.7328 125.5 45.8263 127.1 45.8386V45.8376ZM127.9 45.8376C129.499 45.826 131.097 45.7332 132.687 45.5596C131.765 48.0046 130.277 49.8876 127.9 50.0796V45.8376ZM127.9 45.0376V35.9446C129.989 35.9339 132.077 35.8298 134.158 35.6326C134.184 38.7038 133.785 41.7639 132.972 44.7256C131.288 44.9222 129.595 45.0264 127.9 45.0376ZM127.9 35.1446V24.9406C128.999 24.9356 131.038 24.9066 133.279 24.7796C133.843 28.0996 134.136 31.46 134.156 34.8276C132.076 35.0299 129.989 35.136 127.9 35.1456V35.1446ZM131.723 16.6946C131.288 15.7612 130.693 14.911 129.966 14.1826C131.376 14.5183 132.704 15.1368 133.869 16.0006C133.189 16.3317 132.467 16.5659 131.723 16.6966V16.6946ZM123.277 16.6946C122.532 16.5647 121.81 16.3311 121.13 16.0006C122.294 15.1371 123.622 14.519 125.033 14.1836C124.305 14.9123 123.71 15.7628 123.276 16.6966L123.277 16.6946ZM120.929 24.7296C120.376 28.0384 120.08 31.3851 120.044 34.7396C117.933 34.5206 115.841 34.1449 113.786 33.6156C113.817 30.3687 114.392 27.15 115.488 24.0936C117.287 24.4144 119.103 24.6268 120.928 24.7296H120.929ZM113.794 34.4516C115.847 34.9692 117.936 35.3348 120.044 35.5456C119.99 38.6014 120.352 41.6504 121.121 44.6086C119.354 44.3753 117.613 43.9809 115.918 43.4306C114.523 40.6428 113.796 37.5688 113.794 34.4516ZM121.396 45.4446C121.888 47.1149 122.847 48.6098 124.16 49.7536C122.593 49.435 121.108 48.8006 119.794 47.889C118.48 46.9775 117.366 45.8079 116.52 44.4516C118.118 44.9041 119.748 45.2361 121.396 45.4446ZM133.604 45.4446C135.251 45.2364 136.881 44.9048 138.479 44.4526C137.632 45.8085 136.518 46.9778 135.204 47.889C133.891 48.8002 132.405 49.4343 130.839 49.7526C132.152 48.6096 133.111 47.1153 133.604 45.4456V45.4446ZM133.88 44.6086C134.648 41.6504 135.01 38.6014 134.956 35.5456C137.063 35.3348 139.152 34.9692 141.206 34.4516C141.204 37.5688 140.476 40.6428 139.082 43.4306C137.387 43.9809 135.646 44.3752 133.88 44.6086ZM142.282 22.2126C142.282 22.4826 141.512 22.8366 140.005 23.1666C138.972 20.4017 137.288 17.9262 135.096 15.9496C135.134 15.8849 135.167 15.8165 135.192 15.7456C138.101 17.2143 140.552 19.4506 142.282 22.2126ZM134.462 15.3836C134.46 15.4004 134.456 15.4171 134.452 15.4336C134.386 15.3836 134.317 15.3376 134.25 15.2896C134.321 15.3196 134.392 15.3526 134.463 15.3836H134.462ZM120.548 15.4336C120.543 15.4192 120.54 15.4045 120.538 15.3896C120.608 15.3586 120.678 15.3196 120.75 15.2896C120.683 15.3376 120.614 15.3846 120.548 15.4346V15.4336ZM119.808 15.7456C119.833 15.8165 119.865 15.8849 119.904 15.9496C117.716 17.9213 116.035 20.39 115.002 23.1476C113.568 22.8216 112.815 22.4676 112.742 22.1716C114.47 19.428 116.913 17.2066 119.808 15.7456ZM113.885 43.4536C114.341 43.6791 114.81 43.8784 115.289 44.0506C115.781 44.9374 116.369 45.7674 117.043 46.5256C115.868 45.6351 114.807 44.6033 113.885 43.4536ZM137.957 46.5256C138.63 45.7674 139.219 44.9374 139.711 44.0506C140.19 43.8784 140.659 43.6791 141.115 43.4536C140.192 44.6034 139.132 45.6351 137.957 46.5256Z",fill:"#D9BC00"})}].filter((e=>e.show)).map(this.renderOnboardingSection);return(0,a.h)("arcgis-information",{label:e.onboard.tooltipLabel,placement:"bottom-start",heading:e.onboard.title,headingLevel:3,class:"onboarding",overlayPositioning:"fixed",paddedContent:!0},(0,a.h)("div",{class:"onboarding__scroll"},t))}render(){const{i18n:e,noPadding:t,isLoading:i,loadingText:s,isActive:l,disableCloseButton:r}=this,n=this.outerHeight?{height:`${this.outerHeight}px`}:{};return(0,a.h)("calcite-modal",{ref:e=>this.modalRef=e,open:l,onCalciteModalClose:this.closeDialog,outsideCloseDisabled:!0,escapeDisabled:!0,class:{modal:!0,"modal--grey":t},closeButtonDisabled:r},(0,a.h)("div",{slot:"header",class:"header"},(0,a.h)("h3",{id:"modal-title",class:"header__title"},this.getHeaderTitle()),"home"===this.pageHistory[this.pageHistory.length-1]&&l&&this.renderOnboarding()),(0,a.h)("div",{slot:"content",style:n,ref:e=>this.contentSlot=e,class:"content"},i&&(0,a.h)("div",{class:"stage"},(0,a.h)("arcgis-new-item-loader",{active:i,text:null!=s?s:e.loadingData})),!i&&this.displayPage()),(0,a.h)("div",{slot:"back"},this.showBackButton&&(0,a.h)("calcite-button",{appearance:"outline-fill",kind:"neutral","data-id":"backButton",onClick:()=>{this.navEnabled&&this.triggerPageTransition("arcgisNewItemPagePrev")},width:"full",disabled:!this.navEnabled},e.back)),(0,a.h)("calcite-button",{slot:"secondary",appearance:"outline-fill","data-id":"cancelButton",onClick:()=>{r||(this.isActive=!1)},width:"full",disabled:r},e.cancel),(0,a.h)("calcite-button",{slot:"primary",appearance:"solid","data-id":"nextButton",onClick:()=>{this.triggerPageTransition("arcgisNewItemPageNext")},width:"full",disabled:!this.navEnabled},this.primaryButtonText))}get el(){return(0,a.d)(this)}static get watchers(){return{isActive:["updateActive"],firstStep:["updateFirstStep"],file:["initializeWithFile"],initialFolder:["updateInitialFolder"]}}};H.style=".stage{padding-bottom:1.5rem;padding-left:1px;padding-right:1px;box-sizing:border-box;width:100%;opacity:1;display:block;height:calc(100% - 2rem);transition:all 200ms ease-in-out}@media screen and (min-width: 1080px){.stage{height:min(700px, 60vh)}}.stage--fullscreen{height:100%;overflow:auto;padding-bottom:0}.stage--disable-scroll{overflow:hidden;height:33vh}.stage-anim{transform:translate3d(0, 0, 0)}.stage-anim--leaving{position:absolute;width:calc(100% - 4rem)}.stage-anim--left{opacity:0;transform:translate3d(-24px, 0, 0)}.stage-anim--right{opacity:0;transform:translate3d(24px, 0, 0)}.header{display:flex;align-items:center;position:relative}.header>.icon{border-style:none;margin-left:0.5rem;margin-right:0.5rem;padding:0;display:flex;background-color:transparent}@media screen and (max-width: 480px){.stage{padding-bottom:6rem}}.header__title{font-size:1.125rem;margin:0;padding:0;font-weight:500}.content{height:100%}.onboarding{--arcgis-information-min-width:0}.onboarding__scroll{overflow:auto;max-height:min(700px, 60vh)}.onboarding__section{padding-bottom:1rem;padding-top:0.5rem;width:255px}.onboarding__title{color:var(--calcite-ui-text-1);font-size:0.875rem;padding-top:0;margin:0;font-weight:600}.onboarding__description{margin-top:0.5rem;margin-bottom:0.75rem;font-size:0.75rem;color:var(--calcite-ui-text-1)}.modal{--calcite-modal-width:1080px;--calcite-modal-height:min(922px, 75vh)}.modal--grey{--calcite-modal-content-padding:0;--calcite-modal-content-background:var(--calcite-ui-background)}";const j=e=>{const{telemetry:t}=l.c,i={eventType:"new item click",pageName:"my content",category:"new item",label:e};null==t||t.logEvent(i),g.u.telemetryDetails=e},W=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.handleRedirect=(0,a.c)(this,"handleRedirect",7),this.i18n=void 0,this.options=void 0,this.isLoading=!1}async componentWillLoad(){this.i18n=g.u.i18n.createLayersList;const{user:e,portal:t,userLicensedItems:i}=l.c;this.isLoading=!0;const{result:a}=await(0,s.f)((()=>(0,T.g)(l.c.portal)),"subscriptionType",l.c.user.id);l.c.subscriptionInfo=a,this.isLoading=!1,this.options=[{heading:this.i18n.featureLayerHeading,icon:"featureLayer",description:this.i18n.featureLayerDescription,show:l.c.allowedModes.includes("featureLayer")&&(0,b.b)(e,t),handler:this.onFeatureLayerClick},{heading:this.i18n.urlHeading,icon:"web",description:this.i18n.urlDescription,show:l.c.allowedModes.includes("url"),handler:this.onURLClick},{heading:this.i18n.developerCredentialsHeading,icon:"key",description:this.i18n.developerCredentialsNoAPIDescription,show:l.c.allowedModes.includes("developerCredentials")&&(0,b.d)(e),handler:this.onDeveloperCredentialsClick},{heading:this.i18n.applicationHeading,icon:"apps",description:this.i18n.applicationDescription,show:l.c.allowedModes.includes("application"),handler:this.onApplicationClick},{heading:this.i18n.imageLayerHeading,icon:"imageLayer",description:this.i18n.imageLayerDescription,show:l.c.allowedModes.includes("imageryLayer")&&(0,b.e)(e,t,i),handler:this.onImageryLayerClick},{heading:this.i18n.tileLayerHeading,icon:"tileLayer",description:this.i18n.tileLayerDescription,show:l.c.allowedModes.includes("tileLayer")&&(0,b.g)(e,t),handler:this.onTileLayerClick},{heading:this.i18n.sceneLayerHeading,icon:"layerGraphics",description:this.i18n.sceneLayerDescription,handler:this.onSceneLayerClick,show:l.c.allowedModes.includes("sceneLayer")&&(0,b.h)(e)},{heading:this.i18n.locatorHeading,icon:"locator",description:this.i18n[(0,b.i)(e,t)?"locatorDescription":"locatorOnlyDescription"],show:l.c.allowedModes.includes("locator")&&(0,b.j)(e),handler:this.onLocatorClick},{heading:this.i18n.dataStoreHeading,icon:"data",description:this.i18n.dataStoreDescription,show:l.c.allowedModes.includes("dataStore")&&(0,b.k)(e,t),handler:this.onDataStoreClick},{heading:this.i18n.dataStoreHeading,icon:"data",description:this.i18n.dataStoreConnectionDescription,show:!1,handler:this.onDataStoreConnectionClick},{heading:this.i18n.rasterFunctionTemplateHeading,icon:"new-raster-function-template",description:this.i18n.rasterFunctionTemplateDescription,show:l.c.allowedModes.includes("rasterFunctionTemplate")&&(0,b.l)(e)&&!(0,C.n)(e),handler:this.onRasterFunctionTemplateClick}]}onFeatureLayerClick(){j("feature layer"),(async()=>{var e;null===(e=l.c.telemetry)||void 0===e||e.startWorkflow("create feature layer",{category:"create feature layer",pageName:"my content"}),d.a.newItemMode="create"})(),this.newItemUpdatePage.emit("featureLayerSelect")}onTileLayerClick(){j("tile layer"),d.a.newItemMode="tileLayer",(0,S.l)(),this.newItemUpdatePage.emit("tileLayerSelect")}onSceneLayerClick(){j("scene layer"),d.a.newItemMode="sceneLayer",l.c.portal.isPortal?this.newItemUpdatePage.emit("sceneLayerSelect"):this.newItemUpdatePage.emit("layerUpload")}onImageryLayerClick(){j("imagery layer"),this.handleRedirect.emit({type:"Imagery Layer"})}onURLClick(){j("url"),this.newItemUpdatePage.emit("urlTypeSelect")}onDataStoreClick(){const e=l.c.config.addDatastoreComponentEnabled;j("data store"),e?(d.a.newItemMode="dataStore",this.newItemUpdatePage.emit("dataStoreSelect")):this.handleRedirect.emit({type:"Data Store"})}onDataStoreConnectionClick(){d.a.newItemMode="dataStore",this.newItemUpdatePage.emit("dataStoreSelect")}onApplicationClick(){j("an app"),d.a.newItemMode="application",d.a.file=null,d.a.type="Web Mapping Application",d.a.typeKeywords=["JavaScript","Online Map","Ready To Use"],d.a.thumbnailURL="https://static.arcgis.com/images/desktopapp.png",this.newItemUpdatePage.emit("application")}async onLocatorClick(){j("locator"),this.newItemUpdatePage.emit("locatorSelect")}onDeveloperCredentialsClick(){d.a.newItemMode="developerCredentials",j("dev cred"),this.newItemUpdatePage.emit("developerCredentialsSelect")}onRasterFunctionTemplateClick(){j("raster function template"),d.a.type="Raster function template",d.a.newItemMode="rasterFunctionTemplate",this.newItemUpdatePage.emit("itemProperties")}renderOptions(){return this.options.map((e=>e.show&&(0,a.h)("li",{class:"list-item"},(0,a.h)("button",{class:"card",onClick:e.handler.bind(this)},(0,a.h)("div",{class:"card__icon"},(0,a.h)("calcite-icon",{icon:e.icon,scale:"l"})),(0,a.h)("div",{class:"card__content"},(0,a.h)("h4",{class:"card__title"},e.heading," ",(0,a.h)("calcite-icon",{class:"card__arrow",icon:"arrow-right","flip-rtl":!0})),(0,a.h)("h4",{class:"card__subtitle"},e.description))))))}render(){const{isLoading:e,i18n:t}=this;return(0,a.h)("nav",{"aria-labelledby":"layers-list-heading"},(0,a.h)("arcgis-new-item-loader",{active:e,text:t.getSubscriptionInfo}),(0,a.h)("ul",{class:"list"},this.renderOptions()))}get el(){return(0,a.d)(this)}};W.style=".title{font-weight:400;font-size:1rem;color:var(--calcite-ui-text-1);padding:0;margin:0;margin-top:2rem}.list{margin:0;padding:0;padding-bottom:0.75rem;display:flex;flex-wrap:wrap}.list-item{margin:0;padding:0;display:flex;justify-items:start;list-style-type:none;flex:1 1 380px}.card{margin-top:1.25rem;padding:0;display:flex;border:1px solid transparent;-webkit-margin-end:2rem;margin-inline-end:2rem;max-width:440px;align-items:stretch;background-color:white;transition:all 150ms ease-in-out;outline-offset:0px;outline-color:transparent;font-family:inherit;text-align:initial;cursor:pointer}.card:hover{border-color:#aaa}.card:focus{outline:none;border-color:var(--calcite-ui-brand)}.card:hover .card__icon,.card:focus .card__icon{background-color:#eef7fd}.card:hover .card__arrow,.card:focus .card__arrow{opacity:1;transform:translate3d(0, 0, 0)}.card__arrow{vertical-align:-6px;opacity:0;transform:translate3d(-20px, 0, 0);transition:all 150ms ease-in-out}.card__icon{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:87px;min-height:87px;color:#000000;background-color:var(--calcite-ui-background);transition:all 150ms ease-in-out}.card__content{padding-left:0.75rem;padding-right:0.75rem;padding-top:0.5rem;padding-bottom:0.5rem}.card__title{font-size:1rem;line-height:1.25rem;margin:0;padding:0;font-weight:400;color:#323232}.card__subtitle{font-size:0.875rem;line-height:1.25rem;font-weight:400;margin:0;margin-top:0.5rem;padding:0;color:#646464}";const G=class{constructor(e){(0,a.r)(this,e),this.fieldChange=(0,a.c)(this,"fieldChange",7),this.handleTypeChange=e=>{const t=e.target.selectedOption.value;this.fieldChange.emit({name:this.field.name,key:"type",value:t,modified:t!==this.initialField.type})},this.checked=!0,this.defaultChecked=!0,this.field=void 0,this.fieldTypes=void 0,this.detectedType=void 0,this.canHideFields=void 0,this.displayNameLabel=void 0,this.typeLabel=void 0}componentWillLoad(){this.checked=this.defaultChecked,this.allowedFieldTypes=(0,x.g)(this.detectedType),this.initialField=Object.assign({},this.field)}render(){const{field:e,canHideFields:t}=this,i=!e.selected;return(0,a.h)("div",{class:"row",role:"row"},(0,a.h)("calcite-label",{class:"cell",layout:"inline",role:"cell"},t&&(0,a.h)("calcite-checkbox",{onCalciteCheckboxChange:t=>this.fieldChange.emit({name:e.name,key:"selected",value:t.target.checked}),checked:e.selected}),(0,a.h)("span",{class:{"field-name":!0,deselected:i}},e.name)),(0,a.h)("calcite-label",{class:"cell label",role:"cell"},(0,a.h)("calcite-input",{disabled:i,onCalciteInputInput:t=>{const i=t.target.value;this.fieldChange.emit({name:e.name,key:"alias",value:i,modified:i!==this.initialField.alias})},value:e.alias||e.name}),(0,a.h)("span",{class:"screen-readers-only"},this.displayNameLabel)),(0,a.h)("calcite-select",{label:this.typeLabel,class:"cell",role:"cell","aria-sort":"none",disabled:i,onCalciteSelectChange:this.handleTypeChange},Object.keys(this.fieldTypes).filter((e=>this.allowedFieldTypes.includes(e))).map((t=>(0,a.h)("calcite-option",{selected:e.type===t,value:t,key:e.name},this.fieldTypes[t])))))}get el(){return(0,a.d)(this)}};G.style=".cell{box-sizing:border-box;width:33.333333%}.cell label{margin-top:0.75rem !important}.row{display:flex;justify-content:space-between;align-items:center;grid-gap:0.25rem;gap:0.25rem;padding:0.25rem;border-top:1px solid #eaeaea}.deselected{opacity:var(--calcite-ui-opacity-disabled)}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.label{--calcite-label-margin-bottom:0;position:relative}.field-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}";const B=class{constructor(e){(0,a.r)(this,e),this.removeCustomParameter=(0,a.c)(this,"removeCustomParameter",7),this.updateCustomParameter=(0,a.c)(this,"updateCustomParameter",7),this.itemType=void 0,this.index=void 0,this.customParameter=void 0,this.i18n=void 0,this.showAppend=!1,this.deleteButtonRef=void 0,this.deleteTooltipOpen=!1}async componentDidLoad(){this.setFocus(),await(0,r.t)(500);const e=()=>{this.deleteTooltipOpen=!0},t=()=>{this.deleteTooltipOpen=!1};this.deleteButtonRef.onfocus=e,this.deleteButtonRef.onblur=t,this.deleteButtonRef.onmouseover=e,this.deleteButtonRef.onmouseout=t}componentWillLoad(){this.handleItemTypeChange()}async setFocus(e=0){await(0,r.t)(e),this.mainInputRef.setFocus()}handleItemTypeChange(){this.showAppend=["WMS","WMTS"].some((e=>e===this.itemType))}handleInputChange(e,t){const i=e.target,a="parameter"===t?Object.assign(Object.assign({},this.customParameter),{parameter:i.value}):Object.assign(Object.assign({},this.customParameter),{value:i.value});this.updateCustomParameter.emit({index:this.index,customParameter:a})}handleCheckboxChange(e){const t=Object.assign(Object.assign({},this.customParameter),{append:e.target.checked?"layer":"all"});this.updateCustomParameter.emit({index:this.index,customParameter:t})}render(){var e,t;return(0,a.h)("div",{class:"container"},(0,a.h)("div",{class:"content-container"},(0,a.h)("div",{class:"inputs"},(0,a.h)("calcite-label",null,this.i18n.parameter,(0,a.h)("calcite-input",{placeholder:this.i18n.addParameter,value:null===(e=this.customParameter)||void 0===e?void 0:e.parameter,onCalciteInputInput:e=>this.handleInputChange(e,"parameter"),ref:e=>this.mainInputRef=e})),(0,a.h)("calcite-label",null,this.i18n.value,(0,a.h)("calcite-input",{placeholder:this.i18n.addValue,value:null===(t=this.customParameter)||void 0===t?void 0:t.value,onCalciteInputInput:e=>this.handleInputChange(e,"value")}))),(0,a.h)("div",{class:"delete-container"},(0,a.h)("button",{class:"delete-btn","aria-label":this.i18n.remove,onClick:()=>this.removeCustomParameter.emit(this.index),ref:e=>this.deleteButtonRef=e},(0,a.h)("calcite-icon",{icon:"trash",scale:"s"})),(0,a.h)("calcite-popover",{label:this.i18n.remove,pointerDisabled:!0,referenceElement:this.deleteButtonRef,open:this.deleteTooltipOpen},(0,a.h)("div",{class:"delete-btn-popover"},this.i18n.remove)))),this.showAppend&&(0,a.h)("label",{class:"checkbox"},(0,a.h)("calcite-checkbox",{checked:"layer"===this.customParameter.append,onCalciteCheckboxChange:e=>this.handleCheckboxChange(e),onClick:e=>e.preventDefault()}),this.i18n.append))}static get watchers(){return{itemType:["handleItemTypeChange"]}}};B.style=".container{margin-bottom:0.5rem;border:1px solid;border-color:var(--calcite-ui-border-1);padding:16px;max-width:100%}.content-container{display:flex}.inputs{display:flex;flex-direction:column;width:100%}@media (min-width: 864px){.inputs{flex-direction:row}}.inputs calcite-label{flex:1 1 0%}@media (min-width: 864px){.inputs calcite-label:first-child{-webkit-margin-end:12px;margin-inline-end:12px}}.delete-container{display:flex;justify-content:flex-end;align-items:center;position:relative;-webkit-margin-start:1.5rem;margin-inline-start:1.5rem;margin-top:10px}.delete-btn{cursor:pointer;border-style:none;background:transparent;height:-moz-fit-content;height:fit-content;padding:6px}.delete-btn:focus{outline:5px auto;outline-color:var(--calcite-ui-brand-hover)}.checkbox{display:flex;align-items:center}calcite-checkbox{-webkit-margin-end:5px;margin-inline-end:5px}.delete-btn-popover{white-space:nowrap;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem}";const $=class{constructor(e){(0,a.r)(this,e),this.customParameterRefList=[],this.itemType=void 0,this.customParameters=void 0,this.i18n=void 0}removeCustomParameter(e){const t=e.detail,{url:i}=d.a;if(i){const e=(0,u.r)(i,this.customParameters[t]);d.a.url=e}const{customParameters:a}=d.a;this.customParameters=a.filter(((e,i)=>i!==t)),d.a.customParameters=[...this.customParameters],this.customParameters.length<=0?this.newCustomParameterRef.focus():this.customParameterRefList[Math.max(0,t-1)].setFocus()}updateCustomParameterHandler(e){const{customParameters:t}=d.a,{index:i,customParameter:a}=e.detail;this.customParameters=t.map(((e,t)=>(t===i&&(e=a),e))),d.a.customParameters=[...this.customParameters]}async componentWillLoad(){const{customParameters:e}=d.a;this.i18n=g.u.i18n.customParameters,this.customParameters=e}createNewCustomParameter(){const{customParameters:e}=d.a;this.customParameters=[...e,{parameter:"",value:"",append:"all"}],d.a.customParameters=this.customParameters}render(){var e;const{i18n:t,itemType:i}=this;return(0,a.h)(a.H,null,(0,a.h)("calcite-label",{class:"label"},t.customParameters),(0,a.h)("p",{class:"sub-header"},t.description," ",(0,a.h)("arcgis-information",{label:t.customParameters,placement:"bottom",offsetSkidding:6,overlayPositioning:"fixed",headingLevel:3,paddedContent:!0},(0,a.h)("span",{class:"help-text"},t.helpText))),(0,a.h)("button",{class:"add",type:"submit",onClick:()=>this.createNewCustomParameter(),ref:e=>this.newCustomParameterRef=e},(0,a.h)("calcite-icon",{class:"add-icon",icon:"plus",scale:"s"}),t.newCustomParameter),null===(e=this.customParameters)||void 0===e?void 0:e.map(((e,s)=>(0,a.h)("arcgis-new-item-custom-parameter",{class:"custom-parameter",itemType:i,customParameter:e,index:s,i18n:t,ref:e=>this.customParameterRefList[s]=e}))))}get el(){return(0,a.d)(this)}};$.style=":host{font-family:Avenir Next, Avenir, Helvetica Neue, sans-serif;font-size:0.875rem;margin-bottom:14px}.label{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);line-height:16px;margin-bottom:8px}.sub-header{font-size:0.875rem;color:var(--calcite-ui-text-3);display:flex;margin-top:0px;line-height:18px}.help-text{max-width:20rem;display:block}.add{font-weight:500;font-size:0.875rem;cursor:pointer;display:flex;justify-content:center;align-items:center;font-family:Avenir Next, Avenir, Helvetica Neue, sans-serif;margin-bottom:0.5rem;transition-duration:200ms;color:var(--calcite-ui-text-link);border:none;box-shadow:none;background:transparent;padding:10px;-webkit-padding-start:0;padding-inline-start:0;line-height:16px}.add:focus,.add:focus-visible{outline:5px auto;outline-color:#00619b}.add:hover{color:#00619b}.add-icon{color:var(--calcite-ui-text-link);-webkit-margin-end:0.625rem;margin-inline-end:0.625rem}";const V=class{constructor(e){(0,a.r)(this,e),this.scale="m",this.label=void 0,this.path=void 0,this.i18n=void 0,this.labelType="bold"}async componentWillLoad(){var e,t;this.i18n=g.u.i18n.inputReadonly;const{newItemMode:i,fileName:a,originalFileName:s,url:l,provider:r,databaseProvider:n,addDataStoreType:o}=d.a,c=g.u.i18n.itemProperties;switch(i){case"file":this.label=null!==(e=this.label)&&void 0!==e?e:this.i18n.file,this.path=null!=s?s:a;break;case"url":this.label=this.i18n.url,this.path=l;break;case"dataStore":this.label=this.i18n.dataStore,this.path="cloud"===o?c[r]:null!==(t=c[n])&&void 0!==t?t:null}}render(){var e;const{labelType:t,path:i,label:s,scale:r}=this;return(0,a.h)("calcite-label",{scale:null!==(e=l.c.scale)&&void 0!==e?e:r},"overwrite"!==d.a.addAppendSelectOption&&(0,a.h)("span",{class:`label label--${t}`},s),i&&(0,a.h)("div",{class:"item-field"},i))}get el(){return(0,a.d)(this)}};V.style=":host{--arcgis-label-font-weight:400}.label{margin-top:0;margin-bottom:0;font-weight:var(--arcgis-label-font-weight)}.label--bold{--arcgis-label-font-weight:500}";const Z=class{constructor(e){(0,a.r)(this,e),this.searchUpdate=(0,a.c)(this,"searchUpdate",7),this.handleSearchInput=e=>{const t=e.target.value||"";t!==this.searchInput&&(this.searchInput=t,this.searchUpdate.emit(t))},this.handleKeyup=e=>{"Escape"!==e.key&&"Esc"!==e.key||!this.searchInput||(e.stopPropagation(),this.searchInput="")},this.searchInput="",this.controls=void 0,this.searchLabel=void 0,this.i18n=void 0}async componentWillLoad(){this.i18n=g.u.i18n.layerSearch}async focusMainInput(){this.mainInputRef.setFocus()}render(){return(0,a.h)("div",{class:"search-container"},(0,a.h)("label",{class:"screen-reader",htmlFor:"search"},this.i18n.search),(0,a.h)("calcite-input",{placeholder:`${this.i18n.search} ${this.searchLabel}`,icon:"search",type:"search",id:"search",clearable:!0,"aria-controls":this.controls,value:this.searchInput,onKeyUp:this.handleKeyup,ref:e=>this.mainInputRef=e,onCalciteInputInput:this.handleSearchInput}))}get el(){return(0,a.d)(this)}};Z.style=".screen-reader{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.search-container{width:100%}";const J=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.submenus={desktop:{title:"Platform",file:!0},mobile:{title:"SDK"},web:{title:"API"}},this.url=d.a.url,this.urlInputMessage=void 0,this.fileInputMessage=void 0,this.manifestInputMessage=void 0,this.manifestUrl=void 0,this.i18n=void 0,this.i18nURL=void 0}validateFile(e){const{title:t,fileName:i,extension:a}=(0,f.s)(e);return"zip"!==a?(this.fileInputMessage=this.i18n.selectZip,!1):(d.a.file=e,c.i.title=t,d.a.fileName=i,this.fileInputMessage=null,!0)}async navigateToNextPage(){const{url:e,i18n:t,i18nURL:i,manifestUrl:a}=this,{file:s,applicationType:r}=d.a;let n;if(e&&(0,I.i)(e,l.c.portal.isPortal))return void(this.urlInputMessage=i.httpWarning);if("desktop"===r){if(!s)return void(this.fileInputMessage=t.fileRequired);if(!this.validateFile(s))return}if(("mobile"===r||"web"===r)&&!e)return void(this.urlInputMessage=t.enterUrl);if("appExtension"===r||"experienceBuilderWidget"===r){if(!a)return void(this.manifestInputMessage=t.enterManifestUrl);const{error:e,result:i}=await(0,u.f)(this.manifestUrl);if(e)return void(this.manifestInputMessage=this.i18n[e.code]);n=i}const o={web:{type:"Web Mapping Application",typeKeywords:["Web Map","Map","Online Map","Mapping Site"],thumbnailUrl:"https://static.arcgis.com/images/webapp.png",url:e},desktop:{type:"Desktop Application",typeKeywords:["Desktop Application"],url:e},mobile:{type:"Mobile Application",typeKeywords:["ArcGIS Mobile Map","Mobile Application"],thumbnailUrl:"https://static.arcgis.com/images/mobileapp.png",url:e},appExtension:{type:"AppBuilder Extension",typeKeywords:["Widget","App Builder","widget","HTML3D"===(null==n?void 0:n.platform)?"HTML3D":"HTML"],url:a,accessInformation:(null==n?void 0:n.author)||"",text:n?JSON.stringify(n):""},experienceBuilderWidget:{type:"Experience Builder Widget",url:a,accessInformation:(null==n?void 0:n.author)||"",text:n?JSON.stringify(n):""},otherApplication:{type:"Application",typeKeywords:["Application"]}};let h="";e?h=(0,I.u)(e)||"":s?h=(0,f.s)(s).title:n&&(h=n.name||"application extension");const p=o[r];d.a.newItemMode="application",c.i.title=h,d.a.name=`${h}_${(0,L.g)()}`,d.a.type=p.type,d.a.typeKeywords=p.typeKeywords,d.a.url=p.url,d.a.accessInformation=p.accessInformation,d.a.text=p.text,this.newItemUpdatePage.emit("itemProperties")}async componentWillLoad(){const{application:e,url:t}=g.u.i18n;this.i18n=e,this.i18nURL=t;const{file:i,applicationType:a}=d.a;i?d.a.applicationType="desktop":a||(d.a.applicationType="web")}render(){const{i18n:e}=this,{applicationType:t,applicationFile:i,file:s}=d.a,r=this.submenus[t];return(0,a.h)(a.H,null,!i&&"desktop"===t&&s&&(0,a.h)("div",null,(0,a.h)("h4",{class:"label"},e.File),(0,a.h)("p",{class:"file"},s.name)),(0,a.h)("form",{novalidate:!0,onSubmit:e=>{e.preventDefault()}},(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label"},e.applicationType)),(0,a.h)("calcite-tile-select-group",{layout:"vertical"},["web","desktop","mobile",...l.c.portal.isPortal&&(0,C.e)(l.c.user)?["appExtension","experienceBuilderWidget"]:[],"otherApplication"].map((i=>(0,a.h)("calcite-tile-select",{checked:t===i,width:"full","input-enabled":!0,"input-alignment":"start",value:i,name:e[i],heading:e[i],onCalciteTileSelectChange:e=>{d.a.applicationType=e.target.value,this.urlInputMessage=null,this.fileInputMessage=null}})))),r&&(0,a.h)("div",{class:"leader"},(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label"},e.URL),(0,a.h)("calcite-input",{type:"text",value:this.url,required:"web"===t||"mobile"===t,status:this.urlInputMessage?"invalid":"idle",onCalciteInputInput:e=>{this.url=e.target.value,this.urlInputMessage=null},onFocusout:e=>{var t;e.target.value&&(null===(t=this.url)||void 0===t?void 0:t.indexOf("http"))<0&&(this.url=`https://${this.url}`)}}),(0,a.h)("calcite-input-message",{icon:!0,hidden:!this.urlInputMessage,status:"invalid"},this.urlInputMessage)),r.file&&(i||!s)&&(0,a.h)("div",{class:"leader"},(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label"},e.File),(0,a.h)("calcite-input",{type:"file",required:!0,status:this.fileInputMessage?"invalid":"idle",onCalciteInputInput:e=>{const t=e.target.shadowRoot.querySelector("input").files[0];this.validateFile(t),d.a.applicationFile=t}}),(0,a.h)("calcite-input-message",{icon:!0,hidden:!this.fileInputMessage,status:"invalid"},this.fileInputMessage)))),["appExtension","experienceBuilderWidget"].includes(t)&&(0,a.h)("div",{class:"leader"},(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label"},e.manifestUrl),(0,a.h)("calcite-input",{type:"text",required:!0,status:this.manifestInputMessage?"invalid":"idle",onCalciteInputInput:e=>{this.manifestUrl=e.target.value,this.manifestInputMessage=null}}),(0,a.h)("calcite-input-message",{icon:!0,hidden:!this.manifestInputMessage,status:"invalid"},this.manifestInputMessage)))))}get element(){return(0,a.d)(this)}};J.style=".flex-container{display:flex;justify-content:space-between}.leader{margin-top:2rem}.two-up{width:calc(50% - 2rem)}calcite-label{color:var(--calcite-ui-text-1)}.label{font-weight:500;font-size:0.875rem;margin-bottom:0;margin-top:0;line-height:18px}.file{font-size:0.875rem;color:var(--calcite-ui-text-1);margin:0;margin-bottom:2rem;padding:0}";const q=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.handlePasswordChange=e=>{this.updateValidationResponse(!0),d.a.password=e.target.value},this.handleUsernameChange=e=>{this.updateValidationResponse(!0),d.a.username=e.target.value},this.isLoading=!1,this.validationResponse={valid:!0}}async navigateToNextPage(){if(d.a.username&&d.a.password){this.isLoading=!0;try{const e=await(0,u.a)(Object.assign({},d.a)),{title:t,tags:i,snippet:a,description:s,serviceInfo:l,serviceUsername:r,servicePassword:n,spatialReference:o,proxyUrl:h,extent:p,thumbnailToken:m}=e;if(c.i.title=t||c.i.title,c.i.tags=i,c.i.snippet=a,d.a.description=s,d.a.serviceInfo=l,d.a.serviceUsername=r,d.a.servicePassword=n,d.a.spatialReference=o,d.a.thumbnailToken=m,d.a.proxyUrl=h,d.a.extent=p,this.isLoading=!1,(0,u.i)(d.a.url,l))return void this.newItemUpdatePage.emit("hybridImageSelect");this.newItemUpdatePage.emit("itemProperties")}catch(e){console.error(e),this.validationResponse={valid:!1,message:this.i18n.invalid},this.isLoading=!1}}else this.validationResponse={valid:!1,message:this.i18n.requiresCredentials}}handleLoadChange(e,t){this.newItemToggleNavigationEnabled.emit(t)}async componentWillLoad(){this.i18n=g.u.i18n.auth,this.urlTypei18n=g.u.i18n.urlType,d.a.serviceInfo=null}updateValidationResponse(e){this.validationResponse.valid||(this.validationResponse={valid:e})}render(){const{i18n:e,urlTypei18n:t,validationResponse:i,isLoading:s}=this,{valid:l,message:r}=i;return(0,a.h)(a.H,null,(0,a.h)("arcgis-new-item-loader",{type:"indeterminate",value:d.a.uploadProgress,active:s,text:t.getServiceInfo}),(0,a.h)("calcite-label",{for:"username"},e.enterUsername,(0,a.h)("calcite-input",{onCalciteInputInput:this.handleUsernameChange,id:"username",placeholder:e.enterUsername,value:d.a.username,status:l?"idle":"invalid"})),(0,a.h)("calcite-label",{for:"password"},e.enterPassword,(0,a.h)("calcite-input",{type:"password",onCalciteInputInput:this.handlePasswordChange,id:"password",placeholder:e.enterPassword,value:d.a.password,status:l?"idle":"invalid",required:!0}),(0,a.h)("calcite-input-message",{icon:!l,hidden:l,status:l?"idle":"invalid"},r)))}get element(){return(0,a.d)(this)}static get watchers(){return{isLoading:["handleLoadChange"]}}};var K;!function(e){e.Single="single",e.Multi="multi",e.Children="children",e.MultiChildren="multi-children",e.Ancestors="ancestors"}(K||(K={}));const Q=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.inView={},this.searchUpdateHandler=e=>{const t=e.detail;this.searchInput=t;const i=t.toLowerCase();this.filteredLayers=this.getDisplayLayers(function e(a){const s=[];return a.forEach((a=>{if(a.title.toLowerCase().replace(/[\u202F\u00A0]/g," ").includes(i)||!t)s.push(Object.assign({},a));else{const t=e(a.subLayers);t.length&&s.push(Object.assign({},a,{subLayers:t,expanded:!0}))}})),s}(this.layers))},this.handleLayerSelect=e=>{const t=e.target.selectedItems.map((e=>e.getAttribute("id"))),i=Object.keys(this.selectedLayerIdTracker.idMap).filter((e=>!this.inView[e])),a=t.length+i.length,s={};t.forEach((e=>s[e]=!0)),i.forEach((e=>s[e]=!0));const l={count:a,idMap:s};d.a.selectedLayerIdTracker=l,this.selectedLayerIdTracker=l,this.noLayersSelected=!!this.noLayersSelected&&a<=0},this.getDisplayLayers=(e=this.layers,t=[])=>{let i=0;for(const a of e)if(i>=1e3)this.usePro=!0,(this.isLayerSelected(a)||this.containsSelected(a))&&t.push(a);else if(i++,a.subLayers.length>0){const e=this.countSublayers(a);e>=1e4?t.push(Object.assign(Object.assign({},a),{subLayers:[]})):(i+=e,t.push(a))}else t.push(a);return t.sort(((e,t)=>e.title>t.title?1:-1)),t},this.countSublayers=e=>{if(e.subLayers.length<=0)return 0;let t=e.subLayers.length;return e.subLayers.forEach((e=>{t+=this.countSublayers(e)})),t},this.renderTree=e=>{var t;const i=e.id,s=e.expanded||!1,l=this.isLayerSelected(e),r=this.containsSelected(e);return(0,a.h)("calcite-tree-item",{key:i,id:i,selected:l||e.visible,expanded:r&&!l||s,ref:()=>this.inView[i]=!0},(0,a.h)("span",null,e.title),(null===(t=e.subLayers)||void 0===t?void 0:t.length)?(0,a.h)("calcite-tree",{selectionMode:K.Ancestors,slot:"children"},e.subLayers.map(this.renderTree)):null)},this.managedFocus=!0,this.layers=[],this.filteredLayers=[],this.searchInput="",this.selectedLayerIdTracker={count:0,idMap:{}},this.usePro=void 0,this.noLayersSelected=!1,this.allLayersSelected=void 0}async componentWillLoad(){var e,t;const i=g.u.i18n;this.i18n=i.bulkLayerSelect,this.isAddToMapTerminalPage()&&(g.u.nextText=d.a.addAsBasemap?"useAsBaseMap":"addToMap");const{layers:a,selectedLayerIdTracker:s}=d.a;this.layers=a&&(null===(e=a[0])||void 0===e?void 0:e.id)?a:this.addIds(a),this.filteredLayers=this.getDisplayLayers(),this.selectedLayerIdTracker={count:null!==(t=null==s?void 0:s.count)&&void 0!==t?t:0,idMap:s?Object.assign({},s.idMap):{}}}onTransitionComplete(){var e;null===(e=this.layerSearchRef)||void 0===e||e.focusMainInput()}handleNext(){if(0===this.selectedLayerIdTracker.count)this.noLayersSelected=!0;else{const e=this.setVisibility(this.layers).filter((e=>e.visible)).map((e=>{const{name:t,title:i,queryable:a,subLayers:s}=e;return{name:t,title:i,queryable:a,subLayers:s}}));d.a.layers=e,this.isAddToMapTerminalPage()?this.workflowComplete.emit({type:d.a.type,url:encodeURI(d.a.url),customParameters:d.a.customParameters,layers:e,addAsBasemap:d.a.addAsBasemap}):this.newItemUpdatePage.emit("itemProperties")}}isAddToMapTerminalPage(){return"map"===g.u.workflow}isLayerSelected(e){return!!this.selectedLayerIdTracker.idMap[e.id]}setVisibility(e){return e.map((e=>(e.visible=this.isLayerSelected(e),e.subLayers&&(e.subLayers=this.setVisibility(e.subLayers)),e)))}addIds(e){return e.map((e=>(e.subLayers&&(e.subLayers=this.addIds(e.subLayers)),e.id=(0,L.g)(),e.visible=!1,e)))}containsSelected(e){var t;return null===(t=e.subLayers)||void 0===t?void 0:t.some((t=>{const i=this.isLayerSelected(e);if(t.subLayers){const e=this.containsSelected(t);return i||e}return i}))}handleSelectAll(){const e={};let t=0;const i=a=>{a.forEach((a=>{e[a.id]||(t+=1),e[a.id]=!0,a.subLayers&&i(a.subLayers)}))};this.allLayersSelected||(i(this.layers),this.allLayersSelected=!0);const a={count:t,idMap:e};this.selectedLayerIdTracker=a,d.a.selectedLayerIdTracker=a}checkSelectionStatus(e){return e.every((e=>{const t=this.isLayerSelected(e);if(e.subLayers){const i=this.checkSelectionStatus(e.subLayers);return t&&i}return t}))}render(){this.inView={};const{i18n:e,usePro:t,searchUpdateHandler:i,handleLayerSelect:s,renderTree:l,handleSelectAll:r,filteredLayers:n,noLayersSelected:o}=this;return this.allLayersSelected=this.checkSelectionStatus(this.filteredLayers),(0,a.h)("div",{class:"outer-container"},(0,a.h)("calcite-notice",{class:"layer-notice",icon:"information",open:t,width:"full"},(0,a.h)("p",{slot:"message"},e.usePro)),(0,a.h)("strong",{class:"select-item-message"},e.selectLayers),(0,a.h)("arcgis-new-item-layer-search",{onSearchUpdate:i,controls:"layer-select-tree",searchLabel:e.layers,ref:e=>this.layerSearchRef=e}),0===n.length?(0,a.h)("strong",{class:"layer-not-found-message"},e.noLayersFound):(0,a.h)("div",{class:"layer-select-tree"},this.searchInput.length>=1?null:(0,a.h)("calcite-button",{appearance:"transparent",class:"select-all",onClick:r.bind(this)},this.allLayersSelected?this.i18n.deselectAll:e.selectAll),(0,a.h)("calcite-tree",{onCalciteTreeSelect:s,selectionMode:K.Ancestors},n.map(l))),(0,a.h)("arcgis-new-item-alert",{active:o,heading:e.errorTitle,description:e.noLayersSelected}))}get el(){return(0,a.d)(this)}};Q.style=".outer-container{display:flex;flex-direction:column}.layer-select-tree{width:100%;overflow-y:auto}.layer-notice{margin-bottom:1.5rem}.select-item-message{font-weight:500;font-size:0.875rem;margin-bottom:0.25rem}.layer-not-found-message{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-2);text-align:center;width:100%;margin-top:1.5rem}.select-all{margin-top:5px;margin-left:5px}";const Y=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.updateFilter=()=>{this.searching=!0;const e=this.select.querySelector("calcite-option[selected]");this.filter=e.value,this.search()},this.debouncedInput=(0,r.d)((async e=>{this.searching=!0,this.searchTerm=e.target.value,this.search()}),400),this.managedFocus=!0,this.loading=!0,this.loadingText="",this.searching=void 0,this.files=[],this.moreResults=void 0,this.searchTerm="",this.filter="csv",this.selected=void 0,this.error=void 0,this.i18n=void 0}async componentWillLoad(){this.i18n=g.u.i18n.cloud;const e=d.a.cloudProvider;this.loadingText=this.i18n[e],this.provider=(0,k.g)(e)}async componentDidLoad(){var e;try{await this.provider.connect(),await this.search(),await(0,r.t)(200),null===(e=this.mainInputRef)||void 0===e||e.setFocus(),"map"!==g.u.workflow||d.a.existingItem||this.removeExistingFile()}catch(e){this.parseError(e)}this.loading=!1}async navigateToNextPage(){if(this.selected){const{title:e,fileName:t,extension:i}=(0,f.a)(this.selected.name);d.a.dataUrl=this.selected.downloadUrl,d.a.fileName=t,d.a.extension=i,d.a.newItemMode="file",d.a.cloudProviderResource={cloudProvider:(0,k.a)(d.a.cloudProvider),id:this.selected.id,mimeType:this.selected.mimeType,cloudDriveFileName:this.selected.name,cloudFileType:this.filter},d.a.selectedFields=void 0,c.i.title=e;const a=(0,w.f)(i);if("googlesheets"===this.selected.mimeType){await this.removeExistingFile(),d.a.type="Microsoft Excel",d.a.extension="xls";const e=!1===l.c.allowPublish?"itemProperties":"publishSelect";this.newItemUpdatePage.emit(e)}else if(1===a.length){await this.removeExistingFile(),d.a.type=a[0].type;const e=a[0].nextStep,t=!1===l.c.allowPublish&&"publishSelect"===e?"itemProperties":e;this.newItemUpdatePage.emit(t)}else"zip"===i&&this.newItemUpdatePage.emit("zipSelect")}else this.error={title:this.i18n.errorTitle,message:this.i18n.errorMessage}}async removeExistingFile(){const e=d.a.id;e&&(d.a.id=null,await(0,v.d)(e,{permanentDelete:!0}))}async search(e){this.moreResults=!1,this.error=null;const t=await this.provider.search({searchText:this.searchTerm,dropdownFilter:this.filter,next:e});this.files=e?[...this.files,...t.files]:[...t.files],this.moreResults=t.next,this.selected=null,this.searching=!1}getFilterOptions(){const e=["csv","excel","zip","geojson"];return"google drive"===d.a.cloudProvider&&e.push("googlesheets"),e}renderFiles(){const{files:e,selected:t,i18n:i,moreResults:s}=this;return(null==e?void 0:e.length)?(0,a.h)("div",null,!this.error&&(0,a.h)("ul",{class:"files"},e.map((e=>(0,a.h)("li",{class:{files__item:!0,"files__item--active":e.id===(null==t?void 0:t.id)},key:e.id},(0,a.h)("label",{class:"file",htmlFor:`input-${e.id}`},(0,a.h)("calcite-icon",{icon:k.c[e.mimeType]||"file-text",scale:"s",class:"file__icon"}),(0,a.h)("input",{type:"radio",id:`input-${e.id}`,name:"file",value:e.id,checked:(null==t?void 0:t.id)===e.id,onChange:()=>{this.selected=e,this.error=null},class:"screen-readers-only"}),(0,a.h)("span",{class:"file__title"},e.name),(0,a.h)("span",{class:"file__type","aria-hidden":"true"},k.b[e.mimeType]||i.file),e.size&&(0,a.h)("span",{class:"file__size","aria-hidden":"true"},(0,f.f)(e.size))))))),s&&(0,a.h)("calcite-button",{"icon-start":"plus",class:"next",appearance:"transparent",onClick:()=>this.search(!0)},i.viewMore)):(0,a.h)("div",{class:"no-results"},i.noResults)}parseError(e){this.error="popupBlocked"===e?this.i18n.error.popup:this.i18n.error.generic}render(){const{loading:e,loadingText:t,files:i,i18n:s,filter:l,searching:r,error:n}=this;return(0,a.h)(a.H,null,e&&!i.length?(0,a.h)("arcgis-new-item-loader",{active:!0,text:t,type:"indeterminate"}):(0,a.h)("div",{class:"table"},(0,a.h)("calcite-input",{type:"search",icon:"search",class:"input",onCalciteInputInput:this.debouncedInput,label:s.searchFiles,ref:e=>this.mainInputRef=e},(0,a.h)("calcite-select",{label:s.filterFileType,ref:e=>this.select=e,onCalciteSelectChange:this.updateFilter,slot:"action",class:"select"},this.getFilterOptions().map((e=>{var t;return(0,a.h)("calcite-option",{selected:l===e,value:e,label:null!==(t=s.fileType[e])&&void 0!==t?t:k.b[e]})})))),(0,a.h)("fieldset",{class:{table__body:!0,"table__body--center":r||!i.length}},(0,a.h)("legend",{class:"screen-readers-only"},s.selectAFile),this.searching?(0,a.h)("div",{class:"loader"},(0,a.h)("arcgis-new-item-loader",{active:!0,text:s.loadingFiles})):this.renderFiles())),(0,a.h)("arcgis-new-item-alert",{heading:null==n?void 0:n.title,description:null==n?void 0:n.message,active:!!n,onAlertDismiss:()=>{this.error=null}}))}get el(){return(0,a.d)(this)}};Y.style='.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.table{display:flex;flex-direction:column;border-style:none;margin:0;min-height:35rem}.table__body{margin:0;padding:0;outline:2px solid transparent;outline-offset:2px;border-style:none;flex:1 1 0%}.table__body--center{display:flex;align-items:center;justify-items:center}.input{width:100%;margin-bottom:1rem;display:block}.select{min-width:10rem;-webkit-margin-start:0.5rem;margin-inline-start:0.5rem}.files{padding:0;list-style-type:none;margin:0 -0.5rem}.files__item{position:relative;width:100%}.files__item:before{display:block;position:absolute;bottom:0;content:"";right:0.5rem;left:0.5rem;border-top:1px solid var(--calcite-ui-border-3);transition:all 150ms ease-in-out;z-index:2}.files__item:hover:before,.files__item:focus-within:before{border-top-color:#009AF2}.files__item--active:before{border-top-color:transparent}.file{padding-top:0.75rem;padding-bottom:0.75rem;padding-left:0.5rem;padding-right:0.5rem;margin:0;display:flex;color:var(--calcite-ui-text-2);font-size:0.875rem;width:100%;box-sizing:border-box;border-radius:0;cursor:pointer;font-weight:400;align-items:center;background-color:white;transition:all 150ms ease-in-out;outline:1px solid transparent;outline-offset:-1px;font-family:inherit;border:none;text-align:initial}.files__item--active .file{background-color:rgba(0, 121, 193, 0.04);outline-color:#009AF2}.file__icon{color:var(--calcite-ui-brand);flex:0}.file__title{font-weight:500;padding-left:0.75rem;padding-right:0.75rem;font-size:0.875rem;flex:1 1 0%}.file__type{width:30%;flex:0 1 auto}.file__size{text-align:inline-end;width:6rem;flex:0 1 auto}.no-results{text-align:center;width:100%;display:block}.next{display:block;margin:0}.error{position:absolute;bottom:1rem;right:1rem;inset-inline-end:1rem;z-index:2}';const X=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.fieldsSearched=!1,this.fieldsModified={},this.addDirectToMap=!1,this.handleTimezoneChange=e=>{d.a.timezone=e.detail},this.updateModifiedFields=e=>{const{name:t,key:i,modified:a}=e;this.fieldsModified[t]?this.fieldsModified[t][i]=a?1:0:this.fieldsModified[t]={type:"type"===i&&a?1:0,alias:"alias"===i&&a?1:0}},this.handleFieldTypeFilter=e=>{this.selectedFieldTypeFilter=e.target.selectedOption.value},this.handleSearchChange=e=>{this.fieldsSearched=!0,this.searchTerm=e.target.value},this.getFilteredFields=()=>{this.filteredFields=this.fields.reduce(((e,t)=>(!(!this.searchTerm||t.name.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1||t.alias.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1)||"default"!==this.selectedFieldTypeFilter&&this.selectedFieldTypeFilter!==t.type||(e[t.name]=t),e)),{})},this.handleSelectAllToggle=()=>{this.fields=this.fields.map((e=>this.filteredFields[e.name]?Object.assign(Object.assign({},e),{selected:!this.allSelected}):e))},this.clearSelection=()=>{this.fields=this.fields.map((e=>Object.assign(Object.assign({},e),{selected:!1})))},this.logCSVFieldChanges=e=>{const t=l.c.telemetry,i={type:0,alias:0},a=this.fields.length,s=Object.keys(e).length;for(const e in this.fieldsModified)i.type+=this.fieldsModified[e].type,i.alias+=this.fieldsModified[e].alias;const r={eventType:"other",pageName:"my content",category:"new item csv time zone and fields",details:this.fieldsSearched?"fields searched":"no fields searched",label:this.initialTimezone===d.a.timezone?"default timezone":"timezone changed",count:a,number:a-s,size:i.alias,position:i.type};null==t||t.logEvent(r)},this.selectedFieldTypeFilter="default",this.fields=void 0,this.filteredFields=void 0,this.searchTerm=void 0,this.i18n=void 0,this.allSelected=void 0}handleNext(){const e=this.fields.reduce(((e,t)=>{var i,a;return t.selected&&(delete t.selected,"esriFieldTypeString"===t.type&&(null===(a=null===(i=this.fieldsModified)||void 0===i?void 0:i[t.name])||void 0===a?void 0:a.type)&&(t.length=4e3),e[t.name]=t),e}),{});d.a.selectedFields=e,this.logCSVFieldChanges(e),this.isAddToMapTerminalPage()?this.workflowComplete.emit({type:d.a.type,url:encodeURI(d.a.url),customParameters:d.a.customParameters,results:{analyzeResults:d.a.analyzeResults,fields:d.a.selectedFields}}):"GeoJson"===d.a.type?this.newItemUpdatePage.emit("itemProperties"):this.newItemUpdatePage.emit("csvLocationFields")}fieldsChanged(){this.getFilteredFields()}isAddToMapTerminalPage(){const{newItemMode:e,type:t}=d.a;return"map"===g.u.workflow&&"url"===e&&"CSV"!==t}async componentWillLoad(){const e=g.u.i18n;this.i18n=e.csvFields,this.isAddToMapTerminalPage()&&(g.u.nextText="addToMap");const{backupLayerFields:t}=d.a,i=(0,x.a)().fields,a={};i.forEach((e=>a[e.name]=!0)),this.fields=t.map((e=>{var t,i;return Object.assign(Object.assign({},null!==(i=null===(t=d.a.selectedFields)||void 0===t?void 0:t[e.name])&&void 0!==i?i:e),{selected:!!a[e.name]})})),this.getFilteredFields(),this.initialTimezone=d.a.timezone,this.addDirectToMap="map"===g.u.workflow&&!d.a.enablePublishing}async componentDidLoad(){var e;this.scrollContainer&&(null===(e=null===navigator||void 0===navigator?void 0:navigator.vendor)||void 0===e?void 0:e.includes("Apple"))&&(this.scrollContainer.style.overflow="hidden",await(0,r.t)(100),this.scrollContainer.style.overflow="auto")}updateField(e){const{name:t,key:i,value:a}=e.detail;this.fields=this.fields.map((s=>(s.name===t&&(s[i]=a,this.updateModifiedFields(e.detail)),s)))}render(){const{i18n:e,addDirectToMap:t}=this;this.allSelected=Object.keys(this.filteredFields).every((e=>this.filteredFields[e].selected));const i=!t&&"append"!==g.u.workflow,s=this.fields.filter((e=>e.selected)).length,l=this.fields.some((e=>"esriFieldTypeDate"===e.type)),r=d.a.timezone,n=[e.fieldName,e.displayName,e.type];return(0,a.h)("section",{class:"fields-container"},(0,a.h)("arcgis-new-item-description",{class:"description",header:e.fieldTitle,content:e[d.a.enablePublishing?"fieldDescription":"fieldNoHostedDescription"]}),(0,a.h)("div",{class:"search-container"},(0,a.h)("calcite-label",{class:"field-search"},(0,a.h)("calcite-input",{onCalciteInputInput:this.handleSearchChange,type:"search",placeholder:e.searchFields}),(0,a.h)("span",{class:"screen-readers-only"},e.searchFields)),(0,a.h)("calcite-select",{label:e.fieldType,onCalciteSelectChange:this.handleFieldTypeFilter,class:"field-select",width:"half"},(0,a.h)("calcite-option",{selected:"default"===this.selectedFieldTypeFilter,value:"default"},e.allTypes),Object.keys(e.fieldTypes).map((t=>{const i=e.fieldTypes[t];return(0,a.h)("calcite-option",{selected:this.selectedFieldTypeFilter===t,value:t},i)})))),(0,a.h)("div",{class:"field-table",role:"table"},(0,a.h)("div",{class:"chip-container "+(0===s||i?"":"not-visible")},(0,a.h)("calcite-chip",{class:"chip",value:s},s," ",e.selected),(0,a.h)("button",{onClick:this.clearSelection,class:"clear-selection"},e.clearSelection)),(0,a.h)("div",{class:"header-row "+(0===Object.keys(this.filteredFields).length?"hide":""),role:"row"},n.map(((e,t)=>0===t&&i?(0,a.h)("calcite-label",{layout:"inline",class:"header-cell",role:"columnheader","aria-sort":"none"},(0,a.h)("calcite-checkbox",{checked:this.allSelected,onCalciteCheckboxChange:this.handleSelectAllToggle}),e):(0,a.h)("span",{class:"header-cell",role:"columnheader","aria-sort":"none"},e)))),Object.keys(this.filteredFields).length>0?(0,a.h)("div",{class:"fields-scroll-container",ref:e=>{this.scrollContainer=e}},Object.keys(this.filteredFields).map((t=>{var s,l;const r=this.filteredFields[t];return(0,a.h)("arcgis-new-item-csv-field",{detectedType:null===(l=null===(s=null===d.a||void 0===d.a?void 0:d.a.backupLayerFields)||void 0===s?void 0:s.find((e=>e.name===r.name)))||void 0===l?void 0:l.type,onFieldChange:this.updateField.bind(this),field:r,fieldTypes:e.fieldTypes,defaultChecked:r.selected,canHideFields:i,displayNameLabel:e.displayNameLabel.replace("${name}",r.name),typeLabel:e.typeLabel.replace("${name}",r.name)})}))):(0,a.h)("calcite-input-message",{icon:!0,status:"valid"},e.noFields)),l&&!t&&(0,a.h)("arcgis-new-item-timezone-dropdown",{onTimezoneChange:this.handleTimezoneChange,defaultTimezone:r}))}get el(){return(0,a.d)(this)}static get watchers(){return{fields:["fieldsChanged"],selectedFieldTypeFilter:["fieldsChanged"],searchTerm:["fieldsChanged"]}}};X.style=".fields-container{display:flex;flex-direction:column;height:100%}.field-table{margin-bottom:1.5rem;display:flex;flex-direction:column;min-height:15rem}.search-container{display:flex;width:100%}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.field-search{-webkit-margin-end:8px;margin-inline-end:8px;width:75%}.field-select{width:25%}.fields-scroll-container{overflow-y:auto;flex:1 1 auto;transform:translateZ(0)}.header-row{display:flex;align-content:flex-start;justify-content:center;color:var(--calcite-ui-text-1);font-size:0.875rem;grid-gap:0.25rem;gap:0.25rem;padding:0.25rem}.header-cell{width:100%}.hide{display:none}.chip-container{margin-top:1rem;margin-bottom:1rem}.chip{font-weight:700}.clear-selection{border-style:none;cursor:pointer;padding:0;border-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-size:0.75rem;font-weight:500;color:var(--calcite-ui-text-2);margin-left:0.75rem;margin-right:0.75rem;font-family:Avenir Next, Avenir, Helvetica Neue, sans-serif;background:transparent}.clear-selection:hover{text-decoration:underline;cursor:pointer}.not-visible{visibility:hidden;height:0}.description{margin-bottom:1rem}";const ee=class{constructor(e){(0,a.r)(this,e),this.workflowCancel=(0,a.c)(this,"workflowCancel",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.workflowCancelled=!1,this.handleRequest=async()=>{var e,t,i;if(!await this.validate())return;const{newItemMode:a,existingItem:s,type:n}=d.a,{categories:o}=c.i,{portal:h}=l.c;let p,m,f="featureLayer"===a;const w=c.i.title;(null==w?void 0:w.length)>250&&(c.i.title=w.substring(0,250));try{!function(){const e=l.c.telemetry;null==e||e.startWorkflow("new item upload",{eventType:"workflow",category:"new item upload",details:d.a.type,pageName:R})}(),({addResponse:p,publishResponse:m}=s&&"file"===a?await this.publishExistingItem():await this.handleAddItem());const w=[null==p?void 0:p.id,null==m?void 0:m.id].filter((e=>e));if(o&&await(0,v.u)(h,w,o),"KML"===n){const{config:t,portal:i,api:a}=l.c;await(0,u.p)(null!==(e=p.id)&&void 0!==e?e:d.a.id,i,t.restBaseUrl,t,a)}if(this.workflowCancelled)(null==m?void 0:m.id)&&await(0,v.d)(m.id,{permanentDelete:!0}),p.id&&await(0,v.d)(p.id,{permanentDelete:!0}),this.workflowCancel.emit();else{let e;if(function(){var e,t;const i=l.c.telemetry,{title:a,folder:s,categories:r,tags:n,snippet:o}=c.i,{initialTitle:h,initialFolders:p}=d.a,u=!s||s.title===s.id,m=!!p.map((e=>e.id)).find((e=>e===s.id)),g={eventType:"other",pageName:R,category:"new item item info",label:a===h?"default title":"title changed",action:(null==o?void 0:o.length)>0?"summary":"no summary",count:null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0,number:null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0};g.details=m?u?"root folder":"custom folder":"new folder",null==i||i.logEvent(g)}(),function(){const{type:e,applicationType:t,customParameters:i,selectedLayerIdTracker:a}=d.a,s=l.c.telemetry,r=g.u.telemetryDetails;null==s||s.endWorkflow("new item upload",{details:e,pageName:R});const n={eventType:"other",pageName:R,category:E,label:E,details:r};"url"===r?(n.attribute=e,(null==i?void 0:i.length)>0&&(n.action="customParams"),"WMS"===e&&(n.count=null==a?void 0:a.count)):t&&(n.attribute=t),null==s||s.logEvent(n)}(),d.a.addTileLayerOption&&(0,S.a)(),l.c.telemetry&&await(0,r.t)(750),this.isAddToMapTerminalPage())if("url"===a)e=Object.assign(Object.assign({url:d.a.url,customParameters:d.a.customParameters,type:d.a.type,addAsBasemap:d.a.addAsBasemap},m?{id:m.id,serviceUrl:m.serviceUrl}:{}),d.a.storeAuth?{id:p.id}:{});else{let a;a=m?{type:m.serviceType,id:m.id,jobId:m.jobId,serviceUrl:m.serviceUrl,results:{sourceItemInfo:{id:null!==(t=null==p?void 0:p.id)&&void 0!==t?t:null==s?void 0:s.id,type:null!==(i=d.a.type)&&void 0!==i?i:null==s?void 0:s.type}}}:Object.assign({type:d.a.type,id:p.id},d.a.analyzeResults&&d.a.selectedFields?{results:{analyzeResults:d.a.analyzeResults,fields:d.a.selectedFields}}:{}),e=a}else e=Object.assign({id:null==p?void 0:p.id,item:Object.assign({},d.a),response:p,emptyLayerCreated:f,newItemMode:a},m);this.workflowComplete.emit(e)}(0,y.r)()}catch(e){"featureLayer"===a&&(0,U.f)(JSON.stringify(e)),console.error(e),this.error=e,this.showLoader(!1)}},this.preprocessAddItem=()=>{"3dTiles"===d.a.tileLayerPublishType&&(d.a.typeKeywords=[...d.a.typeKeywords.filter((e=>!p.t.includes(e))),d.a.tilesLayer3dTilesLayerType])},this.itemType=void 0,this.error=void 0,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.i18n=void 0}async validate(){var e,t;if(!await this.itemPropertiesFolderRef.saveActiveFolder())return!1;const i=await(null===(e=this.titleRef)||void 0===e?void 0:e.validateTitle());if(i)return this.error="titleInUseService"===i.code?{code:"serviceNameExists"}:i,this.titleRef.focusMainInput(),!1;const a=await(null===(t=this.summaryRef)||void 0===t?void 0:t.getErrorMessage());return!a||(this.error=a,!1)}async navigateToNextPage(){this.handleRequest()}async handleError(){const{error:e}=this,t="string"==typeof e?e:null==e?void 0:e.message;(null==t?void 0:t.includes("Service name"))&&!d.a.existingItem&&await(0,v.d)(d.a.id,{permanentDelete:!0})}isAddToMapTerminalPage(){return"map"===g.u.workflow}shouldUpdatePreviouslyCreatedItem(){const{type:e,enablePublishing:t,file:i}=d.a;return"map"===g.u.workflow&&"CSV"===e&&!t&&!!i&&i.size>u.M}async componentWillLoad(){const e=g.u.i18n.itemProperties;this.i18n=e;const{newItemMode:t}=d.a;this.isAddToMapTerminalPage()?g.u.nextText="createAndAddToMap":g.u.nextText="dataStore"===t?"createConnection":"save",d.a.initialFolders=l.c.folders,d.a.initialTitle=c.i.title;const{enablePublishing:i,fileName:a,type:s,storeAuth:r}=d.a;"map"===g.u.workflow&&(this.descriptionInfo={title:a?(0,A.r)(e.howWillAdd,a,"fileName"):e.howWillAddService,content:r?e.howWillAddSecuredServiceDescription:i?e.howWillAddHostedDescription:(0,A.r)(e.howWillAddDescription,"GeoJson"===s?"GeoJSON":s,"fileType")})}async handleAddItem(){const{file:e,fileName:t,newItemMode:i,type:a,enablePublishing:s,serviceInfo:r,typeKeywords:n,tags:o,extent:h,selectedServiceInfoLayersNames:p,addFeatureLayerType:m}=d.a;let g,y;switch(this.preprocessAddItem(),i){case"file":this.showLoader(!0,{loaderType:(null==e?void 0:e.size)>u.M?"determinate":"indeterminate",loaderMessage:(0,A.r)(this.i18n.uploading,t,"fileType")}),this.shouldUpdatePreviouslyCreatedItem()?({addResponse:g}=await this.handleFileUpdate()):({addResponse:g,publishResponse:y}=await this.handleFileUpload()),d.a.file||d.a.dataUrl||(this.workflowCancelled=!0);break;case"url":this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.adding,d.a.url,"fileType")}),"CSV"!==a&&"GeoJson"!==a||!s?g=await(0,u.h)(d.a,l.c.config,l.c.api):({addResponse:g,publishResponse:y}=await this.handleFileUpload());break;case"featureLayer":this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.creating,"feature layer","fileType")}),g=await(0,u.c)({serviceInfo:r,typeKeywords:n,tags:o,extent:h,selectedServiceInfoLayersNames:p,addFeatureLayerType:m}),(0,U.a)();break;case"tileLayer":case"sceneLayer":this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.publishing,"sceneLayer"===i?"scene service":"tile layer","fileType")}),({addResponse:g,publishResponse:y}=await this.addTileLayer());break;case"rasterFunctionTemplate":this.showLoader(!0,{loaderType:(null==e?void 0:e.size)>u.M?"determinate":"indeterminate",loaderMessage:(0,A.r)(this.i18n.uploading,t,"fileType")}),d.a.file=new File([""],`${c.i.title}.rft.json`),({addResponse:g,publishResponse:y}=await this.handleFileUpload());break;case"application":this.showLoader(!0,{loaderType:(null==e?void 0:e.size)>u.M?"determinate":"indeterminate",loaderMessage:(0,A.r)(this.i18n.adding,d.a.type,"fileType")}),g=await(0,u.b)(d.a,l.c.config.restBaseUrl,"Application"===a?{redirect_uris:["urn:ietf:wg:oauth:2.0:oob"],appType:"multiple"}:void 0);break;case"dataStore":const{addDataStoreType:f,provider:w}=d.a;this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.addDataStore,this.i18n["cloud"===f?w:f],"fileType")}),g=await(0,P.a)(d.a,c.i.title,c.i.tags,c.i.categories,c.i.snippet);break;case"developerCredentials":this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.creating,d.a.type,"fileType")}),g=await this.addDeveloperCredentialApplication();break;default:this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:(0,A.r)(this.i18n.creating,d.a.type,"fileType")}),g=await(0,v.c)(d.a)}return{addResponse:g,publishResponse:y}}async publishExistingItem(){const{id:e,type:t}=d.a;let i={success:!0,id:e,folder:null};const a="Image Collection"===t?await this.publishImageCollection(i):await this.publishService(e);return await(0,F.a)(a),["Shapefile","File Geodatabase","CSV","Microsoft Excel","GeoJson","GeoPackage","Feature Collection"].includes(t)&&({addResponse:i}=await this.handleFileUpdate(a.id)),{addResponse:i,publishResponse:a}}async handleFileUpload(){var e;const{type:t,enablePublishing:i,cloudProviderResource:a,geoJSONResource:s,csvResource:l}=d.a;let r,n;const o="CSV"!==t&&"Microsoft Excel"!==t;if(i){if("Image Collection"===t?(r=await this.addFile(),n=await this.publishImageCollection(r)):(o||!a&&!d.a.id?(r=await this.addFile({title:c.i.title}),d.a.id=r.id,n=await this.publishService(r.id)):(await(0,v.e)(d.a.id,(0,v.f)({title:c.i.title,tags:c.i.tags,snippet:c.i.snippet})),({addResponse:r,publishResponse:n}=await this.publishExistingItem())),await(0,F.a)(n)),this.updateFolder(n),a||s||l){"zip"===(null==a?void 0:a.mimeType)&&(a.zipItemType=t);try{await(0,u.d)(null!==(e=null!=a?a:s)&&void 0!==e?e:l,n.id)}catch(e){}}}else r=a&&!o&&d.a.id?await(0,v.e)(d.a.id,(0,v.f)({title:c.i.title,tags:c.i.tags,snippet:c.i.snippet})):await this.addFile({title:c.i.title});return{addResponse:r,publishResponse:n}}async handleFileUpdate(e){this.updateLoader("indeterminate",this.i18n.uploading.replace("${type}",d.a.fileName));const t=await(0,v.e)(null!=e?e:d.a.id,(0,v.f)({title:c.i.title,tags:c.i.tags,snippet:c.i.snippet}));return this.updateFolder(t),{addResponse:t}}async addDeveloperCredentialApplication(){const{developerCredentialsRedirectUrls:e,applicationEnvironment:t,developerCredentialsType:i,apiKeyReferrerUrls:a,developerPrivileges:r}=d.a;return(0,u.b)(d.a,(0,s.g)(l.c.portal),"oauth"===i?{appType:t,redirect_uris:e}:{appType:"apikey",redirect_uris:e,httpReferrers:a,privileges:r})}async addFile(e){const t=await(0,u.e)(e);return this.updateLoader("indeterminate",this.i18n.checkingStatus),await(0,F.c)(t),t}async updateFolder(e){const{id:t,file:i,cloudProviderResource:a}=d.a,s=c.i.folder;if((null==i?void 0:i.size)>u.M||a){const i=[];t&&i.push(t),(null==e?void 0:e.id)&&i.push(null==e?void 0:e.id),s.id!==s.username&&await(0,v.m)(i.join(","),s.id)}}async publishService(e){var t,i,a,s,r,n,o,h;this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:this.i18n.publishingService});const{result:p}=await(0,F.p)({itemId:e,user:l.c.user,extension:d.a.extension,type:d.a.type,title:c.i.title});if(!(null===(t=p.services)||void 0===t?void 0:t.length)||0==!(null===(a=null===(i=p.services)||void 0===i?void 0:i[0])||void 0===a?void 0:a.success))throw this.i18n.errorPublishing;if(null===(r=null===(s=p.services[0])||void 0===s?void 0:s.error)||void 0===r?void 0:r.message)throw null===(o=null===(n=p.services[0])||void 0===n?void 0:n.error)||void 0===o?void 0:o.message;const u=null===(h=p.services)||void 0===h?void 0:h[0];return{id:null==u?void 0:u.serviceItemId,jobId:null==u?void 0:u.jobId,serviceType:null==u?void 0:u.type,serviceUrl:null==u?void 0:u.serviceurl}}async publishImageCollection(e){var t,i,a,s;const{config:r,user:n,portal:o}=l.c;this.showLoader(!0,{loaderType:"indeterminate",loaderMessage:this.i18n.publishingService});const d=(0,M.c)(e,c.i.title,{config:r,user:n,portal:o});try{for(var h,p=!0,u=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(i){t[i]=e[i]&&function(t){return new Promise((function(a,s){!function(e,t,i,a){Promise.resolve(a).then((function(t){e({value:t,done:i})}),t)}(a,s,(t=e[i](t)).done,t.value)}))}}}(d);!(t=(h=await u.next()).done);){s=h.value,p=!1;try{const e=s;if("string"!=typeof e)return{id:e.serviceItemId,jobId:null,serviceType:e.type,serviceUrl:e.serviceurl};this.updateLoader("indeterminate",this.i18n[e])}finally{p=!0}}}catch(e){i={error:e}}finally{try{p||t||!(a=u.return)||await a.call(u)}finally{if(i)throw i.error}}}async addTileLayer(){const{dataset:e,dataStoreId:t,serverId:i}=d.a,{folder:a,categories:s}=c.i;let r;if(e){const{result:s,error:n}=await(0,P.p)({type:e.type,serviceName:c.i.title,pathInCachedStore:e.path,cacheStoreId:t,serverId:i,folder:a,description:c.i.snippet,tags:c.i.tags},l.c.portal);if(n)throw n;s&&(r={id:s.serviceItemId,serviceType:s.type,serviceUrl:s.serviceUrl})}else if("3dTiles"!==d.a.tileLayerPublishType){const{tileLayerPublishContent:e,tileLayerPublishType:t,tileLayerData:i}=d.a,{title:n,tags:o,snippet:h}=c.i;r=await(0,m.p)(e,{user:l.c.user,publishType:t,folder:a,title:n,tags:o,categories:s,snippet:h},i)}return{addResponse:{success:!0,id:r.id,folder:null},publishResponse:r}}showLoader(e,t){t&&this.updateLoader(t.loaderType,t.loaderMessage),e?(this.newItemToggleNavigationEnabled.emit(!1),this.loading=!0):(this.newItemToggleNavigationEnabled.emit(!0),this.loading=!1)}updateLoader(e,t){this.loaderType=e,this.loaderMessage=t}parseError(){var e,t,i,a,s,l;const{i18n:r,error:n}=this;if("string"!=typeof n&&(0,u.j)(n)){const e=n.code;let t;"itemExists"!==e&&"fileExists"!==e||(t={link:n.itemUrl,text:r.alreadyExists.linkText});let i=r.errorTitle,a=n.translatedMessage;if(a||"fileExists"!==e||(i=r.alreadyExists.title,a=(0,A.r)(r.alreadyExists.description,this.fileName,"fileName")),"failToPublishFromDataStore"===e){const{newItemMode:e}=d.a,t=r.failDatastorePublish;i=t.title,a=(0,A.r)(t.description,"sceneLayer"===e||"tileLayer"===e?t[e]:"","fileType")}return"serviceNameExists"===e&&({title:i,description:a}=r.serviceNameExists),{title:i,description:a,linkInfo:t}}if((0,u.k)(n)){const e=n.details[0];if(null==e?void 0:e.includes("must be uploaded directly to an ArcGIS Server site")){const e=r.arcgisServerUpload;return{title:e.title,description:e.description}}if(e.includes("spatial reference must be either a geographic or projected coordinate system")){const e=r.invalidSpatialRef;return{title:e.title,description:e.description}}}const o=("string"==typeof n?n:null==n?void 0:n.message)||(null==n?void 0:n.statusMessage)||r.errorDescription;if(!o)return{title:r.errorTitle,description:r.errorDescription};const{fileName:c,file:h}=d.a,p=o.toLowerCase();switch(!0){case null===(e=p.includes)||void 0===e?void 0:e.call(p,"already exists"):if(p.includes("file")||p.includes("item"))return{title:r.alreadyExists.title,description:r.alreadyExists.description.replace("${fileName}",c||(null==h?void 0:h.name))};if(o.includes("Service name"))return r.serviceNameExists;break;case null===(t=o.includes)||void 0===t?void 0:t.call(o,"GeoJson doesn't have 'type'"):return r.invalidGeoJSON;case null===(i=o.includes)||void 0===i?void 0:i.call(o,"GeoJson file is not a valid json"):return r.invalidJSON;case null===(a=o.includes)||void 0===a?void 0:a.call(o,"Invalid Shapefile"):return{title:r.invalidShapefile.title,description:r.invalidShapefile.description};case null===(s=o.includes)||void 0===s?void 0:s.call(o,"Invalid File Geodatabase"):return r.invalidGeodatabase;case null===(l=o.includes)||void 0===l?void 0:l.call(o,"error publishing"):return{title:r.errorTitle,description:r.errorPublishing}}return{title:r.errorTitle,description:r.errorDescription}}render(){const{descriptionInfo:e,loading:t}=this,{title:i,description:s,linkInfo:r}=this.parseError(),{newItemMode:n,type:o,enablePublishing:h}=d.a,{user:p}=l.c,u="Service Definition"===o&&h,m="map"===g.u.workflow;return(0,a.h)(a.H,{class:{"overflow-hidden":t}},m&&"url"===n&&(0,a.h)("div",{class:"info-container"},(0,a.h)("arcgis-new-item-input-readonly",null)),e&&(0,a.h)("div",{class:"info-container"},(0,a.h)("arcgis-new-item-description",{class:"layer-description",header:e.title,content:e.content,scale:"s",contentScale:"m"})),(0,a.h)("arcgis-new-item-loader",{type:this.loaderType,value:d.a.uploadProgress,active:this.loading,text:this.loaderMessage}),["file","url","dataStore"].includes(n)&&!m&&(0,a.h)("div",{class:"info-container"},(0,a.h)("arcgis-new-item-input-readonly",null)),"Geocoding Service"===o&&(0,a.h)("div",null,(0,a.h)("h5",{class:"locator__heading"},this.i18n.item),(0,a.h)("p",{class:"locator__description"},g.u.i18n.createLayersList["url"===n?"locatorHeading":"locatorViewHeading"])),(0,a.h)("arcgis-item-properties",null,!u&&(0,a.h)("arcgis-title-input",{class:"medium",currentFolder:c.i.folder,type:d.a.type,enablePublishing:d.a.enablePublishing,update:this.shouldUpdatePreviouslyCreatedItem(),ref:e=>this.titleRef=e,onArcgisTitleInputChange:()=>{this.error=null}}),(0,a.h)("arcgis-folder-picker",{class:"medium",ref:e=>this.itemPropertiesFolderRef=e,onArcgisFolderPickerLoad:({detail:e})=>{var t;null!==(t=d.a.initialFolders)&&void 0!==t||(d.a.initialFolders=e)}}),!(0,C.n)(p)&&(0,a.h)("arcgis-categories-picker",{class:"medium"}),(0,a.h)("arcgis-tags-picker",{class:"medium"}),(0,a.h)("arcgis-summary-input",{class:"medium",ref:e=>this.summaryRef=e}),"Notebook"===o&&(0,a.h)("arcgis-notebook-runtime-select",{class:"medium"})),(0,a.h)("arcgis-new-item-alert",{heading:i,description:s,active:!!this.error,link:{href:null==r?void 0:r.link,title:null==r?void 0:r.text},onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.d)(this)}static get watchers(){return{error:["handleError"]}}};ee.style=".layer-description.sc-arcgis-new-item-pages-item-properties{display:block;margin-bottom:0.75rem}.locator__heading.sc-arcgis-new-item-pages-item-properties{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);line-height:18px;margin-bottom:2px}.locator__description.sc-arcgis-new-item-pages-item-properties{font-size:0.875rem;color:var(--calcite-ui-text-1);margin:0;margin-bottom:1rem;padding:0}.medium.sc-arcgis-new-item-pages-item-properties{--arcgis-label-font-weight:500}.info-container.sc-arcgis-new-item-pages-item-properties{margin-bottom:1.5rem}";const te=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,a.c)(this,"newItemPrevPage",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.canSkipPublishSelect=!1,this.updateSelectedSheet=async({currentTarget:e})=>{const t=parseInt(e.selectedOption.value);d.a.selectedSheet=isNaN(t)?0:t,this.newItemToggleNavigationEnabled.emit(!1),d.a.selectedFields=null,d.a.analyzeResults=null,d.a.backupLayerFields=null,await this.analyze(d.a.existingItem||d.a.cloudProviderResource?"item":"file")&&this.newItemToggleNavigationEnabled.emit(!0)},this.deleteCurItem=async()=>{try{d.a.id&&(this.isDeletingOldFile=!0,await(0,v.d)(d.a.id,{permanentDelete:!0}),d.a.id=null,this.isDeletingOldFile=!1)}catch(e){console.warn("Delete item failed",e)}},this.selected="hosted",this.loading=void 0,this.isDeletingOldFile=void 0,this.loaderType="indeterminate",this.alertContent=void 0,this.tip=void 0,this.loaderMessage=void 0,this.publishSelectOption=null,this.i18n=void 0,this.itemInfoI18N=void 0,this.duplicateItemUrl=null}async handleNext(){"3dTiles"===d.a.tileLayerPublishType&&(d.a.tilesLayer3dTilesLayerType=this.publishSelectOption.tilesLayer3dTilesLayerType);const{customParameters:e,url:t,type:i,newItemMode:a,file:s}=d.a,r="hosted"===this.selected,n="map"===g.u.workflow;if(d.a.enablePublishing=r,this.isAddToMapTerminalPage())this.workflowComplete.emit({type:i,url:encodeURI(t),customParameters:e});else{if("url"===a&&"CSV"===i&&n){if(!await this.analyze("url"))return}else{if(this.duplicateItemUrl&&r)return void this.handleError({code:"itemExists",itemUrl:this.duplicateItemUrl});const e=["Json","Tile Package","Vector Tile Package","Service Definition","Scene Package","GeoPackage","3DTiles Package","GeoJson"],t=l.c.telemetry,a={eventType:"other",pageName:"my content",category:"new item add csv file"};if(e.indexOf(i)>-1||!r&&!n)return"CSV"===i&&(a.details="csv only",null==t||t.logEvent(a)),void this.newItemUpdatePage.emit("itemProperties");if("CSV"===i&&!await this.analyze(d.a.cloudProviderResource?"cloud":s?"file":"url"))return;a.details="csv and hosted feature layer",null==t||t.logEvent(a)}this.newItemUpdatePage.emit("fileField")}}async handlePrev(e){e.preventDefault(),await this.deleteCurItem();const{type:t}=d.a;"CSV"!==t&&"Microsoft Excel"!==t||(d.a.selectedFields=void 0),this.newItemPrevPage.emit()}determineHint(e){if(!(0,w.i)(e.size))return;const{i18n:t}=this,{user:i,portal:a}=l.c,s=g.u.i18n.common.learnMore;let r,n="brand";!i||(0,C.n)(i)?(r=t.bigGeoJsonHintPublicAccount,n="danger"):r=(0,b.a)(i,"GeoJson",a)?t.bigGeoJsonHint:t.bigGeoJsonHintNoPrivilege,this.alertContent={title:r,linkText:s,link:void 0,color:n}}shouldDisableNonHosted(){const{file:e,type:t}=d.a;return"map"===g.u.workflow&&"GeoJson"===t&&e&&(0,w.i)(e.size)}updateLoader(e,t){this.loaderType=e,this.loaderMessage=t}async connectedCallback(){var e,t,i;this.i18n=g.u.i18n.publishSelect,this.itemInfoI18N=g.u.i18n.itemTypeInfo;const{type:a,id:r,existingItem:n,newItemMode:o,cloudProviderResource:c,file:h,tileLayerPublishType:u}=d.a,{user:m,portal:y,config:{helpMap:f,helpBase:v}}=l.c;if(m){const{error:e,result:t}=await(0,s.f)((()=>(0,s.i)(y,m)),"isPortalBackedBySDS",y.id);e||(l.c.portal.isBackedBySDS=t)}const w="map"===g.u.workflow,S="Microsoft Excel"===a;if(n){if(!await this.analyze("item"))return;if("CSV"===a||S&&1===(null===(e=d.a.analyzeResults.publishParameters.layers)||void 0===e?void 0:e.length))return void this.newItemUpdatePage.emit("fileField")}!S||(0,C.n)(m)||n||(r?await this.analyze("item"):(d.a.selectedSheet=0,await this.analyze(c?"cloud":"file"))),w&&(this.selected="url"!==o&&(0,b.a)(m,a,y)||this.shouldDisableNonHosted()?"hosted":"non-hosted",this.isAddToMapTerminalPage()&&(g.u.nextText="addToMap")),this.canSkipPublishSelect=_({directMode:w,isMultipageExcel:S&&(null===(t=d.a.excelLayers)||void 0===t?void 0:t.length)>1,newItemMode:o,cloud:!!c,fromExistingItem:!!n,itemType:a,canPublishItemType:(0,b.a)(m,a,y)}),this.canSkipPublishSelect&&("url"===o&&(this.selected="non-hosted"),this.handleNext()),(0,C.o)(y)&&m||(this.selected="non-hosted"),"Scene Package"!==a||(0,b.h)(m)||(this.selected="non-hosted",this.handleNext()),"GeoJson"===a&&"map"===g.u.workflow&&(h?this.determineHint(h):d.a.url&&(this.tip={title:this.i18n.largeGeoJsonConditionDescription,linkText:g.u.i18n.common.learnMore,link:`${v}${f[120003923]}`})),"3dTiles"===u&&(this.publishSelectOption={tileLayerPublishType:u,tilesLayer3dTilesLayerType:null!==(i=d.a.tilesLayer3dTilesLayerType)&&void 0!==i?i:p.D})}isAddToMapTerminalPage(){const{selected:e}=this,{newItemMode:t,type:i}=d.a;return"map"===g.u.workflow&&"url"===t&&"GeoJson"===i&&"non-hosted"===e}async analyze(e,t=!1){var i;const{fileName:a,file:s,url:r,dataUrl:n,id:o,extension:c,type:h}=d.a,{portal:p,user:m,config:g,lang:y}=l.c;this.updateLoader("indeterminate",this.i18n.analyze.replace("${fileName}",a.length>0?a:r)),this.loading=!0;const f="cloud"===e;let b=null;if(f||"CSV"===h&&s&&(0,w.a)(s.size)||t){const e=await(0,v.h)(d.a.fileName,null===(i=(0,w.f)(c)[0])||void 0===i?void 0:i.type);if(e)return this.handleError({code:"itemExists",itemUrl:e}),this.loading=!1,!1;if(!d.a.id){const e=(0,L.g)();(null==s?void 0:s.size)>u.M&&this.updateLoader("determinate",this.i18n.uploading.replace("${item}",a));const t=await(f?u.l:u.e)({title:e,filename:e});this.updateLoader("indeterminate",this.i18n.analyze.replace("${fileName}",a.length>0?a:r));try{await(0,F.c)(t)}catch(e){return this.handleError({code:"unhandledError"}),this.loading=!1,!1}const i=t.id;({error:b}=await(0,D.a)({analyzeArgs:{type:"item",itemid:i},configArgs:{portal:p,user:m,config:g,lang:y},itemArgs:{itemType:h},initialize:!0})),d.a.id=i}}else if(({error:b}=await(0,D.a)({analyzeArgs:"url"===e?{type:"url",sourceUrl:null!=r?r:n}:"file"===e?{type:"file",file:s}:{type:"item",itemid:o},configArgs:{portal:p,user:m,config:g,lang:y},itemArgs:{itemType:h},initialize:!0})),"timeout"===(null==b?void 0:b.code))return this.analyze(e,!0);return this.loading=!1,b&&this.handleError(b),!b}handleError(e){const{i18n:t}=this;switch(this.duplicateItemUrl=null,this.alertContent=null,e.code){case"itemExists":this.duplicateItemUrl=e.itemUrl;const i=d.a.fileName;this.alertContent={title:t.error.alreadyExists.title,description:t.error.alreadyExists.desciption.replace("${fileName}",i),link:e.itemUrl,linkText:t.error.alreadyExists.linkText};break;case"emptyFile":this.alertContent={title:t.error.title,description:t.error.emptyFile};break;case"duplicateFieldNames":this.alertContent=t.error.duplicateFields;break;default:this.alertContent=t.error}}getDisplayType(e,t){var i,a,s;let l=e;return"googlesheets"===(null===(i=d.a.cloudProviderResource)||void 0===i?void 0:i.mimeType)?l="Google Sheets":"json"===t&&(l="JSON"),null!==(s=null!==(a=this.itemInfoI18N.lowercaseDisplayName[l])&&void 0!==a?a:l)&&void 0!==s?s:""}getOptionText(e,t){const i="hosted"===e,{i18n:a,itemInfoI18N:s}=this,{dataUrl:l,fileName:r,type:n}=d.a,o="map"===g.u.workflow;return o?i?{title:a.hostedMVTitle,description:a.hostedMVDescription}:{title:l?a.addDirectlyUrlTitle:a.addDirectlyTitle,description:l?a.addDirectlyUrlDescription:a.addDirectlyDescription}:"GeoJSON"===t&&l?a.geoJSONFromURL[i?"hosted":"nonHosted"]:{title:(0,A.r)(i?a.hostedTitle[o&&"CSV"===n?"CSVNoTable":t]||a.hostedTitle[n]:s.nonHostedTitle,r,"fileName"),description:(0,A.r)(i?a.hostedDescription[t]||a.hostedDescription[t.toLowerCase()]||a.hostedDescription[n]||a.hostedDescription[n.toLowerCase()]:s.nonHostedDescription,t,"fileType")}}renderOption(e,t){const{title:i,description:s}=this.getOptionText(e,t);return(0,a.h)("calcite-tile-select",{checked:e===this.selected,onCalciteTileSelectChange:e=>{this.selected=e.target.value,g.u.nextText=this.isAddToMapTerminalPage()?"addToMap":"next"},description:s,heading:i,name:s,"input-enabled":!0,"input-alignment":"start",type:"radio",value:e,width:"full",id:`${e}-input-option`,disabled:"non-hosted"===e&&this.shouldDisableNonHosted()})}renderSheetSelect(){var e;const{excelLayers:t}=d.a;return t&&1!==t.length?(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label label--leader"},this.i18n.publishThisSheet),(0,a.h)("calcite-select",{label:"",onCalciteSelectChange:this.updateSelectedSheet.bind(this),value:null!==(e=String(d.a.selectedSheet))&&void 0!==e?e:"0",class:"constrain"},t.map(((e,t)=>(0,a.h)("calcite-option",{value:t,selected:t===d.a.selectedSheet},e.name))))):null}render3dTilesSelect(){const{i18n:e,publishSelectOption:t}=this;if("3dTiles"!==(null==t?void 0:t.tileLayerPublishType))return null;const{tilesLayer3dTilesLayerType:i}=t;return(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label label--leader"},e["3dTiles"].layerType),(0,a.h)("calcite-select",{label:"",onCalciteSelectChange:({currentTarget:e})=>{const i=e.selectedOption.value;t.tilesLayer3dTilesLayerType=i},value:t.tilesLayer3dTilesLayerType,class:"constrain"},p.t.map((e=>(0,a.h)("calcite-option",{value:e,selected:e===i},"3DObject"===e?"3D Objects":"Integrated Mesh")))))}render(){const{extension:e,type:t,existingItem:i}=d.a,{portal:s,user:r}=l.c,n=this.getDisplayType(d.a.type,e),{loaderType:o,itemInfoI18N:c,loading:h,loaderMessage:p,selected:u,alertContent:m,isDeletingOldFile:y,tip:f,canSkipPublishSelect:v}=this,w="map"===g.u.workflow,S="GeoJson"===t&&(0,b.a)(r,"GeoJson",s),T="CSV"===t&&(0,b.a)(r,"CSV",s),x=!i&&(!w||!v&&(S||T));return(0,a.h)("div",null,(0,a.h)("arcgis-new-item-loader",{type:o,value:d.a.uploadProgress,active:h,text:p}),(0,a.h)("arcgis-new-item-loader",{type:"indeterminate",active:y}),(0,a.h)("arcgis-new-item-input-readonly",null),x&&(0,a.h)("fieldset",{class:"fieldset"},(0,a.h)("legend",{class:"label"},c.howToAdd),(0,a.h)("calcite-tile-select-group",{layout:"vertical"},["hosted","non-hosted"].filter((e=>(0,C.o)(s)||"hosted"!==e)).map((e=>this.renderOption(e,n))))),"Microsoft Excel"===t&&"hosted"===u&&"append"!==g.u.workflow&&this.renderSheetSelect(),this.render3dTilesSelect(),(0,a.h)("calcite-notice",{open:!!f,class:"notice--tip",icon:!0,scale:"s"},(0,a.h)("div",{slot:"title"},null==f?void 0:f.title),(null==f?void 0:f.description)&&(0,a.h)("div",{slot:"message"},null==f?void 0:f.description),(null==f?void 0:f.link)&&(0,a.h)("calcite-link",{slot:"link",href:null==f?void 0:f.link,target:"_blank"},null==f?void 0:f.linkText)),(0,a.h)("arcgis-new-item-alert",{heading:null==m?void 0:m.title,description:null==m?void 0:m.description,link:{href:null==m?void 0:m.link,title:null==m?void 0:m.linkText},active:!!m,onAlertDismiss:()=>this.alertContent=null,scale:"s"}))}get el(){return(0,a.d)(this)}};te.style=".label{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);margin-bottom:1rem;padding-top:1rem;display:block;line-height:18px}.label--leader{margin-top:0.75rem;margin-bottom:0.5rem;font-weight:400}.fieldset{margin:0;padding:0;border-style:none}.constrain{max-width:360px}.notice--tip{margin-top:1.5rem}";const ie=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.selectWMTSLayer=e=>{var t;const{serviceInfo:i}=d.a;i.selectedLayer=e,d.a.serviceInfo=i,d.a.selectedLayer=e,d.a.tileMatrices=4===l.c.api?e.tileMatrixSets.toArray():e.tileMatrixSetInfos,d.a.selectedTileInfo=null===(t=d.a.tileMatrices)||void 0===t?void 0:t[0],c.i.title=e.title},this.selectWFSLayer=async e=>{const{serviceInfo:t,maxFeatures:i}=d.a,{name:a,extent:s,title:r}=e,n={layerName:a,mode:"snapshot",title:r||a,fullExtent:s,maxFeatures:i||3e3};if(3===l.c.api)await t.selectLayer(n,(()=>{t.selectedLayer=n;const e="esriGeometryComplex"===t.geometryType;t.isComplex=e;const i=t.url.trim();d.a.isComplex=e,d.a.serviceInfo=t,d.a.selectedLayer=n,d.a.url=i,c.i.title=n.title}));else{t.layerName=a,t.maxFeatures=n.maxFeatures,t.selectedLayer=n;const e="esriGeometryComplex"===t.geometryType;t.isComplex=e;const i=t.url.trim();d.a.isComplex=e,d.a.serviceInfo=t,d.a.selectedLayer=n,d.a.url=i,c.i.title=t.title}},this.handleSearchUpdate=e=>{const t=d.b.layers.filter((t=>!e.detail||t.title.toLowerCase().indexOf(e.detail)>-1));this.filteredLayers=t},this.handleTileChange=()=>{const e=this.getSelectOption(this.tileSelectRef),t=d.b.tileMatrices.find((t=>t[4===l.c.api?"id":"tileMatrixSet"]===e));d.a.selectedTileInfo=t},this.handleMaxFeatureChange=e=>{d.a.maxFeatures=parseInt(e.target.value)},this.handleGeometryChange=()=>{this.selectedGeometry=this.getSelectOption(this.geometrySelectRef),d.a.geometryType=this.selectedGeometry},this.renderSelectMenus=()=>{const{type:e,maxFeatures:t,tileMatrices:i,isComplex:s}=d.b,{i18n:r,handleGeometryChange:n,handleMaxFeatureChange:o,handleTileChange:c}=this;return"WFS"===e?(0,a.h)("div",{class:"select-container"},(0,a.h)("calcite-label",{class:"select-item"},(0,a.h)("strong",{class:"select-item-message"},r.maxFeature),(0,a.h)("calcite-input",{onCalciteInputInput:o,value:`${t}`,"number-button-type":"vertical",min:0,type:"number"})),s&&(0,a.h)("calcite-label",{class:"select-item"},(0,a.h)("strong",{class:"select-item-message"},r.featureType),(0,a.h)("calcite-select",{label:"",class:"select-geometry",onCalciteSelectChange:n,ref:e=>this.geometrySelectRef=e},(0,a.h)("calcite-option",{selected:"default"===this.selectedGeometry,disabled:!0,value:"default",label:r.selectGeometry}),(0,a.h)("calcite-option",{value:"esriGeometryPoint",label:r.points}),(0,a.h)("calcite-option",{value:"esriGeometryPolyline",label:r.lines}),(0,a.h)("calcite-option",{value:"esriGeometryPolygon",label:r.polygons})))):(null==i?void 0:i.length)>1?(0,a.h)("div",{class:"select-container"},(0,a.h)("calcite-label",{class:"select-item"},(0,a.h)("strong",{class:"select-item-message"},r.selectTile),(0,a.h)("calcite-select",{label:"",onCalciteSelectChange:c,ref:e=>this.tileSelectRef=e},i.map((e=>{const t=3===l.c.api?e.tileMatrixSet:e.id;return(0,a.h)("calcite-option",{value:t,label:t})}))))):void 0},this.managedFocus=!0,this.selectedLayer=void 0,this.selectedGeometry="default",this.filteredLayers=void 0,this.errorMessage="",this.i18n=void 0}onTransitionComplete(){var e;null===(e=this.layerSearchRef)||void 0===e||e.focusMainInput()}async handleNext(){const{isComplex:e}=d.b;if(e&&"default"===this.selectedGeometry)return this.errorMessage=this.i18n.selectGeometryError,void this.geometrySelectRef.setFocus();const{type:t}=d.a;"WFS"===t&&await this.selectWFSLayer(this.selectedLayer),this.isAddToMapTerminalPage()?this.workflowComplete.emit({type:d.a.type,url:encodeURI(d.a.url),customParameters:d.a.customParameters,layers:[this.selectedLayer],addAsBasemap:d.a.addAsBasemap}):this.newItemUpdatePage.emit("itemProperties")}async handleLayerChange(e){if(e)if("WMTS"===d.b.type){const t=d.b.layers.find((t=>(3===l.c.api?t.identifier:t.id)===e));this.selectedLayer=t,this.selectWMTSLayer(t)}else if("WFS"===d.b.type){const t=d.b.layers.find((t=>t.name===e));await this.selectWFSLayer(t),this.selectedLayer=t,this.selectedGeometry="default"}else{const t=d.b.layers.find((t=>t.title===e));this.selectedLayer=t,(0,u.m)(t)}}isAddToMapTerminalPage(){return"map"===g.u.workflow}async componentWillLoad(){const e=g.u.i18n;this.i18n=e.singleLayerSelect,this.isAddToMapTerminalPage()&&(g.u.nextText=d.a.addAsBasemap?"useAsBaseMap":"addToMap"),"WFS"===d.b.type&&(d.a.maxFeatures=3e3,await this.selectWFSLayer(d.a.serviceInfo.layers[0])),"WMTS"===d.b.type&&this.selectWMTSLayer(d.a.serviceInfo.layers[0]),this.filteredLayers=d.b.layers;const t="OGCFeatureServer"===d.b.type,i=t?"title":"WFS"===d.b.type?"layerName":"identifier";this.selectedLayer=d.b.layers.find((e=>{var a;return e[t?"title":" name"]===(null===(a=d.b.selectedLayer)||void 0===a?void 0:a[i])}))||d.b.layers[0],d.a.selectedLayer=this.selectedLayer}getSelectOption(e){const t=null==e?void 0:e.querySelector("calcite-option[selected]");return null==t?void 0:t.value}render(){var e;const{renderSelectMenus:t,i18n:i,selectedLayer:s}=this,r="WMTS"===d.b.type,n="OGCFeatureServer"===d.b.type,o=n?"title":r?3===l.c.api?"identifier":"id":"name",c=this.filteredLayers.length>=1e3;return(0,a.h)("div",{class:"outer-container"},(0,a.h)("calcite-notice",{class:"layer-notice",icon:"information",open:c,width:"full"},(0,a.h)("p",{slot:"message"},i.usePro)),(0,a.h)("strong",{class:"select-item-message"},i.selectLayer),(0,a.h)("div",null,(0,a.h)("arcgis-new-item-layer-search",{searchLabel:"layers",onSearchUpdate:this.handleSearchUpdate,ref:e=>this.layerSearchRef=e}),(0,a.h)("div",{class:"layer-container"},0===this.filteredLayers.length?(0,a.h)("strong",{class:"layer-not-found-message"},i.noLayersFound):(0,a.h)("calcite-radio-button-group",{name:"layer-select",role:"radiogroup",layout:"vertical",onCalciteRadioButtonGroupChange:e=>this.handleLayerChange(e.target.selectedItem.value)},null===(e=this.filteredLayers)||void 0===e?void 0:e.slice(0,1e3).map((e=>{const t=e[o],i=e.title;let l=!1;return t===s[o]&&(l=!n||e.id===s.id),(0,a.h)("calcite-label",{layout:"inline",for:t,class:{"layer-item":!0,selected:l}},(0,a.h)("calcite-radio-button",{class:"radio",checked:l,id:t,name:t,value:t}),i||t)}))))),t(),(0,a.h)("arcgis-new-item-alert",{active:!!this.errorMessage,description:this.errorMessage,onAlertDismiss:()=>this.errorMessage=""}))}get el(){return(0,a.d)(this)}};ie.style=".outer-container{display:flex;flex-direction:column}.layer-container{overflow:auto;overflow-x:hidden;box-sizing:border-box;display:flex;max-height:212px;height:30vh;border:1px solid var(--calcite-ui-border-1);border-top:0;width:100%}calcite-radio-button-group{width:100%}.layer-item{padding:12px 12px 0}.layer-notice{margin-bottom:1.5rem}.layer-input-message{font-weight:400;color:var(--calcite-ui-text-3);font-size:0.875rem}.layer-not-found-message{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-2);text-align:center;width:100%;margin-top:1.5rem}.selected{background-color:rgba(0, 121, 193, 0.05)}.select-container{display:flex;justify-content:space-between;margin-top:1.5rem}.select-item{width:45%}.select-item-message{font-weight:500;font-size:0.875rem;margin-bottom:0.25rem}";const ae=class{constructor(e){var t;(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.addDirectToMap=!1,this.urlOptions=[{value:"AGS",icon:"server",show:!0},{value:"Document Link",icon:"file-code",show:!(0,C.n)(l.c.user)},{value:"GeoJson",icon:"brackets-curly",show:!0},{value:"KML",icon:"layer-kml",show:!0},{value:"OGCFeatureServer",icon:"feature-layer",show:!0},{value:"WFS",icon:"feature-layer",show:!0},{value:"WMS",icon:"layer-map",show:!0},{value:"WMTS",icon:"tile-layer",show:!0},{value:"GeoRSS",icon:"file-text",show:"map"===g.u.workflow},{value:"CSV",icon:"file-csv",show:"map"===g.u.workflow||!(null===(t=l.c.portal)||void 0===t?void 0:t.isPortal)},{value:"Tile Layer",icon:"tile-layer",show:"map"===g.u.workflow}],this.setServiceInfoState=e=>{Object.keys(e).forEach((t=>{const i=e[t];(e=>["url","type","newItemMode","serviceInfo","isSecured","allowStoredAuth","storeAuth","hybridImageServiceSetting","addAsBasemap","dataUrl","fileName","geoJSONResource","title","tags","snippet"].includes(e))(t)?this.urlData[t]=i:d.a[t]=i}))},this.isAddToMapTerminalPage=()=>{var e;const{selectedOption:t,urlData:{url:i,serviceInfo:a},addDirectToMap:s}=this;return s&&((0,N.i)(this.urlData.type)&&!this.urlData.storeAuth&&a||(0,I.s)(t))&&!(0,u.i)(i,a)&&(!["WMS","WFS","WMTS","CSV","GeoJson","OGCFeatureServer"].includes(t)||(0,N.i)(this.urlData.type)||"GeoJson"===t&&!l.c.user||(null===(e=l.c.portal)||void 0===e?void 0:e.isPortal)&&["CSV","GeoJson"].includes(t))},this.determineNextText=()=>{const{urlData:e,isAddToMapTerminalPage:t,showAddToMap:i}=this;g.u.nextText="next",t()&&(g.u.nextText="addToMap",i()&&e.addAsBasemap&&(g.u.nextText="useAsBaseMap"))},this.showAddToMap=()=>{const{urlData:e,addDirectToMap:t}=this,{url:i="",serviceInfo:a}=e;return t&&(["Tile Layer","WMS","WMTS","Vector Tile Service","Image Service","Map Service"].includes(e.type)||(0,u.i)(i,a))},this.handleAuthSwitchChange=e=>{this.urlData.storeAuth=e.detail},this.handleLoaderUpdate=e=>{this.loading=e.detail},this.resetError=()=>{this.error=!1,this.errorMessage=""},this.open=!1,this.selectedOption=null,this.previousSelectedOption=null,this.i18n=void 0,this.error=!1,this.errorMessage=void 0,this.loading=!1,this.loaderText=void 0,this.urlData={}}async handleNext(){var e,t;const{urlData:i,selectedOption:a,itemUrlRef:s,i18n:l,selectRef:r}=this,{customParameters:n}=d.a;if(await(null==s?void 0:s.validateInput()))return void s.focusMainInput();if(this.loading)return;if(!a)return r.setFocus(),this.errorMessage=l.undetected,void(this.error=!0);this.loading=!0;const o=await this.handlePageTransition();if(this.loading=!1,o){if((0,u.i)(i.url,null===(e=this.urlData)||void 0===e?void 0:e.serviceInfo))return this.assignStoreState(),void this.newItemUpdatePage.emit(this.urlData.storeAuth?"auth":"hybridImageSelect");this.isAddToMapTerminalPage()&&(this.loading=!0,this.workflowComplete.emit({type:i.type,url:encodeURI(i.url),customParameters:n,addAsBasemap:null!==(t=this.urlData.addAsBasemap)&&void 0!==t&&t}),this.loading=!1),this.setNextPage(),this.assignStoreState(),this.newItemUpdatePage.emit(this.nextPage)}else this.itemUrlRef.focusMainInput(),this.error=!0}assignStoreState(){const{url:e,type:t,allowStoredAuth:i,storeAuth:a,title:s,tags:l,snippet:r,serviceInfo:n,isSecured:o,addAsBasemap:h}=this.urlData,p=this.selectedOption;d.a.url=e,d.a.storeAuth=a,d.a.type=t,d.a.allowStoredAuth=i,d.a.newItemMode="url",d.a.serviceInfo=n,d.a.isSecured=o,d.a.addAsBasemap=null!=h&&h;const u=e.split("/"),m=u[u.length-1];"GeoJson"===p&&e&&(d.a.dataUrl=e,d.a.title=m.replace(C.q,"").replace(C.s,""),d.a.fileName=m,d.a.extension="json","map"!==g.u.workflow&&(d.a.newItemMode="file"),d.a.geoJSONResource={fileName:m,url:e,mimeType:"geojson"}),"CSV"===p&&(d.a.type="CSV",d.a.dataUrl=e,d.a.fileName=(0,I.u)(e),d.a.extension="csv",d.a.csvResource={fileName:m,url:e,mimeType:"csv"}),s&&(c.i.title=s.replace(C.s,"")),l&&(c.i.tags=l),r&&(c.i.snippet=r)}async componentWillLoad(){var e;const{type:t,url:i,serviceInfo:a,isSecured:s,allowStoredAuth:r,storeAuth:n,addAsBasemap:o,title:c}=d.a;this.urlData={url:i,type:t,allowStoredAuth:r,storeAuth:n,serviceInfo:a,isSecured:s,addAsBasemap:o,title:c},this.changeOption(null!==(e=t)&&void 0!==e?e:null),this.addDirectToMap="map"===g.u.workflow,this.i18n=g.u.i18n.urlType,this.loaderText=this.i18n.getServiceInfo,l.c.allowedItemTypes&&(this.urlOptions=this.urlOptions.filter((e=>{var t,i;return"AGS"===e.value?null===(t=l.c.allowedItemTypes)||void 0===t?void 0:t.some((e=>(0,N.i)(e))):null===(i=l.c.allowedItemTypes)||void 0===i?void 0:i.includes(e.value)})),this.allowedItemTypes=l.c.allowedItemTypes.filter((e=>!l.c.portal.isPortal||"map"===g.u.workflow||"CSV"!==e))),this.options=this.urlOptions.filter((({show:e})=>e)).map((({value:e,icon:t})=>{const i="string"!=typeof e?"AGS":e;return{optionTitle:this.i18n[i].title,value:i,description:this.i18n[i].description,icon:t}})),d.a.dataUrl=null,d.a.fileName=null,d.a.geoJSONResource=null,d.a.csvResource=null}async getServiceInfo(e){var t;const{url:i,type:a,storeAuth:s}=this.urlData,{error:l,result:r}=await(0,u.o)({url:i,customParameters:d.a.customParameters,type:a,checkAuth:e,storeAuth:s});if(!l&&r)return r;if(this.error=!0,"does not point to a GIS server"===(null==l?void 0:l.message))this.errorMessage=this.i18n.serviceNotGIS;else if(null===(t=null==l?void 0:l.message)||void 0===t?void 0:t.includes("doesn't support GeoJSON output"))this.errorMessage=this.i18n.unsupportedWFSGeoJSONOutputFormat;else switch(null==l?void 0:l.code){case"serviceNotExist":this.errorMessage=this.i18n.serviceNotExist;break;case"unauthorized":this.errorMessage="Unauthorized";break;case"unsupportedWFSVersion":this.errorMessage=this.i18n.unsupportedWFSVersion;break;case"invalidWMTS":this.errorMessage=this.i18n.invalidWMTS;break;case"invalidSpatialRef":this.errorMessage=this.i18n.invalidSpatialRef;break;case"emptyFeatureLayer":this.errorMessage=this.i18n.emptyFeatureLayer;break;default:this.errorMessage=this.i18n[null==l?void 0:l.code]||this.i18n.serviceNotExist}}handleLoadChange(e,t){this.newItemToggleNavigationEnabled.emit(t)}changeOption(e){this.previousSelectedOption=this.selectedOption,this.selectedOption=(0,N.i)(e)?"AGS":e,this.urlData.type=e,this.previousSelectedOption!==this.selectedOption&&this.logChangeOptionEvent(),this.determineNextText()}async detectType(e){if(e){const{isPortal:t}=l.c.portal,{result:i}=(0,I.g)(e,t);return i}return this.urlData.type}async handleNewUrl(e){const{url:t}=e;if(this.loading=!0,this.resetError(),this.urlData.url!==t){this.resetUrlData(),this.resetServiceInfo();const e=await this.detectType(t);if(this.urlData.url=t,this.urlData.type=e,(0,N.i)(e)){const e=await this.getServiceInfo(!1);e&&this.setServiceInfoState(e)}this.changeOption(e)}this.loading=!1}resetUrlData(){const{urlData:e}=this;e.url=null,e.type=null,e.isSecured=null,e.storeAuth=null,e.allowStoredAuth=null,e.serviceInfo=null,e.title=null,e.tags=null,e.snippet=null}resetServiceInfo(){d.a.agsType=null,d.a.description=null,d.a.extent=null,d.a.thumbnailToken=null}async handlePageTransition(){const{urlData:e}=this,{customParameters:t}=d.a;if("Document Link"===this.selectedOption)return!0;const i=!!e.isSecured;d.a.checkAuth=i;const a=await this.getServiceInfo(i);return a&&this.setServiceInfoState(a),t.length>0&&3===l.c.api&&await async function(e,t,i){const{customParameters:a,customLayerParameters:s}=(0,u.n)(i);switch(t){case"WMS":case"WMTS":await(null==e?void 0:e.setCustomParameters(a||{},s||{}));break;case"WFS":await(null==e?void 0:e.setCustomParameters(a||{}))}}(e.serviceInfo,e.type,t),!!a}logChangeOptionEvent(){const e=l.c.telemetry,t={eventType:"other",pageName:"my content",category:"new item url type change",details:this.urlData.url,label:`${this.previousSelectedOption}, ${this.selectedOption}`};null==e||e.logEvent(t)}setNextPage(){const{selectedOption:e,addDirectToMap:t}=this;let i;if((0,N.i)(this.urlData.type))i=this.urlData.storeAuth?"auth":"itemProperties";else switch(e){case"WMS":i="bulkLayerSelect";break;case"WFS":case"WMTS":i="singleLayerSelect";break;case"CSV":case"GeoJson":i="publishSelect";break;case"Tile Layer":i="tileLayerFromUrl";break;case"OGCFeatureServer":if(t){i="singleLayerSelect";break}default:i="itemProperties"}this.nextPage=i}render(){var e;const{i18n:t,selectedOption:i,urlData:s,determineNextText:n,addDirectToMap:o}=this,{url:c="",isSecured:d,addAsBasemap:h,allowStoredAuth:p}=s,{config:{helpMap:u,helpBase:m},user:g}=l.c,y=["WMS","WFS","WMTS","OGCFeatureServer",...(0,r.b)(Object.values(N.a))].includes(s.type);return(0,a.h)(a.H,null,(0,a.h)("arcgis-new-item-loader",{active:this.loading,text:t.getServiceInfo}),(0,a.h)("arcgis-new-item-alert",{active:this.error,description:this.errorMessage,onAlertDismiss:()=>{this.error=!1,this.errorMessage=""}}),(0,a.h)("arcgis-new-item-url",{url:c,onNewItemUrlChange:e=>this.handleNewUrl(e.detail),supportedServices:null!==(e=this.allowedItemTypes)&&void 0!==e?e:l.c.allowedItemTypes,onUrlLoaderUpdate:this.handleLoaderUpdate,ref:e=>this.itemUrlRef=e}),(0,a.h)("arcgis-select",{ref:e=>this.selectRef=e,emptyText:t.undetected,selectedOption:i,options:this.options,label:t.label,onArcgisOptionChange:e=>this.changeOption(e.detail)}),y&&(0,a.h)("div",{class:"custom-param-container"},(0,a.h)("arcgis-new-item-custom-parameters",{itemType:s.type})),!!g&&d&&p&&(0,a.h)("arcgis-new-item-switch-card",{onSwitchChange:this.handleAuthSwitchChange,header:t[o?"storeAuthMV":"storeAuth"],headerLink:{text:t.learnMore,href:`${m}${u[120000597]}`},defaultChecked:this.urlData.storeAuth}),this.showAddToMap()&&(0,a.h)("arcgis-new-item-switch-card",{header:t.useAsBaseMap,defaultChecked:h,onSwitchChange:e=>{const t=e.detail;s.addAsBasemap=t,n()}}))}get element(){return(0,a.d)(this)}static get watchers(){return{loading:["handleLoadChange"]}}};var se;ae.style=".label{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);margin-bottom:1rem;padding-top:1rem;display:block;line-height:18px}.fieldset{margin:0;margin-bottom:1.5rem;padding:0;border-style:none}.info-header{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);margin:0;margin-bottom:0.5rem;padding:0}.info-header--leader{margin-top:1rem}.info-description{font-weight:400;font-size:0.75rem;color:var(--calcite-ui-text-1);margin:0;padding:0}.custom-param-container{margin-bottom:1.5rem}:host{overflow-x:hidden}",function(e){e.Shapefile="shapefile",e["File Geodatabase"]="fgdb",e["Photos with Locations"]="geotagged photos",e["Deep Learning Package"]="deep learning package",e["Map Template"]="map template",e["CAD Drawing"]="cad",e["CSV Collection"]="csv collection",e["KML Collection"]="kml collection",e["Desktop Application Template"]="desktop app template",e["Geoprocessing Sample"]="geoprocessing sample",e["Code Sample"]="code sample",e["ArcPad Package"]="arcpad package",e["AppBuilder Widget Package"]="wab custom widget",e["Image Collection"]="image collection",e["iWork Pages"]="iwork pages",e["iWork Numbers"]="iwork numbers",e["iWork Keynote"]="iwork keynote",e.GML="gml",e.Application="application"}(se||(se={}));const le=["C","C#","C++","Java","Perl","PHP","Python","Ruby","SQL","VB","WPF","Other"],re=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.itemTypes=[],this.updateHostedStatus=e=>{this.publish=e.target.value},this.handleChange=e=>{this.selected=e.detail},this.selected="Shapefile",this.publish="hosted",this.language="C",this.pad="project",this.i18n=void 0,this.itemInfoI18N=void 0}handleNext(){const e="Photos with Locations"===this.selected?"Image Collection":this.selected;if("Application"===this.selected)return d.a.newItemMode="application",void this.newItemUpdatePage.emit("application");const{type:t,typeKeywords:i,thumbnailURL:a}=h.a[e];"ArcPad Package"===this.selected&&i.push("project"===this.pad?"ArcPad Project":"ArcPad Template"),"Code Sample"===this.selected&&i.push(this.language),"Photos with Locations"===this.selected&&i.push("Photo locations"),d.a.newItemMode="file",d.a.type=t,d.a.typeKeywords=i,d.a.thumbnailURL=a,d.a.enablePublishing="hosted"===this.publish&&this.canPublishZipType()&&l.c.allowPublish,this.newItemUpdatePage.emit("itemProperties")}async componentWillLoad(){this.i18n=g.u.i18n.zipSelect,this.itemInfoI18N=g.u.i18n.itemTypeInfo;const{portal:e,user:t}=l.c;(0,C.o)(e)||(this.publish="not-hosted");const i=(0,C.n)(t),a=e.isPortal;this.itemTypes=[{value:"Shapefile",icon:"file-zip",publishable:!0},{value:"File Geodatabase",icon:"data",publishable:!0},{value:"Photos with Locations",icon:"images",publishable:!0,hide:a},{value:"Deep Learning Package",icon:"deep-learning"},{value:"Map Template",icon:"file-zip"},{value:"CAD Drawing",icon:"file-cad"},{value:"CSV Collection",icon:"file-csv"},{value:"KML Collection",icon:"layer-kml"},{value:"Desktop Application Template",icon:"file-zip"},{value:"Geoprocessing Sample",icon:"hammer"},{value:"Code Sample",icon:"file-code"},{value:"ArcPad Package",icon:"cube"},{value:"AppBuilder Widget Package",icon:"app-gear",hide:i},{value:"Image Collection",icon:"collection",hide:i},{value:"GML",icon:"code",hide:i},{value:"Application",icon:"apps",hide:i}],l.c.allowedItemTypes&&(this.itemTypes=this.itemTypes.filter((e=>l.c.allowedItemTypes.includes(e.value))))}replaceTypeAndName(e,t){const i=new RegExp(/\$\{fileName\}/g),a=new RegExp(/\$\{type\}/g);return e.replace(a,this.selected).replace(i,t)}canPublishZipType(){const{user:e,portal:t}=l.c,i=this.itemTypes.find((e=>e.value===this.selected));return i.publishable&&(0,b.a)(e,i.value,t)}renderPublish(){const{i18n:e,itemInfoI18N:t}=this,{portal:i}=l.c,s=t.lowercaseDisplayName[this.selected];let r=["hosted","not-hosted"];return r=r.filter((e=>"hosted"!==e||(0,C.o)(i))),(0,a.h)("div",null,(0,a.h)("calcite-label",{class:"trailer-0"},(0,a.h)("span",{class:"label label--top"},(0,A.r)(t.howToAdd,s,"fileType"))),(0,a.h)("calcite-tile-select-group",{layout:"vertical"},r.map((i=>{const l=(0,A.r)("hosted"===i?e[i].heading:t.nonHostedTitle,d.a.fileName,"fileName"),r=(0,A.r)("hosted"===i?e[i].description:t.nonHostedDescription,s,"fileType");return(0,a.h)("calcite-tile-select",{checked:this.publish===i,width:"full","input-enabled":!0,"input-alignment":"start",name:"publish",value:i,onCalciteTileSelectChange:this.updateHostedStatus,heading:l,description:r})}))))}renderLanguages(){const e=le.map((e=>(0,a.h)("calcite-option",{value:e,selected:this.language===e},"Other"===e?this.i18n.other:e)));return(0,a.h)("calcite-label",{key:"language-label"},(0,a.h)("span",{class:"label label--top"},this.i18n.language),(0,a.h)("calcite-select",{label:this.i18n.language,width:"half",ref:e=>{this.languageSelect=e},onCalciteSelectChange:()=>this.language=this.languageSelect.selectedOption.value},e))}renderPad(){const e=["project","template"].map((e=>(0,a.h)("calcite-option",{value:e,selected:this.pad===e},this.i18n.ArcPad[e])));return(0,a.h)("calcite-label",{key:"pad-label"},(0,a.h)("span",{class:"label label--top"},this.i18n.type),(0,a.h)("calcite-select",{label:"",width:"half",ref:e=>{this.padSelect=e},onCalciteSelectChange:()=>this.pad=this.padSelect.selectedOption.value},e))}render(){const{fileName:e}=d.a,t=this.itemTypes.filter((e=>!e.hide)).map((({value:e,icon:t})=>({optionTitle:this.i18n[e].title,value:e,description:this.i18n[e].description,icon:t})));return(0,a.h)("div",null,(0,a.h)("h4",{class:"label"},this.i18n.file),(0,a.h)("p",{class:"file"},e),(0,a.h)("arcgis-select",{class:"label--top",selectedOption:this.selected,options:t,label:this.i18n.itemType,onArcgisOptionChange:e=>{const t=l.c.telemetry,i={eventType:"other",pageName:"my content",category:"new item zip item type",label:se[e.detail]};null==t||t.logEvent(i),this.selected=e.detail}}),this.canPublishZipType()&&"map"!==g.u.workflow&&l.c.allowPublish&&this.renderPublish(),"Code Sample"===this.selected&&this.renderLanguages(),"ArcPad Package"===this.selected&&this.renderPad())}get el(){return(0,a.d)(this)}};re.style=":host{padding-bottom:2rem;min-height:460px}.file{font-size:0.875rem;color:var(--calcite-ui-text-1);margin:0;padding:0}.label{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);margin-bottom:0.75rem;margin-top:0;line-height:18px}.label--top{display:block;margin-top:1.5rem}.trailer-0{margin-bottom:0}";const ne={0:"Dateline Standard Time",200:"Hawaiian Standard Time",300:"Alaskan Standard Time",400:"Pacific Standard Time",410:"Pacific Standard Time (Mexico)",520:"US Mountain Standard Time",510:"Mountain Standard Time (Mexico)",500:"Mountain Standard Time",610:"Central America Standard Time",620:"Central Standard Time",630:"Central Standard Time (Mexico)",600:"Canada Central Standard Time",710:"SA Pacific Standard Time",700:"Eastern Standard Time",720:"US Eastern Standard Time",730:"Venezuela Standard Time",850:"Paraguay Standard Time",800:"Atlantic Standard Time",810:"Central Brazilian Standard Time",830:"SA Western Standard Time",820:"Pacific SA Standard Time",900:"Newfoundland Standard Time",910:"E. South America Standard Time",950:"Argentina Standard Time",940:"SA Eastern Standard Time",920:"Greenland Standard Time",930:"Montevideo Standard Time",1010:"UTC-02",1e3:"Mid-Atlantic Standard Time",1100:"Azores Standard Time",1110:"Cape Verde Standard Time",1220:"Morocco Standard Time",1230:"UTC",1200:"GMT Standard Time",1210:"Greenwich Standard Time",1340:"W. Europe Standard Time",1300:"Central Europe Standard Time",1320:"Romance Standard Time",1310:"Central European Standard Time",1330:"W. Central Africa Standard Time",1350:"Namibia Standard Time",1430:"GTB Standard Time",1460:"Middle East Standard Time",1410:"Egypt Standard Time",1480:"Syria Standard Time",1400:"E. Europe Standard Time",1470:"South Africa Standard Time",1420:"FLE Standard Time",1490:"Turkey Standard Time",1440:"Israel Standard Time",1450:"Jordan Standard Time",1510:"Arabic Standard Time",1530:"Kaliningrad Standard Time",1500:"Arab Standard Time",1520:"E. Africa Standard Time",1535:"Iran Standard Time",1600:"Arabian Standard Time",1610:"Azerbaijan Standard Time",1540:"Russian Standard Time",1650:"Mauritius Standard Time",1640:"Georgian Standard Time",1620:"Caucasus Standard Time",1660:"Afghanistan Standard Time",1710:"West Asia Standard Time",1715:"Pakistan Standard Time",1720:"India Standard Time",1730:"Sri Lanka Standard Time",1740:"Nepal Standard Time",1800:"Central Asia Standard Time",1810:"Bangladesh Standard Time",1755:"Ekaterinburg Standard Time",1820:"Myanmar Standard Time",1900:"SE Asia Standard Time",1830:"N. Central Asia Standard Time",2e3:"China Standard Time",1910:"North Asia Standard Time",2020:"Singapore Standard Time",2040:"W. Australia Standard Time",2030:"Taipei Standard Time",2050:"Ulaanbaatar Standard Time",2060:"North Asia East Standard Time",2110:"Tokyo Standard Time",2100:"Korea Standard Time",2140:"Cen. Australia Standard Time",2130:"AUS Central Standard Time",2210:"E. Australia Standard Time",2200:"AUS Eastern Standard Time",2240:"West Pacific Standard Time",2220:"Tasmania Standard Time",2150:"Yakutsk Standard Time",2300:"Central Pacific Standard Time",2250:"Vladivostok Standard Time",2410:"New Zealand Standard Time",2430:"UTC+12",2400:"Fiji Standard Time",2310:"Magadan Standard Time",2500:"Tonga Standard Time",120:"Samoa Standard Time"},oe=class{constructor(e){(0,a.r)(this,e),this.timezoneChange=(0,a.c)(this,"timezoneChange",7),this.selected="1230",this.subTitle=void 0,this.defaultTimezone=void 0,this.i18n=void 0}async componentWillLoad(){this.i18n=g.u.i18n.timezoneDropdown;const{defaultTimezone:e}=this;if(e)for(const t in ne)if(e===ne[t]){this.selected=t;break}}render(){const{i18n:e,selected:t,timezoneChange:i,subTitle:s}=this;return(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"label"},!s&&e.title),!s&&(0,a.h)("span",{class:"sub-label"},e.subTitle),(0,a.h)("calcite-select",{onCalciteSelectChange:e=>{const t=e.target.selectedOption.value,a=ne[t]||t;i.emit(a)},width:"half",label:"timezone-select",selectedOption:t},Object.keys(e.timezones).map((i=>{const s=e.timezones[i];return(0,a.h)("calcite-option",{selected:i===t,value:i},s)}))),s&&(0,a.h)("span",{class:"sub-label"},s))}get el(){return(0,a.d)(this)}};oe.style=".label{font-weight:500;font-size:0.875rem;color:var(--calcite-ui-text-1);line-height:18px;margin-bottom:6px}.has-subtitle{font-size:1rem;margin-bottom:0}.sub-label{font-size:0.75rem}:host{margin-bottom:1.5rem}";const ce=class{constructor(e){(0,a.r)(this,e),this.urlInputAddAction=(0,a.c)(this,"urlInputAddAction",7),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemUrlChange=(0,a.c)(this,"newItemUrlChange",7),this.urlLoaderUpdate=(0,a.c)(this,"urlLoaderUpdate",7),this.debouncedInput=(0,r.d)((()=>{this.urlInputAddHandler()}),2e3),this.inputTitle="",this.inputMessage="",this.headerScale="s",this.supportedServices=void 0,this.url=void 0,this.placeholder="https://",this.required=!0,this.inputMessageActive=!1,this.inputStatus=void 0,this.isLoading=!1,this.i18n=void 0}async componentWillLoad(){var e;const t=g.u.i18n;this.i18n=t.url,(null===(e=this.supportedServices)||void 0===e?void 0:e.length)>0&&(this.supportedServiceString=this.supportedServices.filter((e=>(0,h.i)(e))).map((e=>{var i,a;const s=(0,N.i)(e)?"AGS":e;return null!==(a=null!==(i=t.itemTypeInfo.mvText[s])&&void 0!==i?i:t.itemTypeInfo.lowercaseDisplayName[s])&&void 0!==a?a:e})).join(", "),this.helpText=(0,A.r)(t.common.supportLayerTypes,this.supportedServiceString,"typeList")),this.inputStatus="idle",this.inputMessageActive=this.inputMessage.length>0,this.inputTitle||(this.inputTitle=this.i18n.url)}async focusMainInput(){this.mainInputRef.setFocus()}async validateInput(){const{url:e,required:t}=this;if(this.resetValidation(),this.debouncedInput.invoke(),e||t)return e?(0,I.i)(e,l.c.portal.isPortal)?(this.urlLoaderUpdate.emit(!1),this.setError("httpWarning")):void 0:(this.urlLoaderUpdate.emit(!1),this.setError("invalidUrl"));this.urlLoaderUpdate.emit(!1)}resetValidation(){this.inputStatus="idle",this.inputMessageActive=!1}async urlInputAddHandler(){if(!this.url)return;this.urlLoaderUpdate.emit(!0);const{isPortal:e,allSSL:t}=l.c.portal;this.url=(0,I.f)(this.url,t);const{result:i,error:a}=(0,I.g)(this.url,e);"KML"!==i&&(c.i.title=(0,I.u)(this.url).replace(C.s,"")),this.urlLoaderUpdate.emit(!1),a?this.setError(a.code):this.newItemUrlChange.emit({type:i,url:this.url})}setError(e){var t;const i=this.supportedServiceString,a=("invalidUrl"===e&&i?(0,A.r)(this.i18n.invalidUrlWithType,i,"typeList"):null===(t=this.i18n)||void 0===t?void 0:t[e])||this.i18n.errorMessage;return this.inputStatus="invalid",this.inputMessage=a,this.inputMessageActive=!0,a}render(){const{url:e,helpText:t,placeholder:i,required:s,headerScale:l}=this;return(0,a.h)("calcite-label",null,(0,a.h)("arcgis-new-item-description",{header:this.inputTitle,headerScale:l}),(0,a.h)("calcite-input",{id:"item-properties-url",placeholder:i,value:e,required:s,ref:e=>this.mainInputRef=e,status:this.inputStatus,type:"url",onInput:e=>{this.resetValidation(),"insertFromPaste"!==e.inputType&&(this.url=e.target.value,this.debouncedInput())},onKeyDown:e=>{"Enter"===e.key&&(this.url=this.mainInputRef.value,this.debouncedInput.invoke())},onPaste:e=>{this.url=e.clipboardData.getData("text"),this.debouncedInput.invoke()}}),this.inputMessageActive?(0,a.h)("calcite-input-message",{icon:"invalid"===this.inputStatus,status:this.inputStatus},this.inputMessage):t?(0,a.h)("p",{class:"help-text"},t):null)}get el(){return(0,a.d)(this)}};ce.style=".url-field{margin-bottom:1rem}.help-text{margin-top:0.25rem;margin-bottom:0.5rem;font-size:0.875rem}"},42762:(e,t,i)=>{var a;function s(e){return null!=e}function l(e,t){for(;e;){if(e.nodeName===t.toUpperCase())return!0;e=e.parentElement}return!1}i.d(t,{a:()=>s,i:()=>l,s:()=>a}),function(e){e.SMALL="s",e.MEDIUM="m",e.LARGE="l"}(a||(a={}))},72637:(e,t,i)=>{var a,s,l,r,n,o;i.d(t,{L:()=>o,a:()=>n,f:()=>s,i:()=>a,l:()=>l,s:()=>r}),function(e){e.sourceUrl="sourceUrl",e.title="title",e.caption="caption",e.linkUrl="linkUrl",e.altText="altText"}(a||(a={})),function(e){e.expression="expression/",e.relationship="relationships/",e.raster="Raster."}(s||(s={})),function(e){e.feature="feature",e.cluster="cluster",e.mapNotes="mapNotes"}(l||(l={})),function(e){e.feature="feature",e.mapImage="map-image",e.scene="scene",e.ogcFeature="ogc-feature",e.imagery="imagery",e.wfs="wfs",e.wms="wms",e.csv="csv",e.geojson="geojson",e.stream="stream",e.imageryTile="imagery-tile",e.tile="tile",e.subtype="subtype"}(r||(r={})),function(e){e.integer="integer",e.smallInteger="small-integer",e.bigInteger="big-integer",e.single="single",e.double="double",e.long="long",e.string="string",e.date="date",e.dateOnly="date-only",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e.oid="oid",e.guid="guid",e.globalId="global-id",e.number="number"}(n||(n={})),function(e){e.default="default",e.display="display",e.type="type",e.field="field"}(o||(o={}))},71120:(e,t,i)=>{i.d(t,{a:()=>p,b:()=>d,c:()=>h,e:()=>o,f:()=>u,i:()=>c});var a=i(76134),s=i(58892);const l="create feature layer",r="my content",n=e=>{switch(e){case"build":return"blank";case"existing":return"fs";case"template":return"template";case"link":return"url"}},o=e=>{const t=a.c.telemetry;null==t||t.stepWorkflow(l,"enable "+("captureGPS"===e?"gps":"enableZDefaults"===e?"z":"m"),{category:l,attribute:n(s.a.addFeatureLayerType),pageName:r})},c=e=>{const t=a.c.telemetry;null==t||t.stepWorkflow(l,`expand ${e} details`,{category:l,attribute:n(s.a.addFeatureLayerType),pageName:r})},d=()=>{const e=a.c.telemetry;null==e||e.stepWorkflow(l,"filter",{category:l,attribute:n(s.a.addFeatureLayerType),pageName:r})},h=e=>{const t=n(e),i=a.c.telemetry;null==i||i.stepWorkflow(l,"from option",{category:l,attribute:t,pageName:r})},p=()=>{const{addFeatureLayerType:e,serviceInfo:t}=s.a,i=t,o=a.c.telemetry;null==o||o.endWorkflow(l,{category:l,attribute:n(e),pageName:r,count:i.layers.length,number:i.tables.length})},u=e=>{var t;null===(t=a.c.telemetry)||void 0===t||t.logError({category:l,error:e})}},47682:(e,t,i)=>{i.d(t,{r:()=>s});const a={fileName:/\$\{fileName\}/g,fileType:/\$\{type\}/g,typeList:/\$\{typeList\}/g,missingFields:/\$\{\missingFields\}/g},s=(e,t,i)=>{const s=new RegExp(a[i]);return null==e?void 0:e.replace(s,t)}},71249:(e,t,i)=>{i.d(t,{c:()=>c});var a=i(48680),s=i(86739),l=i(83129),r=i(41171),n=function(e){return this instanceof n?(this.v=e,this):new n(e)},o=function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,s=i.apply(e,t||[]),l=[];return a={},r("next"),r("throw"),r("return"),a[Symbol.asyncIterator]=function(){return this},a;function r(e){s[e]&&(a[e]=function(t){return new Promise((function(i,a){l.push([e,t,i,a])>1||o(e,t)}))})}function o(e,t){try{(i=s[e](t)).value instanceof n?Promise.resolve(i.value.v).then(c,d):h(l[0][2],i)}catch(e){h(l[0][3],e)}var i}function c(e){o("next",e)}function d(e){o("throw",e)}function h(e,t){e(t),l.shift(),l.length&&o(l[0][0],l[0][1])}};function c(e,t,i){return o(this,arguments,(function*(){const{config:o,portal:c,user:d}=i,{item:h}=yield n(function(e,t){const i=`${t.userContentUrl}/items/${e.id}`;return(0,r.r)(i)}(e,d)),p=yield n((0,l.u)(c));yield yield n("publishingService");const u=h.ownerFolder&&"/"!==h.ownerFolder&&"root"!==h.ownerFolder,m=`${t}---${(0,a.g)()}`,{createServiceResponse:g,addToDefinitionResponse:y}=yield n((0,l.v)(Object.assign({name:u?m:t,layers:(null==p?void 0:p.layers)||[],tables:(null==p?void 0:p.tables)||[]},p),{config:o,user:d}));u&&(yield n((0,s.m)(g.itemId,h.ownerFolder)),yield n((0,s.e)(g.itemId,{title:t}))),yield yield n("appendingPhotos");const{statusUrl:f}=yield n(function(e,t,i){var a;const s=t.layers[0],l=`${e.encodedServiceURL}/${null!==(a=s.id)&&void 0!==a?a:0}/append`,n={appendItemId:i.id,appendUploadFormat:"imageCollection",appendAttachmentsInfo:JSON.stringify({ignoreAttachmentsWithoutLocation:!0}),upsert:!1,useGlobalIds:!1,rollbackOnFailure:!0};return(0,r.r)(l,n,{},"post")}(g,y,h));yield n(function(e,t,i){const a=`${i.userContentUrl}/addRelationship`,s={relationshipType:"Service2Data",destinationItemId:t.id,originItemId:e.itemId};return(0,r.r)(a,s,{},"post")}(g,h,d)),yield yield n("checkingStatus"),yield n((0,r.p)(f)),yield yield n(g)}))}},64171:(e,t,i)=>{i.d(t,{a:()=>b,b:()=>o,c:()=>n,d:()=>T,e:()=>S,f:()=>g,g:()=>w,h:()=>f,i:()=>h});var a=i(76134);function s(e,t,i,a,s){return new Promise(((l,r)=>{const n=new XMLHttpRequest;n.open(e,t,!1),a&&n.setRequestHeader("Authorization",a),s&&n.setRequestHeader("Content-type",s),i?n.send(i):n.send();const o=JSON.parse(n.responseText);n.status>=400&&r(JSON.parse(n.responseText)),l(o)}))}function l(e,t){return new Promise(((i,a)=>{t=t.replace(/[[]/,"[").replace(/[]]/,"]");const s=new RegExp(`[?&#]${t}=([^&#]*)`).exec(e);null==s?a("InvalidToken"):i(s[1])}))}function r(e,t){return new Promise(((i,a)=>{const s=`${window.location.protocol}//${window.location.hostname}`,l=`https://${t}/home/cloudDriveOauth-callback.html?cloudUrl=${e}&currentSourceUrl=${s}&portalHostName=${t}`,r=document.createElement("iframe");r.src=l,r.className="hide",document.body.appendChild(r);const n=window.addEventListener?"addEventListener":"attachEvent";(0,window[n])("attachEvent"===n?"onmessage":"message",(e=>{e.origin===`https://${t}`&&("popupBlocked"!==e.data&&"windowClosed"!==e.data||a(e.data),i(e.data))}),!1)}))}const n={csv:"file-csv",excel:"file-excel",zip:"file-zip",geojson:"file-code",sheet:"file-report",cad:"file-cad",gpx:"file-gpx",png:"file-image",jpg:"file-image",jpeg:"file-image",tiff:"file-image",gif:"file-image",pdf:"file-pdf",docx:"file-word"},o={csv:"CSV",excel:"Excel",zip:"Zip File",geojson:"GeoJSON",googlesheets:"Google Sheets",cad:"CAD",gpx:"GPX",png:"Image",jpg:"Image",jpeg:"Image",tiff:"Image",gif:"Image",pdf:"PDF",docx:"Microsoft Word",pptx:"Microsoft PowerPoint"},c={csv:".csv",excel:".xls",zip:".zip",geojson:".geojson",googlesheets:""};function d(e){const t=e.split("."),i=t[t.length-1].toLowerCase();return{xls:"excel",xlsx:"excel",csv:"csv",zip:"zip",geojson:"geojson",json:"geojson"}[i]||i}function h(e,t){return`https://content.dropboxapi.com/2/files/download?httpHeaders={"Authorization":"Bearer&#32;${t}","Dropbox-API-Arg":"{\\"path\\":\\"${e}\\"}"}`}class p{constructor(){this.nextStart=0}async connect(){const{config:e,portal:t}=a.c,i=`dropbox${Math.floor(Date.now()/1e3)}`,s=document.documentElement.lang||"en-US",n=`https://www.dropbox.com/oauth2/authorize?redirect_uri=https://${t.portalHostname}/home/cloudDriveOauth-callback2.html&response_type=token&client_id=${e.dropboxClientId}&locale=${s}&state=${i}`;return new Promise((async(e,a)=>{try{const s=await r(n,t.portalHostname),o=await l(s,"state");i!==o&&a("invalidState");const c=await l(s,"access_token");this.token=c,e(c)}catch(e){a(e)}}))}search(e={}){const{token:t}=this;return new Promise((async i=>{const{searchText:a,dropdownFilter:l,next:r}=e,n=`Bearer ${t}`,o=a?` ${a}`:"",h=r?this.nextStart:0;let p=c[l];"excel"===l&&(p="xls");const u=`{"path":"","query":"${o} ${p}","mode": "filename","max_results":10,"start":${h}}`,m=await s("POST","https://api.dropboxapi.com/2/files/search",u,n,"application/json");this.nextStart=m.start,i({files:m.matches.filter((e=>{var t;return"file"===(null===(t=e.metadata)||void 0===t?void 0:t[".tag"])})).map((({metadata:{id:e,name:i,size:a}})=>({id:e,name:i,mimeType:d(i),downloadUrl:`https://content.dropboxapi.com/2/files/download?httpHeaders={"Authorization":"Bearer&#32;${t}","Dropbox-API-Arg":"{\\"path\\":\\"${e}\\"}"}`,size:a}))),next:!!m.more})}))}}function u(e){return e.indexOf("spreadsheetml.sheet")>-1||e.indexOf("ms-excel")>-1?"excel":e.indexOf("application/zip")>-1?"zip":e.indexOf("application/octet-stream")>-1||e.indexOf("application/json")>-1?"geojson":e.indexOf("google-apps.spreadsheet")>-1?"googlesheets":e.indexOf("text/csv")>-1?"csv":"zip"}const m={csv:'(mimeType="text/csv")',excel:'(mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"ormimeType="application/vnd.ms-excel")',zip:'(mimeType="application/x-zip-compressed"ormimeType="application/zip")',geojson:'(name contains "json" or name contains "geojson")and(mimeType="application/octet-stream"ormimeType="application/json")',googlesheets:'(mimeType="application/vnd.google-apps.spreadsheet")'};function g(e,t,i){const a=`https://www.googleapis.com/drive/v3/files/${e}`,s=`&httpHeaders={"Authorization":"Bearer&#32;${i}"}`,l=`${a}/export?mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet${s}`,r=`${a}?alt=media${s}`;return t.indexOf("google-apps")>-1||t.indexOf("googlesheets")>-1?l:r}class y{async connect(){return new Promise((async(e,t)=>{const{config:i,portal:s}=a.c,n=s.portalHostname,o=document.documentElement.lang||"en-US",c=`google${Math.floor(Date.now()/1e3)}`,d=`https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/drive.readonly&redirect_uri=https://${n}/home/cloudDriveOauth-callback2.html&response_type=token&client_id=${i.googleClientId}&hl=${o}&state=${c}`;try{const i=await r(d,n);c!==await l(i,"state")&&t("invalidState"),this.token=await l(i,"access_token"),e(this.token)}catch(e){t(e)}}))}async search(e={}){return new Promise((async t=>{const{searchText:i,next:a,dropdownFilter:l}=e,r=`https://www.googleapis.com/drive/v3/files?access_token=${this.token}&pageSize=10&fields=incompleteSearch,nextPageToken,files(id,kind,mimeType,name)&q=${i?`name contains '${i}' and trashed = false and`:"trashed = false and"}${m[l]}${a?`&pageToken=${this.nextToken}`:""}`,n=await s("GET",r,null,null,"application/json");this.nextToken=n.nextPageToken,t({files:n.files.map((({id:e,name:t,mimeType:i})=>({id:e,name:t,mimeType:u(i),downloadUrl:g(e,i,this.token)}))),next:!!n.nextPageToken})}))}}function f(e,t){return`https://graph.microsoft.com/v1.0/me/drive/items/${e}/content?httpHeaders={"Authorization":"Bearer&#32;${t}"}`}class v{async connect(){return new Promise((async(e,t)=>{const{config:i,portal:s}=a.c,n=s.portalHostname,o=document.documentElement.lang||"en-US",c=`onedrive${Math.floor(Date.now()/1e3)}`,d=`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?scope=files.read&redirect_uri=https://${n}/home/cloudDriveOauth-callback2.html&response_type=token&client_id=${i.oneDriveClientId}&locale=${o}&state=${c}`;try{const i=await r(d,n);c!==await l(i,"state")&&t("invalidState"),this.token=await l(i,"access_token"),e(this.token)}catch(e){t(e)}}))}search(e={}){return new Promise((async t=>{const{searchText:i,dropdownFilter:a,next:l}=e,r=`Bearer ${this.token}`,n=`https://graph.microsoft.com/v1.0/me/drive/root/search(q='${i||""} ${c[a]||""}')?select=name,id,file,size&top=10`,o=l?this.nextLink:n,h=await s("GET",o,null,r,"application/json");this.nextLink=h["@odata.nextLink"],t({files:h.value.map((({size:e,id:t,name:i})=>({size:e,id:t,name:i,mimeType:d(i),downloadUrl:`https://graph.microsoft.com/v1.0/me/drive/items/${t}/content?httpHeaders={"Authorization":"Bearer ${this.token}"}`}))),next:!!h["@odata.nextLink"]})}))}}function w(e){return new{dropbox:p,"google drive":y,onedrive:v}[e]}function b(e){return{dropbox:"dropBoxConnect","google drive":"googleConnect",onedrive:"oneDriveConnect"}[e]}function S(e){return new{dropBoxConnect:p,googleConnect:y,oneDriveConnect:v}[e]}function T(e){return{dropBoxConnect:"dropbox",googleConnect:"google drive",oneDriveConnect:"onedrive"}[e]}},51510:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>l,i:()=>n,m:()=>r});var a=i(26426),s=i(31546);function l(e,t){let i;i=t?t.map((e=>e.type)):Object.keys(s.a);let a=[];return i.forEach((t=>{var i;(null===(i=s.a[t].fileExt)||void 0===i?void 0:i.indexOf(e))>=0&&a.push(s.a[t])})),a}function r(e){return e?(0,a.b)(e.flatMap((e=>{var t;return null===(t=s.a[e])||void 0===t?void 0:t.fileExt})).filter((e=>!!e))):null}const n=e=>e/1024/1024>50,o=e=>e/1024/1024>20},81068:(e,t,i)=>{i.d(t,{C:()=>n,a:()=>d,f:()=>o,g:()=>r,l:()=>l});var a=i(66716),s=i(18869);const l=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","nb"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function r(e){return function(e,t,i){const a=(0,s.c)(e,"[dir]");return a?a.getAttribute("dir"):"ltr"}(e)}const n={rtl:"arcgis--rtl"};async function o(e,t){const{api:i,type:s,places:l}=t||{};if(4===i){const[t]=await(0,a.l)(["esri/intl"]),i=t.convertNumberFormatToIntlOptions({places:l,style:s,digitSeparator:!0});return t.formatNumber(e,Object.assign(Object.assign({},i),{style:s}))}const[r]=await(0,a.l)(["dojo/number"]);return r.format(e,{type:s,places:l,pattern:null==t?void 0:t.pattern})}const c={};function d(e){const t=document.documentElement.lang;return c[t]||(c[t]=new Intl.DateTimeFormat(document.documentElement.lang,{year:"numeric",month:"short",day:"numeric"})),c[t].format(e)}},62727:(e,t,i)=>{i.d(t,{a:()=>r,g:()=>c});var a=i(18869),s=i(81068),l=i(28384);function r(e){var t,i,l;const r=null!==(t=(0,a.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===l?void 0:l.documentElement,n=((null==r?void 0:r.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(n)?s.l.get(n):s.l.has(n.slice(0,2))?s.l.get(n.slice(0,2)):"en"}const n={};function o(e,t){const i=`${e}${t}`;return n[i]||(n[i]=function(e,t){return new Promise(((i,a)=>{fetch((0,l.a)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then((e=>{e.ok?i(e.json()):a()}),(()=>a()))}))}(e,t)),n[i]}async function c(e,t){const i=t||e.tagName.toLowerCase(),l=r(e),n=function(e){var t,i,l;const r=null!==(t=(0,a.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===l?void 0:l.documentElement,n=((null==r?void 0:r.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(n)?s.l.get(n):s.l.has(n.slice(0,2))?n:"en"}(e);let c;try{c=await o(i,l)}catch(e){console.warn(`no locale for ${i} (${l}) loading default locale en.`),c=await o(i,"en")}return[c,l,n]}},56482:(e,t,i)=>{i.d(t,{a:()=>p,c:()=>u,p:()=>g});var a=i(76134),s=i(58892),l=i(54871),r=i(99274),n=i(30063),o=i(61099),c=i(83129),d=i(86739),h=i(41171);async function p(e,t){var i;const l=null!==(i=null!=t?t:a.c.user)&&void 0!==i?i:a.c.portal.user,{cloudProviderResource:n,geoJSONResource:o,locationType:c,csvResource:h,existingItem:p}=s.a,{result:u}=await(0,d.a)(e.id),m=[...u.typeKeywords];if((n||o||h)&&m.push("Cloud Drive"),"address"===c&&m.push("showUnmatchedAddresses"),["3DTiles Package","3DTiles Service"].includes(u.type))if("3dTiles"===s.a.tileLayerPublishType)m.push(s.a.tilesLayer3dTilesLayerType);else if(p){const e=[...p.typeKeywords].find((e=>r.t.includes(e)));e&&m.push(e)}return(0,d.e)(e.id,{typeKeywords:null==m?void 0:m.join(",")},l)}async function u(e){const t=await(0,c.w)(e.id,{success:e.success});if("failed"===t.status)throw new Error(t.statusMessage)}function m(e,t){const{selectedFields:i,timezone:a,analyzeResults:l,type:r}=s.a,n=l.publishParameters,c=(0,o.a)();c.fields=Object.keys(i).map((e=>{const t=i[e];var a;return a=t.type,["esriFieldTypeDouble","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeSmallInteger"].includes(a)&&(t.sqlType=function(e){switch(e){case"esriFieldTypeDouble":return"sqlTypeDouble";case"esriFieldTypeInteger":case"esriFieldTypeOID":return"sqlTypeInteger";case"esriFieldTypeString":return"sqlTypeNVarchar";case"esriFieldTypeSingle":return"sqlTypeFloat";case"esriFieldTypeSmallInteger":return"sqlTypeSmallInt";case"esriFieldTypeDate":return"sqlTypeDate";default:return"sqlTypeOther"}}(t.type),delete t.length),t})),c.capabilities="Query",n.capabilities="Query",c.hasStaticData=!0,n.hasStaticData=!0,n.persistErrorRecordsForReview=!0,n.name=e;const d={timeZone:a||"UTC"};return t||"GeoJson"===r?c.dateFieldsTimeReference=d:n.dateFieldsTimeReference=d,n}async function g(e,t){var i,a,r,o;const{user:c,title:d,itemId:p,extension:u,type:g,dataUrl:y,itemOwnerUrl:f}=e;null!=t||(t=Object.assign({},function(e,t,i,a,l){t=(0,n.a)(t);let r=i.toLowerCase();"zip"===r&&(r=a);const o="Microsoft Excel"===a,c={name:t,maxRecordCount:2e3},d=("GeoJson"===a||"CSV"===a)&&l,h=s.a.cloudProvider||d?{deleteSourceItemUponCompletion:!0}:{},p=JSON.stringify(c),u=JSON.stringify(Object.assign(Object.assign({},c),{hasStaticData:!0,layerInfo:{capabilities:"Query"}}));switch(r){case"3tz":return{itemId:e,publishParameters:JSON.stringify({name:t}),filetype:"3DTiles Service"};case"csv":case"xls":case"xlsx":return Object.assign({itemId:e,filetype:o?"excel":"csv",publishParameters:JSON.stringify(m(t,o))},h);case"featurecollection":return{itemId:e,filetype:"featureCollection",publishParameters:u};case"geojson":case"json":return Object.assign({itemId:e,filetype:"geojson",publishParameters:u},h);case"tpk":case"tpkx":return{itemId:e,filetype:"tilePackage",publishParameters:p,buildInitialCache:!0};case"vtpk":return{itemId:e,filetype:"vectortilepackage",publishParameters:p,outputType:"vectorTiles",buildInitialCache:!0};case"spk":case"slpk":return{itemId:e,filetype:"scenepackage",publishParameters:p,outputType:"sceneService",buildInitialCache:!0};case"sd":return{itemId:e,filetype:"serviceDefinition",buildInitialCache:!1};case"File Geodatabase":return Object.assign({itemId:e,filetype:"fileGeodatabase",publishParameters:u},h);case"Shapefile":return Object.assign({itemId:e,filetype:"shapefile",publishParameters:u},h);case"gpkg":return{itemId:e,filetype:"geoPackage",publishParameters:p};case"Image Collection":return{itemId:e,filetype:"imageCollection",outputType:"image service",publishParameters:p};default:return{itemId:e,publishParameters:p}}}(p,d,u,g,y)));const v=`${"append"===l.u.workflow?f:c.userContentUrl}/publish`;try{const e=await(0,h.r)(v,t,{},"post");if(e.services&&e.services.length){if(null===(a=null===(i=e.services[0])||void 0===i?void 0:i.error)||void 0===a?void 0:a.message)throw null===(o=null===(r=e.services[0])||void 0===r?void 0:r.error)||void 0===o?void 0:o.message;return{result:e}}throw this.i18n.errorPublishing}catch(e){return console.error(e),e.includes("Service name")?{error:{code:"serviceNameExists"}}:{error:{code:"unhandledError"}}}}},55470:(e,t,i)=>{i.d(t,{g:()=>s});var a=i(41171);const s=async e=>{try{return{result:await(0,a.r)(`${(0,a.g)(e)}portals/self/subscriptionInfo`)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}},27099:(e,t,i)=>{i.d(t,{a:()=>h,b:()=>d,l:()=>c});var a=i(76134),s=i(58892);const l="create tile layer",r="my content",n=e=>{switch(e){case"store":return"data store";case"existing":return"fs";case"upload":return"upload"}},o=e=>{switch(e){case"tiles":return"raster";case"vectorTiles":return"vector"}},c=()=>{var e;null===(e=a.c.telemetry)||void 0===e||e.startWorkflow(l,{category:"create tile layer",pageName:"my content"})},d=()=>{const e=a.c.telemetry;null==e||e.stepWorkflow(l,"from option",{category:l,attribute:n(s.a.addTileLayerOption),details:o(s.a.tileLayerPublishType),pageName:r})},h=()=>{const e=a.c.telemetry;null==e||e.endWorkflow(l,{category:l,attribute:n(s.a.addTileLayerOption),details:o(s.a.tileLayerPublishType),pageName:r})}},76706:(e,t,i)=>{i.d(t,{a:()=>n,r:()=>r});var a=i(65508),s=i(58892),l=i(54871);function r(){s.d.reset(),a.a.reset()}const n=()=>{if(s.a.existingItem||"register"===l.u.workflow)return;s.d.reset();const e=a.i.folder;a.a.reset(),a.i.folder=e}}}]);