/*! For license information please see 970bcc7617923983ac3ad884e6a2cb6d.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[56345],{56345:(e,i,t)=>{t.r(i),t.d(i,{arcgis_new_item_pages_developer_credentials_select:()=>p});var r=t(28384),n=t(41171),o=t(76134),s=t(83129),a=t(58892),l=t(54871),c=t(90784),d=t(59004),u=t(55470);t(66716),t(62381),t(27010),t(65508),t(24552),t(85142),t(72022),t(96729),t(58728),t(86739),t(31546),t(83397),t(18869),t(46220),t(82463),t(48507),t(48333),t(86274);const p=class{constructor(e){(0,r.r)(this,e),this.newItemUpdatePage=(0,r.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,r.c)(this,"workflowComplete",7),this.canCreateAPIKey=!1,this.canShowLearnMore=!0,this.isRegisterTerminalPage=()=>"register"===l.u.workflow&&"oauth"===this.selectedCredentialType,this.setAlertMessage=e=>{this.alertInfo=this.i18n.error[e]},this.setUnsupportedUrlAlertMessage=()=>{const e=this.i18nBase.featureLayerFromUrl.error;this.alertInfo={title:e.invalidFeatureLayerUrl.title,description:this.i18n.error.registerError.description}},this.alertInfo=void 0,this.selectedCredentialType="oauth",this.selectedApplicationEnvironment="multiple",this.redirectUrls=[],this.referrerUrls=[],this.url="",this.isLoading=!1}componentWillLoad(){var e,i;this.isRegisterTerminalPage()&&(l.u.nextText="register"),this.i18n=l.u.i18n.developerCredentialsSelect,this.i18nBase=l.u.i18n,this.selectedCredentialType=a.a.developerCredentialsType||"apiKey",this.canCreateAPIKey||(this.selectedCredentialType="oauth");const t=a.a.existingItem;t&&("API Key"===t.type?this.selectedCredentialType="apiKey":"Application"===t.type&&(this.selectedCredentialType="oauth")),this.selectedApplicationEnvironment=a.a.applicationEnvironment||"multiple",this.url=null!==(e=a.a.url)&&void 0!==e?e:null===(i=a.a.existingItem)||void 0===i?void 0:i.url;const r=a.a.developerCredentialsRedirectUrls;this.redirectUrls=(null==r?void 0:r.length)>0?r:[""];const n=a.a.apiKeyReferrerUrls;this.referrerUrls=(null==n?void 0:n.length)>0?n:[""];const{portal:s,config:{helpBase:c}}=o.c;this.canShowLearnMore=!s.isPortal||c.includes("https://enterprise.arcgis.com/")}async componentDidLoad(){if(!o.c.subscriptionInfo){this.isLoading=!0;const{result:e}=await(0,n.f)((()=>(0,u.g)(o.c.portal)),"subscriptionType",o.c.user.id);o.c.subscriptionInfo=e,this.isLoading=!1}this.canCreateAPIKey=(0,d.p)()}async handleNext(){const{selectedCredentialType:e,selectedApplicationEnvironment:i,isRegisterTerminalPage:t,redirectUrls:r,redirectManagmentRef:l,referrerUrls:c,referrerManagmentRef:d,urlRef:u,setAlertMessage:p,url:v}=this;if(await u.validateInput())return void u.focusMainInput();const g=r.filter((e=>e));if(g.length<=0)return p("redirectEmpty"),void l.focusInputByIndex(0);const m=c.filter((e=>e));if("apiKey"===e&&m.length<=0)return p("referrerEmpty"),void d.focusInputByIndex(0);if(!await this.redirectManagmentRef.validateAllInputs({focusWhenInvalid:!0}))return void this.setUnsupportedUrlAlertMessage();const h="apiKey"===e;if(t()){this.isLoading=!0;const{result:e}=await(0,s.y)(a.a.id,(0,n.g)(o.c.portal),{appType:i,redirect_uris:g,url:v});return this.isLoading=!1,void(e?this.workflowComplete.emit({id:a.a.id,redirectUrls:g,httpReferrers:m,clientId:e.client_id,clientSecret:e.client_secret,appType:e.appType}):this.setUnsupportedUrlAlertMessage())}a.a.developerCredentialsType=e,a.a.applicationEnvironment=h?void 0:i,a.a.apiKeyReferrerUrls=h?m:void 0,a.a.developerCredentialsRedirectUrls=g,a.a.type=h?"API Key":"Application",a.a.url=h?void 0:v,this.newItemUpdatePage.emit(h?"serviceScope":"itemProperties")}render(){const{i18n:e,selectedCredentialType:i,selectedApplicationEnvironment:t,redirectUrls:n,alertInfo:o,isLoading:s,referrerUrls:d,url:u,canCreateAPIKey:p,canShowLearnMore:v}=this;return(0,r.h)(r.H,{class:{"overflow-hidden":s}},(0,r.h)("arcgis-new-item-loader",{active:s,text:e.registering}),(0,r.h)("div",null,p?(0,r.h)(r.F,null,(0,r.h)("div",{class:"title-container"},(0,r.h)("arcgis-new-item-description",{header:e.title}),(0,r.h)("arcgis-information",{label:e.onboard.title,placement:"bottom-start",heading:e.onboard.title,headingLevel:3,class:"onboarding",overlayPositioning:"fixed",paddedContent:!1},(0,r.h)("div",{class:"onboarding__scroll"},(0,r.h)("img",{class:"illustration",src:(0,r.a)("./assets/cred-type.png")}),c.d.map((i=>{const{description:t,title:n}=e.onboard[i];return(0,r.h)("div",{class:"onboarding__section"},(0,r.h)("h4",{class:"onboarding__title"},n),(0,r.h)("p",{class:"onboarding__description"},t))}))))),(0,r.h)("calcite-tile-select-group",{layout:"vertical",class:"tile-select"},c.d.map((t=>(0,r.h)("calcite-tile-select",{disabled:!!a.a.existingItem,checked:i===t,heading:e.options[t].title,description:e.options[t].description,name:"dev-cred-create-mode","input-enabled":!0,width:"full",type:"radio",value:t,onCalciteTileSelectChange:e=>this.selectedCredentialType=e.target.value}))))):(0,r.h)("p",{innerHTML:v?e.oauth2Hint.replace("${apiLinkStart}",'<a href="https://developers.arcgis.com/documentation/mapping-apis-and-services/security/oauth-2.0/" target="_blank">').replace("${endLink}","</a>"):e.oauth2HintNoLink})),(0,r.h)("div",{class:"section"},(0,r.h)("arcgis-data-array-management",{header:e.redirectUrlsTitle,description:e.redirectUrlsDescription,addNewText:l.u.i18n.common.add,placeholder:"https://<server>[:port]",initialData:n,required:!0,validateData:e=>{const i=new RegExp(/[^ -~]/).test(e.content);return e.content.length>0&&!i},onDataChanged:({detail:{allData:e}})=>{this.redirectUrls=e.map((e=>e.content))},ref:e=>this.redirectManagmentRef=e})),"apiKey"===i&&(0,r.h)("div",{class:"section"},(0,r.h)("arcgis-data-array-management",{header:e.refererrUrlsTitle,description:e.refererrUrlsDescription,addNewText:l.u.i18n.common.add,placeholder:"http://*.your-app.com",initialData:d,required:!0,validateData:e=>e.content.length>0,onDataChanged:({detail:{allData:e}})=>{this.referrerUrls=e.map((e=>e.content))},ref:e=>this.referrerManagmentRef=e})),"oauth"===i&&(0,r.h)(r.F,null,(0,r.h)("div",{class:"section"},(0,r.h)("arcgis-application-environment",{defaultEnvironment:t,onArcgisApplicationEnvironmentChange:e=>{this.selectedApplicationEnvironment=e.detail}})),(0,r.h)("div",{class:"section"},(0,r.h)("arcgis-new-item-url",{onNewItemUrlChange:e=>this.url=e.detail.url,url:u,ref:e=>this.urlRef=e,required:!1,headerScale:"m"}))),(0,r.h)("arcgis-new-item-alert",{heading:null==o?void 0:o.title,description:null==o?void 0:o.description,active:!!o,onAlertDismiss:()=>this.alertInfo=null}))}static get assetsDirs(){return["assets"]}};p.style=".title-container{display:flex;align-items:center}.onboarding{--arcgis-information-min-width:0}.onboarding__scroll{overflow:auto;max-height:min(700px, 60vh)}.onboarding__section{padding-bottom:1rem;padding-top:0.5rem;padding-left:0.75rem;padding-right:0.75rem;width:286px}.onboarding__title{color:var(--calcite-ui-text-1);font-size:0.875rem;padding-top:0;margin:0;font-weight:600}.onboarding__description{margin-top:0.5rem;margin-bottom:0.75rem;font-size:0.75rem;color:var(--calcite-ui-text-1)}.section{margin-top:2rem}.url-container{padding:1.5rem;margin-top:1rem;margin-bottom:1.5rem;background-color:var(--calcite-ui-background)}.info-card{display:flex;align-items:center;list-style-type:none}.url-input{width:100%;margin-top:0.5rem;-webkit-margin-end:1rem;margin-inline-end:1rem}.add-url{margin-top:1rem;width:-moz-fit-content;width:fit-content}.header{font-weight:500;font-size:1rem;color:var(--calcite-ui-text-1);margin-top:0;margin-bottom:0;padding:0}"},90784:(e,i,t)=>{t.d(i,{a:()=>n,b:()=>a,d:()=>r,o:()=>s,r:()=>o,s:()=>l});const r=["apiKey","oauth"],n=["basemap","geocodingNotStored","routing","serviceArea","geocodingStored","optimizedRouting","closestFacility","locationAllocation","multiVehicleRouting","costMatrix","geoEnrichment"],o=["basemap"],s=["geocodingNotStored"],a=["geocodingNotStored","routing","serviceArea"],l={basemap:"portal:apikey:basemaps",geocodingNotStored:"premium:user:geocode:temporary",routing:"premium:user:networkanalysis:routing",serviceArea:"premium:user:networkanalysis:servicearea",geocodingStored:"premium:user:geocode:stored",optimizedRouting:"premium:user:networkanalysis:optimizedrouting",closestFacility:"premium:user:networkanalysis:closestfacility",locationAllocation:"premium:user:networkanalysis:locationallocation",multiVehicleRouting:"premium:user:networkanalysis:vehiclerouting",costMatrix:"premium:user:networkanalysis:origindestinationcostmatrix",geoEnrichment:"premium:user:geoenrichment"}},59004:(e,i,t)=>{t.d(i,{a:()=>P,b:()=>d,c:()=>x,d:()=>g,e:()=>m,f:()=>f,g:()=>u,h:()=>v,i:()=>y,j:()=>w,k:()=>C,l:()=>l,m:()=>U,n:()=>c,o:()=>k,p:()=>A,q:()=>s,r:()=>I,s:()=>b,t:()=>S,u:()=>T});var r=t(62381),n=t(76134),o=t(41171);async function s(){return new Promise((async e=>{const{portal:i}=n.c;if(null==i?void 0:i.isPortal){const t=i.helperServices.geocode,r=await function(e){const{config:i,portal:t}=n.c;return new Promise((async(r,n)=>{const s=e.filter((e=>a(e.url,t))).filter((e=>e.isEsriBatchGeocoder))[0];if(s){const e=s.url.split("/servers/")[1].split("/rest/services/")[0],t=`${i.restBaseUrl}/content/items/${e}`;try{r((await(0,o.r)(t)).url)}catch(e){n(e)}}else n("No world geocoder configured")}))}(t);e(r)}else{const t=function(e){const i=null==e?void 0:e.portalHostname;return-1!==i.indexOf("dev")?"dev":-1!==i.indexOf("qa")?"qa":""}(i);e(`https://geocode${t}.arcgis.com/arcgis/rest/services/World/GeocodeServer`)}}))}function a(e="",i){var t;const r=i.isPortal,n=e.toLowerCase(),o=n.indexOf("/geocodeserver")>-1&&n.indexOf("/rest/services/")>-1,s=r&&n.indexOf(null===(t=i.portalHostname)||void 0===t?void 0:t.toLowerCase())>-1,a=!r&&n.indexOf("utility")&&n.indexOf(".arcgis.com")>-1;return o&&(s||a)}function l(e){return(0,r.n)(e)||(null==e?void 0:e.privileges.includes("portal:user:createItem"))}function c(e){return(0,r.n)(e)||(null==e?void 0:e.privileges.includes("portal:user:receiveItems"))}function d(e,i){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("portal:publisher:publishFeatures"))&&(!i.isPortal||i.isBackedBySDS)}function u(e,i){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("portal:publisher:publishTiles"))&&(!i.isPortal||i.isBackedBySDS)}function p(e){return!(0,r.n)(e)&&!0}function v(e){var i;return!(0,r.n)(e)&&(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:publisher:publishScenes"))}const g=e=>!(0,r.n)(e);function m(e,i,t){var r,n;const o=!!(null===(n=null===(r=i.helperServices)||void 0===r?void 0:r.rasterAnalytics)||void 0===n?void 0:n.url),s=function(e,i,t){var r;return(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:publisher:publishDynamicImagery"))&&(i.isPortal||h(t))}(e,i,t),a=i.isPortal?s:s||function(e,i,t){var r;return(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:publisher:publishTiledImagery"))&&!i.isPortal&&h(t)}(e,i,t);return o&&a}function h(e){return null==e?void 0:e.some((e=>{var i;return null===(i=e.entitlements)||void 0===i?void 0:i.some((e=>"image"===e.toLowerCase()))}))}async function f(e){var i;const{userLicensedItems:t}=await(0,o.r)(`${null!==(i=e.restUrl)&&void 0!==i?i:e.portalUrl}/community/self?returnUserLicensedItems=true`);return t}function y(e,i){var t,n;const o=null===(t=i.helperServices)||void 0===t?void 0:t.geocode.some((({url:e})=>a(e,i))),s=null!==(n=null==e?void 0:e.privileges)&&void 0!==n?n:[];return!(0,r.n)(e)&&o&&(!i.isPortal||!i.isWebTierAuth&&s.includes("portal:user:viewOrgItems")&&s.includes("portal:user:createItem"))}const w=e=>!(0,r.n)(e);function b(e){return null==e?void 0:e.privileges.includes("premium:publisher:createAdvancedNotebooks")}function I(e){return null==e?void 0:e.privileges.includes("premium:publisher:createNotebooks")}function C(e,i){var t;return!!i.isPortal&&!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:publisher:registerDataStores"))}function U(e){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("premium:user:geocode"))}function x(e,i,t){return!i.isPortal&&d(e,i)&&function(e,i,t){return!(0,r.n)(e)&&!!i.supportsHostedServices&&l(e)&&(u(e,i)||d(e,i)||v(e)||p(e)||m(e,i,t))}(e,i,t)}function P(e,i,t){switch(i){case"CSV":case"GeoJson":case"Microsoft Excel":case"Shapefile":case"File Geodatabase":case"Photos with Locations":return d(e,t);case"Tile Package":return u(e,t);case"Vector Tile Package":return p(e);case"Scene Package":return v(e);case"Service Definition":return function(e,i){return d(e,i)&&u(e,i)}(e,t);default:return!0}}function k(e,i){var t;return(0,r.e)(e)||function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:manageCredits"))}(e)||!!((null==e?void 0:e.assignedCredits)>-1&&(null===(t=null==i?void 0:i.portalProperties)||void 0===t?void 0:t.showCreditsOnProfile))}const A=e=>!1;function S(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:viewGroups"))}function T(e){return(0,r.e)(e)||function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:viewUsers"))}(e)&&function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:viewItems"))}(e)&&(function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:updateItems"))}(e)||function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:deleteItems"))}(e)||function(e){var i;return!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:admin:reassignItems"))}(e))}},55470:(e,i,t)=>{t.d(i,{g:()=>n});var r=t(41171);const n=async e=>{try{return{result:await(0,r.r)(`${(0,r.g)(e)}portals/self/subscriptionInfo`)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}}}]);