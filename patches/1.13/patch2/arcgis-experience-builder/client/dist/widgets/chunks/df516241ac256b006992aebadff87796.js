"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[94187],{94187:(e,t,i)=>{i.r(t),i.d(t,{arcgis_infographic_selector:()=>d,arcgis_infographic_tree:()=>c});var s,o=i(30396),n=i(57123),r=i(14298),a=i(99678),l=i(31367);class h{static nextCallback(e){e&&(this._callbackNext=e)}static previousCallback(e){e&&(this._callbackPrev=e)}static hidePopup(){this._cancelTimer(),this._removePopup(),this._reportId=""}static _onTimerTick(){this._timer=void 0,this.hidePopup()}static _onGoToNext(){this._callbackNext&&this._callbackNext(this._reportId)}static _onGoToPrev(){this._callbackPrev&&this._callbackPrev(this._reportId)}static _startTimer(){const e=this;e._cancelTimer(),e._timer=setTimeout((()=>{e._onTimerTick.call(e)}),1e3*this.timeoutSeconds)}static _cancelTimer(){this._timer&&(clearTimeout(this._timer),this._timer=void 0)}static _resetTimer(){this._cancelTimer(),this._startTimer()}static _removePopup(){this._popupElement&&this._popupElement.remove(),this._popupElement=void 0}static _generatePopup(e,t,i){const s=this,o=document.createElement("div");o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.width=this._container.offsetWidth-this._rightPad+"px",o.style.height=this._container.offsetHeight+"px",o.style.backgroundColor="transparent",o.style.zIndex="900",this._popupElement=o,this._container.appendChild(this._popupElement),o.addEventListener("mouseover",(()=>{s.hidePopup()})),this._placeImageDiv(e,t,i)}static _placeImageDiv(e,t,i){try{const s=20,o=document.createElement("img");let n={click:{y:e},popup:{top:0,right:0,wt:1,ht:1},adjustedContHt:0,adjustedContWt:0,ratio:t};n.adjustedContHt=this._popupElement.offsetHeight-2*s,n.adjustedContWt=this._popupElement.offsetWidth-s,n.ratio>=1?(n.popup.wt=n.adjustedContWt,n.popup.ht=n.popup.wt/n.ratio,n.popup.ht>n.adjustedContHt&&(n.popup.ht=n.adjustedContHt,n.popup.wt=n.adjustedContHt*n.ratio)):(n.popup.ht=n.adjustedContHt,n.popup.wt=n.popup.ht*n.ratio,n.popup.wt>n.adjustedContWt&&(n.popup.wt=n.adjustedContWt,n.popup.ht=n.adjustedContWt/n.ratio));const r=Math.max(n.click.y-n.popup.ht/2,s),a=n.adjustedContHt-n.popup.ht+s;n.popup.top=Math.min(r,a),n.popup.right=0,o.style.position="absolute",o.style.right=n.popup.right+"px",o.style.top=n.popup.top+"px",o.style.width=n.popup.wt+"px",o.style.height=n.popup.ht+"px",o.src=i,this._popupElement.appendChild(o),o.addEventListener("mouseover",(e=>(e.stopPropagation(),e.preventDefault(),!1)))}catch(e){console.log("%c PreviewPopup error","color:red;font-size:10pt",e)}return document.createElement("img")}}s=h,h.show=(e,t,i,o,n)=>{t&&i&&n&&r.U.hasText(n)&&(e==s._reportId?s._resetTimer():(s.hidePopup(),s.timeoutSeconds||(s.timeoutSeconds=6),s._container=t,s._reportId=e,s._generatePopup(i,o,n),s._startTimer()))},h._rightPad=60;const c=class{constructor(e){(0,o.r)(this,e),this.reportSelected=(0,o.c)(this,"reportSelected",7),this._idPrefix="arcgis-infographic-tree-",this._idPrefixBusy="arcgis-infographic-tree-busy-",this._busyIdPrefix="ig-tree-busy-",this._containerPrefix="ait-container-",this._elementIds={},this._idListPrefix="ig-tree-list-",this._idSearchPrefix="ig-tree-search-",this._idSortPrefix="ig-tree-sort-",this._idPrefixReports="selector-popover-reports-",this._imgOffset=1,this._dbg=!1,this.stSourceCountry="US",this.stMultipleChoice=!1,this.stSortType="newest",this._isInitialized=!1,this.openPopoverId=null,r.L.debug=!1,r.L.darkTheme=!0,this.baseConfig=new n.B("tree",this,this.onUpdateUI),r.A.announceVersion(),this._instanceId=r.E.generateId(this._idPrefix).id,this._busyId=r.E.generateId(this._busyIdPrefix).id,this._infographics={MyInfographics:{dataId:2,tag:"report-my-infographics",data:void 0},EsriInfographics:{dataId:3,tag:"report-esri-infographics",data:void 0},SharedInfographics:{dataId:4,tag:"report-shared-infographics",data:void 0},GalleryInfographics:{dataId:5,tag:"report-gallery-infographics",data:void 0}},this.langCode="en-us",this.sourceCountry="US",this.stMultipleChoice=!1,r.B._initialize(this.langCode)}onConfigChange(e,t){if(e&&"string"==typeof e&&this.baseConfig&&r.A.hasText(e)){const i=JSON.parse(e),s=t&&r.A.hasText(t)?JSON.parse(t):null;if(this.baseConfig.updateConfig(i,s),this.baseConfig.config?.reportList){let e={};const t="string"==typeof this.baseConfig.config.reportList?JSON.parse(this.baseConfig.config.reportList):this.baseConfig.config.reportList,i=r.A.getKeys(t);if(i&&i.length>0)for(let s=0;s<i.length;s++){let o=[];const n=i[s],r=t[n];r.length>0&&r.forEach((e=>{e.isChecked&&o.push(e)})),o.length>0&&(e[n]=o)}this._configFilteredReports=e}else this._configFilteredReports=void 0}}onEnvChanged(){this.stEnv=this.env,a.E.setEnvironment(this.env),this.baseConfig&&this.baseConfig.updateConfig({env:this.env},null)}onLangCodeChanged(){this.stLangCode=this.langCode,r.B._initialize(this.stLangCode),this.baseConfig&&this.baseConfig.updateConfig({langCode:this.langCode},null)}onSourceCountryChanged(){this.stSourceCountry=this.sourceCountry,this.baseConfig&&this.baseConfig.updateConfig({sourceCountry:this.sourceCountry},null),this._configFilteredReports=void 0,this._cachedReports=void 0,this.stReportList=void 0}onTokenChanged(){this.stToken=this.token,this.baseConfig&&this.baseConfig.updateConfig({token:this.token},null),this.username&&r.A.hasText(this.username)&&this.token&&r.A.hasText(this.token)&&(0,l.s)(this.username,this.token)}onUsernameChanged(){this.stUsername=this.username,this.baseConfig&&this.baseConfig.updateConfig({username:this.username},null),this.username&&r.A.hasText(this.username)&&this.token&&r.A.hasText(this.token)&&(0,l.s)(this.username,this.token)}onSelectedReportChanged(){this.stSelectedReportId=this.selectedReportId}onReportListChanged(){this.stReportList=Object.keys(this.reportList).length?JSON.parse(this.reportList):{}}onThemeChanged(){this.stTheme=this.theme,this.baseConfig&&this.baseConfig.setTheme(this.theme)}onPortalUrlChanged(){this.portalUrl&&a.E.setPortalUrl(this.portalUrl)}onGeoenrichmentUrlChanged(){this.stGeoenrichmentUrl=this.geoenrichmentUrl,this.baseConfig&&this.baseConfig.updateConfig({geoenrichmentUrl:this.geoenrichmentUrl},null),this.geoenrichmentUrl&&a.E.setGeoenrichmentUrl(this.geoenrichmentUrl)}async updateLayout(){this.adjustTreeItemsWidth()}async getConfig(){return this.baseConfig}async initialize(e,t,i,s,n,h){const c=this;c.token=t,c.username=e,c.sourceCountry=s,c.langCode=n,c.env=i,c.stReportList=Object.keys(h).length?JSON.parse(h):{},a.E.setEnvironment(c.env),c.geoenrichmentUrl&&a.E.setGeoenrichmentUrl(c.geoenrichmentUrl),c.portalUrl&&a.E.setPortalUrl(c.portalUrl),(0,l.s)(e,t);try{let e,t,i,n;const r=await(0,l.g)(s,!1);Object.keys(c.stReportList).length?(e=c.stReportList.user,t=c.stReportList.public,i=c.stReportList.shared):(e=r.user.map((e=>({...e,isChecked:!0}))),t=r.public.map((e=>({...e,isChecked:!0}))),i=r.shared.map((e=>({...e,isChecked:!0}))),n=r.gallery.map((e=>({...e,isChecked:!1}))),c.stReportList={user:e,public:t,shared:i,gallery:n}),r?(c._infographics.MyInfographics.data=e,c._infographics.EsriInfographics.data=t,c._infographics.SharedInfographics.data=i,c._infographics.GalleryInfographics.data=n):(c._infographics.MyInfographics.data=void 0,c._infographics.EsriInfographics.data=void 0,c._infographics.SharedInfographics.data=void 0,c._infographics.GalleryInfographics.data=void 0),this._isInitialized=!0;const a=(0,o.h)("calcite-tree",{scale:"m",selectionMode:"single"},c.renderList("MyInfographics"),c.renderList("EsriInfographics"),c.renderList("SharedInfographics"),c.renderList("GalleryInfographics"));c._content=a,c.showBusy.call(c,!1)}catch(e){r.L.show("%e","arcgis-infographic-tree request for esri reports failed",e)}}setLocaleStrings(){}showBusy(e){const t=r.A.queryElementById.call(this,this._busyId);t&&(t.style.display=e?"block":"none")}async setColorTheme(e){if(e&&r.A.hasText(e)&&this.el){this.stColorTheme=e.trim().toLowerCase();const t=e.trim().toLowerCase();"light"===t?(this.el.style.setProperty("--calcite-ui-brand","#007ac2"),this.el.style.setProperty("--calcite-ui-brand-hover","#00619b"),this.el.style.setProperty("--calcite-ui-brand-press","#004874"),this.el.style.setProperty("--calcite-ui-background","#f8f8f8"),this.el.style.setProperty("--calcite-ui-foreground-1","#ffffff"),this.el.style.setProperty("--calcite-ui-foreground-2","#f3f3f3"),this.el.style.setProperty("--calcite-ui-foreground-3","#eaeaea"),this.el.style.setProperty("--calcite-ui-text-1","#151515"),this.el.style.setProperty("--calcite-ui-text-2","#4a4a4a"),this.el.style.setProperty("--calcite-ui-text-3","#6a6a6a"),this.el.style.setProperty("--calcite-ui-text-inverse","#ffffff"),this.el.style.setProperty("--calcite-ui-text-link","#00619b"),this.el.style.setProperty("--calcite-ui-border-1","#cacaca"),this.el.style.setProperty("--calcite-ui-border-2","#d4d4d4"),this.el.style.setProperty("--calcite-ui-border-3","#dfdfdf"),this.el.style.setProperty("--calcite-ui-border-input","#949494"),this.el.style.setProperty("--calcite-ui-info","#00619b"),this.el.style.setProperty("--calcite-ui-success","#35ac46"),this.el.style.setProperty("--calcite-tree-padding-y","0")):"dark"===t&&(this.el.style.setProperty("--calcite-ui-brand","#009af2"),this.el.style.setProperty("--calcite-ui-brand-hover","#007ac2"),this.el.style.setProperty("--calcite-ui-brand-press","#00619b"),this.el.style.setProperty("--calcite-ui-background","#353535"),this.el.style.setProperty("--calcite-ui-foreground-1","#2b2b2b"),this.el.style.setProperty("--calcite-ui-foreground-2","#202020"),this.el.style.setProperty("--calcite-ui-foreground-3","#151515"),this.el.style.setProperty("--calcite-ui-text-1","#ffffff"),this.el.style.setProperty("--calcite-ui-text-2","#bfbfbf"),this.el.style.setProperty("--calcite-ui-text-3","#9f9f9f"),this.el.style.setProperty("--calcite-ui-text-inverse","#151515"),this.el.style.setProperty("--calcite-ui-text-link","#00a0ff"),this.el.style.setProperty("--calcite-ui-border-1","#555555"),this.el.style.setProperty("--calcite-ui-border-2","#4a4a4a"),this.el.style.setProperty("--calcite-ui-border-3","#404040"),this.el.style.setProperty("--calcite-ui-border-input","#757575"),this.el.style.setProperty("--calcite-ui-info","#00a0ff"),this.el.style.setProperty("--calcite-ui-success","#36da43"))}}_loadInstances(){this._instanceId||(this._instanceId=r.E.generateId(this._idPrefix).id),this._busyId||(this._busyId=r.E.generateId(this._idPrefixBusy).id),this._elementIds.list||(this._elementIds.list=r.E.generateId(this._idListPrefix).id),this._elementIds.search||(this._elementIds.search=r.E.generateId(this._idSearchPrefix).id),this._elementIds.sort||(this._elementIds.sort=r.E.generateId(this._idSortPrefix).id)}onUpdateUI(){}onClickTreeItem(e,t){return h.hidePopup(),this.reportSelected.emit({report:t}),e.stopPropagation(),e.preventDefault(),!1}applySort(e){if(e&&e.length>0){const t=[...e];let i=this.stSortType||"newest";const s=r.A.queryElementById.call(this,r.A.fixId(this._elementIds.sort));if(void 0!==s&&(i=s.value),i)switch(i){case"oldest":t.sort(((e,t)=>e.date-t.date));break;case"ascending":t.sort(((e,t)=>{let i=e.title,s=t.title;return i<s?-1:i>s?1:0}));break;case"descending":t.sort(((e,t)=>{let i=e.title,s=t.title;return i>s?-1:i<s?1:0}));break;default:t.sort(((e,t)=>{let i=e.date;return t.date-i}))}return t}return e}getFilteredReportList(e){const t=[],i={MyInfographics:"user",EsriInfographics:"public",SharedInfographics:"shared",GalleryInfographics:"gallery"}[e],s=this._configFilteredReports||this.stReportList||this._cachedReports,o=s[i],n=this.el.querySelector("#"+this._elementIds.search);if(!n)return this.applySort(o);{const e=n.value.trim().toLowerCase();if(!e||!r.A.hasText(e))return this.applySort(o);s&&s[i]&&s[i].length>0&&s[i].forEach((i=>{const s=i.title;s&&r.A.hasText(s)&&s.toLowerCase().includes(e)&&t.push(i)}))}return this.applySort(t)}onUpdateThumbnailPopoverSize(){if(!this.el)return;let e=100;const t=document.documentElement.clientHeight,i=document.documentElement.clientWidth,s=this.el.offsetTop,o=t-(this.el.offsetTop+this.el.offsetHeight)+window.scrollY;let n=i/2;const a=i-this.el.offsetLeft+window.scrollX;e=o<100&&o<s?s-36:o-36,n=Math.max(200,Math.min(a-16,735));const l=r.A.queryElementById.call(this.el,this._elementIds.content);l&&l&&(l.style.height=e+"px");const h=r.A.queryElementById.call(this.el,this._elementIds.popover);h&&(h.style.width=n+"px");const c=r.A.queryElementById.call(this.el,this._elementIds.reports);c&&c.updateLayout()}handleMouseOver(e,t){const i=e.clientY,s=t;return this._debounce2((()=>{h.hidePopup();const e=c._getThumbnailUrl(s);if(e&&e.isOk){const t=this.el.closest("calcite-popover");if(t){const o=t.getBoundingClientRect(),n=i-o.top;h.show(s,t,n,e.ratio,e.url)}}}),200),!0}handleMouseOut(){this._debounce2((()=>{h.hidePopup()}),300)}static _setThumbnailIndex(e,t,i,s){c.ThumbnailIndex[e]={url:i,ratio:t,isOk:s}}static _getThumbnailUrl(e){return c.ThumbnailIndex[e]}renderList(e){this._dbg&&console.log("%c TREE renderList","color:orange;font-size:11pt",e);const t=this,i={MyInfographics:"report-my-infographics",EsriInfographics:"report-esri-infographics",SharedInfographics:"report-shared-infographics",GalleryInfographics:"report-gallery-infographics",NoPreviewAvailable:"preview-not-available"};let s="EsriInfographics"===e;const n={position:"relative",width:"100%",height:"100%"},l=t.getFilteredReportList(e);if(l&&l.length>0){l.length<=16&&(s=!0);let h=r.B.i18n(i[e]);"??"===h&&(r.L.show("%e","Missing Report Category name",i[e]),h=r.B.i18n(i[e]));const d=this.getFilteredReportList(e);if(this._dbg&&console.log("%c TREE renderList["+e+"] filtered=","font-size:12pt;color:orange;",d),!d)return;if(r.A.isDef(d)){let p=!1;return d.forEach((e=>{e.isChecked&&(p=!0)})),p?(0,o.h)("div",{style:n},(0,o.h)("calcite-tree-item",{class:"reportList",slot:"children",expanded:s},h,l.length>0&&(0,o.h)("calcite-tree",{slot:"children",class:"reportTree"},l.map((s=>{if(d.some((e=>e.id===s.id&&!0===e.isChecked))){const n="tree-item-"+s.id,l=n+"-prev",h=n+"-pop";return function(e,s,o,n,l){if(r.A.hasText(e)&&r.A.hasText(s)&&r.A.hasText(o)){t._dbg&&console.log("%c TREE _getThumbnail","font-size:11pt;color:orange;");const h=s,d=o,p=n;function g(e){const s=t.el.querySelector(r.A.fixId(d));s&&s.remove();const o=t.el.querySelector(r.A.fixId(e));if(o){const t=document.createElement("calcite-tooltip");t.setAttribute("reference-element",e),t.style.minWidth="160px",t.style.left="-40px";const s=document.createElement("span");s.innerText=r.B.i18n(i.NoPreviewAvailable),t.appendChild(s),o.appendChild(t)}}function u(e){return"EsriInfographics"===e&&!(!t.portalOnlineGEProxy||a.E.isAGOPortal(a.E.getPortalBase()))}let f=!0;const m=c._getThumbnailUrl(s);if(m&&(m.isOk||0==m.isOk)&&(f=!1),f){let y="";function C(e,i,s,o,n){c._setThumbnailIndex(s,o/n,i,!0);const a=t.el.querySelector(r.A.fixId(e));if(a){const e=a.querySelector("calcite-tooltip");e&&e.remove()}}function b(e,t,i){c._setThumbnailIndex(i,1,t,!1),g(e)}y=u(l)?"https://www.arcgis.com/sharing/rest/content/items/"+h+"/resources/thumbnail.png":a.E.getPortalBase()+"/sharing/rest/content/items/"+h+"/resources/thumbnail.png?token="+t.token;try{const _=new Image;_.onload=function(){const e=this.width,t=this.height;C(p,y,h,e,t)},_.onerror=()=>{b(p,y,h)},_.src=y}catch(v){b(p,y,h)}}}}(t._instanceId+"-img"+t._imgOffset++,s.id,h,l,e),(0,o.h)("div",{class:"report-tree-dropdown"},(0,o.h)("calcite-tree-item",{id:n,selected:s.id===t.stSelectedReportId,class:"reportItems",data:s.id,onClick:e=>t.onClickTreeItem(e,{thumbnail:h,id:s.id,name:s.title})},(0,o.h)("div",{class:"report-item-content"},(0,o.h)("div",{class:"report-item-text"},s.title),(0,o.h)("div",{class:"report-item-buttons"},(0,o.h)("div",null,(0,o.h)("div",{id:l,class:"report-item-preview",onMouseOver:e=>this.handleMouseOver(e,s.id),onMouseOut:()=>this.handleMouseOut()},(0,o.h)("svg",{"aria-hidden":"true",class:"svg",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.h)("path",{d:"M17 16h-5.525a5.95 5.95 0 0 0-.172-1H17zm2-7h-9v1h9zm0 3h-9v.544q.193.22.364.456H19zm3 8H11.818l-.913-.913c.014-.028.023-.059.037-.087H21V7h-4V3H8v8.053a5.945 5.945 0 0 0-1-.356V2h11.4L22 5.6zM21 5.69L18.31 3H18v3h3zM8.926 19.23l3.085 3.084a.476.476 0 0 1 0 .674l-.017.017a.476.476 0 0 1-.673 0L8.237 19.92A4.383 4.383 0 1 1 9.9 16.5a4.358 4.358 0 0 1-.974 2.73zM5.5 19.9a3.4 3.4 0 1 0-3.4-3.4 3.404 3.404 0 0 0 3.4 3.4z"}))))))))}}))))):""}return""}return""}async refreshInfographicList(){const e=this;let t,i,s,n;this._dbg&&console.log("%c TREE refreshInfographicList","font-size:12pt;color:orange;",e.stReportList);const a=this._configFilteredReports||this.stReportList||this._cachedReports;if(this.baseConfig.config?.reportList){const e="string"==typeof this.baseConfig.config.reportList?JSON.parse(this.baseConfig.config.reportList):this.baseConfig.config.reportList,t=r.A.getKeys(e);0==t?.length&&(delete a?.user,delete a?.shared,delete a?.gallery)}let h;a&&Object.keys(a).length?(t=a.user,i=a.public,s=a.shared,n=a.gallery):(e._isInitialized=!1,h=await(0,l.g)(e.sourceCountry,!1),t=h.user.map((e=>({...e,isChecked:!0}))),i=h.public.map((e=>({...e,isChecked:!0}))),s=h.shared.map((e=>({...e,isChecked:!0}))),n=h.gallery.map((e=>({...e,isChecked:!0}))),this._configFilteredReports=void 0,e._cachedReports={user:t,public:i,shared:s,gallery:n},e._isInitialized=!0),a||h?(e._infographics.MyInfographics.data=t,e._infographics.EsriInfographics.data=i,e._infographics.SharedInfographics.data=s,e._infographics.GalleryInfographics.data=n):(e._infographics.MyInfographics.data=void 0,e._infographics.EsriInfographics.data=void 0,e._infographics.SharedInfographics.data=void 0,e._infographics.GalleryInfographics.data=void 0);const c=(0,o.h)("calcite-tree",{scale:"m",selectionMode:"single"},e.renderList("MyInfographics"),e.renderList("EsriInfographics"),e.renderList("SharedInfographics"),e.renderList("GalleryInfographics"));e._content=c,e.adjustTreeItemsWidth()}async getLocalFilteredInfographicsList(){}async componentWillLoad(){const e=this;e.env&&e.onEnvChanged(),e.token&&e.onTokenChanged(),e.username&&e.onUsernameChanged(),e.selectedReportId&&e.onSelectedReportChanged(),e.reportList&&e.onReportListChanged(),e.langCode&&e.onLangCodeChanged(),e.geoenrichmentUrl&&e.onGeoenrichmentUrlChanged(),e.sourceCountry&&e.onSourceCountryChanged(),e.portalUrl&&e.onPortalUrlChanged(),e.config&&e.onConfigChange(e.config,""),this.theme?this.baseConfig.setTheme(this.theme):this.baseConfig.setTheme("light"),e._loadInstances();try{await e.refreshInfographicList(),e._isInitialized=!0}catch(e){r.L.show("%e","arcgis-infographic-tree request for esri reports failed",e)}}componentDidUpdate(){const e=this;e.showBusy.call(this,!1),e.baseConfig&&e.baseConfig.onComponentHasRendered(),e._cachedReports&&(e.stReportList=e._cachedReports,e._cachedReports=void 0)}componentDidLoad(){const e=this;e._loadInstances(),e.showBusy.call(e,!1);const t=this.el.querySelector("#"+this._elementIds.search);function i(){e.adjustTreeItemsWidth()}window.removeEventListener("resize",i),window.addEventListener("resize",i),e.adjustTreeItemsWidth();const s=t=>{const i=t.currentTarget.closest("calcite-tree-item");if(i){const s=i.id.substring(10);if(r.A.hasText(s)){e.selectedReportId=s,e.onSelectedReportChanged();let o="";const n=i.querySelector("div.report-item-text");n&&(o=n.innerText),e.onClickTreeItem(t,{id:s,name:o})}}},o=r.A.queryElementAll.call(e,"div.default-popover-content");if(!o||o.length>0)for(let e=0;e<o.length;e++)o[e].removeEventListener("click",s),o[e].addEventListener("click",s);const n=()=>{e._debounce2((()=>{e.stTimestamp=(new Date).getTime()}),500)},a=r.A.queryElementById.call(e,r.A.fixId(e._elementIds.sort));a&&a.addEventListener("calciteSelectChange",(()=>{e.stSortType=a.value})),t&&(t.removeEventListener("input",n),t.addEventListener("input",n),t.addEventListener("calciteInputChange",n)),e.adjustTreeItemsWidth()}_debounce2(e,t){const i=this;i._debounceTimer&&clearTimeout(i._debounceTimer),i._debounceTimer=setTimeout((function(){i._debounceTimer=null,e.apply(i)}),t)}adjustTreeItemsWidth(){if(this.el){const e=this.el.querySelectorAll("div.report-item-content");if(!e||e.length<=0)return;const t=e[0].closest(".reportList");if(t){const i=t.offsetWidth;e.forEach((e=>{e.style.width=i-60+"px"}))}}const e=this.el.parentElement?.parentElement,t=e?.style?.width;if(t&&r.A.hasText(t)){const e=parseInt(t);if(!Number.isNaN(e)){const t=.9*e;if(t>300){const e=this.el.querySelectorAll("img.thumbnail-preview");e&&e.forEach((e=>{e.style.maxWidth=t+"px",e.style.maxHeight=.66*t+"px"}))}}}}render(){const e=r.B.i18n("search-infos-by-name"),t=r.B.i18n("date-sort-newest"),i=r.B.i18n("date-sort-oldest"),s=r.B.i18n("name-sort-asc"),n=r.B.i18n("name-sort-desc");return this.refreshInfographicList(),(0,o.h)("div",{id:this._instanceId,style:{position:"absolute",width:"calc(100% - 12px)",height:"calc(100% - 8px)","overflow-x":"hidden","overflow-y":"scroll"},class:"arcgis-tree-outer"},(0,o.h)("div",{id:this._busyId,class:"infographic-tree-busy"}),(0,o.h)("div",{class:"info-tree-search-div"},(0,o.h)("calcite-input",{clearable:"true",id:this._elementIds.search,placeholder:e,class:"info-tree-search"}),(0,o.h)("div",{id:this._elementIds.icon,class:"info-tree-icon"},(0,o.h)("calcite-icon",{scale:"l",icon:"search"}))),(0,o.h)("calcite-select",{id:this._elementIds.sort,class:"info-tree-sort"},(0,o.h)("calcite-option",{value:"newest"},t),(0,o.h)("calcite-option",{value:"oldest"},i),(0,o.h)("calcite-option",{value:"ascending"},s),(0,o.h)("calcite-option",{value:"descending"},n)),(0,o.h)("div",{id:this._elementIds.list,class:"info-tree-list"},(0,o.h)("div",null,this._content)))}get el(){return(0,o.g)(this)}static get watchers(){return{config:["onConfigChange"],env:["onEnvChanged"],langCode:["onLangCodeChanged"],sourceCountry:["onSourceCountryChanged"],token:["onTokenChanged"],username:["onUsernameChanged"],selectedReportId:["onSelectedReportChanged"],reportList:["onReportListChanged"],theme:["onThemeChanged"],portalUrl:["onPortalUrlChanged"],geoenrichmentUrl:["onGeoenrichmentUrlChanged"]}}};c.ThumbnailIndex={},c.style=':host{display:block}::slotted([slot="children"]){width:100%}.reportList{font-weight:200}.reportItems{font-weight:200;margin-inline-end:0.25rem}.report-item-buttons{position:relative;width:23px;height:28px}.report-item-preview{position:absolute;top:5px;width:22px;height:22px}.report-item-dots{position:absolute;top:7px;left:34px;width:22px;height:22px}.reportTree{padding-bottom:2px}.infographic-tree-busy{position:absolute;top:0;left:0;width:100%;height:100%;background:url(./assets/largeBusy.gif);background-repeat:no-repeat;background-position:center;z-index:999;display:none}calcite-tree-item [selected]{font-weight:bold}.report-item-content{width:100%;height:32px;display:flex}.report-refresh-button{position:absolute;top:8px;right:10px;width:18px;height:18px}.info-tree-search-div{position:absolute;top:3px;left:3px;width:calc(100% - 165px);height:33px;display:flex}.info-tree-search{flex:1 1 0%;width:calc(100% - 29px);height:24px;float:left}.info-tree-icon{position:relative;top:4px;left:2px;width:24px;height:26px;float:right;transform:scale(0.6);background-repeat:no-repeat}.info-tree-sort{position:absolute;top:3px;left:calc(100% - 148px);width:144px;height:32px;z-index:6}.info-tree-list{position:absolute;top:36px;left:3px;height:calc(100% - 40px);width:calc(100% - 6px)}.report-item-text{position:relative;top:7px;flex:1 1 0%;text-align:left;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-weight:200}.report-item-popover{width:auto;height:auto;min-width:300px;min-height:200px;background-color:transparent}.report-item-popover-content{min-height:32px;line-height:200px;text-align:right}.report-item-default-popover{min-width:160px;padding:3px;height:42px}.tree-container{position:absolute;width:calc(100% - 12px);height:calc(100% - 18px);overflow-x:hidden;overflow-y:scroll}.thumbnail-preview{position:absolute;top:0;right:0;max-width:300px;max-height:200px;background-color:transparent;border:none;z-index:6;opacity:1;object-fit:cover}.report-item-popover-not-found{position:absolute;top:4px;right:41px;min-width:160px;height:32px !important;line-height:24px !important}';const d=class{constructor(e){(0,o.r)(this,e),this.infographicSelectorPopupOpened=(0,o.c)(this,"infographicSelectorPopupOpened",6),this.infographicSelectorPopupClosed=(0,o.c)(this,"infographicSelectorPopupClosed",6),this._localeSettings={},this._popoverIsOpen=!1,this._idPrefix="arcgis-infographic-selector-",this._elementIds={},this._idButtonPrefix="selector-dropdown-button-",this._idDropdownArrowPrefix="selector-dropdown-arrow-",this._idDropdownLabelPrefix="selector-dropdown-label-",this._idReportListPrefix="selector-report-list-",this._idPopoverPrefix="selector-popover-",this._idPopoverContentPrefix="selector-popover-content-",this._report={id:null,name:""},this.baseConfig=new n.B("selector",this,this.onUpdateUI),r.A.announceVersion(),this.langCode=this.langCode||"en-us",r.B._initialize(this.langCode),this.setLocaleStrings(),this.sourceCountry=this.sourceCountry||"US",this.baseConfig.updateLocaleSettings({language:this.langCode,country:this.sourceCountry})}onEnvChanged(){a.E.setEnvironment(this.env),this.baseConfig&&this.baseConfig.updateConfig({env:this.env},null)}onTokenChanged(){const e=this.token,t=this.baseConfig?.config?.username;e&&r.A.hasText(e)&&t&&r.A.hasText(t)&&a.T.setToken(t,e),this.baseConfig&&this.baseConfig.updateConfig({token:this.token},null)}onUsernameChanged(){const e=this.username,t=this.baseConfig?.config?.token;t&&r.A.hasText(t)&&e&&r.A.hasText(e)&&a.T.setToken(e,t),this.baseConfig&&this.baseConfig.updateConfig({username:this.username},null)}onLangCodeChanged(){this.baseConfig&&this.baseConfig.updateConfig({langCode:this.langCode},null)}onGeoenrichmentUrlChanged(){this.baseConfig&&this.baseConfig.updateConfig({geoenrichmentUrl:this.geoenrichmentUrl},null)}onSelectedReportIdChanged(){this.baseConfig&&this.baseConfig.updateConfig({sourceCountry:this.sourceCountry},null)}onSourceCountryChanged(){this.baseConfig&&this.baseConfig.updateConfig({sourceCountry:this.sourceCountry},null)}onThemeChanged(){this.stTheme=this.theme,this.baseConfig&&this.baseConfig.setTheme(this.theme)}onConfigChange(e,t){if(this.baseConfig&&e&&r.A.hasText(e)){const i=JSON.parse(e),s=t&&r.A.hasText(t)?JSON.parse(t):null;this.baseConfig.updateConfig(i,s)}}async getConfig(){return this.baseConfig}reportSelectedEventHandler(e){const t=e.detail?.report;t?.id&&t?.name&&(this.selectedReportId=t.id,this.onSelectedReportIdChanged(),this._hidePlaceholderAndShowLabel(t.name),this.hidePopover())}defaultReportSelectedEventHandler(e){const t=e.detail?.reportId,i=e.detail?.name;if(t&&r.A.hasText(t)&&(this.selectedReportId=t,this.onSelectedReportIdChanged(),i)){const e=r.A.queryElementById.call(this,this._elementIds.label);e&&(e.innerText=i,this.hidePopover())}}onUpdateUI(){}_loadInstances(){this._instanceId||(this._instanceId=r.E.generateId(this._idPrefix).id),this._elementIds.label||(this._elementIds.label=r.E.generateId(this._idDropdownLabelPrefix).id),this._elementIds.button||(this._elementIds.button=r.E.generateId(this._idButtonPrefix).id),this._elementIds.popover||(this._elementIds.popover=r.E.generateId(this._idPopoverPrefix).id),this._elementIds.content||(this._elementIds.content=r.E.generateId(this._idPopoverContentPrefix).id),this._elementIds.arrow||(this._elementIds.arrow=r.E.generateId(this._idDropdownArrowPrefix).id),this._elementIds.reports||(this._elementIds.reports=r.E.generateId(this._idReportListPrefix).id)}setLocaleStrings(){}async componentWillLoad(){this.env&&this.onEnvChanged(),this.token&&this.onTokenChanged(),this.username&&this.onUsernameChanged(),this.langCode&&this.onLangCodeChanged(),this.geoenrichmentUrl&&this.onGeoenrichmentUrlChanged(),this.sourceCountry&&this.onSourceCountryChanged(),this.config&&this.onConfigChange(this.config,""),this.selectedReportId&&this.onSelectedReportIdChanged(),this.theme?this.baseConfig.setTheme(this.theme):this.baseConfig.setTheme("light"),this._loadInstances()}componentDidUpdate(){this.baseConfig&&this.baseConfig.onComponentHasRendered()}onClickDropdown(e){e.stopPropagation(),this.onUpdatePopoverSize(),this._popoverIsOpen=!this._popoverIsOpen,this._popoverIsOpen?this.infographicSelectorPopupOpened.emit():this.infographicSelectorPopupClosed.emit();const t=r.A.queryElementById.call(this.el,this._elementIds.arrow);return t&&(this._popoverIsOpen?t.classList.add("selector-drop-open"):t.classList.remove("selector-drop-open")),!1}componentDidLoad(){const e=this;function t(t){e.onClickDropdown.call(e,t)}e._loadInstances();const i=r.A.queryElementById.call(e.el,this._elementIds.button);i&&(i.removeEventListener("click",t),i.addEventListener("click",t));const s=r.A.queryElementById.call(e.el,this._elementIds.label);s&&(s.removeEventListener("click",t),s.addEventListener("click",t));const o=r.A.queryElementById.call(e.el,this._elementIds.arrow);function n(){e.hidePopover(),e.onUpdatePopoverSize()}o&&(o.removeEventListener("click",t),o.addEventListener("click",t)),window.removeEventListener("resize",n),window.addEventListener("resize",n),e.baseConfig&&e.baseConfig.onComponentHasRendered()}hidePopover(){const e=r.A.queryElementById.call(this.el,this._elementIds.popover);e&&e.setAttribute("open","false"),this._popoverIsOpen=!1,this.infographicSelectorPopupClosed.emit();const t=r.A.queryElementById.call(this.el,this._elementIds.arrow);t&&t.classList.remove("selector-drop-open")}onUpdatePopoverSize(){if(!this.el)return;let e=100;const t=document.documentElement.clientHeight,i=document.documentElement.clientWidth,s=this.el.getBoundingClientRect(),o=s.top,n=t-(s.top+s.height)+window.scrollY;let a=i/2;const l=i-s.left+window.scrollX;e=n<100&&n<o||o>n&&o>=100?o-36:n-36,a=l<s.width&&s.left>l||s.left>l&&s.left>=s.width?s.left-16:i-s.left-16,a=Math.min(450,a);const h=r.A.queryElementById.call(this.el,this._elementIds.content);h&&h&&(h.style.height=e+"px");const c=r.A.queryElementById.call(this.el,this._elementIds.popover);c&&(c.style.width=Math.min(450,a)+"px");const d=r.A.queryElementById.call(this.el,this._elementIds.reports);d&&d.updateLayout()}_showPlaceholder(){const e=r.B.i18n("select-infographic"),t=r.A.queryElementById.call(this,this._elementIds.label);t&&(t.classList.add("selector-label-placeholder"),t.innerText=e)}_hidePlaceholderAndShowLabel(e){const t=r.A.queryElementById.call(this,this._elementIds.label);t&&(t.classList.remove("selector-label-placeholder"),e&&(t.innerText=e))}render(){this.baseConfig.config?.username&&r.A.hasText(this.baseConfig.config.username)||console.log("ERROR: arcgis-infographic-selector missing [username]"),this.baseConfig.config?.token&&r.A.hasText(this.baseConfig.config.token)||console.log("ERROR: arcgis-infographic-selector missing [token]");const e=r.B.i18n("select-infographic");return(0,o.h)("div",{id:this._instanceId,class:"infographicSelectorOuter"},(0,o.h)("div",{id:this._elementIds.button,class:"selector-dropdown"},(0,o.h)("div",{id:this._elementIds.label,class:"selector-dropdown-label"},e),(0,o.h)("svg",{id:this._elementIds.arrow,class:"selector-dropdown-arrow",width:"24",height:"24",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.h)("path",{fill:"currentColor","fill-rule":"evenodd",stroke:"currentColor",d:"M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z","clip-rule":"evenodd"}))),(0,o.h)("calcite-popover",{id:this._elementIds.popover,style:{position:"absolute",top:"0px",left:"0px",transform:"translate(-312px, 7px)",border:"none","box-shadow":"none",width:"450px"},label:"Choose infographics","pointer-disabled":"true","overlay-positioning":"absolute",placement:"bottom-start","offset-skidding":"4","auto-close":"true","reference-element":this._elementIds.button,onCalcitePopoverClose:()=>{this.infographicSelectorPopupClosed.emit()}},(0,o.h)("div",{id:this._elementIds.content,style:{padding:"6px",width:"300px",height:"200px"}},(0,o.h)("arcgis-infographic-tree",{id:this._elementIds.reports,portalOnlineGEProxy:this.portalOnlineGEProxy,class:"arcSel-reports",config:this.baseConfig.getConfigString()}))))}get el(){return(0,o.g)(this)}static get watchers(){return{env:["onEnvChanged"],token:["onTokenChanged"],username:["onUsernameChanged"],langCode:["onLangCodeChanged"],geoenrichmentUrl:["onGeoenrichmentUrlChanged"],selectedReportId:["onSelectedReportIdChanged"],sourceCountry:["onSourceCountryChanged"],theme:["onThemeChanged"],config:["onConfigChange"]}}};d.style=":host{display:block}.infographicSelectorOuter{position:relative;width:100%;height:30px;justify-content:left;align-items:center}.selector-label-placeholder{color:gray}.infoSel-magnify{position:absolute;top:2px;left:100px;height:32px;width:32px;background-color:blue}.arcSel-combo{width:100%;height:32px;font-size:11pt;color:darkslategray}.arcSel-reports{width:calc(100% - 16px);height:100%;overflow:auto}.selector-dropdown-label{position:absolute;top:7px;left:6px;width:calc(100% - 35px);height:25px;font-size:10.5pt;font-weight:300;text-align:left;text-overflow:ellipsis;border-radius:0px;overflow:hidden;white-space:nowrap;cursor:pointer}.selector-dropdown{position:relative;height:32px;width:100%;cursor:pointer}.selector-dropdown-arrow{position:absolute;top:9px;right:7px;width:12px;height:12px;transition:all 0.15s 0.15s;transform:rotate(0)}.selector-drop-open{transform:rotate(180deg)}calcite-popover ::-webkit-scrollbar{background-color:var(--calcite-ui-background-1);width:8px;height:8px}calcite-popover ::-webkit-scrollbar-thumb{background-color:var(--calcite-ui-foreground-3)}calcite-popover ::-webkit-scrollbar-track{background-color:transparent}calcite-popover ::-webkit-scrollbar-corner{background-color:var(--calcite-ui-background-1);width:8px;height:8px}"},31367:(e,t,i)=>{i.d(t,{g:()=>r,s:()=>n});var s=i(99678),o=i(14298);function n(e,t){try{return null!=e&&e.length>0?null!=t&&t.length>0?(s.T.setToken(e,t),o.B.i18n("ok")):o.B.i18n("invalid-token"):o.B.i18n("invalid-username")}catch(e){return e}}async function r(e,t=!1){return await s.G.getInfographicTemplatesList(e,t)}}}]);