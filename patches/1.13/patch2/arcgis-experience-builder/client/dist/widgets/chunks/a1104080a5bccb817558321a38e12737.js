/*! For license information please see a1104080a5bccb817558321a38e12737.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[47113],{47113:(e,t,r)=>{r.r(t),r.d(t,{arcgis_new_item_pages_feature_layer_from_url:()=>p});var a=r(28384),i=r(41171),n=r(76134),s=r(65508),l=r(83129),o=r(58892),c=r(54871),u=r(24552),d=r(71120);r(66716),r(62381),r(27010),r(86739),r(31546),r(82463),r(48507),r(48333),r(86274),r(85142),r(72022),r(96729),r(58728),r(83397),r(18869),r(46220);const p=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.url=void 0,this.error=void 0,this.loading=void 0}async componentWillLoad(){this.i18n=c.u.i18n.featureLayerFromUrl,this.commonI18n=c.u.i18n.common,this.url=o.a.serviceInfoUrl}async handleNext(){var e,t,r,a,c;const{url:p}=this;if(!p)return(0,d.f)("Empty URL"),this.inputRef.setFocus(),void(this.error="missingUrl");const{error:h}=(0,u.g)(p);if(h)return(0,d.f)("Invalid URL"),this.inputRef.setFocus(),void(this.error=h.code);this.loading=!0;const m=p.toLowerCase().indexOf("/featureserver"),g=p.substring(0,m)+"/FeatureServer";try{const{result:u}=await(0,l.A)({url:g});(null==u?void 0:u.isSecured)&&(o.a.checkAuth=!0);const{layers:d,serviceInfo:h,tables:m}=await(0,l.g)(p,(0,i.g)(n.c.portal),!1,null==u?void 0:u.isSecured);o.a.serviceInfo=Object.assign(Object.assign({},h),{layers:d,tables:m});let v=null===(e=h.documentInfo)||void 0===e?void 0:e.title;const y=null!==(t=h.layers)&&void 0!==t?t:[],f=null!==(r=h.tables)&&void 0!==r?r:[];v||(1===y.length&&0===f.length?v=y[0].name:1===f.length&&0===y.length&&(v=f[0].name)),s.i.title=v,s.i.snippet=null!==(a=h.serviceDescription)&&void 0!==a?a:"",o.a.description=null!==(c=h.description)&&void 0!==c?c:"",o.a.serviceInfoUrl=p,this.loading=!1,this.newItemUpdatePage.emit("featureLayerSummary")}catch(e){(0,d.f)("Service doesn't exist"),this.error="serviceNotExist"}}handleInputChange(e){this.url=e.target.value}render(){const{loading:e,i18n:t,commonI18n:r,error:i,url:s}=this,{title:l,description:o}=t.error[i]||{},{portal:u}=n.c;return(0,a.h)(a.H,null,(0,a.h)("arcgis-new-item-loader",{active:e,text:c.u.i18n.urlType.getServiceInfo}),(0,a.h)("calcite-label",{class:"label"},(0,a.h)("arcgis-new-item-description",{header:r.url,content:t.description}),(0,a.h)("calcite-input",{placeholder:u.isPortal?"https://webadaptorhost.domain.com/webadaptorname/rest/services/service/servicetype":"https://myserver.com/arcgis/rest/services/folder/service/FeatureServer",onCalciteInputInput:e=>this.handleInputChange(e),class:"input",scale:"l",ref:e=>this.inputRef=e,value:s})),(0,a.h)("arcgis-new-item-alert",{heading:l,description:o,active:!!i,onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.d)(this)}};p.style=".input{margin-top:1rem}.label{display:block;margin-top:1rem}"},71120:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>u,c:()=>d,e:()=>o,f:()=>h,i:()=>c});var a=r(76134),i=r(58892);const n="create feature layer",s="my content",l=e=>{switch(e){case"build":return"blank";case"existing":return"fs";case"template":return"template";case"link":return"url"}},o=e=>{const t=a.c.telemetry;null==t||t.stepWorkflow(n,"enable "+("captureGPS"===e?"gps":"enableZDefaults"===e?"z":"m"),{category:n,attribute:l(i.a.addFeatureLayerType),pageName:s})},c=e=>{const t=a.c.telemetry;null==t||t.stepWorkflow(n,`expand ${e} details`,{category:n,attribute:l(i.a.addFeatureLayerType),pageName:s})},u=()=>{const e=a.c.telemetry;null==e||e.stepWorkflow(n,"filter",{category:n,attribute:l(i.a.addFeatureLayerType),pageName:s})},d=e=>{const t=l(e),r=a.c.telemetry;null==r||r.stepWorkflow(n,"from option",{category:n,attribute:t,pageName:s})},p=()=>{const{addFeatureLayerType:e,serviceInfo:t}=i.a,r=t,o=a.c.telemetry;null==o||o.endWorkflow(n,{category:n,attribute:l(e),pageName:s,count:r.layers.length,number:r.tables.length})},h=e=>{var t;null===(t=a.c.telemetry)||void 0===t||t.logError({category:n,error:e})}}}]);