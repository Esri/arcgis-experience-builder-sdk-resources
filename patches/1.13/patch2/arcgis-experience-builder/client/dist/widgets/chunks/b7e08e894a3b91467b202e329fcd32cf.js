/*! For license information please see b7e08e894a3b91467b202e329fcd32cf.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[47817],{47817:(e,t,r)=>{r.r(t),r.d(t,{$:()=>Ge,A:()=>Kg,B:()=>Yh,C:()=>eu,D:()=>Ws,E:()=>A_,F:()=>lo,G:()=>co,H:()=>b,I:()=>S,J:()=>Fu,K:()=>Uh,L:()=>Uv,M:()=>Wh,N:()=>Nn,O:()=>Jc,P:()=>$s,Q:()=>uo,R:()=>d,S:()=>G,T:()=>Eu,U:()=>En,V:()=>ju,W:()=>Ru,X:()=>Lu,Y:()=>C,Z:()=>Wi,_:()=>Ee,a:()=>Zv,a$:()=>kc,a0:()=>St,a1:()=>$o,a2:()=>ar,a3:()=>D,a4:()=>ir,a5:()=>Sc,a6:()=>ee,a7:()=>pg,a8:()=>cr,a9:()=>rr,aA:()=>Ht,aB:()=>Qo,aC:()=>Ef,aD:()=>so,aE:()=>Pr,aF:()=>L,aG:()=>mc,aH:()=>Dr,aI:()=>me,aJ:()=>Mr,aK:()=>xc,aL:()=>$e,aM:()=>js,aN:()=>Ze,aO:()=>Md,aP:()=>qr,aQ:()=>wc,aR:()=>vy,aS:()=>gc,aT:()=>Yt,aU:()=>Xc,aV:()=>eh,aW:()=>Kc,aX:()=>Uc,aY:()=>qc,aZ:()=>zc,a_:()=>Gc,aa:()=>u,ab:()=>Je,ac:()=>wg,ad:()=>ng,ae:()=>hn,af:()=>Km,ag:()=>fr,ah:()=>Zs,ai:()=>ao,aj:()=>It,ak:()=>pt,al:()=>y,am:()=>Xs,an:()=>w_,ao:()=>Ac,ap:()=>O_,aq:()=>He,ar:()=>Bu,as:()=>Uu,at:()=>dh,au:()=>ph,av:()=>Ec,aw:()=>_,ax:()=>ye,ay:()=>Bs,az:()=>Qs,b:()=>n_,b$:()=>Fe,b0:()=>jc,b1:()=>wr,b2:()=>Cr,b3:()=>or,b4:()=>Ms,b5:()=>Gs,b6:()=>dn,b7:()=>nw,b8:()=>to,b9:()=>Js,bA:()=>pd,bB:()=>fd,bC:()=>Pf,bD:()=>yg,bE:()=>Mu,bF:()=>I,bG:()=>m,bH:()=>Sd,bI:()=>Td,bJ:()=>Id,bK:()=>c_,bL:()=>Xf,bM:()=>d_,bN:()=>$,bO:()=>gy,bP:()=>fy,bQ:()=>Od,bR:()=>f_,bS:()=>sy,bT:()=>m_,bU:()=>md,bV:()=>W,bW:()=>Ur,bX:()=>f,bY:()=>B,bZ:()=>_d,b_:()=>ny,ba:()=>No,bb:()=>Ks,bc:()=>ce,bd:()=>Vc,be:()=>Rc,bf:()=>Lc,bg:()=>ch,bh:()=>Ns,bi:()=>po,bj:()=>ro,bk:()=>k,bl:()=>Oi,bm:()=>fe,bn:()=>On,bo:()=>re,bp:()=>py,bq:()=>yy,br:()=>dr,bs:()=>Tn,bt:()=>dy,bu:()=>$a,bv:()=>We,bw:()=>Pu,bx:()=>et,by:()=>le,bz:()=>Gu,c:()=>l_,c$:()=>oo,c0:()=>cd,c1:()=>nd,c2:()=>dd,c3:()=>h_,c4:()=>p_,c5:()=>y_,c6:()=>Pd,c7:()=>kd,c8:()=>Ep,c9:()=>jp,cA:()=>hu,cB:()=>Rs,cC:()=>Ls,cD:()=>La,cE:()=>Os,cF:()=>Ds,cG:()=>o,cH:()=>Ga,cI:()=>x_,cJ:()=>Ed,cK:()=>Hd,cL:()=>$d,cM:()=>Qd,cN:()=>Zd,cO:()=>rp,cP:()=>v_,cQ:()=>ws,cR:()=>no,cS:()=>Co,cT:()=>yo,cU:()=>O,cV:()=>T,cW:()=>M,cX:()=>vd,cY:()=>ho,cZ:()=>eo,c_:()=>P,ca:()=>lp,cb:()=>Mp,cc:()=>Dd,cd:()=>$t,ce:()=>Pn,cf:()=>j,cg:()=>Ji,ch:()=>kr,ci:()=>lh,cj:()=>wh,ck:()=>io,cl:()=>Fc,cm:()=>Bc,cn:()=>Ua,co:()=>za,cp:()=>qa,cq:()=>Ea,cr:()=>br,cs:()=>hh,ct:()=>Hc,cu:()=>uh,cv:()=>wu,cw:()=>Du,cx:()=>xh,cy:()=>Gh,cz:()=>x,d:()=>Vy,d0:()=>hw,d1:()=>uw,d2:()=>Do,d3:()=>Ie,d4:()=>ja,d5:()=>a,d6:()=>n,d7:()=>mo,d8:()=>Ts,d9:()=>lw,dA:()=>bd,dB:()=>Fa,dC:()=>gd,dD:()=>Cp,dE:()=>Sp,dF:()=>Np,dG:()=>ks,dH:()=>N,dI:()=>my,dJ:()=>Ba,dK:()=>Ra,dL:()=>c,dM:()=>h,dN:()=>A,dO:()=>l,dP:()=>Dn,dQ:()=>hr,dR:()=>Zn,dS:()=>T_,dT:()=>iS,da:()=>J,db:()=>Oy,dc:()=>Or,dd:()=>fo,de:()=>Gr,df:()=>je,dg:()=>a_,dh:()=>he,di:()=>Re,dj:()=>$r,dk:()=>lr,dl:()=>Te,dm:()=>Er,dn:()=>Jr,dp:()=>Ar,dq:()=>uu,dr:()=>aw,ds:()=>cw,dt:()=>z,du:()=>Xm,dv:()=>Ft,dw:()=>If,dx:()=>ew,dy:()=>nr,dz:()=>Ut,e:()=>i_,f:()=>mv,g:()=>_r,h:()=>$v,i:()=>Cg,j:()=>Gt,k:()=>u_,l:()=>zr,m:()=>$g,n:()=>Rv,o:()=>F,p:()=>Vg,q:()=>_h,r:()=>Zc,s:()=>At,t:()=>w,u:()=>bv,v:()=>Tu,w:()=>Ug,x:()=>Nu,y:()=>e_,z:()=>sr});var i=r(58574);function s(e,t,r,i){var s,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(o<3?s(n):o>3?s(t,r,n):s(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n}function o(e,t){if(e.forEach)e.forEach(t);else for(let r=0;r<e.length;r++)t(e[r],r,e)}function n(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));const i=Math.max(0,r-t),s=new e.constructor(i);for(let r=0;r<i;r++)s[r]=e[t+r];return s}function a(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}function l(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name}function c(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name}function h(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name}function u(e,t){let r;if(t)for(r in e)e.hasOwnProperty(r)&&(void 0===e[r]?delete e[r]:e[r]instanceof Object&&u(e[r],!0));else for(r in e)e.hasOwnProperty(r)&&void 0===e[r]&&delete e[r];return e}function d(e){if(!e||"object"!=typeof e||"function"==typeof e)return e;if((t=e)instanceof Int8Array||t&&t.constructor&&"Int8Array"===t.constructor.name||l(e)||function(e){return e instanceof Uint8ClampedArray||e&&e.constructor&&"Uint8ClampedArray"===e.constructor.name}(e)||function(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name}(e)||c(e)||function(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name}(e)||h(e)||function(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name}(e)||function(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name}(e))return n(e);var t;if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;return e.forEach(((e,r)=>{t.set(r,d(e))})),t}if(e instanceof Set){const t=new Set;return e.forEach((e=>{t.add(d(e))})),t}let r;const i=e;if("function"==typeof i.clone)r=i.clone();else if("function"==typeof i.map&&"function"==typeof i.forEach)r=i.map(d);else if("function"==typeof i.notifyChange&&"function"==typeof i.watch)r=i.clone();else{r={};for(const t of Object.getOwnPropertyNames(e))r[t]=d(e[t])}return r}function p(e,t){return e===t||"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)||"function"==typeof(e||{}).getTime&&"function"==typeof(t||{}).getTime&&e.getTime()===t.getTime()||!1}function f(e,t,r=!1){return v(e,t,r)}function y(e,t){if(null!=t)return t[e]||g(e.split("."),!1,t)}function m(e,t,r){const i=e.split("."),s=i.pop(),o=g(i,!0,r);o&&s&&(o[s]=t)}function g(e,t,r){let i=r;for(const r of e){if(null==i)return;if(!(r in i)){if(!t)return;i[r]={}}i=i[r]}return i}function v(e,t,r){return t?Object.keys(t).reduce((function(e,i){let s=e[i],o=t[i];return s===o?e:void 0===s?(e[i]=d(o),e):(Array.isArray(o)||Array.isArray(e)?(s=s?Array.isArray(s)?e[i]=s.concat():e[i]=[s]:e[i]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach((e=>{-1===s.indexOf(e)&&s.push(e)})):e[i]=o.concat())):o&&"object"==typeof o?e[i]=v(s,o,r):e.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(e[i]=o),e)}),e||{}):e}const _={apiKey:void 0,applicationUrl:i.e.location&&i.e.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(i.e.esriConfig&&(f(_,i.e.esriConfig,!0),delete _.has),!_.assetsPath){const e="4.19.0";_.assetsPath=`https://js.arcgis.com/${e.slice(0,-2)}/@arcgis/core/assets`}function b(e){return null!=e}function w(e){return null==e}function x(e){return void 0===e}function S(e){return e}function C(e,t){return b(e)?e:"function"==typeof t?t():t}function I(e){return b(e)&&e.destroy(),null}function A(e){return b(e)&&e.dispose(),null}function k(e){return b(e)&&e.remove(),null}function N(e){return null}function O(e,t){const r=new Array;for(const i of e)r.push(P(i,null,t));return r}function T(e,t){for(const r of e)P(r,null,t)}function P(e,t,r){return b(e)?r(e):t}function M(e,t){return b(e)?t(e):null}function D(e,...t){let r=e,i=0;for(;i<t.length&&r;)r=r[t[i++]];return r}function L(e){return e}_.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(_,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),_.request.corsEnabledServers=[],_.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0};const E=/\{([^\}]+)\}/g;function R(e){return null==e?"":e}function j(e,t){return e.replace(E,"object"==typeof t?(e,r)=>R(y(r,t)):(e,r)=>R(t(r)))}function F(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(e=>t&&-1!==t.indexOf(e)?e:`\\${e}`))}function B(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function z(e){return(new DOMParser).parseFromString(e||"","text/html").body.innerText||""}const U={info:0,warn:1,error:2,none:3};class G{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,G._loggers[this.module]=this;const t=this.module.lastIndexOf(".");-1!==t&&(this._parent=G.getLogger(this.module.slice(0,t)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(e={}){const t=G._loggers;return G._loggers=e,t},set throttlingDisabled(e){G._throttlingDisabled=e}}}static getLogger(e){let t=G._loggers[e];return t||(t=new G({module:e})),t}_log(e,t,...r){if(this._matchLevel(e)){if("always"!==t&&!G._throttlingDisabled){const i=this._argsToKey(r),s=this._loggedMessages[e].get(i);if("once"===t&&null!=s||"oncePerTick"===t&&s&&s>=G._tickCounter)return;this._loggedMessages[e].set(i,G._tickCounter),G._scheduleTickCounterIncrement()}for(const t of _.log.interceptors)if(t(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,t){let r=this;for(;b(r);){const t=r[e];if(b(t))return t;r=r.parent}return t}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,t,...r){console[e](`[${t}]`,...r)}_matchLevel(e){const t=_.log.level?_.log.level:"warn";return U[this._parentWithMember("level",t)]<=U[e]}_argsToKey(...e){return B(JSON.stringify(e,((e,t)=>"object"!=typeof t||Array.isArray(t)?t:"[Object]")))}static _scheduleTickCounterIncrement(){G._tickCounterScheduled||(G._tickCounterScheduled=!0,Promise.resolve().then((()=>{G._tickCounter++,G._tickCounterScheduled=!1})))}}G._loggers={},G._tickCounter=0,G._tickCounterScheduled=!1,G._throttlingDisabled=!1;const q=G.getLogger("esri.core.Accessor");function V(e){return null==e?e:new Date(e)}function H(e){return null==e?e:!!e}function $(e){return null==e?e:e.toString()}function W(e){return null==e?e:(e=parseFloat(e),isNaN(e)?0:e)}function J(e){return null==e?e:Math.round(parseFloat(e))}function Q(e){return e&&e.constructor&&void 0!==e.constructor.__accessorMetadata__}function Z(e,t){return null!=t&&e&&!(t instanceof e)}function Y(e){return e&&"isCollection"in e}function K(e){return e&&e.Type?"function"==typeof e.Type?e.Type:e.Type.base:null}function X(e,t){return!!Q(t)&&(q.error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+te(e)+"'"),!0)}function ee(e,t){return null==t?t:Y(e)?function(e,t){if(!t||!t.constructor||!Y(t.constructor))return X(e,t)?t:new e(t);const r=K(e.prototype.itemType),i=K(t.constructor.prototype.itemType);return r?i?r===i?t:r.prototype.isPrototypeOf(i.prototype)?new e(t):(X(e,t),t):new e(t):t}(e,t):Z(e,t)?X(e,t)?t:new e(t):t}function te(e){return e&&e.prototype&&e.prototype.declaredClass||"unknown"}function re(e,t){const r=function(e){switch(e){case Number:return W;case ce:return J;case Boolean:return H;case String:return $;case Date:return V;default:return ee.bind(null,e)}}(e);return 1===arguments.length?r:r(t)}function ie(e,t,r){return 1===arguments.length?ie.bind(null,e):t?Array.isArray(t)?t.map((t=>e(t,r))):[e(t,r)]:t}function se(e,t,r){return 0!==t&&Array.isArray(r)?r.map((r=>se(e,t-1,r))):e(r)}function oe(e,t,r){if(2===arguments.length)return oe.bind(null,e,t);if(!r)return r;let i=t,s=r=se(e,t,r);for(;i>0&&Array.isArray(s);)i--,s=s[0];if(void 0!==s)for(let e=0;e<i;e++)r=[r];return r}function ne(e){return!!Array.isArray(e)&&!e.some((t=>{const r=typeof t;return!("string"===r||"number"===r||"function"===r&&e.length>1)}))}function ae(e,t){if(2===arguments.length)return ae(e).call(null,t);const r=new Set,i=e.filter((e=>"function"!=typeof e)),s=e.filter((e=>"function"==typeof e));for(const t of e)"string"!=typeof t&&"number"!=typeof t||r.add(t);let o=null,n=null;return(e,t)=>{if(null==e)return e;const a=typeof e,l="string"===a||"number"===a;return l&&(r.has(e)||s.some((e=>"string"===a&&e===String||"number"===a&&e===Number)))||"object"===a&&s.some((t=>!Z(e,t)))?e:(l&&i.length?(o||(o=i.map((e=>"string"==typeof e?`'${e}'`:`${e}`)).join(", ")),q.error("Accessor#set",`'${e}' is not a valid value for this property, only the following values are valid: ${o}`)):"object"==typeof e&&s.length?(n||(n=s.map((e=>te(e))).join(", ")),q.error("Accessor#set",`'${e}' is not a valid value for this property, value must be one of ${n}`)):q.error("Accessor#set",`'${e}' is not a valid value for this property`),t&&(t.valid=!1),null)}}function le(e,t){if(2===arguments.length)return le(e).call(null,t);const r={},i=[],s=[];for(const t in e.typeMap){const o=e.typeMap[t];r[t]=re(o),i.push(te(o)),s.push(t)}const o=()=>`'${i.join("', '")}'`,n=()=>`'${s.join("', '")}'`,a="string"==typeof e.key?t=>t[e.key]:e.key;return t=>{if(e.base&&!Z(e.base,t))return t;if(null==t)return t;const i=a(t)||e.defaultKeyValue,s=r[i];if(!s)return q.error("Accessor#set",`Invalid property value, value needs to be one of ${o()}, or a plain object that can autocast (having .type = ${n()})`),null;if(!Z(e.typeMap[i],t))return t;if("string"==typeof e.key&&!Q(t)){const r={};for(const i in t)i!==e.key&&(r[i]=t[i]);return s(r)}return s(t)}}class ce{}const he={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function ue(e){switch(e.type){case"native":return re(e.value);case"array":return ie(ue(e.value));case"one-of":return function(e){let t=null;return(r,i)=>pe(r,e)?r:(null==t&&(t=de(e)),q.error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),i&&(i.valid=!1),null)}(e);default:return null}}function de(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case ce:return"integer";case Date:return"date";default:return te(e.value)}case"array":return`array of ${de(e.value)}`;case"one-of":{const t=e.values.map((e=>de(e)));return`one of ${t.slice(0,t.length-1)} or ${t[t.length-1]}`}}return"unknown"}function pe(e,t){if(null==e)return!0;switch(t.type){case"native":switch(t.value){case Number:case ce:return"number"==typeof e;case Boolean:return"boolean"==typeof e;case String:return"string"==typeof e}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some((e=>!pe(e,t.value)));case"one-of":return t.values.some((t=>pe(e,t)))}}function fe(e){return ye((()=>e.forEach((e=>b(e)&&e.remove()))))}function ye(e){return{remove:()=>{e&&(e(),e=void 0)}}}function me(e){return e?e.__accessor__?e.__accessor__:e.propertyInvalidated?e:null:null}function ge(e,t,r){return ve(e,t,r?{policy:r,path:""}:null)}function ve(e,t,r){return t?Object.keys(t).reduce((function(e,i){let s=null,o="merge";if(r&&(s=r.path?`${r.path}.${i}`:i,o=r.policy(s)),"replace"===o)return e[i]=t[i],e;if(void 0===e[i])return e[i]=d(t[i]),e;let n=e[i],a=t[i];if(n===a)return e;if(Array.isArray(a)||Array.isArray(e))n=n?Array.isArray(n)?e[i]=n.concat():e[i]=[n]:e[i]=[],a&&(Array.isArray(a)||(a=[a]),a.forEach((e=>{-1===n.indexOf(e)&&n.push(e)})));else if(a&&"object"==typeof a)if(r){const t=r.path;r.path=s,e[i]=ve(n,a,r),r.path=t}else e[i]=ve(n,a,null);else e.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(e[i]=a);return e}),e||{}):e}function _e(e){return Array.isArray(e)?e:e.split(".")}function be(e){return e.indexOf(",")>-1?e.split(",").map((e=>e.trim())):[e.trim()]}function we(e,t,r,i){const s=function(e){if(Array.isArray(e)){const t=[];for(const r of e)t.push(...be(r));return t}return be(e)}(t);return 1!==s.length?fe(s.map((t=>i(e,t,r)))):i(e,s[0],r)}function xe(e){let t=!1;return()=>{t||(t=!0,e())}}function Se(e,t){const r="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(r,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const i=me(t);return function(e,t){return null!=e&&e.metadatas&&null!=e.metadatas[t]}(i,r)?i.get(r):t[r]}function Ce(e,t,r){if(null==e)return e;const i=Se(t[r],e);return!i&&r<t.length-1?void 0:r===t.length-1?i:Ce(i,t,r+1)}function Ie(e,t,r=0){return"string"==typeof t&&-1===t.indexOf(".")?Se(t,e):Ce(e,_e(t),r)}function Ae(e,t){return Ie(e,t)}function ke(e,t){return void 0!==Ie(t,e)}class Ne{constructor(e){this.autoDestroy=!1,this.properties=e}}function Oe(e){let t=e.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){const r=Object.create(t.properties),i=t.autoDestroy;for(const e in r)r[e]=d(r[e]);t=new Ne(r),t.autoDestroy=i,Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t=new Ne({}),Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function Te(e,t){const r=function(e){return Oe(e).properties}(e);let i=r[t];return i||(i=r[t]={}),i}const Pe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Me(e){return Pe.test(e)?"replace":"merge"}function De(e,t,r){if(e&&t)if("object"==typeof t)for(const r of Object.getOwnPropertyNames(t))De(e,r,t[r]);else{if(-1!==t.indexOf(".")){const i=t.split("."),s=i.splice(i.length-1,1)[0];return void De(Ae(e,i),s,r)}e[t]=r}}G.getLogger("esri.core.accessorSupport.set");const Le=G.getLogger("esri.core.accessorSupport.decorators.property");function Ee(e={}){return(t,r,i)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${r}. Accessor does not support static properties.`);const s=Te(t,r);i&&(i.get||i.set?(s.get=i.get||s.get,s.set=i.set||s.set):"value"in i&&("value"in e&&Le.warn(`@property() will redefine the value of "${r}" on "${t.constructor.name}" already defined in the metadata`,e),s.value=e.value=i.value)),null!=e.readOnly&&(s.readOnly=e.readOnly);const o=e.aliasOf;if(o){const e="string"==typeof o?o:o.source,t="string"==typeof o?null:!0===o.overridable;let i;s.dependsOn=[e],s.get=function(){let t=Ae(this,e);if("function"==typeof t){i||(i=e.split(".").slice(0,-1).join("."));const r=Ae(this,i);r&&(t=t.bind(r))}return t},s.readOnly||(s.set=t?function(e){void 0!==e?this._override(r,e):this._clearOverride(r)}:function(t){De(this,e,t)})}const n=e.type,a=e.types;s.cast||(n?s.cast=function(e){let t=0,r=e;if(function(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}(e))return ue(e);for(;Array.isArray(r)&&1===r.length&&"string"!=typeof r[0]&&"number"!=typeof r[0];)r=r[0],t++;const i=r;if(ne(i))return 0===t?ae(i):oe(ae(i),t);if(1===t)return function(e,t){return 1===arguments.length?ie(re.bind(null,e)):ie(re.bind(null,e),t)}(i);if(t>1)return function(e,t,r){return 2===arguments.length?oe(re.bind(null,e),t):oe(re.bind(null,e),t,r)}(i,t);const s=e;return s.from?s.from:re(s)}(n):a&&(Array.isArray(a)?s.cast=ie(le(a[0])):s.cast=le(a))),e.range&&(s.cast=je(s.cast,e.range)),function(e,t){ge(e,t,Me)}(s,e)}}function Re(e,t,r){const i=Te(e,r);i.json||(i.json={});let s=i.json;return void 0!==t&&(s.origins||(s.origins={}),s.origins[t]||(s.origins[t]={}),s=s.origins[t]),s}function je(e,t){return r=>{let i=+e(r);return null!=t.step&&(i=Math.round(i/t.step)*t.step),null!=t.min&&(i=Math.max(t.min,i)),null!=t.max&&(i=Math.min(t.max,i)),i}}function Fe(e,t){return Ee({aliasOf:t?{...t,source:e}:e})}const Be=Object.prototype.toString;function ze(e){const t="__accessorMetadata__"in e?re(e):e;return function(...e){if(e.push(t),"number"==typeof e[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Ue.apply(this,e)}}function Ue(e,t,r,i){Te(e,t).cast=i}function Ge(...e){if(3!==e.length||"string"!=typeof e[1])return 1===e.length&&"[object Function]"===Be.call(e[0])?ze(e[0]):1===e.length&&"string"==typeof e[0]?function(e){return function(t,r){Te(t,e).cast=t[r]}}(e[0]):void 0}const qe=new Set;function Ve(e,t,r={}){if((0,i.t)("esri-deprecation-warnings")){const{replacement:i,version:s,see:o,warnOnce:n}=r;let a=t;i&&(a+=`\n\tðŸ› ï¸ Replacement: ${i}`),s&&(a+=`\n\tâš™ï¸ Version: ${s}`),o&&(a+=`\n\tðŸ”— See ${o} for more details.`),function(e,t,r=!1){r&&qe.has(t)||(r&&qe.add(t),e.warn(`ðŸ›‘ DEPRECATED - ${t}`))}(e,a,n)}}class He{constructor(e,t={ignoreUnknown:!1}){this.jsonToAPI=e,this.options=t,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(e),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=e=>this.fromJSON(e),this.write=(e,t,r)=>{const i=this.toJSON(e);void 0!==i&&(t[r]=i)},this.write.isJSONMapWriter=!0}toJSON(e){return this.apiToJSON.hasOwnProperty(e)?this.apiToJSON[e]:this.options.ignoreUnknown?void 0:e}fromJSON(e){return this.jsonToAPI.hasOwnProperty(e)?this.jsonToAPI[e]:this.options.ignoreUnknown?void 0:e}invertMap(e){const t={};for(const r in e)t[e[r]]=r;return t}getKeysSorted(e){const t=[];for(const r in e)t.push(r);return t.sort(),t}}function $e(){return function(e){return new He(e,{ignoreUnknown:!0})}}function We(e,t={ignoreUnknown:!0}){const r=e instanceof He?e:new He(e,t),i={type:null!=t&&t.ignoreUnknown?r.apiValues:String,readOnly:null==t?void 0:t.readOnly,json:{type:r.jsonValues,read:(null==t||!t.readOnly)&&{reader:r.read},write:{writer:r.write}}};return void 0!==(null==t?void 0:t.default)&&(i.json.default=t.default),Ee(i)}function Je(e,t,r){let i,s;return void 0===t||Array.isArray(t)?(s=e,r=t,i=[void 0]):(s=t,i=Array.isArray(e)?e:[e]),(e,t)=>{const o=e.constructor.prototype;i.forEach((i=>{const n=Re(e,i,s);n.read&&"object"!=typeof n.read&&(n.read={}),m("read.reader",o[t],n),r&&(n.read.source=(n.read.source||[]).concat(r))}))}}class Qe{constructor(e,t,r){this.name=e,this.details=r,this.message=void 0,this instanceof Qe&&(this.message=t&&function(e,t){return e.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(e,r){if(""===r)return"$";const i=y(r,t),s=null==i?"":i;if(void 0===s)throw new Error(`could not find key "${r}" in template`);return s.toString()}))}(t,r)||"")}toString(){return"["+this.name+"]: "+this.message}}class Ze extends Qe{constructor(e,t,r){if(super(e,t,r),!(this instanceof Ze))return new Ze(e,t,r)}}function Ye(e){return!!e&&e.prototype&&e.prototype.declaredClass&&0===e.prototype.declaredClass.indexOf("esri.core.Collection")}Ze.prototype.type="warning";const Ke=G.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Xe(e,t,r){var i,s;e&&(!r&&!t.read||null!=(i=t.read)&&i.reader||!1===(null==(s=t.read)?void 0:s.enabled)||function(e){return"types"in e?nt(e.types):ot(e.type)}(e)&&m("read.reader",et(e),t))}function et(e){var t;const r=null!=(t=e.ndimArray)?t:0;if(r>1)return function(e){var t;const r=tt(e),i=rt.bind(null,r),s=null!=(t=e.ndimArray)?t:0;return(e,t,r)=>{if(null==e)return e;e=i(e,r,s);let o=s,n=e;for(;o>0&&Array.isArray(n);)o--,n=n[0];if(void 0!==n)for(let t=0;t<o;t++)e=[e];return e}}(e);if(1===r)return it(e);if("type"in e&&st(e.type)){var i,s;const t=null==(i=e.type.prototype)||null==(s=i.itemType)?void 0:s.Type,r=it("function"==typeof t?{type:t}:{types:t});return(t,i,s)=>{const o=r(t,i,s);return o?new e.type(o):o}}return tt(e)}function tt(e){return"type"in e?function(e){return e.prototype.read?(t,r,i)=>{if(null==t)return t;const s=typeof t;if("object"!==s)return void Ke.error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${s}'`);const o=new e;return o.read(t,i),o}:e.fromJSON}(e.type):function(e){var t;let r=null;const i=null!=(t=e.errorContext)?t:"type";return(t,s,o)=>{if(null==t)return t;const n=typeof t;if("object"!==n)return void Ke.error(`Expected JSON value of type 'object' to deserialize, but got '${n}'`);r||(r=function(e){const t={};for(const s in e.typeMap){var r,i;const o=e.typeMap[s],n=Oe(o.prototype);if("function"==typeof e.key)continue;const a=n.properties[e.key];if(!a)continue;null!=(r=a.json)&&r.type&&Array.isArray(a.json.type)&&1===a.json.type.length&&"string"==typeof a.json.type[0]&&(t[a.json.type[0]]=o);const l=null==(i=a.json)?void 0:i.write;if(!l||!l.writer){t[s]=o;continue}const c=l.target,h="string"==typeof c?c:e.key,u={};l.writer(s,u,h),u[h]&&(t[u[h]]=o)}return t}(e));const a=e.key;if("string"!=typeof a)return;const l=t[a],c=l?r[l]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!c){const e=`Type '${l||"unknown"}' is not supported`;return o&&o.messages&&t&&o.messages.push(new Ze(`${i}:unsupported`,e,{definition:t,context:o})),void Ke.error(e)}const h=new c;return h.read(t,o),h}}(e.types)}function rt(e,t,r,i){return 0!==i&&Array.isArray(t)?t.map((t=>rt(e,t,r,i-1))):e(t,void 0,r)}function it(e){const t=tt(e);return(e,r,i)=>{if(null==e)return e;if(Array.isArray(e)){const r=[];for(const s of e){const e=t(s,void 0,i);void 0!==e&&r.push(e)}return r}const s=t(e,void 0,i);return void 0!==s?[s]:void 0}}function st(e){if(!Ye(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&("function"==typeof t.Type?ot(t.Type):nt(t.Type))}function ot(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||st(e))}function nt(e){for(const t in e.typeMap)if(!ot(e.typeMap[t]))return!1;return!0}function at(e){e.name&&(e.read&&"object"==typeof e.read?void 0===e.read.source&&(e.read.source=e.name):e.read={source:e.name},e.write&&"object"==typeof e.write?void 0===e.write.target&&(e.write.target=e.name):e.write={target:e.name})}function lt(e){"boolean"==typeof e.read?e.read={enabled:e.read}:"function"==typeof e.read?e.read={enabled:!0,reader:e.read}:e.read&&"object"==typeof e.read&&void 0===e.read.enabled&&(e.read.enabled=!0)}function ct(e){"boolean"==typeof e.write?e.write={enabled:e.write}:"function"==typeof e.write?e.write={enabled:!0,writer:e.write}:e.write&&"object"==typeof e.write&&void 0===e.write.enabled&&(e.write.enabled=!0)}function ht(e,t){var r;if(!t.write||t.write.writer||!1===t.write.enabled&&!t.write.overridePolicy)return;const i=null!=(r=null==e?void 0:e.ndimArray)?r:0;e&&(1===i||"type"in e&&Ye(e.type))?t.write.writer=ft:t.write.writer=i>1?function(e){return function(t,r,i,s){let o;if(null===t)o=null;else{o=yt(t,s,e);let r=e,i=o;for(;r>0&&Array.isArray(i);)r--,i=i[0];if(void 0!==i)for(let e=0;e<r;e++)o=[o]}m(i,o,r)}}(i):ut}function ut(e,t,r,i){m(r,dt(e,i),t)}function dt(e,t){return e&&"function"==typeof e.write?e.write({},t):e&&"function"==typeof e.toJSON?e.toJSON():"number"==typeof e?pt(e):e}function pt(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function ft(e,t,r,i){let s;null===e?s=null:e&&"function"==typeof e.map?(s=e.map((e=>dt(e,i))),"function"==typeof s.toArray&&(s=s.toArray())):s=[dt(e,i)],m(r,s,t)}function yt(e,t,r){return 0!==r&&Array.isArray(e)?e.map((e=>yt(e,t,r-1))):dt(e,t)}function mt(e,t){return vt(e,"read",t)}function gt(e,t){return vt(e,"write",t)}function vt(e,t,r){let i=e&&e.json;if(e&&e.json&&e.json.origins&&r){const s=e.json.origins[r.origin];s&&("any"===t||t in s)&&(i=s)}return i}const _t={processPrototypePropertyMetadata(e,t){(function(e){if(e.json||(e.json={}),lt(e.json),ct(e.json),at(e.json),e.json.origins)for(const t in e.json.origins)lt(e.json.origins[t]),ct(e.json.origins[t]),at(e.json.origins[t]);return!0})(t)&&(function(e){if(e.json&&e.json.origins){const t=e.json.origins,r={"web-document":["web-scene","web-map"]};for(const e in r)if(t[e]){const i=t[e];r[e].forEach((e=>{t[e]=i})),delete t[e]}}}(t),function(e){const t=function(e){return e.type?function(e){if(!e.type)return;let t=0,r=e.type;for(;Array.isArray(r)&&!ne(r);)r=r[0],t++;return{type:r,ndimArray:t}}(e):function(e){if(!e.types)return;let t=0,r=e.types;for(;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}(e)}(e);if(e.json.origins)for(const r in e.json.origins){const i=e.json.origins[r];Xe(t,i,!1),ht(t,i)}Xe(t,e.json,!0),ht(t,e.json)}(t))}},bt=[_t],wt=new Set,xt=new Set;function St(e){return t=>{t.prototype.declaredClass=e,function(e,t){for(const r of bt)if(r.processPrototypePropertyMetadata)for(const i in e){const s=e[i];r.processPrototypePropertyMetadata(i,s,e,t)}}(Oe(t.prototype).properties,e),function(e){const t=e.prototype,r=t.declaredClass,i=Oe(t).properties;!function(e,t){for(const r of bt)if(r.processClassPropertyMetadata)for(const i in e){const s=e[i];r.processClassPropertyMetadata(i,s,e,t)}}(i,r);const s={};for(const e of Object.getOwnPropertyNames(i)){const t=i[e];s[e]={enumerable:!0,configurable:!0,get:Ct(e,t),set(r){const i=this.__accessor__;if(void 0!==i){if(!Object.isFrozen(this)){if(i.initialized&&t.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${e}' of ${this.declaredClass}`);if(2===i.lifecycle&&t.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${e}' of ${this.declaredClass}`);i.set(e,r)}}else Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}}}Object.defineProperties(e.prototype,s)}(t);const r=[],i=[];let s=t.prototype;for(;s;)s.hasOwnProperty("initialize")&&!wt.has(s.initialize)&&(wt.add(s.initialize),r.push(s.initialize)),s.hasOwnProperty("destroy")&&!xt.has(s.destroy)&&(xt.add(s.destroy),i.push(s.destroy)),s=Object.getPrototypeOf(s);wt.clear(),xt.clear();class o extends t{constructor(...e){if(super(...e),this.constructor===o&&"function"==typeof this.postscript){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let e=r.length-1;e>=0;e--)r[e].call(this)}}),i.length){let e=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!e){e=!0;for(let e=0;e<i.length;e++)i[e].call(this)}}})}this.postscript(...e)}}}return o.__accessorMetadata__=Oe(t.prototype),o.prototype.declaredClass=e,o}}function Ct(e,t){return null==t.get?function(){return this.__accessor__.getterStatic(e)}:function(){return this.__accessor__.getterComputed(e)}}function It(e,t,r){let i,s;return void 0===t?(s=e,i=[void 0]):"string"!=typeof t?(s=e,i=[void 0],r=t):(s=t,i=Array.isArray(e)?e:[e]),(e,t)=>{const o=e.constructor.prototype;i.forEach((i=>{const n=Re(e,i,s);n.write&&"object"!=typeof n.write&&(n.write={}),r&&m("write.target",r,n),m("write.writer",o[t],n)}))}}class At extends Qe{constructor(e,t,r){if(super(e,t,r),!(this instanceof At))return new At(e,t,r)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((e,t)=>{if(t&&"object"==typeof t&&"function"==typeof t.toJSON)return t;try{return d(t)}catch(e){return"[object]"}})))}}catch(e){throw G.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new At(e.name,e.message,e.details)}}At.prototype.type="error";const kt=G.getLogger("esri.core.urlUtils"),Nt=_.request,Ot="esri/config: esriConfig.request.proxyUrl is not set.",Tt=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Pt=/^\s*http:/i,Mt=/^\s*https:/i,Dt=/^\s*file:/i,Lt=/:\d+$/,Et=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Rt=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),jt=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class Ft{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let t=this.uri.match(Rt);this.scheme=t[2]||(t[1]?"":null),this.authority=t[4]||(t[3]?"":null),this.path=t[5],this.query=t[7]||(t[6]?"":null),this.fragment=t[9]||(t[8]?"":null),null!=this.authority&&(t=this.authority.match(jt),this.user=t[3]||null,this.password=t[4]||null,this.host=t[6]||t[7],this.port=t[9]||null)}toString(){return this.uri}}const Bt=new Ft(_.applicationUrl),zt={},Ut=(()=>{const e=Bt.path,t=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return`${Bt.scheme}://${Bt.host}${null!=Bt.port?`:${Bt.port}`:""}${t}`})();function Gt(e){const t={path:null,query:null},r=new Ft(e),i=e.indexOf("?");return null===r.query?t.path=e:(t.path=e.substring(0,i),t.query=qt(r.query)),r.fragment&&(t.hash=r.fragment,null===r.query&&(t.path=t.path.substring(0,t.path.length-(r.fragment.length+1)))),t}function qt(e){const t=e.split("&"),r={};for(const e of t){if(!e)continue;const t=e.indexOf("=");let i,s;t<0?(i=decodeURIComponent(e),s=""):(i=decodeURIComponent(e.slice(0,t)),s=decodeURIComponent(e.slice(t+1)));let o=r[i];"string"==typeof o&&(o=r[i]=[o]),Array.isArray(o)?o.push(s):r[i]=s}return r}function Vt(e){return e&&"object"==typeof e&&"toJSON"in e&&"function"==typeof e.toJSON}function Ht(e,t){return e?t&&"function"==typeof t?Object.keys(e).map((r=>encodeURIComponent(r)+"="+encodeURIComponent(t(r,e[r])))).join("&"):Object.keys(e).map((r=>{const i=e[r];if(null==i)return"";const s=encodeURIComponent(r)+"=",o=t&&t[r];return o?s+encodeURIComponent(o(i)):Array.isArray(i)?i.map((e=>Vt(e)?s+encodeURIComponent(JSON.stringify(e)):s+encodeURIComponent(e))).join("&"):Vt(i)?s+encodeURIComponent(JSON.stringify(i)):s+encodeURIComponent(i)})).filter((e=>e)).join("&"):""}function $t(e){const t=Zt(e);let r,i;if(t){const e=Jt(t.proxyUrl);r=e.path,i=e.query?qt(e.query):null}if(r){const t=Gt(e);e=r+"?"+t.path;const s=Ht({...i,...t.query});s&&(e=`${e}?${s}`)}return e}const Wt={path:"",query:""};function Jt(e){const t=e.indexOf("?");return-1!==t?(Wt.path=e.slice(0,t),Wt.query=e.slice(t+1)):(Wt.path=e,Wt.query=null),Wt}function Qt(e){return(e=vr(e=function(e){return e&&"/"===e[e.length-1]?e:`${e}/`}(e=Jt(e).path),!0)).toLowerCase()}function Zt(e){const t=Nt.proxyRules,r=Qt(e);for(let e=0;e<t.length;e++)if(0===r.indexOf(t[e].urlPrefix))return t[e]}function Yt(e,t){return e=Kt(e),t=Kt(t),vr(e)===vr(t)}function Kt(e){const t=(e=sr(e)).indexOf("/sharing");return t>0?e.substring(0,t):e.replace(/\/+$/,"")}function Xt(e,t,r=!1){const i=Sr(e),s=Sr(t);return!(!r&&i.scheme!==s.scheme)&&null!=i.host&&null!=s.host&&i.host.toLowerCase()===s.host.toLowerCase()&&i.port===s.port}function er(e){if("string"==typeof e){if(!ar(e))return!0;e=Sr(e)}if(Xt(e,Bt))return!0;const t=Nt.trustedServers||[];for(let r=0;r<t.length;r++){const i=tr(t[r]);for(let t=0;t<i.length;t++)if(Xt(e,i[t]))return!0}return!1}function tr(e){return zt[e]||(yr(e)||fr(e)?zt[e]=[new Ft(rr(e))]:zt[e]=[new Ft(`http://${e}`),new Ft(`https://${e}`)]),zt[e]}function rr(e,t=Ut,r){return fr(e)?r&&r.preserveProtocolRelative?e:"http"===Bt.scheme&&Bt.authority===nr(e).slice(2)?`http:${e}`:`https:${e}`:yr(e)?e:or("/"===e[0]?function(e){const t=e.indexOf("//"),r=e.indexOf("/",t+2);return-1===r?e:e.slice(0,r)}(t):t,e)}function ir(e,t=Ut,r){if(!ar(e))return e;const i=sr(e),s=i.toLowerCase(),o=sr(t).toLowerCase().replace(/\/+$/,""),n=r?sr(r).toLowerCase().replace(/\/+$/,""):null;if(n&&0!==o.indexOf(n))return e;const a=(e,t,r)=>-1===(r=e.indexOf(t,r))?e.length:r;let l=a(s,"/",s.indexOf("//")+2),c=-1;for(;s.slice(0,l+1)===o.slice(0,l)+"/"&&(c=l+1,l!==s.length);)l=a(s,"/",l+1);if(-1===c)return e;if(n&&c<n.length)return e;e=i.slice(c);const h=o.slice(c-1).replace(/[^/]+/g,"").length;if(h>0)for(let t=0;t<h;t++)e=`../${e}`;else e=`./${e}`;return e}function sr(e){return function(e){const t=Nt.httpsDomains;if(!function(e){return Pt.test(e)||"http"===Bt.scheme&&fr(e)}(e))return e;const r=e.indexOf("/",7);let i;if(i=-1===r?e:e.slice(0,r),i=i.toLowerCase().slice(7),Lt.test(i)){if(!i.endsWith(":80"))return e;i=i.slice(0,-3),e=e.replace(":80","")}return"http"===Bt.scheme&&i===Bt.authority&&!Et.test(e)||(gr()&&i===Bt.authority||t&&t.some((e=>i===e||i.endsWith(`.${e}`)))||gr()&&!Zt(e))&&(e=mr(e)),e}(e=function(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(e=function(e){if(/^https?:\/\//i.test(e)){const t=Jt(e);e=(e=t.path.replace(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+=`?${t.query}`)}return e}(e=rr(e=e.trim()))))}function or(...e){const t=e.filter(b);if(!t||!t.length)return;const r=[];if(ar(t[0])){const e=t[0],i=e.indexOf("//");-1!==i&&(r.push(e.slice(0,i+1)),function(e){return Dt.test(e)}(t[0])&&(r[0]+="/"),t[0]=e.slice(i+2))}else"/"===t[0][0]&&r.push("");const i=t.reduce(((e,t)=>t?e.concat(t.split("/")):e),[]);for(let e=0;e<i.length;e++){const t=i[e];".."===t&&r.length>0&&".."!==r[r.length-1]?r.pop():(!t&&e===i.length-1||t&&("."!==t||0===r.length))&&r.push(t)}return r.join("/")}function nr(e,t=!1){if(lr(e)||cr(e))return null;let r=e.indexOf("://");if(-1===r&&fr(e))r=2;else{if(-1===r)return null;r+=3}const i=e.indexOf("/",r);return-1!==i&&(e=e.slice(0,i)),t&&(e=vr(e,!0)),e}function ar(e){return fr(e)||yr(e)}function lr(e){return null!=e&&"blob:"===e.slice(0,5)}function cr(e){return"data:"===e.slice(0,5)}function hr(e){const t=dr(e);if(!t||!t.isBase64)return null;const r=atob(t.data),i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return i.buffer}const ur=/^data:(.*?)(;base64)?,(.*)$/;function dr(e){const t=e.match(ur);if(!t)return null;const[,r,i,s]=t;return{mediaType:r,isBase64:!!i,data:s}}function pr(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}function fr(e){return null!=e&&void 0!==e&&"/"===e[0]&&"/"===e[1]}function yr(e){return Tt.test(e)}function mr(e){return fr(e)?`https:${e}`:e.replace(Pt,"https:")}function gr(){return"https"===Bt.scheme}function vr(e,t=!1){return fr(e)?e.slice(2):(e=e.replace(Tt,""),t&&e.length>1&&"/"===e[0]&&"/"===e[1]&&(e=e.slice(2)),e)}function _r(e){let t=0;if(ar(e)){const r=e.indexOf("//");-1!==r&&(t=r+2)}const r=e.lastIndexOf("/");return r<t?e:e.slice(0,r+1)}function br(e,t){if(!e)return"";const r=Gt(e).path.replace(/\/+$/,""),i=r.substring(r.lastIndexOf("/")+1);if(null==t||!t.length)return i;const s=new RegExp(`.(${t.join("|")})$`,"ig");return i.replace(s,"")}function wr(e){return e.replace(/\/+$/,"")}function xr(e,t,r){if(!(t&&r&&e&&ar(e)))return e;const i=e.indexOf("//"),s=e.indexOf("/",i+2),o=e.indexOf(":",i+2),n=Math.min(s<0?e.length:s,o<0?e.length:o);return e.slice(i+2,n).toLowerCase()!==t.toLowerCase()?e:`${e.slice(0,i+2)}${r}${e.slice(n)}`}function Sr(e){return"string"==typeof e?new Ft(rr(e)):(e.scheme||(e.scheme=Bt.scheme),e)}function Cr(e,t){const r=Gt(e),i=Object.keys(r.query||{});return i.length>0&&t&&t.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function Ir(e,t,r){const i=Gt(e),s=i.query||{};return s[t]=String(r),`${i.path}?${Ht(s)}`}function Ar(e,t){const r=Gt(e),i=r.query||{};for(const e in t)i[e]=t[e];const s=Ht(i);return s?`${r.path}?${s}`:r.path}function kr(e){if(w(e))return null;const t=e.match(Nr);return t?t[1]:null}const Nr=/.*?\.([^\/]*)$/;function Or(){const e=Tr.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16);return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}const Tr=i.e.crypto||i.e.msCrypto,Pr=7;function Mr(e){switch(e){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function Dr(e){switch(e){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"user"}}function Lr(e){return Dr(e)}function Er(e){return Rr[function(e){return e instanceof Blob?e.type:function(e){const t=kr(e);return Br[t]||jr}(e.url)}(e)]||Fr}const Rr={},jr="text/plain",Fr=Rr[jr],Br={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const e in Br)Rr[Br[e]]=e;function zr(e,t){const r=t&&t.url&&t.url.path;if(e&&r&&(e=rr(e,r,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const r=ir(e,t.portalItem.itemUrl);Hr.test(r)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(r).path)}return Wr(e,t&&t.portal)}function Ur(e,t,r=0){if(!e)return e;!ar(e)&&t&&t.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);let i=rr(e);if(t){const r=t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.rootPath||t.url&&t.url.path;if(r){const s=Wr(r,t.portal);i=ir(Wr(i,t.portal),s,s),i!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=function(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?xr(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}(i,t&&t.portal),ar(i)&&(i=sr(i)),null!=t&&t.resources&&null!=t&&t.portalItem&&!ar(i)&&!cr(i)&&0===r&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(i)}),i}function Gr(e,t,r){return zr(e,r)}function qr(e,t,r,i){const s=Ur(e,i);void 0!==s&&(t[r]=s)}const Vr=/\/items\/([^\/]+)\/resources\//,Hr=/^\.\/resources\//;function $r(e){const t=b(e)?e.match(Vr):null;return b(t)?t[1]:null}function Wr(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const r=`${t.urlKey}.${t.customBaseUrl}`;return Xt(Bt,`${Bt.scheme}://${r}`)?xr(e,t.portalHostname,r):xr(e,r,t.portalHostname)}var Jr=Object.freeze({__proto__:null,fromJSON:zr,toJSON:Ur,read:Gr,write:qr,itemIdFromResourceUrl:$r});function Qr(e){return Array.isArray(e)?e.filter((e=>!!e)):e?e.split(" ").filter((e=>!!e)):[]}let Zr;function Yr(){return"ltr"===(((0,i.h)("worker")?Zr:document.body.dir)||"ltr").toLowerCase()}const Kr={innerHTML:1,textContent:1,className:1,value:1},Xr={classname:"class"},ei={class:"className",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent"};function ti(e,t,r){if("object"==typeof t){for(const r in t)ti(e,"style"===r?"style":r,t[r]);return e}if(void 0===r)return e;const i=t,s=i.toLowerCase(),o=ei[s]||i,n=Kr[o];return"style"===o&&"string"!=typeof r?ui(e,r):n||"boolean"==typeof r?e[o]=r:e.setAttribute(Xr[s]||i,r+""),e}function ri(e,t){e&&e.classList&&Qr(t).forEach((t=>{e.classList.add(t)}))}function ii(e,t){e&&e.classList&&Qr(t).forEach((t=>{e.classList.remove(t)}))}function si(e,t,r){ii(e,r),ri(e,t)}function oi(e,t,r){r?ri(e,t):ii(e,t)}function ni(e,t){return!(!e||!e.classList)&&e.classList.contains(t)}const ai={left:!0,top:!0},li={cssFloat:1,styleFloat:1,float:1},ci=/margin|padding|width|height|max|min|offset/;function hi(e,t,r){const i=e.style;return"opacity"===t?i.opacity:function(e,t,r){if(t=t.toLowerCase(),"auto"===r){if("height"===t)return e.offsetHeight;if("width"===t)return e.offsetWidth}return"fontweight"===t?r+""=="700"?"bold":"normal":(t in ai||(ai[t]=ci.test(t)),ai[t]?pi(r):r)}(e,t=li[t]?"cssFloat"in i?"cssFloat":"styleFloat":t,(r||di(e))[t]||i[t])}function ui(e,t,r){if((t=li[t]?"cssFloat"in e.style?"cssFloat":"styleFloat":t)&&"object"==typeof t&&void 0===r)for(const r in t)ui(e,r,t[r]);else"opacity"===t?e.style.opacity=r+"":e.style[t]=r}function di(e){return e&&1===e.nodeType&&window.getComputedStyle(e)}function pi(e){return parseFloat(e)||0}function fi(e,t){const r=e.getBoundingClientRect(),i={x:r.left,y:r.top,w:r.right-r.left,h:r.bottom-r.top};if(t){const e={x:window.pageXOffset||0,y:window.pageYOffset||0};i.x+=e.x,i.y+=e.y}return i}function yi(e,t){const r=t||di(e),i=pi,s=i(r.marginLeft),o=i(r.marginTop),n=i(r.marginRight),a=i(r.marginBottom);return{l:s,t:o,r:n,b:a,w:s+n,h:o+a}}function mi(e,t){const r=t||di(e),i=gi(e,r),s=vi(e,r),o=e.offsetLeft+i.l+s.l,n=e.offsetTop+i.t+s.t;let a,l=e.clientWidth;return l?a=e.clientHeight:(l=e.offsetWidth-s.w,a=e.offsetHeight-s.h),{l:o,t:n,w:l-i.w,h:a-i.h}}function gi(e,t){const r=t||di(e),i=pi,s=i(r.paddingLeft),o=i(r.paddingTop),n=i(r.paddingRight),a=i(r.paddingBottom);return{l:s,t:o,r:n,b:a,w:s+n,h:o+a}}function vi(e,t){const r=pi,i=t||di(e),s="none"!==i.borderLeftStyle?r(i.borderLeftWidth):0,o="none"!==i.borderTopStyle?r(i.borderTopWidth):0,n="none"!==i.borderRightStyle?r(i.borderRightWidth):0,a="none"!==i.borderBottomStyle?r(i.borderBottomWidth):0;return{l:s,t:o,r:n,b:a,w:s+n,h:o+a}}function _i(e,t,r,s){if((0,i.h)("worker")){const e=new Error("Can't create DOM elements inside a web worker.");throw console.error(e),console.error(e.stack),e}const o=document.createElement(e);return t&&ti(o,t),r&&bi(o,r,s),o}function bi(e,t,r){if("number"==typeof r){const i=t.childNodes;!i.length||i.length<=r?t.appendChild(e):wi(e,i[r<0?0:r])}else switch(r){case"before":wi(e,t);break;case"after":!function(e,t){const r=t.parentNode;r&&(r.lastChild===t?r.appendChild(e):r.insertBefore(e,t.nextSibling))}(e,t);break;case"replace":t.parentNode.replaceChild(e,t);break;case"first":if(t.firstChild){wi(e,t.firstChild);break}default:t.appendChild(e)}return e}function wi(e,t){const r=t.parentNode;r&&r.insertBefore(e,t)}function xi(e){"innerHTML"in e&&(e.innerHTML="");for(;e.lastChild;)e.removeChild(e.lastChild)}function Si(e){e&&(e.firstChild&&xi(e),e.parentNode&&e.parentNode.removeChild(e))}function Ci(e){return function(e,t){return Ai(e,(e=>{ri(e,"esriGEHidden")}))}(e)}function Ii(e){return function(e,t){return Ai(e,(e=>{e&&ii(e,"esriGEHidden")}))}(e)}function Ai(e,t){return Array.isArray(e)?e.forEach(t):t(e),e}function ki(e,t){if(e&&e.children)for(let r=0;r<e.children.length;r++){const i=e.children[r];if(t(i,e))return;ki(i,t)}}function Ni(e){return e&&("function"==typeof e.on||"function"==typeof e.addEventListener)}function Oi(e,t,r){if(!Ni(e))throw new TypeError("target is not a Evented or EventTarget object");if("on"in e)return e.on(t,r);if(Array.isArray(t)){const i=t.slice();for(const t of i)e.addEventListener(t,r);return{remove(){for(const t of i)e.removeEventListener(t,r)}}}return e.addEventListener(t,r),{remove(){e.removeEventListener(t,r)}}}function Ti(e,t,r){if(!Ni(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,r);const i=Oi(e,t,(t=>{i.remove(),r.call(e,t)}));return{remove(){i.remove()}}}let Pi;function Mi(){if(Pi)return Pi;const e={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,safari:!1,macos:!1,windows:!1,electron:!1,pixelRatio:1,os:null,osVersion:"",webView:!1,worker:!1};try{if((0,i.h)("worker")||void 0===self.window)return e.desktop=!0,e.worker=!0,Pi=e;const t=window,r=t.navigator.platform,s=t.navigator.userAgent,o=t.screen.width,n=t.screen.height,a=s.match(/(Android);?[\s\/]+([\d.]+)?/);let l=s.match(/(iPad).*OS\s([\d_]+)/);const c=s.match(/(iPod)(.*OS\s([\d_]+))?/),h=!l&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),u=s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0,d=s.indexOf("Edge/")>=0,p=s.indexOf("Gecko/")>=0&&s.indexOf("Firefox/")>=0,f="Win32"===r,y=s.toLowerCase().indexOf("electron")>=0;let m="MacIntel"===r;e.safari=m&&!a&&!/chrome/i.test(s)&&/safari/i.test(s);const g=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768"];!l&&m&&Li()&&g.indexOf(o+"x"+n)>=0&&(l=s.match(/(Version)\/([\d.]+)/),l||(l=[0,1,"13_0_0"]),m=!1),e.ie=u,e.edge=d,e.firefox=p,a&&!f&&(e.os="android",e.osVersion=a[2],e.android=!0,e.androidChrome=s.toLowerCase().indexOf("chrome")>=0),(l||h||c)&&(e.os="ios",e.ios=!0),h&&!c&&(e.osVersion=h[2].replace(/_/g,"."),e.iphone=!0),l&&(e.osVersion=l[2].replace(/_/g,"."),e.ipad=!0),c&&(e.osVersion=c[3]?c[3].replace(/_/g,"."):null,e.ipod=!0),e.ios&&e.osVersion&&s.indexOf("Version/")>=0&&"10"===e.osVersion.split(".")[0]&&(e.osVersion=s.toLowerCase().split("version/")[1].split(" ")[0]),e.webView=!(!(h||l||c)||!s.match(/.*AppleWebKit(?!.*Safari)/i)&&!t.navigator.standalone)||t.matchMedia&&t.matchMedia("(display-mode: standalone)").matches,e.desktop=!(e.ios||e.android)||y,e.desktop&&(e.electron=y,e.macos=m,e.windows=f,e.macos?e.os="macos":e.windows?e.os="windows":/Linux/.test(r)&&(e.os="linux")),e.pixelRatio=t.devicePixelRatio||1}catch(t){e.error=String(t)}return Pi=e}function Di(){return!Mi().desktop}function Li(){return"ontouchstart"in document||"onpointerdown"in document&&navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function Ei(e,t,r){const i=function(e,t,r,i){if("string"==typeof t&&-1!==t.indexOf(","))throw new TypeError("Event notation like 'click, mouseup' is not supported.");if(e&&"function"==typeof e.addEventListener){const e=[],i=[];(Array.isArray(t)?t:[t]).forEach((t=>{(Fi[t]?e:i).push(t)}));const s={},o={},n=Mi().desktop&&Li();if(e.length){e.forEach((e=>{const t=n?ji[e]:[Fi[e]];if(t.forEach((e=>{s[e]||(s[e]=e)})),n){const e=t[0],r=t[1];let i=o[e];i||(i=o[e]={}),i[r]=1}})),i.forEach((e=>{s[e]||(s[e]=e),o[e]&&delete o[e]})),t=[];for(const e in s)t.push(s[e])}if(e.length&&n){let e,i;const s=()=>{e&&clearTimeout(e),e=null};return{type:t,listener:t=>{if(t.touches)s(),e=setTimeout(s,500),i=t.type;else if(e){const e=o[t.type];if(e&&e[i])return}r.call(null,t)}}}}return{type:t,listener:r}}(e,t,r);return Oi(e,i.type,i.listener)}function Ri(e,t,r){const i=Ei(e,t,(e=>{i.remove(),r.call(null,e)}));return i}const ji={click:["click","touchend"],press:["mousedown","touchstart"],move:["mousemove","touchmove"],release:["mouseup","touchend"],over:["mouseover","touchstart"],out:["mouseout","touchend"],enter:["mouseenter","touchstart"],leave:["mouseleave","touchend"]},Fi=(()=>{const e={},t=Di()?1:0;for(const r in ji)e[r]=ji[r][t];return e})();class Bi{start(e,t){if(this._deferred=(0,i.c)(),this._oldNode=t,e.length&&e[0].node){this._targets=e,Ri(e[0].node,"animationend",(()=>this.finish()));for(let t=0;t<e.length;t++){const r=e[t];ri(r.node,r.classes),ri(r.node,"Anim_Common")}}else this.finish();return this._deferred.promise}finish(){if(this._targets){for(let e=0;e<this._targets.length;e++){const t=this._targets[e];t.node&&(ii(t.node,t.classes),ii(t.node,"Anim_Common"))}this._targets=null}this._oldNode&&(Si(this._oldNode),this._oldNode=null),this._deferred.resolve()}}class zi{constructor(e){this._ltr=Yr(),this._flySurfaceNode=e,this._items=[]}fly(e,t,r,i){i=i||e.cloneNode(!0),r||(r=["top",this._ltr?"left":"right"]);const s=e.getBoundingClientRect(),o=this._flySurfaceNode.getBoundingClientRect();let n,a;ri(i,"Anim_FlyingObj");for(let e=0;e<r.length;e++){const t=r[e];let l=s[t]-o[t];"right"!==t&&"bottom"!==t||(l=-l),("left"===t&&!this._ltr||"right"===t&&this._ltr)&&(n=t,a=l),i.style[t]=l+"px"}return this._flySurfaceNode.appendChild(i),n&&(a+=s.width-i.getBoundingClientRect().width,i.style[n]=a+"px"),this.start([{node:i,classes:[t]}],i),i}start(e,t){const r=new Bi;return this._items.push(r),this._progress||(this._progress=(0,i.c)()),r.start(e,t).then(this._onItemFinished.bind(this,r))}finish(){const e=this._items;for(;e.length>0;)e.pop().finish()}getPromise(){return this._progress&&this._progress.promise}_onItemFinished(e){const t=this._items.indexOf(e);t>=0&&(this._items.splice(t,1),0===this._items.length&&this._progress&&(this._progress.resolve(),this._progress=null))}}let Ui,Gi;function qi(e){Ui=e}function Vi(e,t){if(!(e&&e.parentNode&&e.getBoundingClientRect&&Ui))return!1;t=t||{};const r=function(e,t){if(!e||!Ui)return!1;const r=(t=t||{}).ignorePadding;r&&((e=Object.assign({},e)).x+=r,e.y+=r,e.w-=2*r,e.h-=2*r);const i=t.event?Hi(t.event):Ui;return e.x<=i.clientX&&e.x+e.w>=i.clientX&&e.y<=i.clientY&&e.y+e.h>=i.clientY}(fi(e),{ignorePadding:t.ignorePadding,event:t.event});if(!r&&t.checkAllChildren){let r=!1;return ki(e,(e=>!!Vi(e,{ignorePadding:t.ignorePadding,event:t.event})&&(r=!0,!0))),r}return r}function Hi(e){const t=$i(e);if(t){const r=e;r.screenX=t.screenX,r.screenY=t.screenY,r.clientX=t.clientX,r.clientY=t.clientY,r.pageX=t.pageX,r.pageY=t.pageY}return e}function $i(e){const t=e;if(t.touches){if(!t.touches.length)return t.changedTouches[0];const e=t.touches[0].identifier;let r;for(let i=0;i<t.changedTouches.length;i++)if(t.changedTouches[i].identifier===e){r=t.changedTouches[i];break}return r||t.touches[0]}return null}if(!(0,i.h)("worker")&&globalThis.addEventListener){const e=e=>{const t=$i(e);return t&&(t.type=e.type),t||e};Ei(document.body,"touchstart",(t=>{qi(e(t))})),Ei(document.body,"touchmove",(t=>{qi(e(t))})),Di()||Ei(document.body,"mousemove",(t=>{qi(e(t))})),Ei(document.body,"mousedown",(()=>{Gi||(Gi=!0,Ri(document.body,["mouseup","click"],(()=>{Gi=!1})))}))}function Wi(e,t,r,i){var s,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(o<3?s(n):o>3?s(t,r,n):s(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n}class Ji{constructor(e,t,r,i=1,s=0){if(this.ctor=e,this.acquireFunction=t,this.releaseFunction=r,this.allocationSize=i,this._pool=new Array(s),this._initialSize=s,this.ctor)for(let e=0;e<s;e++)this._pool[e]=new this.ctor;this.allocationSize=Math.max(i,1)}destroy(){this.prune(0)}acquire(...e){let t;if(Ji.test.disabled)t=new this.ctor;else{if(0===this._pool.length){const e=this.allocationSize;for(let t=0;t<e;t++)this._pool[t]=new this.ctor}t=this._pool.pop()}return this.acquireFunction?this.acquireFunction(t,...e):function(e){return e&&e.acquire&&"function"==typeof e.acquire}(t)&&t.acquire(...e),t}release(e){e&&!Ji.test.disabled&&(this.releaseFunction?this.releaseFunction(e):function(e){return e&&e.release&&"function"==typeof e.release}(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let t=e;t<this._pool.length;++t){const e=this._pool[t];this._dispose(e)}this._pool.length=e}}_dispose(e){e.dispose&&"function"==typeof e.dispose&&e.dispose()}}Ji.test={disabled:!1};class Qi{constructor(e,t){this._observers=e,this._observer=t}remove(){this._observers.delete(this._observer)}}let Zi=!1;function Yi(e){return void 0!==e.flags}class Ki{constructor(e,t,r){this.host=e,this.propertyName=t,this.metadata=r,this.flags=1,this._observers=null,this._accessed=null,this._handles=[],this.flags=1|(r.nonNullable?8:0)|(r.hasOwnProperty("value")?16:0)|(void 0===r.get?32:0)|(void 0===r.dependsOn?64:0)}destroy(){this._accessed&&(this._accessed.clear(),this._accessed=null),this._observers&&(this._observers.clear(),this._observers=null),this._clearObservationHandles()}onObservableAccessed(e){e!==this&&(null===this._accessed&&(this._accessed=new Set),this._accessed.add(e))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=32;const e=this._accessed;if(null===e)return;const t=this._handles;for(const r of e)t.push(r.observe(this));e.clear()}observe(e){return null===this._observers&&(this._observers=new Set),new Qi(this._observers.add(e),e)}notify(){2&~this.flags&&(this.flags|=1),this._notifyObservers()}invalidate(){this.notify()}commit(){this.flags&=-2,this._notifyObservers()}_notifyObservers(){if(null===this._observers)return;const e=this._observers.size,t=new Array(e);let r=e-1;for(const e of this._observers)t[r--]=e;const i=!Zi;for(;t.length;){const e=t.pop();if(Yi(e)){if(2&~e.flags&&(e.flags|=1),null===e._observers)continue;for(const r of e._observers)t.push(r)}else i&&e.notify()}}_clearObservationHandles(){for(const e of this._handles)e.remove();this._handles.length=0}}class Xi{constructor(){this._values=new Map}clone(e){const t=new Xi;return this._values.forEach(((r,i)=>{e&&e.has(i)||t.set(i,d(r))})),t}get(e){return this._values.get(e)}originOf(){return 6}keys(){return[...this._values.keys()]}set(e,t){this._values.set(e,t)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}}let es,ts=[];const rs=G.getLogger("esri.core.Accessor");function is(e){void 0!==es&&es.onObservableAccessed(e)}let ss=!1,os=!1;function ns(e,t,r){if(ss)return as(e,t,r);ls(e);const i=t.call(r);return cs(),i}function as(e,t,r){const i=ss;ss=!0,ls(e);let s=null;try{s=t.call(r)}catch(e){os&&rs.error(e)}return cs(),ss=i,s}function ls(e){es=e,ts.push(e)}function cs(){const e=ts.pop();es=ts.length>0?ts[ts.length-1]:void 0,void 0!==e&&e.onTrackingEnd()}function hs(e,t){if(32&t.flags)return;const r=os;os=!1,64&t.flags?as(t,t.metadata.get,e):ds(e,t),os=r}const us=[];function ds(e,t){128&t.flags||(t.flags|=128,as(t,(()=>{const r=t.metadata.dependsOn||us;for(const t of r)if("string"==typeof t&&-1===t.indexOf("."))ps(e,t,!1);else{const r=_e(t);for(let t=0,i=e;t<r.length&&null!=i&&"object"==typeof i;++t)i=ps(i,r[t],t!==r.length-1)}})),t.flags&=-129)}function ps(e,t,r){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const s=me(e),o=null==s?void 0:s.properties.get(i);return o&&(is(o),hs(e,o)),r?e[i]:void 0}function fs(e,t,r){return void 0!==e}function ys(e,t,r,i){return!(void 0===e||null==r&&8&e.flags)}function ms(e){return e&&"function"==typeof e.destroy}G.getLogger("esri.core.accessorSupport.Properties");class gs{constructor(e){this.host=e,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new Xi,this._origin=6;const t=this.host.constructor.__accessorMetadata__,r=t.properties;for(const t in r){const i=new Ki(e,t,r[t]);this.properties.set(t,i)}this.metadatas=r,this._autoDestroy=t.autoDestroy}initialize(){this.lifecycle=1}constructed(){this.lifecycle=2}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[e,t]of this.properties){const r=this.internalGet(e);r&&ms(r)&&(r.destroy(),8&~t.flags&&this._internalSet(t,null)),t.destroy()}else for(const[e,t]of this.properties)t.destroy()}get initialized(){return 0!==this.lifecycle}get(e){return this.properties.get(e).metadata.get?this.getterComputed(e):this.getterStatic(e)}getterStatic(e){const t=this.properties.get(e);if(void 0!==t)return is(t),this.store.has(e)?this.store.get(e):t.metadata.value}getterComputed(e){const t=this.properties.get(e);is(t);const r=this.store,i=t.flags,s=this.store.get(e);if(4&i)return s;if(r.has(e)&&(1&~i||Zi))return s;let o;t.flags|=4;const n=t.metadata.get;64&i?o=ns(t,n,this.host):(ds(this.host,t),o=n.call(this.host)),r.set(e,o,1);const a=this.store.get(e);return a===s?t.flags&=-2:t.commit(),t.flags&=-5,a}originOf(e){const t=this.store.originOf(e);if(void 0===t){const t=this.properties.get(e);if(void 0!==t&&16&t.flags)return"defaults"}return Dr(t)}has(e){return!!this.properties.has(e)&&this.store.has(e)}keys(){return[...this.properties.keys()]}internalGet(e){const t=this.properties.get(e);if(fs(t))return this.store.has(e)?this.store.get(e):t.metadata.value}internalSet(e,t){const r=this.properties.get(e);fs(r)&&this._internalSet(r,t)}getDependsInfo(e,t,r){const i=this.properties.get(t);if(!fs(i))return"";const s=new Set,o=ns({onObservableAccessed:e=>s.add(e),onTrackingEnd:()=>{}},(()=>{var t;return null==(t=i.metadata.get)?void 0:t.call(e)}));let n=`${r}${e.declaredClass.split(".").pop()}.${t}: ${o}\n`;if(0===s.size)return n;r+="  ";for(const e of s){if(!(e instanceof Ki))continue;const t=e.host,i=e.propertyName,s=me(t);n+=s?s.getDependsInfo(t,i,r):`${r}${i}: undefined\n`}return n}setAtOrigin(e,t,r){const i=this.properties.get(e);if(fs(i))return this._setAtOrigin(i,t,r)}isOverridden(e){const t=this.properties.get(e);return void 0!==t&&!!(2&t.flags)}clearOverride(e){const t=this.properties.get(e);void 0!==t&&2&t.flags&&(t.flags&=-3,t.invalidate())}override(e,t){const r=this.properties.get(e);if(!ys(r,0,t))return;const i=r.metadata.cast;if(i){const e=this._cast(i,t),{valid:r,value:s}=e;if(vs.release(e),!r)return;t=s}r.flags|=2,this._internalSet(r,t)}set(e,t){const r=this.properties.get(e);if(!ys(r,0,t))return;const i=r.metadata.cast;if(i){const e=this._cast(i,t),{valid:r,value:s}=e;if(vs.release(e),!r)return;t=s}const s=r.metadata.set;s?s.call(this.host,t):this._internalSet(r,t)}setDefaultOrigin(e){this._origin=Mr(e)}getDefaultOrigin(){return Dr(this._origin)}propertyInvalidated(e){const t=this.properties.get(e);void 0!==t&&t.invalidate()}propertyCommitted(e){const t=this.properties.get(e);void 0!==t&&t.commit()}_internalSet(e,t){const r=0!==this.lifecycle?this._origin:0;this._setAtOrigin(e,t,r)}_setAtOrigin(e,t,r){const i=this.store,s=e.propertyName;i.has(s,r)&&p(t,i.get(s))&&2&~e.flags&&r===i.originOf(s)||(Zi=!0,e.invalidate(),Zi=!1,i.set(s,t,r),e.commit(),hs(this.host,e))}_cast(e,t){const r=vs.acquire();return r.valid=!0,r.value=t,e&&(r.value=e.call(this.host,t,r)),r}}const vs=new Ji(class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}}),_s=Array.prototype.splice;function bs(e){e.length=0}class ws{constructor(e=50,t=50){this._pool=new Ji(Array,void 0,bs,t,e)}acquire(){return this._pool.acquire()}copy(e){const t=this.acquire();return e.unshift(0,0),_s.apply(t,e),e.splice(0,2),t}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return xs.acquire()}static copy(e){return xs.copy(e)}static release(e){return xs.release(e)}static prune(){xs.prune()}}const xs=new ws(100),Ss=i.e.queueMicrotask?i.e.queueMicrotask:e=>{i.e.Promise.resolve().then(e)},Cs=[];let Is=[];function As(e){Cs.push(e),1===Cs.length&&Ss((()=>{for(const e of Is)e();const e=Cs.slice();Cs.length=0;for(const t of e)t()}))}!function(e){e.before=function(e){return Is.push(e),{remove(){Is=Is.filter((t=>t!==e))}}}}(As||(As={}));var ks=As;class Ns{constructor(e,t=29){this.name=e,this._counter=0,this._items=new Array(t)}record(e){this._items[++this._counter%this._items.length]=e}get median(){return this._items.slice().sort()[Math.floor(this._items.length/2)]}get average(){return this._items.reduce(((e,t)=>e+t),0)/this._items.length}get last(){return this._items[this._counter%this._items.length]}}class Os{constructor(e=1){this._seed=e}set seed(e){this._seed=null==e?Math.random()*Os._m:e}getInt(){return this._seed=(Os._a*this._seed+Os._c)%Os._m,this._seed}getFloat(){return this.getInt()/(Os._m-1)}getIntRange(e,t){return Math.round(this.getFloatRange(e,t))}getFloatRange(e,t){const r=t-e;return e+this.getInt()/Os._m*r}}function Ts(e,t,r){if(w(e)&&w(t))return!0;if(w(e)||w(t)||e.length!==t.length)return!1;if(r){for(let i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}Os._m=2147483647,Os._a=48271,Os._c=0;const Ps=!!Array.prototype.fill;function Ms(e,t){if(Ps)return new Array(e).fill(t);const r=new Array(e);for(let i=0;i<e;i++)r[i]=t;return r}function Ds(e,t){void 0===t&&(t=e,e=0);const r=new Array(t-e);for(let i=e;i<t;i++)r[i-e]=i;return r}class Ls{constructor(){this.last=0}}const Es=new Ls;function Rs(e,t,r,i){i=i||Es;const s=Math.max(0,i.last-10);for(let o=s;o<r;++o)if(e[o]===t)return i.last=o,o;const o=Math.min(s,r);for(let r=0;r<o;++r)if(e[r]===t)return i.last=r,r;return-1}function js(e,t,r,i){const s=null==r?e.length:r,o=Rs(e,t,s,i);if(-1!==o)return e[o]=e[s-1],null==r&&e.pop(),t}const Fs=new Set;function Bs(e,t){const r=e.indexOf(t);return-1!==r?(e.splice(r,1),t):null}var zs;!function(e){const t=(e,t,r,i)=>{let s=t,o=t;const n=r>>>1,a=e[s-1];for(;o<=n;){o=s<<1,o<r&&i(e[o-1],e[o])<0&&++o;const t=e[o-1];if(i(t,a)<=0)break;e[s-1]=t,s=o}e[s-1]=a},r=(e,t)=>e<t?-1:e>t?1:0;e.sort=function(e,i,s,o){void 0===i&&(i=0),void 0===s&&(s=e.length),void 0===o&&(o=r);for(let r=s>>>1;r>i;r--)t(e,r,s,o);const n=i+1;for(let r=s-1;r>i;r--){const s=e[i];e[i]=e[r],e[r]=s,t(e,n,r,o)}},e.iterableSort=function*(e,i,s,o){void 0===i&&(i=0),void 0===s&&(s=e.length),void 0===o&&(o=r);for(let r=s>>>1;r>i;r--)t(e,r,s,o),yield;const n=i+1;for(let r=s-1;r>i;r--){const s=e[i];e[i]=e[r],e[r]=s,t(e,n,r,o),yield}}}(zs||(zs={}));var Us=zs;class Gs{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Ls,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),void 0!==e.deallocator&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>qs(this)))}toArray(){return this.data.slice(0,this.length)}getItemAt(e){if(!(e<0||e>=this._length))return this.data[e]}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let t=e;t<this._length;++t)this.data[t]=this._deallocator(this.data[t]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,t=e.length){for(let r=0;r<t;r++)this.data[this._length++]=e[r]}fill(e,t){for(let r=0;r<t;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,qs(this)}pop(){if(0===this.length)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const t=Rs(this.data,e,this.length,this._hint);if(-1!==t)return this.data.splice(t,1),this.length=this.length-1,e}removeUnordered(e){const t=js(this.data,e,this.length,this._hint);return void 0!==t&&(this.length=this.length-1),this._shrink(),t}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,t=e.length,r){this.length=function(e,t,r=e.length,i=t.length,s,o){if(0===i||0===r)return r;Fs.clear();for(let e=0;e<i;++e)Fs.add(t[e]);s=s||Es;const n=Math.max(0,s.last-10);for(let t=n;t<r;++t)if(Fs.has(e[t])&&(o&&o.push(e[t]),Fs.delete(e[t]),e[t]=e[r-1],--r,--t,0===Fs.size||0===r))return Fs.clear(),r;for(let t=0;t<n;++t)if(Fs.has(e[t])&&(o&&o.push(e[t]),Fs.delete(e[t]),e[t]=e[r-1],--r,--t,0===Fs.size||0===r))return Fs.clear(),r;return Fs.clear(),r}(this.data,e,this.length,t,this._hint,r),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(e,t){e>=this.length||t>=this.length||e===t||([this.data[e],this.data[t]]=[this.data[t],this.data[e]])}sort(e){Us.sort(this.data,0,this.length,e)}iterableSort(e){return Us.iterableSort(this.data,0,this.length,e)}some(e,t){for(let r=0;r<this.length;++r)if(e.call(t,this.data[r],r,this.data))return!0;return!1}filterInPlace(e,t){let r=0;for(let i=0;i<this._length;++i){const s=this.data[i];e.call(t,s,i,this.data)&&(this.data[i]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let e=r;e<this._length;e++)this.data[e]=this._deallocator(this.data[e]);return this._length=r,this._shrink(),this}forAll(e,t){const r=this.length,i=this.data;for(let s=0;s<r;++s)e.call(t,i[s],s,i)}map(e,t){const r=new Array(this.length);for(let i=0;i<this.length;++i)r[i]=e.call(t,this.data[i],i,this.data);return r}reduce(e,t){let r=t;for(let t=0;t<this.length;++t)r=e(r,this.data[t],t,this.data);return r}has(e){const t=this.length,r=this.data;for(let i=0;i<t;++i)if(r[i]===e)return!0;return!1}}function qs(e){e.data.length>1.5*e.length&&(e.data.length=Math.floor(1.1*e.length))}var Vs,Hs=(Vs=i.e,{setTimeout:(e,t)=>{const r=Vs.setTimeout(e,t);return{remove:()=>Vs.clearTimeout(r)}}});function $s(e){return Promise.all(e)}function Ws(e){return new Promise(((t,r)=>{try{e(t,r)}catch(e){Promise.resolve().then((()=>r(e)))}}))}function Js(e="Aborted"){return new At("AbortError",e)}function Qs(){return new AbortController}function Zs(e){if(Ks(e))throw Js()}function Ys(e){return b(e)?"aborted"in e?e:e.signal:e}function Ks(e){const t=Ys(e);return b(t)&&t.aborted}function Xs(e){if(so(e))throw e}function eo(e){if(!so(e))throw e}function to(e,t){const r=Ys(e);if(!w(r)){if(!r.aborted)return Ti(r,"abort",(()=>t()));t()}}function ro(e,t){const r=Ys(e);if(!w(r))return Zs(r),Ti(r,"abort",(()=>t(Js())))}function io(e,t){return w(Ys(t))?e:new Promise(((r,i)=>{let s=to(t,(()=>i(Js())));const o=()=>s=k(s);e.then(o,o),e.then(r,i)}))}function so(e){return e&&"AbortError"===e.name}function oo(e){return e.catch((e=>{if(!so(e))throw e}))}function no(){let e=null;const t=new Promise(((t,r)=>{e={promise:void 0,resolve:t,reject:r}}));return e.promise=t,e}function ao(e){if(!e)return;if("function"!=typeof e.forEach){const t=Object.keys(e);return ao(t.map((t=>e[t]))).then((e=>{const r={};return t.forEach(((t,i)=>r[t]=e[i])),r}))}const t=e;return Ws((e=>{const r=[];let i=t.length;0===i&&e(r),t.forEach((t=>{const s={promise:t||Promise.resolve(t)};r.push(s),s.promise.then((e=>{s.value=e})).catch((e=>{s.error=e})).then((()=>{--i,0===i&&e(r)}))}))}))}function lo(e){return Promise.reject(e)}function co(e){return Promise.resolve(e)}function ho(e,t,r){const i=Qs();return to(r,(()=>i.abort())),new Promise(((r,s)=>{let o=setTimeout((()=>{o=0,r(t)}),e);to(i,(()=>{o&&(clearTimeout(o),s(Js()))}))}))}function uo(e){return e&&"function"==typeof e.then}function po(e){return e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then?e:Promise.resolve(e)}function fo(e,t=-1){let r,i,s,o,n=null;const a=(...l)=>{if(r){i=l,o&&o.reject(Js()),o=no();const e=o.promise;if(n){const e=n;n=null,e.abort()}return e}if(s=o||no(),o=null,t>0){const i=Qs();r=po(e(...l,i.signal));const s=r;ho(t).then((()=>{r===s&&(o?i.abort():n=i)}))}else r=1,r=po(e(...l));const c=()=>{const e=i;i=s=r=n=null,null!=e&&a(...e)},h=r,u=s;return h.then(c,c),h.then(u.resolve,u.reject),u.promise};return a}function yo(){let e,t;const r=new Promise(((r,i)=>{e=r,t=i})),i=t=>{e(t)};return i.resolve=t=>e(t),i.reject=e=>t(e),i.timeout=(e,t)=>Hs.setTimeout((()=>i.reject(t)),e),i.promise=r,i}function mo(e){let t=Qs();const r=e(t.signal);let i={promise:r,finished:!1,abort:()=>{t&&(t.abort(),t=null)}};const s=()=>{i&&(i.finished=!0,i=null),t=null};return r.then(s,s),i}class go{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}}let vo=0;const _o={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},bo=["prepare","preRender","render","postRender","update"],wo=[],xo=new Gs,So={frameTasks:xo,willDispatch:!1,clearFrameTasks:function(e=!1){xo.forAll((e=>{e.removed=!0})),e&&Ao()},dispatch:ko,executeFrameTasks:function(e){const t=e-vo;vo=e;const r=1e3/60,i=Math.max(0,t-r);for(let s=0;s<bo.length;s++){const o=performance.now(),n=bo[s];xo.forAll((o=>{var a;o.paused||o.removed||(0===s&&o.ticks++,o.phases[n]&&(_o.time=e,_o.deltaTime=0===o.ticks?0:t,_o.elapsedFrameTime=performance.now()-e,_o.frameDuration=r-i,null==(a=o.phases[n])||a.call(o,_o)))})),Oo[s].record(performance.now()-o)}Ao(),To.record(performance.now()-e)}};function Co(e){const t=new go(e);return wo.push(t),So.willDispatch||(So.willDispatch=!0,ks(ko)),t}const Io=new Gs;function Ao(){xo.forAll((e=>{e.removed&&Io.push(e)})),xo.removeUnorderedMany(Io.data,Io.length),Io.clear()}function ko(){for(;wo.length;){const e=wo.shift();e.isActive&&e.callback()}So.willDispatch=!1}function No(e=1,t){const r=yo(),i=()=>{Ks(t)?r.reject(Js()):0===e?r():(--e,ks((()=>i())))};return i(),r.promise}const Oo=bo.map((e=>new Ns(e))),To=new Ns("total");class Po{constructor(e){this.notify=e,this._accessed=new Set,this._handles=[]}destroy(){this._accessed.clear(),this.clear()}onObservableAccessed(e){this._accessed.add(e)}onTrackingEnd(){for(const e of this._accessed)this._handles.push(e.observe(this));this._accessed.clear()}clear(){for(const e of this._handles)e.remove();this._handles.length=0}}const Mo={runImmediately:!1};function Do(e,t,r=Mo){let i=new Po((function(){if(!i||o)return;const r=s;i.clear(),o=!0,s=ns(i,e),o=!1,t(s,r)})),s=null,o=!1;return o=!0,s=ns(i,e),o=!1,r.runImmediately&&t(s,s),{remove:function(){i&&(i.destroy(),i=null,s=null)}}}class Lo{constructor(){this.uid=0,this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.removed=!1,this.propertyPath=null}acquire(e,t,r,i,s){this.target=e,this.path=t,this.oldValue=r,this.callback=i,this.getValue=s,this.propertyPath=function(e){return e?"string"==typeof e&&-1===e.indexOf(".")?e:_e(e):e}(t),this.uid=++Lo.uid,this.removed=!1}release(){this.target=this.path=this.propertyPath=this.callback=this.oldValue=null,this.uid=++Lo.uid,this.removed=!0}}Lo.pool=new class extends Ji{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const t=super.acquire(...e);return this._set.delete(t),t}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}}(Lo),Lo.uid=0;const Eo=new ws,Ro=new Set;let jo,Fo=Eo.acquire();function Bo(e){Ro.has(e)?Fo.splice(Fo.indexOf(e),1):Ro.add(e),Fo.push(e),jo||(jo=Co(Go))}function zo(e){if(e.removed)return;const{callback:t,path:r,oldValue:i,target:s}=e,o=e.getValue();Uo(i,o)&&(e.oldValue=o,t.call(s,o,i,r,s))}function Uo(e,t){return!p(e,t)}function Go(){let e=10;for(;jo&&e--;){jo=null;const e=Fo;Fo=Eo.acquire(),Ro.clear();const t=Eo.acquire();for(const r of e){const e=r.uid;zo(r),e===r.uid&&r.removed&&t.push(r)}for(let e=0;e<Fo.length;e++){const r=Fo[e];r.removed&&(t.push(r),Ro.delete(r),Fo.splice(e,1),e-=1)}for(let e=0;e<t.length;e++)Lo.pool.release(t[e]);Eo.release(e),Eo.release(t),qo.forEach((e=>e()))}}const qo=new Set;function Vo(e,t,r,i=!1){return!e.__accessor__||e.__accessor__.destroyed?{remove(){}}:i?function(e,t,r){const i=we(e,t,r,((e,t,r)=>{let s=!1;return Do((()=>Ie(e,t)),((o,n)=>{e.__accessor__.destroyed?i.remove():s||(s=!0,Uo(n,o)&&r.call(e,o,n,t,e),s=!1)}))}));return i}(e,t,r):function(e,t,r){let i=we(e,t,r,((e,t,r)=>{let s,o,n=function(e,t){let r=new Po((function(){t(i,s)})),i=null;function s(){return r?(r.clear(),i=ns(r,e),i):null}return s(),{remove:function(){r&&(r.destroy(),r=null),i=null}}}((()=>Ie(e,t)),((n,a)=>{e.__accessor__.destroyed||s&&s.uid!==o?i.remove():(s||(s=Lo.pool.acquire(e,t,n,r,a),o=s.uid),Bo(s))}));return{remove:xe((function(){n.remove(),s&&(s.uid!==o||s.removed||(s.removed=!0,Bo(s)),s=null),i=n=null}))}}));return i}(e,t,r)}function Ho(e){if(null==e)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return e.constructor&&e.constructor.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}class $o{constructor(...e){if(this.constructor===$o)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new gs(this)}),e.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,e))}static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:t,declaredClass:r,constructor:i}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...e){super(...e),this.inherited=null,i&&i.apply(this,e)}}Oe(o.prototype);for(const t in e){const r=e[t];o.prototype[t]="function"==typeof r?function(...e){const i=this.inherited;let o;this.inherited=function(...e){if(s.prototype[t])return s.prototype[t].apply(this,e)};try{o=r.apply(this,e)}catch(e){throw this.inherited=i,e}return this.inherited=i,o}:e[t]}for(const e in t)Ee(Ho(t[e]))(o.prototype,e);return St(r)(o)}postscript(e){const t=this.__accessor__,r=t.ctorArgs||e;t.initialize(),r&&(this.set(r),t.ctorArgs=null),t.constructed(),this.initialize()}initialize(){}destroy(){this.destroyed||(function(e){for(let t=0;t<Fo.length;t++){const r=Fo[t];r.target===e&&(r.removed=!0)}}(this),this.__accessor__.destroy())}get initialized(){return this.__accessor__&&this.__accessor__.initialized||!1}get constructed(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(e){this.get(e)}get(e){return Ae(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}isInstanceOf(e){return function(e,t,r={}){if((0,i.t)("esri-deprecation-warnings")){const{moduleName:i}=r;Ve(e,"Function: "+(i?i+"::":"")+t+"()",r)}}(G.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof e}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,t){return De(this,e,t),this}watch(e,t,r){return Vo(this,e,t,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_override(e,t){return this.__accessor__.override(e,t)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.propertyInvalidated(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,t){return this.__accessor__.internalSet(e,t),this}}class Wo{constructor(){this._emitter=new Wo.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){class t{constructor(e=null){this.target=e,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear()}emit(e,t){const r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;const i=this.target||this;return[...r].forEach((e=>{e.call(i,t)})),r.length>0}on(e,t){if(Array.isArray(e))return fe(e.map((e=>this.on(e,t))));if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(e)||[];return r.push(t),this._listenersMap.set(e,r),{remove:()=>{const r=this._listenersMap&&this._listenersMap.get(e)||[],i=r.indexOf(t);i>=0&&r.splice(i,1)}}}once(e,t){const r=this.on(e,(e=>{r.remove(),t.call(null,e)}));return r}hasEventListener(e){const t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}e.EventEmitter=t,e.EventedMixin=e=>{let r=class extends e{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};return r=Wi([St("esri.core.Evented")],r),r};let r=class extends $o{constructor(){super(...arguments),this._emitter=new Wo.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};r=Wi([St("esri.core.Evented")],r),e.EventedAccessor=r}(Wo||(Wo={}));var Jo,Qo=Wo;class Zo{constructor(){this._observers=new Set}observe(e){return new Qi(this._observers.add(e),e)}notify(){const e=this._observers,t=this._observers.size,r=new Array(t);let i=0;for(const t of e)r[i++]=t;for(let e=0;e<t;e++)r[e].notify()}}const Yo=new Ji(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},void 0,(e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1})),Ko=()=>{};function Xo(e){return e?e instanceof cn?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function en(e){if(e&&e.length)return e[0]}function tn(e,t,r,i){const s=Math.min(e.length-r,t.length-i);let o=0;for(;o<s&&e[r+o]===t[i+o];)o++;return o}function rn(e,t,r,i){t&&t.forEach(((t,s,o)=>{e.push(t),rn(e,r.call(i,t,s,o),r,i)}))}const sn=new Set,on=new Set,nn=new Set,an=new Map;let ln=0,cn=Jo=class extends Qo.EventedAccessor{constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new Zo,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:ln++})}static isCollection(e){return null!=e&&e instanceof Jo}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof Jo?{items:e}:e:{}}*[Symbol.iterator](){yield*this.items}get items(){return is(this._observable),this._items}set items(e){this._emitBeforeChanges(1)||(this._splice(0,this.length,...Xo(e)),this._emitAfterChanges(1))}hasEventListener(e){return"change"===e?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if("change"===e){const e=this._chgListeners,r={removed:!1,callback:t};return e.push(r),this._notifications&&this._notifications.push({listeners:e.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Ko,r.removed=!0,e.splice(e.indexOf(r),1)}}}return this._emitter.on(e,t)}once(e,t){const r=this.on(e,t);return{remove(){r.remove()}}}add(e,t){if(is(this._observable),this._emitBeforeChanges(1))return this;const r=this.getNextIndex(null!=t?t:null);return this._splice(r,0,e),this._emitAfterChanges(1),this}addMany(e,t=this._items.length){if(is(this._observable),!e||!e.length)return this;if(this._emitBeforeChanges(1))return this;const r=this.getNextIndex(t);return this._splice(r,0,...Xo(e)),this._emitAfterChanges(1),this}removeAll(){if(is(this._observable),!this.length||this._emitBeforeChanges(2))return[];const e=this._splice(0,this.length)||[];return this._emitAfterChanges(2),e}clone(){return is(this._observable),this._createNewInstance({items:this._items.map(d)})}concat(...e){is(this._observable);const t=e.map(Xo);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if(is(this._observable),!this.length||this._emitBeforeChanges(2))return;const r=this._splice(0,this.length),i=r.length;for(let s=0;s<i;s++)e.call(t,r[s],s,r);this._emitAfterChanges(2)}every(e,t){return is(this._observable),this._items.every(e,t)}filter(e,t){let r;return is(this._observable),r=2===arguments.length?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:r})}find(e,t){return is(this._observable),this._items.find(e,t)}findIndex(e,t){return is(this._observable),this._items.findIndex(e,t)}flatten(e,t){is(this._observable);const r=[];return rn(r,this,e,t),new Jo(r)}forEach(e,t){return is(this._observable),this._items.forEach(e,t)}getItemAt(e){return is(this._observable),this._items[e]}getNextIndex(e){is(this._observable);const t=this.length;return(e=null==e?t:e)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return is(this._observable),this._items.includes(e,t)}indexOf(e,t=0){return is(this._observable),this._items.indexOf(e,t)}join(e=","){return is(this._observable),this._items.join(e)}lastIndexOf(e,t=this.length-1){return is(this._observable),this._items.lastIndexOf(e,t)}map(e,t){is(this._observable);const r=this._items.map(e,t);return new Jo({items:r})}reorder(e,t=this.length-1){is(this._observable);const r=this.indexOf(e);if(-1!==r){if(t<0?t=0:t>=this.length&&(t=this.length-1),r!==t){if(this._emitBeforeChanges(4))return e;this._splice(r,1),this._splice(t,0,e),this._emitAfterChanges(4)}return e}}pop(){if(is(this._observable),!this.length||this._emitBeforeChanges(2))return;const e=en(this._splice(this.length-1,1));return this._emitAfterChanges(2),e}push(...e){return is(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,...e),this._emitAfterChanges(1)),this.length}reduce(e,t){is(this._observable);const r=this._items;return 2===arguments.length?r.reduce(e,t):r.reduce(e)}reduceRight(e,t){is(this._observable);const r=this._items;return 2===arguments.length?r.reduceRight(e,t):r.reduceRight(e)}remove(e){return is(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if(is(this._observable),e<0||e>=this.length||this._emitBeforeChanges(2))return;const t=en(this._splice(e,1));return this._emitAfterChanges(2),t}removeMany(e){if(is(this._observable),!e||!e.length||this._emitBeforeChanges(2))return[];const t=e instanceof Jo?e.toArray():e,r=this._items,i=[],s=t.length;for(let e=0;e<s;e++){const s=t[e],o=r.indexOf(s);if(o>-1){const s=1+tn(t,r,e+1,o+1),n=this._splice(o,s);n&&n.length>0&&i.push.apply(i,n),e+=s-1}}return this._emitAfterChanges(2),i}reverse(){if(is(this._observable),this._emitBeforeChanges(4))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,...e)),this._emitAfterChanges(4),this}shift(){if(is(this._observable),!this.length||this._emitBeforeChanges(2))return;const e=en(this._splice(0,1));return this._emitAfterChanges(2),e}slice(e=0,t=this.length){return is(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return is(this._observable),this._items.some(e,t)}sort(e){if(is(this._observable),!this.length||this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return arguments.length?t.sort(e):t.sort(),this._splice(0,0,...t),this._emitAfterChanges(4),this}splice(e,t,...r){is(this._observable);const i=(t?2:0)|(r.length?1:0);if(this._emitBeforeChanges(i))return[];const s=this._splice(e,t,...r)||[];return this._emitAfterChanges(i),s}toArray(){return is(this._observable),this._items.slice()}toJSON(){return is(this._observable),this.toArray()}toLocaleString(){return is(this._observable),this._items.toLocaleString()}toString(){return is(this._observable),this._items.toString()}unshift(...e){return is(this._observable),!e.length||this._emitBeforeChanges(1)||(this._splice(0,0,...e),this._emitAfterChanges(1)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,...r){const i=this._items,s=this.constructor.prototype.itemType;let o,n;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=Co((()=>this._dispatchChange()))),t){if(n=i.splice(e,t),this.hasEventListener("before-remove")){const t=Yo.acquire();t.target=this,t.cancellable=!0;for(let r=0,s=n.length;r<s;r++)o=n[r],t.reset(o),this.emit("before-remove",t),t.defaultPrevented&&(n.splice(r,1),i.splice(e,0,o),e+=1,r-=1,s-=1);Yo.release(t)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const e=Yo.acquire();e.target=this,e.cancellable=!1;const t=n.length;for(let r=0;r<t;r++)e.reset(n[r]),this.emit("after-remove",e);Yo.release(e)}}if(r&&r.length){if(s){const e=[];for(const t of r){const r=s.ensureType(t);null==r&&null!=t||e.push(r)}r=e}const t=this.hasEventListener("before-add"),o=this.hasEventListener("after-add"),n=e===this.length;if(t||o){const s=Yo.acquire();s.target=this,s.cancellable=!0;const a=Yo.acquire();a.target=this,a.cancellable=!1;for(const l of r)t?(s.reset(l),this.emit("before-add",s),s.defaultPrevented||(n?i.push(l):i.splice(e++,0,l),this._set("length",i.length),o&&(a.reset(l),this.emit("after-add",a)))):(n?i.push(l):i.splice(e++,0,l),this._set("length",i.length),a.reset(l),this.emit("after-add",a));Yo.release(a),Yo.release(s)}else{if(n)for(const e of r)i.push(e);else i.splice(e,0,...r);this._set("length",i.length)}}return(r&&r.length||n&&n.length)&&this._notifyChangeEvent(r,n),n}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const r=Yo.acquire();r.target=this,r.cancellable=!0,r.type=e,this.emit("before-changes",r),t=r.defaultPrevented,Yo.release(r)}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=Yo.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),Yo.release(t)}this._observable.notify()}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const e=t.changes;sn.clear(),on.clear(),nn.clear();for(const{added:t,removed:r}of e){if(t)if(0===nn.size&&0===on.size)for(const e of t)sn.add(e);else for(const e of t)on.has(e)?(nn.add(e),on.delete(e)):nn.has(e)||sn.add(e);if(r)if(0===nn.size&&0===sn.size)for(const e of r)on.add(e);else for(const e of r)sn.has(e)?sn.delete(e):(nn.delete(e),on.add(e))}const r=ws.acquire();sn.forEach((e=>{r.push(e)}));const i=ws.acquire();on.forEach((e=>{i.push(e)}));const s=this._items,o=t.items,n=ws.acquire();if(nn.forEach((e=>{o.indexOf(e)!==s.indexOf(e)&&n.push(e)})),t.listeners&&(r.length||i.length||n.length)){const e={target:this,added:r,removed:i,moved:n},s=t.listeners.length;for(let r=0;r<s;r++){const i=t.listeners[r];i.removed||i.callback.call(this,e)}}ws.release(r),ws.release(i),ws.release(n)}sn.clear(),on.clear(),nn.clear()}};cn.ofType=e=>{if(!e)return Jo;if(an.has(e))return an.get(e);let t=null;if("function"==typeof e)t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(const r in e.typeMap){const i=e.typeMap[r].prototype.declaredClass;t?t+=` | ${i}`:t=i}let r=class extends Jo{};r=Wi([St(`esri.core.Collection<${t}>`)],r);const i={Type:e,ensureType:"function"==typeof e?re(e):le(e)};return Object.defineProperty(r.prototype,"itemType",{value:i}),an.set(e,r),r},Wi([Ee()],cn.prototype,"length",void 0),Wi([Ee()],cn.prototype,"items",null),cn=Jo=Wi([St("esri.core.Collection")],cn);var hn=cn;let un=class extends $o{constructor(e){super(e),this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach((t=>{e+=t.length})),e}add(e,t){if(!this._isHandle(e)&&!Array.isArray(e)&&!hn.isCollection(e))return this;const r=this._getOrCreateGroup(t);return Array.isArray(e)||hn.isCollection(e)?e.forEach((e=>this._isHandle(e)&&r.push(e))):r.push(e),this.notifyChange("size"),this}forEach(e,t){if("function"==typeof e)this._groups.forEach((t=>t.forEach(e)));else{const r=this._getGroup(e);r&&t&&r.forEach(t)}}has(e){return this._groups.has(this._ensureGroupKey(e))}remove(e){if(Array.isArray(e)||hn.isCollection(e))return e.forEach(this.remove,this),this;if(!this.has(e))return this;const t=this._getGroup(e);for(let e=0;e<t.length;e++)t[e].remove();return this._deleteGroup(e),this.notifyChange("size"),this}removeAll(){return this._groups.forEach((e=>{for(let t=0;t<e.length;t++)e[t].remove()})),this._groups.clear(),this.notifyChange("size"),this}_isHandle(e){return e&&!!e.remove}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const t=[];return this._groups.set(this._ensureGroupKey(e),t),t}_getGroup(e){return this._groups.get(this._ensureGroupKey(e))}_deleteGroup(e){return this._groups.delete(this._ensureGroupKey(e))}_ensureGroupKey(e){return e||"_default_"}};Wi([Ee({readOnly:!0})],un.prototype,"size",null),un=Wi([St("esri.core.Handles")],un);var dn=un;let pn;i.g.IntersectionObserver&&(pn=new IntersectionObserver((e=>{for(const t of e)if(t.isIntersecting){const e=fn.get(t.target).resolve;fn.delete(t.target),pn.unobserve(t.target),e()}}),{root:document.body}));const fn=new WeakMap;class yn{constructor(){this._emitter=new yn.EventEmitter}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){e.EventEmitter=class{clear(){this._listenersMap&&this._listenersMap.clear()}emit(e,t){const r=this._listenersMap&&this._listenersMap.get(e);return!!r&&(r.slice().forEach((e=>{e.call(null,t)})),r.length>0)}on(e,t){if(Array.isArray(e))return r=e.map((e=>this.on(e,t))),i=()=>r.forEach((e=>e&&e.remove())),{remove:()=>{i&&(i(),i=null)}};var r,i;if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const s=this._listenersMap.get(e)||[];return s.push(t),this._listenersMap.set(e,s),{remove:()=>{const r=this._listenersMap&&this._listenersMap.get(e)||[];r.indexOf(t)>=0&&r.splice(r.indexOf(t),1)}}}once(e,t){let r;return r=this.on(e,(e=>{r.remove(),t.call(null,e)})),r}hasEventListener(e){const t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}};let t=class extends $o{constructor(){super(...arguments),this._emitter=new e.EventEmitter}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}get(e){return super.get(e)}set(e,t){return super.set(e,t)}};t=s([St()],t),e.EventedAccessor=t}(yn||(yn={}));const mn=yn,gn=/>\s+</g;function vn(e){return"string"==typeof e?document.getElementById(e):e}let _n=class extends mn.EventedAccessor{constructor(e,t,r){super(e),this._refNodeBehavoir="replace",this._refNode=vn(t),this._refPosition=r}initialize(){this.buildRendering(),this.postCreate()}buildRendering(){if(this.domNode=this._templateString?function(e){const t=e;let r="function"==typeof t._templateString?t._templateString():t._templateString;r=r.replace(gn,"><");const i=(s=r)&&_i("div",{innerHTML:s}).children[0];var s;return ki(i,(e=>{const r=e.getAttribute("data-dojo-attach-point");r&&console.error("Deprecated 'data-dojo-attach-point' is used. Replace with 'data-attach-point'.");const i=r||e.getAttribute("data-attach-point");i&&(t[i]=e)})),i}(this):this._refNode&&"replace"===this._refNodeBehavoir?this._refNode:_i("div"),this.class&&ri(this.domNode,this.class),this._refNode&&this.domNode!==this._refNode){const e=this._refNode.id;bi(this.domNode,this._refNode,"replace"===this._refNodeBehavoir?"replace":this._refPosition),e&&"replace"===this._refNodeBehavoir&&(this.domNode.id=e)}this._refNode=null,this._refPosition=null}postCreate(){}destroy(){Si(this.domNode),this.domNode=null,this._internalHandles&&this._internalHandles.destroy(),this._onDisplayed&&this._onDisplayed.remove()}placeAt(e,t){return e&&bi(this.domNode,vn(e),t),this}own(e){const t={remove:()=>{"function"==typeof e.destroy?e.destroyed?console.error("WARNING: Multiple attempts to dispose resources!"):e.destroy():e.remove(),t.remove=()=>{console.error("WARNING: Multiple attempts to dispose resources!")}}};this._internalHandles=this._internalHandles||new dn,this._internalHandles.add(t)}get onDisplayed(){return this._onDisplayed||(this._onDisplayed=function(e){const t=new Promise(((t,r)=>{null==pn||pn.observe(e),fn.set(e,{resolve:t,remove:()=>{fn.delete(e),null==pn||pn.unobserve(e),r("removed")}})}));return t.__old_then=t.then,t.then=e=>t.__old_then(e).catch((e=>{if("removed"!==e)throw e})),{promise:t,remove:()=>{const t=fn.get(e);t&&t.remove()}}}(this.domNode)),this._onDisplayed.promise}};s([Ee()],_n.prototype,"class",void 0),_n=s([St()],_n);const bn=10,wn=500;function xn(e,t,r){return Di()?function(e,t,r){const i=(r=r||{}).tolerance||bn;let s,o,n,a,l;function c(){o&&o.remove(),n&&n.remove(),a&&a.remove(),clearTimeout(l)}return s=Ei(e,"touchstart",(s=>{let h;function u(e){const t=Hi(s),r=Hi(e);return Math.abs(t.pageX-r.pageX)<i&&Math.abs(t.pageY-r.pageY)<i}if(c(),r.detectLongPress){let t;n=Ei(e,"touchmove",(e=>{t=e})),l=setTimeout((()=>{u(t||s)&&(r.ignoreReleaseIfLongPressHappened&&(h=!0),r.longPressCallback(s))}),r.longPressTimeout||wn)}o=Ri(e,"touchend",(e=>{!h&&u(e)&&t(e),c()})),a=Ri(e,"touchcancel",c)})),{remove:()=>{s&&s.remove(),c()}}}(e,t,r):function(e,t,r){const s=(r=r||{}).tolerance||0;let o,n;const a=Ei(e,"press",(e=>{n&&n.remove();const r=e.pageX,a=e.pageY;let l;o=Ei(document.body,"move",(e=>{if(e.shiftKey||function(e){return(0,i.t)("mac")?e.metaKey:e.ctrlKey}(e))return;const t=e.pageX,o=e.pageY;(Math.abs(t-r)>s||Math.abs(o-a)>s)&&(l=!0)})),n=Ri(document.body,"release",(e=>{o.remove();const i=e.pageX,n=e.pageY;!l&&Math.abs(i-r)<=s&&Math.abs(n-a)<=s&&t(e)}))}));return{remove(){o&&o.remove(),n&&n.remove(),a&&a.remove()}}}(e,t,r)}function Sn(e={},...t){for(const r of t)Cn(e,r);return e}function Cn(e,t,r){let i,s;const o={};for(i in t){s=t[i];const n=!(i in o)||o[i]!==s;(!(i in e)||e[i]!==s&&n)&&(e[i]=r?r(s):s)}return e}const In=/&|<|>/g,An={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},kn=/((www\.|http:\/\/|https:\/\/)[A-Za-z0-9_.\-~]+\.[A-Za-z0-9_.\-~/]+)|([A-Za-z0-9_.\-~]+\.com[A-Za-z0-9_.\-~/]*)/,Nn="4.19",On={request:(e,t)=>Promise.resolve().then((function(){return Zn})).then((({default:r})=>{const i=e.options||{};return i.responseType="array-buffer",i.signal=null==t?void 0:t.signal,r(e.url,i)})).then((e=>({result:{data:e.data,ssl:e.ssl},transferList:[e.data]})))};let Tn;function Pn(e){const t=Tn&&Tn.findCredential(e);return t&&t.token?Ir(e,"token",t.token):e}(0,i.t)("host-webworker")||((0,i.t)("edge")||(0,i.t)("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");const Mn=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function Dn(e,t,r=!1,s){return new Promise(((o,n)=>{if(Ks(s))return void n(Ln());let a=()=>{h(),n(new Error(`Unable to load ${t}`))},l=()=>{const t=e;h(),o(t)},c=()=>{if(!e)return;const t=e;h(),t.src="",n(Ln())};const h=()=>{(0,i.t)("esri-image-decode")||(e.removeEventListener("error",a),e.removeEventListener("load",l)),a=null,l=null,e=null,b(s)&&s.removeEventListener("abort",c),c=null,r&&URL.revokeObjectURL(t)};b(s)&&s.addEventListener("abort",c),(0,i.t)("esri-image-decode")?e.decode().then(l,a):(e.addEventListener("error",a),e.addEventListener("load",l))}))}function Ln(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}async function En(e,t){const s=cr(e),o=lr(e);o||s||(e=sr(e));const n={url:e,requestOptions:{...t}};let a=function(e){const t=t=>null==t||t instanceof RegExp&&t.test(e)||"string"==typeof t&&e.startsWith(t),r=Nt.interceptors;if(r)for(const e of r)if(Array.isArray(e.urls)){if(e.urls.some(t))return e}else if(t(e.urls))return e;return null}(e);if(a){const e=await async function(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let r,i;try{i=await e.before(t)}catch(e){r=qn("request:interceptor",e,t)}if((i instanceof Error||i instanceof At)&&(r=qn("request:interceptor",i,t)),r)throw e.error&&e.error(r),r;return i}}(a,n);if(null!=e)return{data:e,getHeader:Gn,requestOptions:n.requestOptions,url:n.url};a.after||a.error||(a=null)}if(e=n.url,"image"===(t=n.requestOptions).responseType){if((0,i.t)("host-webworker")||(0,i.t)("host-node"))throw qn("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n)}else if(s)throw qn("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+t.responseType),n);if("head"===t.method){if(t.body)throw qn("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(s||o)throw qn("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await async function(){(0,i.t)("host-webworker")?Rn||(Rn=await r.e(81242).then(r.bind(r,81242))):En._abortableFetch||(En._abortableFetch=i.e.fetch.bind(i.e))}(),Rn)return Rn.execute(e,t);const l=Qs();to(t,(()=>l.abort()));const c={controller:l,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:a,params:n,redoRequest:!1,useIdentity:jn.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=await async function(e){let t,r;await async function(e){const t=e.params.url,r=e.params.requestOptions,s=e.controller.signal,o=r.body;let n=null,a=null,l=null;if(Fn&&"HTMLFormElement"in i.e&&(o instanceof FormData?n=o:o instanceof HTMLFormElement&&(a=o,n=new FormData(a))),"string"==typeof o&&(l=o),e.fetchOptions={cache:r.cacheBust&&!En._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},method:"head"===r.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:s},(n||l)&&(e.fetchOptions.body=n||l),"anonymous"===r.authMode&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||r.query&&r.query.token||n&&n.get&&n.get("token")||a&&a.elements.token),!e.hasToken&&_.apiKey&&function(e){const t=nr(e,!0);return t&&t.endsWith(".arcgis.com")&&!Mn.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}(t)&&(r.query||(r.query={}),r.query.token=_.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!Hn(t)&&!Ks(s)){let i;"immediate"===r.authMode?(await Vn(),i=await Tn.getCredential(t,{signal:s}),e.credential=i):"no-prompt"===r.authMode?(await Vn(),i=await Tn.getCredential(t,{prompt:!1,signal:s}).catch((()=>{})),e.credential=i):Tn&&(i=Tn.findCredential(t)),i&&(e.credentialToken=i.token,e.useSSL=!!i.ssl)}}(e);try{do{[t,r]=await $n(e)}while(!await Jn(e,t,r))}catch(r){const i=qn("request:server",r,e.params,t);throw i.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(i),i}const s=e.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(s)&&!e.hasToken&&!e.credentialToken&&r&&r.user&&r.user.username&&!er(s)){const e=nr(s,!0);e&&jn.trustedServers.push(e)}const o=e.credential;if(o&&Tn){const e=Tn.findServerInfo(o.server);let t=e&&e.owningSystemUrl;if(t){t=t.replace(/\/?$/,"/sharing");const e=Tn.findCredential(t,o.userId);e&&-1===Tn._getIdenticalSvcIdx(t,e)&&e.resources.unshift(t)}}return{data:r,getHeader:t?e=>t.headers.get(e):Gn,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}(c);return a&&a.after&&a.after(h),h}let Rn;const jn=_.request,Fn="FormData"in i.e,Bn=[499,498,403,401],zn=["COM_0056","COM_0057","SB_0008"],Un=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Gn=()=>null;function qn(e,t,r,i){let s="Error";const o={url:r.url,requestOptions:r.requestOptions,getHeader:Gn,ssl:!1};if(t instanceof At)return t.details?(t.details=d(t.details),t.details.url=r.url,t.details.requestOptions=r.requestOptions):t.details=o,t;if(t){const e=i&&(e=>i.headers.get(e)),r=i&&i.status,n=t.message;n&&(s=n),e&&(o.getHeader=e),o.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||r||0,o.subCode=t.subcode,o.messageCode=t.messageCode,"string"==typeof t.details?o.messages=[t.details]:o.messages=t.details}return so(t)?Js():new At(e,s,o)}async function Vn(){Tn||await Promise.resolve().then((function(){return Vx}))}function Hn(e){return Un.some((t=>t.test(e)))}async function $n(e){let t=e.params.url;const r=e.params.requestOptions,s=e.fetchOptions,o=lr(t)||cr(t),n=r.responseType||"json",a=o?0:null!=r.timeout?r.timeout:jn.timeout;let l=!1;if(!o){e.useSSL&&(t=mr(t)),r.cacheBust&&"default"===s.cache&&(t=Ir(t,"request.preventCache",Date.now()));let o={...r.query};e.credentialToken&&(o.token=e.credentialToken);let n=Ht(o);(0,i.t)("esri-url-encodes-apostrophe")&&(n=n.replace(/'/g,"%27"));const a=t.length+1+n.length;let c;l="delete"===r.method||"post"===r.method||"put"===r.method||!!r.body||a>jn.maxUrlLength;const h=r.useProxy||!!Zt(t);if(h){const e=function(e=!1){let t,r=Nt.proxyUrl;if("string"==typeof e){t=function(e){return Mt.test(e)||"https"===Bt.scheme&&fr(e)}(e);const i=Zt(e);i&&(r=i.proxyUrl)}else t=!!e;if(!r)throw kt.warn(Ot),new At("urlutils:proxy-not-set",Ot);return t&&gr()&&(r=mr(r)),Gt(r)}(t);c=e.path,!l&&c.length+1+a>jn.maxUrlLength&&(l=!0),e.query&&(o={...e.query,...o})}if("HEAD"===s.method&&(l||h)){if(l){if(a>jn.maxUrlLength)throw qn("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw qn("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(h)throw qn("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(l?(s.method="delete"===r.method?"DELETE":"put"===r.method?"PUT":"POST",r.body?t=Ar(t,o):(s.body=Ht(o),s.headers["Content-Type"]="application/x-www-form-urlencoded")):t=Ar(t,o),h&&(e.useProxy=!0,t=`${c}?${t}`),o.token&&Fn&&s.body instanceof FormData){const e=s.body;e.set?e.set("token",o.token):e.append("token",o.token)}if(r.hasOwnProperty("withCredentials"))e.withCredentials=r.withCredentials;else if(!Xt(t,Bt))if(er(t))e.withCredentials=!0;else if(Tn){const r=Tn.findServerInfo(t);r&&r.webTierAuth&&(e.withCredentials=!0)}e.withCredentials&&(s.credentials="include")}let c,h,u=0,d=!1;a>0&&(u=setTimeout((()=>{d=!0,e.controller.abort()}),a));try{if("image"!==r.responseType||"default"!==s.cache||"GET"!==s.method||l||function(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0;return!1}(r.headers)||!o&&!e.useProxy&&jn.proxyUrl&&!function(e){const t=nr(e);return!t||t.endsWith(".arcgis.com")||-1!==En._corsServers.indexOf(t)||er(t)}(t)){if(c=await En._abortableFetch(t,s),e.useProxy||function(e){if(lr(e)||cr(e))return;const t=nr(e);t&&-1===En._corsServers.indexOf(t)&&En._corsServers.push(t)}(t),c.ok&&"HEAD"!==s.method){switch(n){case"array-buffer":h=await c.arrayBuffer();break;case"blob":case"image":h=await c.blob();break;default:h=await c.text()}if(u&&(clearTimeout(u),u=0),"json"===n||"xml"===n||"document"===n)if(h)switch(n){case"json":h=JSON.parse(h);break;case"xml":h=Wn(h,"application/xml");break;case"document":h=Wn(h,"text/html")}else h=null;if(h){if("array-buffer"===n||"blob"===n){const e=c.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(e)&&h["blob"===n?"size":"byteLength"]<=750)try{const e=await new Response(h).json();e.error&&(h=e)}catch{}}"image"===n&&h instanceof Blob&&(h=await Qn(URL.createObjectURL(h),e,!0))}}}else h=await Qn(t,e)}catch(i){if("AbortError"===i.name){if(d)throw new Error("Timeout exceeded");throw Js("Request canceled")}if(!(!c&&i instanceof TypeError&&jn.proxyUrl)||r.body||"delete"===r.method||"head"===r.method||"post"===r.method||"put"===r.method||e.useProxy)throw i;e.redoRequest=!0,function(e){const t={proxyUrl:e.proxyUrl,urlPrefix:Qt(e.urlPrefix)},r=Nt.proxyRules,i=t.urlPrefix;let s=r.length;for(let e=0;e<r.length;e++){const t=r[e].urlPrefix;if(0===i.indexOf(t)){if(i.length===t.length)return-1;s=e;break}0===t.indexOf(i)&&(s=e+1)}r.splice(s,0,t)}({proxyUrl:jn.proxyUrl,urlPrefix:_r(Gt(t).path)})}finally{u&&clearTimeout(u)}return[c,h]}function Wn(e,t){let r;try{r=(new DOMParser).parseFromString(e,t)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}async function Jn(e,t,r){if(e.redoRequest)return e.redoRequest=!1,!1;if(!t)return!0;if(!t.ok)throw new Error(`Unable to load ${t.url} status: ${t.status}`);let i,s,o,n;r&&r.error&&(i=Object.assign(new Error,r.error)),i&&(s=Number(i.code),o=i.hasOwnProperty("subcode")?Number(i.subcode):null,n=i.messageCode,n=n&&n.toUpperCase());const a=e.params.requestOptions.authMode;if(403===s&&(4===o||i.message&&i.message.toLowerCase().indexOf("ssl")>-1&&-1===i.message.toLowerCase().indexOf("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&("no-prompt"!==a||498===s)&&-1!==Bn.indexOf(s)&&!Hn(e.params.url)&&(403!==s||-1===zn.indexOf(n)&&(null==o||2===o&&e.credentialToken))){await Vn();try{const t=await Tn.getCredential(e.params.url,{error:qn("request:server",i,e.params),prompt:"no-prompt"!==a,signal:e.controller.signal,token:e.credentialToken});return e.credential=t,e.credentialToken=t.token,e.useSSL=e.useSSL||t.ssl,!1}catch(t){if("no-prompt"===a)return e.credential=null,e.credentialToken=null,!1;i=t}}if(i)throw i;return!0}function Qn(e,t,r=!1){const i=t.controller.signal,s=new Image;return t.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.src=e,Dn(s,e,r,i)}En._abortableFetch=null,En._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const Zn=Object.freeze({__proto__:null,default:En}),Yn={80:"443",8080:"8443"};function Kn(e,t,r,i){const s=fi(t,!0),o=function(e){if(!e)return["below"];const t=[];return e.forEach((e=>{let r=Yr();switch(e){case"before-alt":r=!r;case"after-alt":return t.push(r?{aroundCorner:"BR",corner:"BL"}:{aroundCorner:"BL",corner:"BR"}),void t.push(r?{aroundCorner:"TR",corner:"TL"}:{aroundCorner:"TL",corner:"TR"})}t.push(e)})),t}(r);if(/^(above|below)/.test(o[0]+"")){const r=vi(t),i=t.firstChild?vi(t.firstChild):{t:0,l:0,b:0,r:0},o=vi(e),n=e.firstChild?vi(e.firstChild):{t:0,l:0,b:0,r:0};s.y+=Math.min(r.t+i.t,o.t+n.t),s.h-=Math.min(r.t+i.t,o.t+n.t)+Math.min(r.b+i.b,o.b+n.b)}if(t.parentNode){let e="absolute"===di(t).position,r=t.parentNode;for(;r&&1===r.nodeType&&"BODY"!==r.nodeName;){const t=fi(r),i=di(r);if(/relative|absolute/.test(i.position)&&(e=!1),!e&&/hidden|auto|scroll/.test(i.overflow)){const e=Math.min(s.y+s.h,t.y+t.h),r=Math.min(s.x+s.w,t.x+t.w);s.x=Math.max(s.x,t.x),s.y=Math.max(s.y,t.y),s.h=e-s.y,s.w=r-s.x}"absolute"===i.position&&(e=!0),r=r.parentNode}}const n=s.x,a=s.y,l=s.w,c=s.h,h=[];function u(e,t){h.push({aroundCorner:e,corner:t,pos:{x:{L:n,R:n+l,M:n+(l>>1)}[e.charAt(1)],y:{T:a,B:a+c,M:a+(c>>1)}[e.charAt(0)]}})}o.forEach((e=>{let t=Yr();switch(e){case"above-centered":u("TM","BM");break;case"below-centered":u("BM","TM");break;case"after-centered":t=!t;case"before-centered":u(t?"ML":"MR",t?"MR":"ML");break;case"after":t=!t;case"before":u(t?"TL":"TR",t?"TR":"TL"),u(t?"BL":"BR",t?"BR":"BL");break;case"below-alt":t=!t;case"below":u(t?"BL":"BR",t?"TL":"TR"),u(t?"BR":"BL",t?"TR":"TL");break;case"above-alt":t=!t;case"above":u(t?"TL":"TR",t?"BL":"BR"),u(t?"TR":"TL",t?"BR":"BL");break;default:"object"==typeof e&&u(e.aroundCorner,e.corner)}}));const d=function(e,t,r,i){const s={l:0,t:0,w:document.body.clientWidth,h:document.body.clientHeight};e.parentNode&&"body"===String(e.parentNode.nodeName).toLowerCase()||document.body.appendChild(e);let o=null;t.some((t=>{const n=t.corner,a=t.pos;let l=0;const c={w:{L:s.l+s.w-a.x,R:a.x-s.l,M:s.w}[n.charAt(1)],h:{T:s.t+s.h-a.y,B:a.y-s.t,M:s.h}[n.charAt(0)]},h=e.style;if(h.left=h.right="auto",r){const s=r(e,t.aroundCorner,n,c,i);l=void 0===s?0:s}const u=e.style,d=u.display,p=u.visibility;"none"===u.display&&(u.visibility="hidden",u.display="");const f=fi(e);u.display=d,u.visibility=p;const y={L:a.x,R:a.x-f.w,M:Math.max(s.l,Math.min(s.l+s.w,a.x+(f.w>>1))-f.w)}[n.charAt(1)],m={T:a.y,B:a.y-f.h,M:Math.max(s.t,Math.min(s.t+s.h,a.y+(f.h>>1))-f.h)}[n.charAt(0)],g=Math.max(s.l,y),v=Math.max(s.t,m),_=Math.min(s.l+s.w,y+f.w)-g,b=Math.min(s.t+s.h,m+f.h)-v;return l+=f.w-_+(f.h-b),(null==o||l<o.overflow)&&(o={corner:n,aroundCorner:t.aroundCorner,x:g,y:v,w:_,h:b,overflow:l,spaceAvailable:c}),!l})),o.overflow&&r&&r(e,o.aroundCorner,o.corner,o.spaceAvailable,i);const n=o.y-+hi(document.body,"marginTop"),a=o.x-+hi(document.body,"marginLeft");return e.style.top=n+"px",e.style.left=a+"px",e.style.right="auto",o}(e,h,i,{w:l,h:c});return d.aroundNodePos=s,d}const Xn=e=>e*e,ea=e=>1-Xn(1-e),ta=e=>e*e*e,ra=e=>1-ta(1-e),ia=e=>e*e*e*e,sa=e=>1-ia(1-e),oa=e=>e*e*e*e*e,na=e=>1-oa(1-e),aa=e=>1-Math.cos(e*Math.PI/2),la=e=>1-aa(1-e),ca=e=>2**(10*(e-1)),ha=e=>1-ca(1-e),ua=e=>-(Math.sqrt(1-e*e)-1),da=e=>1-ua(1-e);function pa(e){const t=2*(e-Math.sqrt((e-1)*e)),r=t/2/e;return i=>i<r?e*i*i:t*i-t+1}function fa(e,t){return r=>r<t?t*e(r/t):1-e((1-r)/(1-t))*(1-t)}const ya=fa(pa(1),1),ma=fa(pa(1),0),ga=fa(pa(1),.5),va=fa(pa(2),1),_a=fa(pa(2),0),ba=fa(pa(2),.5),wa=fa(pa(3),1),xa=fa(pa(3),0),Sa=fa(pa(3),.5),Ca=fa(pa(4),1),Ia=fa(pa(4),0),Aa=fa(pa(4),.5),ka={linear:function(e){return e},"in-quad":Xn,"out-quad":ea,"in-out-quad":e=>e<.5?Xn(2*e)/2:(ea(2*(e-.5))+1)/2,"in-coast-quad":ya,"out-coast-quad":ma,"in-out-coast-quad":ga,"in-cubic":ta,"out-cubic":ra,"in-out-cubic":e=>e<.5?ta(2*e)/2:(ra(2*(e-.5))+1)/2,"in-coast-cubic":va,"out-coast-cubic":_a,"in-out-coast-cubic":ba,"in-quart":ia,"out-quart":sa,"in-out-quart":e=>e<.5?ia(2*e)/2:(sa(2*(e-.5))+1)/2,"in-coast-quart":wa,"out-coast-quart":xa,"in-out-coast-quart":Sa,"in-quint":oa,"out-quint":na,"in-out-quint":e=>e<.5?oa(2*e)/2:(na(2*(e-.5))+1)/2,"in-coast-quint":Ca,"out-coast-quint":Ia,"in-out-coast-quint":Aa,"in-sine":aa,"out-sine":la,"in-out-sine":e=>e<.5?aa(2*e)/2:(la(2*(e-.5))+1)/2,"in-expo":ca,"out-expo":ha,"in-out-expo":e=>e<.5?ca(2*e)/2:(ha(2*(e-.5))+1)/2,"in-circ":ua,"out-circ":da,"in-out-circ":e=>e<.5?ua(2*e)/2:(da(2*(e-.5))+1)/2};function Na(e){e.progress<1?requestAnimationFrame((()=>{if(e._stopMethod)return;const t=(new Date).getTime();e.progress=1-(e.endTime-t)/e.duration,e.progress=Math.min(1,e.progress),Oa(e),Na(e)})):e._onEnd()}function Oa(e){for(const t in e.properties){const r=e.properties[t],i=r.easing?"function"==typeof r.easing?r.easing:ka[r.easing]:null,s=i?i(e.progress):e.progress,o=r.start+s*(r.end-r.start);e.obj[t]=r.units?o+r.units:o,e._onProgress(t,o,s)}}function Ta({obj:e,node:t,duration:r=1e3,properties:s,onProgress:o,onEnd:n,onStop:a,onCancel:l}){const c=(0,i.c)(),h=Date.now(),u=new mn,d={properties:s,obj:e||t||{},progress:0,promise:c.promise,duration:r,startTime:h,endTime:h+r,stop:e=>{if(d._stopMethod=e?"stopEnd":"stop","stop"!==d._stopMethod)return"stopEnd"===d._stopMethod?(d.progress=1,Oa(d),void d._onEnd()):void 0;d._onEnd()},cancel:()=>{d._stopMethod="cancel",d._onCancel()},then:(e,t)=>c.promise.then(e,t),events:u,_stopMethod:null,_onProgress:(e,t,r)=>{o&&o(e,t,r)},_onEnd:()=>{a&&a(),n&&n(),c.resolve(),u.emit("onEnd")},_onCancel:()=>{l&&l()}};return Oa(d),Na(d),d}const Pa={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,5,10]};function Ma(e,t,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?e+(t-e)*i:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}const Da=new Float32Array(1);function La(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function Ea(e,t,r){return e<t?t:e>r?r:e}function Ra(e,t,r){return Math.min(Math.max(e,t),r)}function ja(e){return 0==(e&e-1)}const Fa=Math.log2||function(e){return Math.log(e)/Math.LN2};function Ba(e,t,r){return e+(t-e)*r}function za(e){return e*Math.PI/180}function Ua(e){return 180*e/Math.PI}function Ga(e){return Math.acos(Ea(e,-1,1))}function qa(e){return Math.asin(Ea(e,-1,1))}function Va(e){return Ea(J(e),0,255)}function Ha(e,t,r){return e=Number(e),isNaN(e)?r:e<t?t:e>r?r:e}Da[0]=34028234663852886e22,Da[0];class $a{constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}static blendColors(e,t,r,i=new $a){return i.r=Math.round(e.r+(t.r-e.r)*r),i.g=Math.round(e.g+(t.g-e.g)*r),i.b=Math.round(e.b+(t.b-e.b)*r),i.a=e.a+(t.a-e.a)*r,i._sanitize()}static fromRgb(e,t){const r=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){const e=r[2].split(/\s*,\s*/),i=r[1];if("rgb"===i&&3===e.length||"rgba"===i&&4===e.length){const r=e[0];if("%"===r.charAt(r.length-1)){const r=e.map((e=>2.56*parseFloat(e)));return 4===e.length&&(r[3]=parseFloat(e[3])),$a.fromArray(r,t)}return $a.fromArray(e.map((e=>parseFloat(e))),t)}if("hsl"===i&&3===e.length||"hsla"===i&&4===e.length)return $a.fromArray(function(e,t,r,i=1){const s=(e%360+360)%360/360,o=r<=.5?r*(t+1):r+t-r*t,n=2*r-o;return[Math.round(256*Ma(n,o,s+1/3)),Math.round(256*Ma(n,o,s)),Math.round(256*Ma(n,o,s-1/3)),i]}(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100,parseFloat(e[3])),t)}return null}static fromHex(e,t=new $a){if(4!==e.length&&7!==e.length||"#"!==e[0])return null;const r=4===e.length?4:8,i=(1<<r)-1;let s=Number("0x"+e.substr(1));return isNaN(s)?null:(["b","g","r"].forEach((e=>{const o=s&i;s>>=r,t[e]=4===r?17*o:o})),t.a=1,t)}static fromArray(e,t=new $a){return t._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(t.a)&&(t.a=1),t._sanitize()}static fromString(e,t){const r=function(e){var t;return null!=(t=Pa[e.toLowerCase()])?t:null}(e);return r&&$a.fromArray(r,t)||$a.fromRgb(e,t)||$a.fromHex(e,t)}static fromJSON(e){return e&&new $a([e[0],e[1],e[2],e[3]/255])}static toUnitRGB(e){return b(e)?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return b(e)?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(e){if("string"==typeof e)$a.fromString(e,this);else if(Array.isArray(e))$a.fromArray(e,this);else{var t,r,i,s;this._set(null!=(t=e.r)?t:0,null!=(r=e.g)?r:0,null!=(i=e.b)?i:0,null!=(s=e.a)?s:1),e instanceof $a||this._sanitize()}return this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return`#${e.length<2?"0"+e:e}${t.length<2?"0"+t:t}${r.length<2?"0"+r:r}`}toCss(e=!1){const t=this.r+", "+this.g+", "+this.b;return e?`rgba(${t}, ${this.a})`:`rgb(${t})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const t=Va(this.r),r=Va(this.g),i=Va(this.b);return 0===e||1!==this.a?[t,r,i,Va(255*this.a)]:[t,r,i]}clone(){return new $a(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}_sanitize(){return this.r=Math.round(Ha(this.r,0,255)),this.g=Math.round(Ha(this.g,0,255)),this.b=Math.round(Ha(this.b,0,255)),this.a=Ha(this.a,0,1),this}_set(e,t,r,i){this.r=e,this.g=t,this.b=r,this.a=i}}function Wa(e,t=!1,r){return"string"!=typeof e||/^0x/i.test(e)||(e=$a.fromString(e)),Array.isArray(e)&&(e=$a.fromArray(e)),(i=e)&&"function"==typeof i.toHex?t||1===e.a?e.toHex():e.toCss(!0):null==e||isNaN(e)?r?Wa(r,t):"#000000":"#"+(e="00000"+Number(e).toString(16)).substr(e.length-6);var i}function Ja(e,t){return"object"==typeof e?new $a(e):$a.fromString(Wa(e,!1,t))}function Qa(e){return e*Math.PI/180}function Za(e){return 180*e/Math.PI}$a.prototype.declaredClass="esri.Color";class Ya{constructor(e){this.dx=0,this.dy=0,this.xx=1,this.xy=0,this.yx=0,this.yy=1,Sn(this,e)}}const Ka=new class{create(e){return new Ya(e)}normalize(e){return e}isIdentity(e){return 1===e.xx&&0===e.xy&&0===e.yx&&1===e.yy&&0===e.dx&&0===e.dy}translate(e,t){return new Ya({dx:e,dy:t})}scale(e,t){return new Ya({xx:e,yy:t})}rotate(e){const t=Math.cos(e),r=Math.sin(e);return new Ya({xx:t,xy:-r,yx:r,yy:t})}rotateg(e){return this.rotate(Qa(e))}rotategAt(e,t,r){return this._sandwich(this.rotateg(e),t,r)}multiply(e){e=e.filter((e=>!!e));let t=e[0];for(let r=1;r<e.length;++r){const i=t,s=e[r];t=new Ya,t.xx=i.xx*s.xx+i.xy*s.yx,t.xy=i.xx*s.xy+i.xy*s.yy,t.yx=i.yx*s.xx+i.yy*s.yx,t.yy=i.yx*s.xy+i.yy*s.yy,t.dx=i.xx*s.dx+i.xy*s.dy+i.dx,t.dy=i.yx*s.dx+i.yy*s.dy+i.dy}return Sn(this,t),t}multiplyRectangle(e,t){const r=Ka.normalize(e);if(this.isIdentity(r))return{x:t.x,y:t.y,w:t.w,h:t.h};const i=this.multiplyPoint(r,t.x,t.y),s=this.multiplyPoint(r,t.x,t.y+t.h),o=this.multiplyPoint(r,t.x+t.w,t.y),n=this.multiplyPoint(r,t.x+t.w,t.y+t.h),a=Math.min(i.x,s.x,o.x,n.x),l=Math.min(i.y,s.y,o.y,n.y);return{x:a,y:l,w:Math.max(i.x,s.x,o.x,n.x)-a,h:Math.max(i.y,s.y,o.y,n.y)-l}}multiplyPoint(e,t,r){const i=this.normalize(e);return this._multiplyPoint(i,t,r)}_multiplyPoint(e,t,r){return{x:e.xx*t+e.xy*r+e.dx,y:e.yx*t+e.yy*r+e.dy}}_sandwich(e,t,r){return this.multiply([this.translate(t,r),e,this.translate(-t,-r)])}};function Xa(e){return Number("string"==typeof e?e.replace("px",""):e)||0}const el={shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},tl={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},rl=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let il=0;const sl={defaultStroke:{type:"stroke",color:"black",style:"solid",width:0,cap:"butt",join:4},defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultPolygon:{type:"polygon",points:[]},defaultRect:{type:"rect",x:0,y:0,w:100,h:100,r:0},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultImage:{type:"image",x:0,y:0,w:0,h:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0}};function ol(e){return"w"===e?"width":"h"===e?"height":e}function nl(e,t=!1){const r=e;r._rawNode=null,r.getAttribute=e=>r._rawNode.attrs[e],r.setAttribute=(e,t)=>{r._rawNode.attrs[e]=t,r.rawNode&&r.rawNode.setAttribute(e,t)},r._setAttributeNS=(e,t,i)=>{r._rawNode.attrs[t]=i,r.rawNode&&r.rawNode.setAttributeNS(e,t,i)},r.removeAttribute=e=>{delete r._rawNode.attrs[e],r.rawNode&&r.rawNode.removeAttribute(e)},r.getStyle=()=>r._rawNode.style,r.setStyle=e=>{if(r._rawNode.style?r._rawNode.style=Sn(r._rawNode.style,e):r._rawNode.style=e,r.rawNode)for(const t in e){const i=e[t];r.rawNode.style[t]=null==i?"":i}},r._setRawNode=(e,i,s)=>{r._rawNode={name:i,attrs:{}},s&&r._assignRawNode(document.createElementNS(e,i)),!t&&r.shape&&("image"!==r.shape.type&&r.setAttribute("fill","none"),r.setAttribute("fill-opacity","0"),r.setAttribute("stroke","none"),r.setAttribute("stroke-opacity","0"),r.setAttribute("stroke-width","1"),r.setAttribute("stroke-linecap","butt"),r.setAttribute("stroke-linejoin","miter"),r.setAttribute("stroke-miterlimit","4"))},r._assignRawNode=e=>{e||console.error("Empty rawNode assignment. This might be a mistake."),r.rawNode=e,r._rawNode.pendingEvents&&(r._rawNode.pendingEvents.forEach((e=>{e.handle=Ei(r.rawNode,e.type,e.callback)})),r._rawNode.pendingEvents=null)},r._setText=e=>{if(r._rawNode.text=e,r.rawNode){const t=r.rawNode;t.firstChild?t.firstChild.nodeValue=e:t.appendChild(document.createTextNode(e))}},r._appendRawNodeChild=(e,t)=>{r._rawNode.children=r._rawNode.children||[],r._rawNode.children.push(e._rawNode),!t&&r.rawNode&&r.rawNode.appendChild(e.rawNode)},r._removeRawNodeChild=e=>{const t=r._rawNode.children.indexOf(e._rawNode);-1!==t&&r._rawNode.children.splice(t,1),r.rawNode&&e.rawNode&&r.rawNode===e.rawNode.parentNode&&r.rawNode.removeChild(e.rawNode)},r._emptryRawNode=()=>{r._rawNode.children=null;const e=r.rawNode;for(;e&&e.lastChild;)e.removeChild(e.lastChild)},r._createDefsNode=()=>{r._rawNode.children=r._rawNode.children||[],r._rawNode.children.push({name:"defs"}),r.rawNode&&r.rawNode.appendChild(document.createElementNS(tl.svg,"defs"))},r._getHTMLString=e=>function t(r){if(e&&e.removeHidden&&r.style&&"none"===r.style.display)return"";let i="<"+r.name;"svg"===r.name&&(i+=' xmlns="'+tl.svg+'"',i+=' xmlns:xlink="'+tl.xlink+'"');for(const e in r.attrs)i+=" "+e+'="'+r.attrs[e]+'"';if(!e||!e.noStyle){let e;for(const t in r.style)e=e||"",null!=r.style[t]&&(e+=t+":"+r.style[t]+";");e&&(i+=' style="'+e+'"')}let s=r.text?function(e,t,r){return null==e?"":(""+e).replace(t,(e=>r[e]||""))}(r.text,In,An):"";return!s&&r.children&&r.children.forEach((e=>{s+=t(e)})),i+=">"+s+"</"+r.name+">",i}(r._rawNode),r.on=(e,t)=>{if(r.rawNode)return Ei(r.rawNode,e,t);r._rawNode.pendingEvents=r._rawNode.pendingEvents||[];const i={type:e,callback:t,handle:null};return r._rawNode.pendingEvents.push(i),{remove:()=>{if(i.handle)i.handle.remove();else if(r._rawNode.pendingEvents){const e=r._rawNode.pendingEvents.indexOf(i);-1!==e&&r._rawNode.pendingEvents.splice(e,1)}}}},r._destroyRawNode=()=>{r._rawNode=null,r.rawNode=null}}function al(e,t=!1){const r=e||{};return nl(r,t),r.getFill=()=>r.fillStyle,r.setFill=e=>{if(e){const t=Ja(e);r.setAttribute("fill",t.toCss()),r.setAttribute("fill-opacity",t.a+""),r.setAttribute("fill-rule","evenodd"),r.fillStyle=t}else r.setAttribute("fill","none"),r.setAttribute("fill-opacity","0"),r.fillStyle=null;return r},r.getStroke=()=>r.strokeStyle,r.setStroke=e=>{if(r.strokeStyle=e,!e)return r.strokeStyle=null,r.setAttribute("stroke","none"),r.setAttribute("stroke-opacity","0"),r;const t=r.strokeStyle=Sn({},sl.defaultStroke,e),i=t.color=Ja(t.color);if(t){const e=t.width<0?0:t.width;r.setAttribute("stroke",i.toCss()),r.setAttribute("stroke-opacity",i.a+""),r.setAttribute("stroke-width",(e||0)+""),r.setAttribute("stroke-linecap",t.cap),"number"==typeof t.join?(r.setAttribute("stroke-linejoin","miter"),r.setAttribute("stroke-miterlimit",t.join+"")):r.setAttribute("stroke-linejoin",t.join);const s=t.style.toLowerCase();if("solid"!==s)if(s in el){const i=el[s].slice();let o;for(o=0;o<i.length;++o)i[o]*=e;if("butt"!==t.cap){for(o=0;o<i.length;o+=2)i[o]-=e,i[o]<1&&(i[o]=1);for(o=1;o<i.length;o+=2)i[o]+=e}r.setAttribute("stroke-dasharray",i.join(","))}else r.setAttribute("stroke-dasharray",s)}return r},r.applyTransform=e=>(r.setTransform(Ka.multiply([r.matrix,e])),r),r.setTransform=e=>(r.matrix=Array.isArray(e)?Ka.multiply(e):new Ya(e),function(){if(r.matrix){const e=r.matrix;r.setAttribute("transform","matrix("+e.xx.toFixed(8)+","+e.yx.toFixed(8)+","+e.xy.toFixed(8)+","+e.yy.toFixed(8)+","+e.dx.toFixed(8)+","+e.dy.toFixed(8)+")")}else r.removeAttribute("transform");return r}()),r._setShape=e=>{r.shape=Sn({},r.shape,e);for(const e in r.shape)if("type"!==e&&"path"!==e){let t=r.shape[e];"w"===e||"h"===e?t=t<0?0:t:null!=t||"x"!==e&&"y"!==e||(t=0),r.setAttribute(ol(e),t)}return r},r.setClip=e=>{let t;r.clip=e;let i=r.getAttribute("clip-path");if(i&&(i=i.substr(5).replace(")",""),r.parent._rawNode.children&&r.parent._rawNode.children.some((e=>"clipPath"===e.name&&e.attrs.id===i&&(t=e,!0))),t)){const e=r.parent._rawNode.children.indexOf(t);if(-1!==e&&r.parent._rawNode.children.splice(e,1),r.rawNode&&t)for(let e=0,t=r.rawNode.parentNode.children.length;e<t;e++){const t=r.rawNode.parentNode.children[e];if(t.getAttribute("id")===i){r.rawNode.parentNode.removeChild(t);break}}}if(e){const i="w"in e?"rect":"ellipse",s="gfx_clip"+ ++il;r.setAttribute("clip-path","url(#"+s+")");const o={name:i,attrs:{}};for(const t in e)o.attrs[ol(t)]=e[t];if(t={name:"clipPath",attrs:{id:s},children:[o]},r.parent._rawNode.children.splice(r.parent._rawNode.children.indexOf(r._rawNode),0,t),r.rawNode){const t=document.createElementNS(tl.svg,"clipPath");t.setAttribute("id",s);const o=document.createElementNS(tl.svg,i);for(const t in e)o.setAttribute(ol(t),e[t]);t.appendChild(o),r.rawNode.parentNode.insertBefore(t,r.rawNode)}}else r.removeAttribute("clip-path");return r},r._destroy=()=>{r._destroyRawNode()},r}function ll(e){const t={};return al(t),t.shape=Sn({},e?sl.defaultPolyline:sl.defaultPolygon),t._setShape=e=>{t.shape=Sn({},t.shape,e);const r=[];return t.shape.points.forEach((e=>{r.push(e.x.toFixed(8),e.y.toFixed(8))})),t.setAttribute("points",r.join(" ")),t},t.getBoundingBox=()=>{if(!t.shape.points.length)return null;const e=t.shape.points,r=e.length;let i=e[0];const s={l:i.x,t:i.y,r:i.x,b:i.y};for(let t=1;t<r;++t)i=e[t],s.l>i.x&&(s.l=i.x),s.r<i.x&&(s.r=i.x),s.t>i.y&&(s.t=i.y),s.b<i.y&&(s.b=i.y);return{x:s.l,y:s.t,w:s.r-s.l,h:s.b-s.t}},t}const cl={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0};function hl(){const e={};al(e),e.shape=Sn({},sl.defaultPath),e.segments=[],e.segmented=!1,e.absolute=!0;const t=e._setShape;let r,i;function s(){if(!e.segmented){const t=e.shape.path;r=[],function(t){const r=t.match(rl);if(e.segments=[],e.absolute=!0,!r)return;let i,s=[];const n=r.length;for(let e=0;e<n;e++){let t=r[e];const n=parseFloat(t);0===n&&"00"===t&&(t="0",r[e]="0",e--),isNaN(n)?(i&&o(i,s),s=[],i=t):s.push(n)}o(i,s)}(t),e.shape.path=r.join(""),r=null,e.segmented=!0}}function o(t,r){const i=cl[t.toLowerCase()];let s;"number"==typeof i&&(i?r.length>=i&&(s={action:t,args:r.slice(0,r.length-r.length%i)},e.segments.push(s),n(s)):(s={action:t,args:[]},e.segments.push(s),n(s)))}function n(t){switch(t.action){case"M":case"L":case"H":case"V":case"C":case"S":case"Q":case"T":case"A":e.absolute=!0;break;case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":e.absolute=!1}const s=t.args,o=s.length;let n;if(i&&i.updateBBox(t),r)for(r.push(t.action),n=0;n<o;++n)r.push(a(s[n],!0));else{for(e.shape.path+=t.action,n=0;n<o;++n)e.shape.path+=a(s[n],!0);e.setAttribute("d",e.shape.path)}}function a(e,t){return e>=0&&t?" "+e:e+""}return e._setShape=r=>(t(r),e.segmented=!1,e.segments=[],s(),e.shape.path?e.setAttribute("d",e.shape.path):e.removeAttribute("d"),e),e.moveTo=(t,r)=>(s(),o(e.absolute?"M":"m",[t,r]),e),e.lineTo=(t,r)=>(s(),o(e.absolute?"L":"l",[t,r]),e),e.hLineTo=t=>(s(),o(e.absolute?"H":"h",[t]),e),e.vLineTo=t=>(s(),o(e.absolute?"V":"v",[t]),e),e.arcTo=(t,r,i,n,a,l,c)=>(s(),o(e.absolute?"A":"a",[t,r,i,n?1:0,a?1:0,l,c]),e),e.curveTo=(t,r,i,n,a,l)=>(s(),o(e.absolute?"C":"c",[t,r,i,n,a,l]),e),e.smoothCurveTo=(t,r,i,n)=>(s(),o(e.absolute?"S":"s",[t,r,i,n]),e),e.qCurveTo=(t,r,i,n)=>(s(),o(e.absolute?"Q":"q",[t,r,i,n]),e),e.qSmoothCurveTo=(t,r)=>(s(),o(e.absolute?"T":"t",[t,r]),e),e.closePath=()=>(s(),o("Z",[]),e),e.getBoundingBox=()=>{i=function(){let e;const t={},r={updateBBox:r=>{const i=r.action,s=r.args,o=s.length;let n;switch(i){case"M":case"L":for(n=0;n<o;n+=2)h(s[n],s[n+1]);t.x=s[o-2],t.y=s[o-1],"M"===i&&(t.xm=t.x,t.ym=t.y);break;case"H":for(n=0;n<o;++n)h(s[n],t.y);t.x=s[o-1];break;case"V":for(n=0;n<o;++n)h(t.x,s[n]);t.y=s[o-1];break;case"m":let e=0;"x"in t||(h(t.x=s[0],t.y=s[1]),e=2);for(n=e;n<o;n+=2)h(t.x+=s[n],t.y+=s[n+1]);"m"===i&&(t.xm=t.x,t.ym=t.y);break;case"l":for(n=0;n<o;n+=2)h(t.x+=s[n],t.y+=s[n+1]);break;case"h":for(n=0;n<o;++n)h(t.x+=s[n],t.y);break;case"v":for(n=0;n<o;++n)h(t.x,t.y+=s[n]);break;case"C":for(n=0;n<o;n+=6)a(t.x,t.y,s[n],s[n+1],t.cx=s[n+2],t.cy=s[n+3],t.x=s[n+4],t.y=s[n+5]);break;case"c":for(n=0;n<o;n+=6)a(t.x,t.y,t.x+s[n],t.y+s[n+1],t.cx=t.x+s[n+2],t.cy=t.y+s[n+3],t.x+=s[n+4],t.y+=s[n+5]);break;case"S":for(n=0;n<o;n+=4){const e="number"==typeof t.cx?t.cx:t.x,r="number"==typeof t.cy?t.cy:t.y,i=t.x+(t.x-e),o=t.y+(t.y-r);a(t.x,t.y,i,o,t.cx=s[n],t.cy=s[n+1],t.x=s[n+2],t.y=s[n+3])}break;case"s":for(n=0;n<o;n+=4){const e="number"==typeof t.cx?t.cx:t.x,r="number"==typeof t.cy?t.cy:t.y,i=t.x+(t.x-e),o=t.y+(t.y-r);a(t.x,t.y,i,o,t.cx=t.x+s[n],t.cy=t.y+s[n+1],t.x+=s[n+2],t.y+=s[n+3])}break;case"Q":for(n=0;n<o;n+=4)l(t.x,t.y,t.qx=s[n],t.qy=s[n+1],t.x=s[n+2],t.y=s[n+3]);break;case"q":for(n=0;n<o;n+=4)l(t.x,t.y,t.qx=t.x+s[n],t.qy=t.y+s[n+1],t.x+=s[n+2],t.y+=s[n+3]);break;case"T":for(n=0;n<o;n+=2){const e="number"==typeof t.qx?t.qx:t.x,r="number"==typeof t.qy?t.qy:t.y,i=t.x+(t.x-e),o=t.y+(t.y-r);l(t.x,t.y,t.qx=i,t.qy=o,t.x=s[n],t.y=s[n+1])}break;case"t":for(n=0;n<o;n+=2){const e="number"==typeof t.qx?t.qx:t.x,r="number"==typeof t.qy?t.qy:t.y,i=t.x+(t.x-e),o=t.y+(t.y-r);l(t.x,t.y,t.qx=i,t.qy=o,t.x+=s[n],t.y+=s[n+1])}break;case"A":for(n=0;n<o;n+=7)c(t.x,t.y,s[n],s[n+1],s[n+2],s[n+3],s[n+4],t.x=s[n+5],t.y=s[n+6]);break;case"a":for(n=0;n<o;n+=7)c(t.x,t.y,s[n],s[n+1],s[n+2],s[n+3],s[n+4],t.x+=s[n+5],t.y+=s[n+6]);break;case"z":case"Z":t.x=t.xm,t.y=t.ym}switch(i){case"M":case"L":case"H":case"V":case"A":case"m":case"l":case"h":case"v":case"a":t.cx=null,t.cy=null,t.qx=null,t.qy=null}function a(e,t,r,i,s,o,n,a){function l(e,t,r,i,s){const o=1-e;return o*o*o*t+3*o*o*e*r+3*o*e*e*i+e*e*e*s}for(let c=0;c<10;c++){const u=.1*(c+1);h(l(u,e,r,s,n),l(u,t,i,o,a))}}function l(e,t,r,i,s,o){function n(e,t,r,i){const s=1-e;return s*s*t+2*s*e*r+e*e*i}for(let a=0;a<10;a++){const l=.1*(a+1);h(n(l,e,r,s),n(l,t,i,o))}}function c(e,t,r,i,s,o,n,a,l){const c=function(e,t,r,i,s,o,n,a,l){const c=(e-a)/2,h=(t-l)/2,u=Qa(s%360),d=Math.cos(u),p=Math.sin(u),f=d*c+p*h,y=-p*c+d*h;let m=(r=Math.abs(r))*r,g=(i=Math.abs(i))*i;const v=f*f,_=y*y,b=v/m+_/g;b>1&&(m=(r=Math.sqrt(b)*r)*r,g=(i=Math.sqrt(b)*i)*i);let w=o===n?-1:1,x=(m*g-m*_-g*v)/(m*_+g*v);x=x<0?0:x;const S=w*Math.sqrt(x),C=S*(r*y/i),I=S*(-i*f/r),A=(e+a)/2+(d*C-p*I),k=(t+l)/2+(p*C+d*I),N=(f-C)/r,O=(y-I)/i,T=(-f-C)/r,P=(-y-I)/i;let M,D;D=Math.sqrt(N*N+O*O),M=N,w=O<0?-1:1;let L=Za(w*Math.acos(M/D));D=Math.sqrt((N*N+O*O)*(T*T+P*P)),M=N*T+O*P,w=N*P-O*T<0?-1:1;let E=Za(w*Math.acos(M/D));return!n&&E>0?E-=360:n&&E<0&&(E+=360),E%=360,L%=360,{cx:A,cy:k,rx:r,ry:i,angleFromRad:Qa(L),angleToRad:Qa(L+E),rotationRad:u}}(e,t,r,i,s,o,n,a,l),u=c.rotationRad?Math.cos(c.rotationRad):1,d=c.rotationRad?Math.sin(c.rotationRad):0;function p(e){const t=c.angleFromRad+(c.angleToRad-c.angleFromRad)*e,r=t?Math.cos(t):1,i=t?Math.sin(t):0,s=c.rx*r,o=c.ry*i,n=u*s-d*o,a=d*s+u*o;return{x:c.cx+n,y:c.cy+a}}for(let e=0;e<10;e++){const t=p(.1*(e+1));h(t.x,t.y)}}function h(t,r){const i=e;i&&"l"in i?(i.l>t&&(i.l=t),i.r<t&&(i.r=t),i.t>r&&(i.t=r),i.b<r&&(i.b=r)):e={l:t,b:r,r:t,t:r}}t.prevAction=i},getBBox:()=>e};return r}(),e.segmented=!1,s();const t=i.getBBox();return i=null,t?{x:t.l,y:t.t,w:t.r-t.l,h:t.b-t.t}:{x:NaN,y:NaN,w:NaN,h:NaN}},e}function ul(e,t=!1){const r=e||{};function i(e,t,i){return r._rawNode||r.rawNode?(e._setRawNode(tl.svg,t,!!r.rawNode),e._setShape(i),r.add(e),e):null}return function(e,t=!1){const r=e||{};r.children=[];let i,s=0;r.openBatch=()=>(!s&&r.rawNode&&(i=document.createDocumentFragment()),++s,r),r.closeBatch=()=>(s=s>0?--s:0,i&&!s&&(r.rawNode.appendChild(i),i=null),r),r.add=e=>{if(e.parent)throw new Error("The shape is already added.");return i?(i.appendChild(e.rawNode),r._appendRawNodeChild(e,!0)):r._appendRawNodeChild(e,!1),r.children.push(e),e.parent=r,e.setClip(e.clip),r},r.remove=e=>{if(e.parent!==r)throw new Error("Shape doesn't belong to this parent.");r._removeRawNodeChild(e),i&&i===e.rawNode.parentNode&&i.removeChild(e.rawNode);const t=r.children.indexOf(e);return-1!==t&&r.children.splice(t,1),e.parent=null,r},r.clear=e=>{let i;r._emptryRawNode(),t&&r._createDefsNode();for(let t=0;t<r.children.length;++t)i=r.children[t],i.parent=null,e&&i._destroy();return r.children=[],r},r.getBoundingBox=()=>{if(!r.children||!r.children.length)return null;let e=null;return r.children.forEach((t=>{let r=t.getBoundingBox();if(!r)return;const i=t.matrix;i&&(r=Ka.multiplyRectangle(i,r)),e?(e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),e.endX=Math.max(e.endX,r.x+r.w),e.endY=Math.max(e.endY,r.y+r.h)):e={x:r.x,y:r.y,endX:r.x+r.w,endY:r.y+r.h,w:null,h:null}})),e&&(e.w=e.endX-e.x,e.h=e.endY-e.y),e.endX=void 0,e.endY=void 0,e}}(r,t),r.createGroup=()=>i(function(){const e={};return al(e,!0),ul(e),e._destroy=()=>{e.clear(!0),e._destroyRawNode()},e}(),"g"),r.createRect=e=>i(function(){const e={};al(e),e.shape=Sn({},sl.defaultRect);const t=e._setShape;return e._setShape=r=>(t(r),null!=e.shape.r&&(e.setAttribute("ry",e.shape.r+""),e.setAttribute("rx",e.shape.r+"")),e),e.getBoundingBox=()=>e.shape,e}(),"rect",e),r.createLine=e=>i(function(){const e={};return al(e),e.shape=Sn({},sl.defaultLine),e.getBoundingBox=()=>({x:Math.min(e.shape.x1,e.shape.x2),y:Math.min(e.shape.y1,e.shape.y2),w:Math.abs(e.shape.x2-e.shape.x1),h:Math.abs(e.shape.y2-e.shape.y1)}),e}(),"line",e),r.createCircle=e=>i(function(){const e={};return al(e),e.shape=Sn({},sl.defaultCircle),e.getBoundingBox=()=>({x:e.shape.cx-e.shape.r,y:e.shape.cy-e.shape.r,w:2*e.shape.r,h:2*e.shape.r}),e}(),"circle",e),r.createEllipse=e=>i(function(){const e={};return al(e),e.shape=Sn({},sl.defaultEllipse),e.getBoundingBox=()=>({x:e.shape.cx-e.shape.rx,y:e.shape.cy-e.shape.ry,w:2*e.shape.rx,h:2*e.shape.ry}),e}(),"ellipse",e),r.createPath=e=>i(hl(),"path",e),r.createPolyline=e=>i(ll(!0),"polyline",e),r.createPolygon=e=>i(ll(!1),"polygon",e),r.createText=e=>i(function(){const e={};return al(e),e.shape=Sn({},sl.defaultText),e._setShape=t=>{e.shape=Sn({},e.shape,t);const r=e.shape;return e.setAttribute("x",r.x+""),e.setAttribute("y",r.y+""),e.setAttribute("text-anchor",r.align),e.setAttribute("text-decoration",r.decoration),e.setAttribute("rotate",r.rotated?"90":"0"),e.setAttribute("kerning",r.kerning?"auto":"0"),e.setAttribute("text-rendering","auto"),e._setText(r.text),e},e.setFont=t=>(e.font=t,e.setAttribute("font-style",t.fontStyle||"normal"),e.setAttribute("font-weight",t.fontWeight||"normal"),e.setAttribute("font-size",(t.fontSize||0)+"px"),e.setAttribute("font-family",t.fontFamily||"Verdana"),e),e.getBoundingBox=()=>null,e}(),"text",e),r.createImage=e=>i(function(){const e={};return al(e),e.shape=Sn({},sl.defaultImage),e._setShape=t=>{e.shape=Sn({},e.shape,t);for(const t in e.shape)if("type"!==t&&"src"!==t){let r=e.shape[t];"w"!==t&&"h"!==t||(r=r<0?0:r),e.setAttribute(ol(t),r)}return e.setAttribute("preserveAspectRatio","none"),e._setAttributeNS(tl.xlink,"xlink:href",e.shape.src),e},e.getBoundingBox=()=>e.shape,e}(),"image",e),r.createShape=e=>{switch(e.type){case sl.defaultPath.type:return r.createPath(e);case sl.defaultRect.type:return r.createRect(e);case sl.defaultLine.type:return r.createLine(e);case sl.defaultCircle.type:return r.createCircle(e);case sl.defaultEllipse.type:return r.createEllipse(e);case sl.defaultPolyline.type:return r.createPolyline(e);case sl.defaultPolygon.type:return r.createPolygon(e);case sl.defaultImage.type:return r.createImage(e);case sl.defaultText.type:return r.createText(e)}return null},r}function dl(){const e={isSurface:!0};nl(e),ul(e,!0),e.setDimensions=(t,r)=>{if(!e._rawNode&&!e.rawNode)return e;let i=t<0?0:t,s=r<0?0:r;return e.roundDimensions&&(i=Math.round(2*i)/2,s=Math.round(2*s)/2),e.setAttribute("width",i+""),e.setAttribute("height",s+""),e},e.getDimensions=()=>({w:parseFloat(e.getAttribute("width")),h:parseFloat(e.getAttribute("height"))}),e.getContentBoundingBoxInViewPort=()=>{const t=e.getDimensions(),r=function(e,t,r){if(e){const t=e.split(" ");return{xmin:Xa(t[0]),ymin:Xa(t[1]),width:Xa(t[2]),height:Xa(t[3])}}return t&&r?{xmin:0,ymin:0,width:Xa(t),height:Xa(r)}:null}(e.getAttribute("viewBox"),t.w,t.h);return function(e,t,r,i){let s,o;switch(i=i||"xMidYMin meet"){case"none":const t=e.w/r.width,i=e.h/r.height;s=e=>t*(e-r.xmin),o=e=>i*(e-r.ymin);break;case"xMidYMin meet":const n=function({box:e,parentBox:t,vAlign:r="middle",hAlign:i="center"}){let s=e.w/t.w,o=e.h/t.h;const n=s>1?1:-1,a=o>1?1:-1;let l;s=s>1?1/s:s,o=o>1?1/o:o,-1===n&&-1===a?l=1/Math.max(s,o):-1===n&&1===a?l=o:1===n&&-1===a?l=s:1===n&&1===a&&(l=Math.min(s,o));const c={x:0,y:0,w:e.w*l,h:e.h*l,ratio:l};switch(i){case"left":c.x=0;break;case"right":c.x=t.w-c.w;break;default:c.x=(t.w-c.w)/2}switch(r){case"top":c.y=0;break;case"bottom":c.y=t.h-c.h;break;default:c.y=(t.h-c.h)/2}return c}({box:{w:r.width,h:r.height},parentBox:e});s=e=>n.x+n.ratio*(e-r.xmin),o=e=>n.y+n.ratio*(e-r.ymin)}const n=s(t.x),a=o(t.y),l=e.w-s(t.x+t.w),c=e.h-o(t.y+t.h);return{x:n,y:a,r:l,b:c,w:e.w-l-n,h:e.h-c-a}}(t,e.getBoundingBox(),r,e.getAttribute("preserveAspectRatio"))},e._render=()=>{if(e.rawNode)return;const t=e._parent||document.createElement("div");t.innerHTML=e._getHTMLString(),e._assignRawNode(t.children[0])};const t=e._assignRawNode;return e._assignRawNode=r=>{t(r),function e(t){let r=0;t.children.forEach((i=>{let s=t.rawNode.children[r];for(;"defs"===s.nodeName||"clipPath"===s.nodeName;)s=t.rawNode.children[++r];r++,i._assignRawNode(s),i.children&&e(i)}))}(e)},e.destroy=()=>{e._destroyRawNode(),e._parent&&(e._parent.innerHTML="",e._parent=null)},e}const pl=["after-centered","before-centered"];let fl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString="\n  <div class='esri4GETooltip esri4GETooltipLeft'>\n    <div class='esri4GETooltipContainer esri4GETooltipContents' data-attach-point='_containerNode'></div>\n    <div class='esri4GETooltipConnector' data-attach-point='_connectorNode'></div>\n  </div>",this.duration=200}postCreate(){bi(this.domNode,document.body)}show(e,t,r){var i;this._stopAnimation(),this._lastRenderFunc=()=>this._render(e,t,r),this._lastRenderFunc(),"number"==typeof this.duration&&(this.domNode.style.opacity="0",this._fadeInHandle=Ta({obj:(i={node:this.domNode,duration:this.duration}).node.style,duration:i.duration||250,properties:{opacity:{start:0,end:1}},onEnd(){i.onEnd&&i.onEnd()}}))}_render(e,t,r){"string"==typeof e?this._containerNode.innerHTML=e:(this._containerNode.innerHTML="",bi(e.domNode||e,this._containerNode));const i=Kn(this.domNode,t,r&&r.length?r:pl,this._orient.bind(this)),s=i.aroundNodePos;"M"===i.corner.charAt(0)&&"M"===i.aroundCorner.charAt(0)?(this._connectorNode.style.top=s.y+(s.h-this._connectorNode.offsetHeight>>1)-i.y+"px",this._connectorNode.style.left=""):"M"===i.corner.charAt(1)&&"M"===i.aroundCorner.charAt(1)?this._connectorNode.style.left=s.x+(s.w-this._connectorNode.offsetWidth>>1)-i.x+"px":(this._connectorNode.style.left="",this._connectorNode.style.top=""),this._drawBackground()}updatePosition(){this._lastRenderFunc&&this._lastRenderFunc()}_orient(e,t,r,i,s){this._connectorNode.style.top="";const o=i.w,n=i.h;e.className="esri4GETooltip "+{"MR-ML":"esri4GETooltipRight","ML-MR":"esri4GETooltipLeft","TM-BM":"esri4GETooltipAbove","BM-TM":"esri4GETooltipBelow","BL-TL":"esri4GETooltipBelow esri4GETooltipABLeft","TL-BL":"esri4GETooltipAbove esri4GETooltipABLeft","BR-TR":"esri4GETooltipBelow esri4GETooltipABRight","TR-BR":"esri4GETooltipAbove esri4GETooltipABRight","BR-BL":"esri4GETooltipRight","BL-BR":"esri4GETooltipLeft"}[this._orientKey=t+"-"+r]+" "+this.class,this.domNode.style.width="auto";const a=fi(this.domNode);a.w=Math.ceil(a.w);const l=Math.min(Math.max(o,1),a.w);if(function(e,t,r){let i=t.w,s=t.h;const o=r||di(e),n=function(e,t){const r=t||di(e),i=gi(e,r),s=vi(e,r);return{l:i.l+s.l,t:i.t+s.t,r:i.r+s.r,b:i.b+s.b,w:i.w+s.w,h:i.h+s.h}}(e,o),a=yi(e,o);i>=0&&(i=Math.max(i-n.w-a.w,0)),s>=0&&(s=Math.max(s-n.h-a.h,0)),function(e,t,r,i,s,o){o=o||"px";const n=e.style;isNaN(t)||(n.left=t+o),isNaN(r)||(n.top=r+o),i>=0&&(n.width=i+o),s>=0&&(n.height=s+o)}(e,t.l,t.t,i,s)}(this.domNode,{w:l}),"B"===r.charAt(0)&&"B"===t.charAt(0)){const t=fi(e),r=this._connectorNode.offsetHeight;if(t.h>n){const e=n-(s.h+r>>1);this._connectorNode.style.top=e+"px",this._connectorNode.style.bottom=""}else this._connectorNode.style.bottom=Math.min(Math.max(s.h/2-r/2,0),t.h-r)+"px",this._connectorNode.style.top=""}else this._connectorNode.style.top="",this._connectorNode.style.bottom="";return this._drawBackground(),Math.max(0,a.w-o)}_drawBackground(){if(!this._orientKey)return;const e="function"==typeof this.customStyle?this.customStyle():this.customStyle,t=this.domNode.clientWidth,r=this.domNode.clientHeight,i=fi(this.domNode),s=fi(this._connectorNode),o=fi(this._containerNode);s.x-=i.x,s.y-=i.y,o.x-=i.x,o.y-=i.y,o.x+=1,o.y+=1,o.w-=2,o.h-=2,this._surface&&this._surface.destroy(),this._surfaceContainer&&Si(this._surfaceContainer);const n=this._surfaceContainer=_i("div",{class:"esriGEAbsoluteStretched"},this.domNode,"first");n.style.pointerEvents="none";const a=this._surface=function(e,t,r,i){const s=dl();return s.roundDimensions=void 0,s._setRawNode(tl.svg,"svg",!!e),s.setAttribute("overflow","hidden"),s.setDimensions(t,r),s.setStyle({position:"absolute",left:0,top:0}),s._createDefsNode(),e&&(s._parent=e,e.appendChild(s.rawNode)),s}(n,t,r),l=[{x:o.x,y:o.y},{x:o.x+o.w,y:o.y},{x:o.x+o.w,y:o.y+o.h},{x:o.x,y:o.y+o.h},{x:o.x,y:o.y}],c=s.x+s.w/2,h=s.y+s.h/2;let u;switch(this._orientKey){case"BL-TL":case"BM-TM":case"BR-TR":u=[{x:c-5,y:o.y},{x:c,y:h},{x:c+5,y:o.y}],l.splice.apply(l,[1,0].concat(u));break;case"ML-MR":case"BL-BR":u=[{x:o.x+o.w,y:h-5},{x:c,y:h},{x:o.x+o.w,y:h+5}],l.splice.apply(l,[2,0].concat(u));break;case"TM-BM":case"TL-BL":case"TR-BR":u=[{x:c+5,y:o.y+o.h},{x:c,y:h},{x:c-5,y:o.y+o.h}],l.splice.apply(l,[3,0].concat(u));break;case"MR-ML":case"BR-BL":u=[{x:o.x,y:h+5},{x:c,y:h},{x:o.x,y:h-5}],l.splice.apply(l,[4,0].concat(u))}const d=a.createPolyline({points:l}),p=e&&e.backgroundColor||"white",f=e&&e.borderColor||"#d3d3d3";d.setFill(p).setStroke({color:f,width:1,join:"round"}),e&&e.color&&(this._containerNode.style.color=e.color)}hide(){var e;this._stopAnimation(),"number"==typeof this.duration&&(this._fadeOutHandle=Ta({obj:(e={node:this.domNode,duration:this.duration}).node.style,duration:e.duration||250,properties:{opacity:{start:1,end:0}},onEnd(){e.onEnd&&e.onEnd()}}))}_stopAnimation(){this._fadeInHandle&&this._fadeInHandle.stop(),this._fadeInHandle=null,this._fadeOutHandle&&this._fadeOutHandle.stop(),this._fadeOutHandle=null}};s([Ee()],fl.prototype,"duration",void 0),s([Ee()],fl.prototype,"customStyle",void 0),fl=s([St()],fl);const yl=[],ml={show(e){const t=e.textOrNodeOrWidget,r=e.aroundNode;let i=e.position;const s=e.classes,o=e.style;yl.forEach((e=>e._shownTooltip&&(e._shownTooltip.domNode.style.display="none"))),yl.length=0,"string"==typeof i&&(i=[i]);const n={after:"after-centered",before:"before-centered"};i=i&&i.map((e=>n[e]||e));const a=new fl({class:Array.isArray(s)?s.join(" "):s,customStyle:o,duration:e.duration});return a.show(t,r,i),r._shownTooltip=a,e.keepWhenOtherShown||yl.push(r),a},hide(e){if(!e)return;e._shownTooltip&&e._shownTooltip.destroy(),e._shownTooltip=void 0;const t=yl.indexOf(e);-1!==t&&yl.splice(t,1)}};function gl(e,t,r){const i=e;if(r=r||{},!i)return null;if(_l(i),i.__setTooltipToNodeMouseEnterHandle&&i.__setTooltipToNodeMouseEnterHandle.remove(),!t)return null;let s=!1;function o(){!s&&!function(e){return!(!e||!e._shownTooltip)}(i)&&vl(i,t,r)}return Di()?i.__setTooltipToNodeMouseEnterHandle=xn(i,o):i.__setTooltipToNodeMouseEnterHandle=Ei(i,"over",o),r.showTooltip&&o(),{remove(){t=null,_l(i)},suspend(){_l(i),s=!0},resume(){s=!1},refresh(){i._shownTooltip&&o()}}}function vl(e,t,r){const i=e;(r=r||{}).stayOnHover=null==r.stayOnHover?"hyperlink":r.stayOnHover;let s=r.stayOnHover;if(!i)return null;_l(i);let o,n="function"==typeof t?t():t;if(!n)return null;if(r.textAlign&&"string"==typeof n&&(n="<div class='"+("start"===r.textAlign?"esriGEStart esriGEFlexStart":"end"===r.textAlign?"esriGEEnd esriGEFlexEnd":"")+"'>"+n+"</div>"),"hyperlink"===r.stayOnHover){let e;"string"==typeof n?e=n:n instanceof HTMLElement?e=n.outerHTML:n.domNode instanceof HTMLElement&&(e=n.domNode.outerHTML),s=e&&/href=|esriGELink|esri4GELink/.test(e)}function a(e,t){return Vi(e,{checkAllChildren:!0,event:t})}function l(){_l(i);let e=Array.isArray(r.classes)?r.classes.join(" "):r.classes;e=e||"",s||(e+=" esriGENonInteractable"),r.notRestricted&&(e+=" notRestricted"),o=ml.show({textOrNodeOrWidget:n,aroundNode:i,position:["after","before"],classes:e,style:r.style,duration:r.duration,keepWhenOtherShown:r.keepWhenOtherShown})}if(ri(i,"esri4GESimpleTextTooltip"),l(),r.ignoreMousePosition||(Di()?i.__setTooltipToNodeMouseLeaveHandle=Ei(document.body,"press",(e=>{a(i,e)||_l(i)})):i.__setTooltipToNodeMouseLeaveHandle=Ri(i,"mouseout",(()=>{!s&&!a(i)&&_l(i)}))),r.ignoreNodeRemoval||(i.__setTooltipToNodeInLayoutHandle=setInterval((()=>{!function(e){return function(e,t,r){let i=!1;const s=e=>{r&&!r(e)||(e.parentNode===t?i=!0:e.parentNode&&s(e.parentNode))};return e&&s(e),i}(e,document.body,(e=>function(e){return!((t=e)&&ni(t,"esriGEHidden")||"none"===hi(e,"display")||ni(e,"dijitHidden"));var t}(e)))}(i)&&_l(i)}),50)),Di()||(i.__setTooltipToNodeMouseOverHandle=setInterval((()=>{!r.ignoreMousePosition&&(!s||!a(o.domNode))&&!a(i)&&_l(i)}),300),i.__setTooltipToNodeClickHandle=Ei(i,"click",(()=>{r.hideOnClick?_l(i):!i._shownTooltip&&l()})),s&&(i.__setTooltipToNodeMouseLeaveMasterHandle=Ei(o.domNode,"out",(()=>{!a(o.domNode)&&_l(i)})))),r.autoAdjustPosition){let e=fi(i);i.__setTooltipToNodeAdjustHandle=setInterval((()=>{const t=fi(i);e.x===t.x&&e.y===t.y||(e=t,i._shownTooltip&&i._shownTooltip.updatePosition())}),30)}return i._shownTooltip}function _l(e){const t=e;t&&(t.removeAttribute("title"),ii(t,"esri4GESimpleTextTooltip"),ml.hide(t),t.__setTooltipToNodeMouseLeaveHandle&&t.__setTooltipToNodeMouseLeaveHandle.remove(),clearInterval(t.__setTooltipToNodeInLayoutHandle),clearInterval(t.__setTooltipToNodeMouseOverHandle),t.__setTooltipToNodeClickHandle&&t.__setTooltipToNodeClickHandle.remove(),t.__setTooltipToNodeMouseLeaveMasterHandle&&t.__setTooltipToNodeMouseLeaveMasterHandle.remove(),t.__setTooltipToNodeAdjustHandle&&clearInterval(t.__setTooltipToNodeAdjustHandle))}let bl,wl;function xl(e){return Ei(e,"over",(e=>{const t=e.target;function r(){wl&&(ml.hide(bl),wl.mouseOutH.remove(),wl.mouseMoveH.remove(),wl=null),bl=null}t!==bl&&ni(t,"esriGETrimWithEllipses")&&t.offsetWidth<t.scrollWidth&&(r(),bl=t,ml.show({textOrNodeOrWidget:bl.textContent,aroundNode:bl,position:["above","below"]}),wl={mouseOutH:Ri(bl,["mouseout","mousedown","touchstart"],r),mouseMoveH:Ei(document.body,"mousemove",(()=>{Vi(bl)||r()}))})}))}class Sl{constructor(e){this.itemClass="",this.itemClassSelected="",this.labelClass="",this.createLabelNode=!1,this.createImageAfterLabel=!1,this.makeLabelFillSpace=!1,Sn(this,e)}createPresentation(e,t,r,i,s){if(e.isSeparator){const t=_i("div",{class:"flowList_listSeparator"},r);return e.hidden&&Ci(t),t}const o=_i("div",{class:"listItem "+(this.itemClass||" ")+(e.itemClass||""),style:e.style},r);return e.isLink&&ri(o,"esri4GELink"),!1===e.enabled&&ri(o,"disabled"),this._createParts(e,o,i),this._setTooltip(e,o,i),this.selectPresentation(o,t,e),e.hidden&&Ci(o),o}_setTooltip(e,t,r){e.tooltip&&gl(t,e.tooltip)}_createParts(e,t,r){let i;this.createImageAfterLabel&&(this._createLabel(e,t,r),i=!0),this._createImage(e,t,r),!i&&this._createLabel(e,t,r)}_createImage(e,t,r){const i=this._createImageNode(e,t,r);i&&(e.imageClass&&ri(i,e.imageClass),e.imageUrl&&(i.style.backgroundImage="url("+e.imageUrl+");"))}_createImageNode(e,t,r){return t}_createLabel(e,t,r){if(this.createLabelNode){const i=_i("div",{textContent:e[r.labelProperty],class:"esriGETrimWithEllipses listItemLabel"},t);return e.labelClass&&ri(i,e.labelClass),this.labelClass&&ri(i,this.labelClass),r.autoDetectUrlsInLabels&&this._tryConvertToUrls(i),this.makeLabelFillSpace&&(i.style.flexGrow="1"),i}return e[r.labelProperty]&&(t.textContent=e[r.labelProperty],r.autoDetectUrlsInLabels&&this._tryConvertToUrls(t)),null}_tryConvertToUrls(e){const t=e.innerHTML.match(kn),r=t&&t[0];r&&(e.innerHTML=e.innerHTML.replace(r,"<a href='"+function(e){if(e&&(e=function(e){return!e||/^http/i.test(e)?e:"http://"+e}(e)),!e||!/^http:\/\//i.test(e))return e;const t=new Ft(e);e=e.replace(/^http/i,"https");const r=Yn[t.port];return r&&(e=e.replace(":"+t.port,":"+r)),e}(r)+"' target='_blank'>"+r+"</a>"))}selectPresentation(e,t,r){oi(e,"listItemSelected "+this.itemClassSelected,t)}}let Cl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString="<div class='esri4GEFlowList esriGENonSelectable'></div>",this.idProperty="value",this.labelProperty="label",this.itemRenderer=null,this.itemClass=null,this.itemClassSelected=null,this.keepScrollPosition=!1,this.allowRepetitiveSelection=!0,this.selectOnMouseDown=!1,this.noDragTolerance=0,this.selectionValidator=null,this.allowManualSelection=!0,this.stopMouseEventPropagation=!0,this.hasSelectableItems=!0,this.autoDetectUrlsInLabels=!1,this.storeItemsInInnerDiv=!1,this.itemsDiv=null,this.onDemandModeLoadStep=1e3,this.onDemandPopulateLimit=1e3,this.onDemandPopulatePeriod=200,this._addedWrappers=[],this._clickHandles=null,this._valueOnCreation=null,this._isCreated=!1,this._selectedPresentation=null,this._scrollTopMemo=0}postCreate(){this.storeItemsInInnerDiv?this._set("itemsDiv",_i("div",{class:"esri4GEFlowList_innerDiv"},this.domNode)):this._set("itemsDiv",this.domNode),this._clearHandlers(),this._setUpItemRenderer(),xl(this.domNode),this._isCreated=!0,this.refresh(),this._valueOnCreation&&(this.value=this._valueOnCreation)}_setUpItemRenderer(){this.itemRenderer||(this.itemRenderer=new Sl),this.itemClass&&(this.itemRenderer.itemClass=this.itemClass),this.itemClassSelected&&(this.itemRenderer.itemClassSelected=this.itemClassSelected)}get value(){return this.selectedItem&&this.selectedItem[this.idProperty]}set value(e){if(!this._isCreated)return void(this._valueOnCreation=e);this._set("value",e);const t=this.items||this.store&&this.store.data;t&&t.some((t=>t[this.idProperty]===e&&(this.selectedItem=t,!0)))}set items(e){this._setItems(e)}_setItems(e){this.keepScrollPosition&&this.memoScroll(),this.clear(),this._set("items",e),this.items&&this._isCreated?(this._addItems(e),this._checkIfStillSelected(),this.keepScrollPosition&&this.applyScrollFromMemo()):this._checkIfStillSelected()}_checkIfStillSelected(){(-1!==this.selectedIndex||this.selectedItem)&&(this._addedWrappers&&this._addedWrappers.some(((e,t)=>this._isItemSelected(e,t)))||(this._set("selectedIndex",-1),this._set("selectedItem",null)))}set store(e){this._setStore(e)}_setStore(e){this.keepScrollPosition&&this.memoScroll(),this.clear(),this._set("store",e),this.idProperty=e&&e.idProperty,this.store&&this._isCreated?(this._loadNextPart(),this._checkIfStillSelected(),this.keepScrollPosition&&this.applyScrollFromMemo(),this._domNodeScrollH&&this._domNodeScrollH.remove(),this._domNodeScrollH=Ei(this.domNode,"scroll",(()=>{const e=this._addedWrappers[this._addedWrappers.length-30],t=e?e.itemPresentation:null;t&&t.offsetTop<this.domNode.scrollTop&&this._loadNextPart()}))):this._checkIfStillSelected()}_loadNextPart(){if(!this.store||this.store.data.length===this._addedWrappers.length)return;const e=this.store.query(null,{start:this._addedWrappers.length,count:this.onDemandModeLoadStep});this._addItems(e),e.length&&this._addedWrappers.length<this.onDemandPopulateLimit&&setTimeout((()=>this._loadNextPart()),this.onDemandPopulatePeriod)}set selectedItem(e){this._setSelectedPresentation(this.queryItem({item:e}).node)}set selectedIndex(e){this._setSelectedPresentation(this.queryItem({index:e}).node)}refresh(){this.store?this._setStore(this.store):this._setItems(this.items)}_addItems(e){this._addedWrappers=this._addedWrappers||[],e.forEach((e=>{const t=Sn({},e);t.itemRef=e,this._addWrapper(t)}))}_addWrapper(e){const t=this._addedWrappers.length,r=this.itemRenderer.createPresentation(e.itemRef,this._isItemSelected(e,t),this.itemsDiv,this,e);if(!r)return;r.index=t,r.item=e.itemRef,e.itemPresentation=r,this._isItemSelected(e,t)&&this._setSelectedPresentation(r),this._addClickHandler(r),this._addedWrappers.push(e);const i=this._addedWrappers.length-1;ri(r,"listItem_"+i),ri(r,"listItem_"+(i%2==0?"even":"odd"))}_isItemSelected(e,t){if(!this.hasSelectableItems||!this._isItemClickable(e))return!1;if(t===this.selectedIndex)return!0;if(e.itemRef===this.selectedItem)return!0;if(e.itemRef&&this.selectedItem){const t=e.itemRef[this.idProperty],r=this.selectedItem[this.idProperty];return void 0!==t&&t===r}return!1}_isItemClickable(e){return this.selectionValidator?this.selectionValidator(e):this._selectionValidatorDefault(e)}_selectionValidatorDefault(e){return!!e&&!e.isSeparator&&!1!==e.enabled}_addClickHandler(e){if(!this.allowManualSelection)return;const t=()=>{(this.allowRepetitiveSelection||this._selectedPresentation!==e)&&this._setSelectedPresentation(e)&&this._dispatchChangeEvent()};let r;r=this.selectOnMouseDown||!this.noDragTolerance?Ei(e,this.selectOnMouseDown?"press":"click",(e=>{this.stopMouseEventPropagation&&e.stopPropagation(),t()})):xn(e,t,{tolerance:this.noDragTolerance}),this._clickHandles.push(r)}_setSelectedPresentation(e){return this._set("selectedIndex",-1),this._set("selectedItem",null),!!(this.hasSelectableItems&&e&&this._isItemClickable(e.item))&&(this._selectedPresentation&&this.itemRenderer.selectPresentation&&this.itemRenderer.selectPresentation(this._selectedPresentation,!1,this._selectedPresentation.item),e&&(this.itemRenderer.selectPresentation&&this.itemRenderer.selectPresentation(e,this.hasSelectableItems,e.item),this._selectedPresentation=e,this._set("selectedIndex",e.index),this._set("selectedItem",e.item)),!0)}_dispatchChangeEvent(){this._onChange({type:"change",selectedIndex:this.selectedIndex,selectedItem:this.selectedItem,value:this.value})}clear(){this._selectedPresentation=null,this._addedWrappers=this._addedWrappers||[],this._addedWrappers&&this._addedWrappers.forEach((e=>{e.destroyPresentation&&e.destroyPresentation()})),this._addedWrappers.length=0,this.itemsDiv&&xi(this.itemsDiv),this._clearHandlers()}_clearHandlers(){this._clickHandles=this._clickHandles||[],this._clickHandles.forEach((e=>{e.remove()})),this._clickHandles.length=0}memoScroll(){this._scrollTopMemo=this.domNode?this.domNode.scrollTop:0}applyScrollFromMemo(){this.domNode.scrollTop=this._scrollTopMemo||0}scrollToItem(e){const t=this.queryItem({item:e}).node;t&&(this.domNode.scrollTop=t.offsetTop)}queryItem(e){const t={item:null,node:null,index:-1};return this._addedWrappers&&this._addedWrappers.some(((r,i)=>!!(e.item&&r.itemRef===e.item||e.node&&r.itemPresentation===e.node||void 0!==e.value&&r.itemRef[this.idProperty]===e.value||void 0!==e.index&&i===e.index)&&(t.item=r.itemRef,t.node=r.itemPresentation,t.index=i,!0))),t}isMouseOver(e){return Vi(this.domNode,{event:e})}_onChange(e){this.onChange(e)}onChange(e){}destroy(){this.clear()}};s([Ee()],Cl.prototype,"idProperty",void 0),s([Ee({constructOnly:!0})],Cl.prototype,"labelProperty",void 0),s([Ee()],Cl.prototype,"itemRenderer",void 0),s([Ee({constructOnly:!0})],Cl.prototype,"itemClass",void 0),s([Ee({constructOnly:!0})],Cl.prototype,"itemClassSelected",void 0),s([Ee()],Cl.prototype,"keepScrollPosition",void 0),s([Ee()],Cl.prototype,"allowRepetitiveSelection",void 0),s([Ee()],Cl.prototype,"selectOnMouseDown",void 0),s([Ee()],Cl.prototype,"noDragTolerance",void 0),s([Ee()],Cl.prototype,"selectionValidator",void 0),s([Ee()],Cl.prototype,"allowManualSelection",void 0),s([Ee()],Cl.prototype,"stopMouseEventPropagation",void 0),s([Ee()],Cl.prototype,"hasSelectableItems",void 0),s([Ee()],Cl.prototype,"autoDetectUrlsInLabels",void 0),s([Ee()],Cl.prototype,"storeItemsInInnerDiv",void 0),s([Ee({readOnly:!0})],Cl.prototype,"itemsDiv",void 0),s([Ee()],Cl.prototype,"onDemandModeLoadStep",void 0),s([Ee()],Cl.prototype,"onDemandPopulateLimit",void 0),s([Ee()],Cl.prototype,"onDemandPopulatePeriod",void 0),s([Ee({dependsOn:["selectedItem"]})],Cl.prototype,"value",null),s([Ee()],Cl.prototype,"items",null),s([Ee()],Cl.prototype,"store",null),s([Ee()],Cl.prototype,"selectedItem",null),s([Ee({value:-1})],Cl.prototype,"selectedIndex",null),s([Ee()],Cl.prototype,"onChange",null),Cl=s([St()],Cl);let Il=class extends Cl{constructor(){super(...arguments),this.allowRepetitiveSelection=!1,this.stopMouseEventPropagation=!1}postCreate(){ri(this.domNode,"esri4GEButtonBar"),super.postCreate()}};Il=s([St()],Il);let Al=class extends Il{constructor(e,t,r){super(e,t,r),this.stopMouseEventPropagation=!0}postCreate(){this.items=this.states.ids.map(((e,t)=>({value:e,label:this.states.labels[t]}))),super.postCreate(),ri(this.domNode,"esri4GEVariableToggle")}getStateName(e){return this.states.names&&this.states.names[this.queryItem({value:e||this.value}).index]||null}};function kl(e,t,r=!1){const i={},s=[];return t.forEach((t=>{s.push(Nl(e,t,i,r))})),{groups:s,hash:i}}function Nl(e,t,r,i=!1){r=r||{};const s=e.getStates&&e.getStates(t),o={value:t,states:s};if(r[t]=o,s){let e=!1;s.ids.forEach((s=>{t===s?e=!0:i||(r[s]=o)})),e||(t=o.value=s.ids[0],r[t]=o)}return o}s([Ee()],Al.prototype,"states",void 0),Al=s([St()],Al);const Ol=(0,i.a)("DataBrowser").ShoppingCart;let Tl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString=`\n  <div class="esri4GEShoppingCart">\n    <table data-attach-point="_countLabel" class="ShoppingCart_Label">\n      <tr>\n        <td class="ShoppingCart_CounterTD">\n          <div class="ShoppingCart_CounterDivLeftBorder"></div>\n          <div data-attach-point="_divCounter" class="ShoppingCart_CounterDiv"></div>\n          <div class="ShoppingCart_CounterDivRightBorder"></div>\n        </td>\n        <td class="ShoppingCart_LabelTd">\n          <div data-attach-point="_selectedVariablesLabel"></div>\n        </td>\n        <td>\n          <div class="ShoppingCartOpener" data-attach-point="_divShoppingCartOpener"></div>\n        </td>\n      </tr>\n    </table>\n\n    <div data-attach-point="_divOuter" class="ShoppingCart_OuterDiv">\n      <div data-attach-point="_divList" class="ShoppingCart_DivList">\n      </div>\n      <div data-attach-point="_divEmpty" class="esriGEAbsoluteStretched ShoppingCart_DivEmpty">\n        <div>${Ol.noVariables}</div>\n      </div>\n    </div>\n  </div>`,this.allowToggles=!0,this.allowMoveButtons=!1,this.allowEditButtons=!1,this.allowReplaceButtons=!1}postCreate(){Ei(this._countLabel,"click",this._toggleList.bind(this)),this._buildVariableLabel(),this._set("selection",[]),this._content=[],this._list=new Cl({hasSelectableItems:!1,keepScrollPosition:!0,itemRenderer:new Sl({createPresentation:this._renderVariable.bind(this)})}).placeAt(this._divList),this._updateLabel(),this._divOuter.style.display="none",this.watch("selection",(()=>{(0,i.w)(this.variables.synchronize()).then(this._onSelectionChanged.bind(this))}))}_buildVariableLabel(){let e=Ol.selectedVars;const t=e.split(/\s+/),r=t.length-1;if(r<2)e=t.join("<br/>");else{const i=e.length-r;let s=t[0].length,o=0;for(let e=1;e<r;e++){const r=s+t[e].length;Math.abs(2*s-i)>Math.abs(2*r-i)&&(o=e),s=r}e=t.slice(0,o+1).join("&nbsp;")+"<br/>"+t.slice(o+1).join("&nbsp;")}this._selectedVariablesLabel.innerHTML=e}_renderVariable(e,t,r){const i=_i("div",{class:"ShoppingCartRow"},r);function s(){_i("div",{class:"ShoppingCartRowSpacer",innerHTML:"&nbsp;"},i)}const o=e.group.states&&this.allowToggles?e.group.states.ids[0]:e.group.value,n=this.variables.get(o),a=_i("div",{class:"esriGETrimWithEllipses ShoppingCartRowLabel",textContent:this._getLabel(n)||""},i);if(n&&n.isMissing&&ri(a,"ShoppingCartRowLabel_missing"),this.allowMoveButtons){s();const t=_i("div",{class:"upDownArrowsBlock"},i);this._content.indexOf(e)>0&&Ei(_i("div",{class:"upArrow"},t),"click",(()=>{this._onMove(e,!0)})),this._content.indexOf(e)<this._content.length-1&&Ei(_i("div",{class:"downArrow"},t),"click",(()=>{this._onMove(e,!1)}))}if(this.allowReplaceButtons){s();const t=_i("div",{class:"ShoppingCartRowReplaceButton"},i);gl(t,Ol.replaceVariable),Ei(t,"click",(()=>{this._onReplaceData(e)}))}if(this.allowEditButtons&&this._canEditData(e)){s();const t=_i("div",{class:"ShoppingCartRowEditButton"},i);gl(t,Ol.editVariable),Ei(t,"click",(()=>{this._onEditData(e)}))}if(e.group.states&&this.allowToggles){s();const t=new Al({states:e.group.states,value:e.group.value,onChange:()=>{this._onToggleChange(t,e)}}).placeAt(i)}s();const l=_i("div",{class:"esri4GECloseCrossButton"},i);return gl(l,Ol.removeVariable),Ei(l,"click",(()=>{this._onRemove(e)})),i}_onSelectionChanged(){const e=[];let t=Math.min(this._content.length,this.selection.length);for(let r=0;r<t;r++){const t=this.selection[r],i=this._content[r];if(!i.hash[t])break;i.group.value=t,e.push(i)}t=this.selection.length;for(let r=e.length;r<t;r++){let t=this.selection[r];const i={hash:{},group:null};i.group=Nl(this.variables,t,i.hash),t=i.group.states&&this.allowToggles?i.group.states.ids[0]:i.group.value;const s=this.variables.get(t);i.label=this._getLabel(s),e.push(i)}this._content=e,this._updateLabel(),this._content.length||this._hideList()}_getLabel(e){return e?"function"==typeof this.variables.getLabel?this.variables.getLabel(e):e.alias||"":""}_onRemove(e){const t=this.selection.slice(),r=this._content.indexOf(e);t.splice(r,1),this._content.splice(r,1),this.selection=t,this._refresh()}_onToggleChange(e,t){t.group.value=e.value;const r=this.selection.slice();r[this._content.indexOf(t)]=e.value,this.selection=r}_onMove(e,t){const r=this.selection.slice(),i=this._content.indexOf(e),s=r[i];r.splice(i,1),this._content.splice(i,1),r.splice(t?i-1:i+1,0,s),this._content.splice(t?i-1:i+1,0,e),this.selection=r,this._refresh()}_canEditData(e){return!1}_onEditData(e){}_onReplaceData(e){}_refresh(){this._list.items=this._content,this._updateLabel(),this._divEmpty.style.visibility=this._content.length?"hidden":"visible"}_updateLabel(){this._divCounter.textContent=this._content.length.toString()}isOpen(){return"none"!==this._divOuter.style.display}hideList(){this._hideList()}_toggleList(){"none"===this._divOuter.style.display?this._displayList():this._hideList()}_displayList(){this._refresh(),this._divOuter.style.display="",this._listenToMouseLeave()}_listenToMouseLeave(){this._mouseOutH&&this._mouseOutH.remove(),this._mouseOutH=function(e){const t=e.isMouseOver||(()=>Vi(e.node,{checkAllChildren:!0}));let r,i;function s(){clearTimeout(r),r=null}const o=Ei(document.body,"mousemove",(o=>{t()?(s(),i=!0):i&&(i=!1,r=setTimeout((()=>{s(),e.onMouseOut&&e.onMouseOut(o)}),e.allowedOutDelay))}));return{remove:()=>{o.remove(),s()}}}({node:this.domNode,onMouseOut:this._onMouseLeave.bind(this)})}_onMouseLeave(){this._mouseOutH&&this._mouseOutH.remove(),this._hideList()}_hideList(){this._divOuter.style.display="none"}onSelectionChanged(e){}};s([Ee()],Tl.prototype,"variables",void 0),s([Ee()],Tl.prototype,"selection",void 0),s([Ee()],Tl.prototype,"allowToggles",void 0),s([Ee()],Tl.prototype,"allowMoveButtons",void 0),s([Ee()],Tl.prototype,"allowEditButtons",void 0),s([Ee()],Tl.prototype,"allowReplaceButtons",void 0),s([Ee()],Tl.prototype,"onSelectionChanged",null),Tl=s([St()],Tl);const Pl="__waitingDiv";function Ml(e,t,r={}){const s=e;return s?(s.__progressIndex=s.__progressIndex||0,0===s.__progressIndex&&(s.__progressDfd=(0,i.c)(),function(e,t){if(!e||e[Pl])return;const r=hi(e,"position");"absolute"!==r&&"relative"!==r&&(e.style.position="relative");const i=t&&t.position,s=e[Pl]=_i("div",{class:"esri4GEProgress "+("bottom-right"===i?"esri4GEProgressBottomRight":"esriGEAbsoluteStretched ")+(t&&t.progressClass||"")},e);t&&t.indicatorSize&&(s.style.backgroundSize=t.indicatorSize+"px"),t&&t.backgroundColor&&(s.style.backgroundColor=t.backgroundColor)}(s,{progressClass:r.progressClass,position:r.position,indicatorSize:r.indicatorSize,backgroundColor:r.backgroundColor}),r.onShowProgress&&r.onShowProgress()),s.__progressIndex++,t.finally((()=>{s.__progressIndex=Math.max(0,--s.__progressIndex),0===s.__progressIndex&&(s.__progressDfd&&s.__progressDfd.resolve(),delete s.__progressDfd,function(e){e&&e[Pl]&&(Si(e[Pl]),delete e[Pl])}(s),r.onRemoveProgress&&r.onRemoveProgress())})),t):t}let Dl=class extends _n{constructor(e,t,r){super(e,t,r),this.stacking="stretch",this._pages={},this._anim=new zi}postCreate(){ri(this.domNode,"esri4GEWizard_Root")}loadPage(e){const t=this._pages[e],r=this.currentPage;t!==r&&(this._anim.finish(),r&&this._animPage("Anim_FadeOut").then((()=>{r.pageIsActive=!1,this.domNode.removeChild(r.domNode)})),this._set("currentPage",t),this._set("currentPageId",e),bi(this.currentPage.domNode,this.domNode,"first"),r&&this._animPage("Anim_FadeIn"),t.stacking=this.stacking,t.pageIsActive=!0,t.resize())}_animPage(e){return this._anim.start([{node:this.currentPage.domNode,classes:[e,"esri4GEWizard_FadeAnim"]}])}resize(){this.currentPage&&this.currentPage.resize()}_showProgress(e){return(0,i.w)(Ml(this.domNode,e))}destroy(){for(const e in this._pages)this._pages[e].destroy();this._pages={}}};function Ll(e,t,r){let i=!1;e.watch(r,(()=>{i||(i=!0,t.set(r,e.get(r)),i=!1)})),t.watch(r,(()=>{i||(i=!0,e.set(r,t.get(r)),i=!1)}))}s([Ee({readOnly:!0})],Dl.prototype,"currentPage",void 0),s([Ee({readOnly:!0})],Dl.prototype,"currentPageId",void 0),s([Ee()],Dl.prototype,"stacking",void 0),Dl=s([St()],Dl);let El=class extends Dl{set title(e){this._set("title",e)}set selection(e){this._setSelection(e)}set countryID(e){this._setCountryID(e)}set hierarchyID(e){this._setCountryID(this._getQueryCountryID(this.countryID,e))}constructor(e,t,r){super(e,t,r),this.allowHierarchies=!1,this.countryBox=!0,this.selectionLimit=-1,this.displayAllGlobalVariables=!1,this.variableInfo=!0,this.shoppingCart=!0,this.allowDerivativeVariables=!1,this._isCreated=!1}postCreate(){this._set("title",(0,i.a)("DataBrowser").DataBrowser.title),this.applyButton=(0,i.a)("DataBrowser").WizardButtons.apply,this.backButton=(0,i.a)("DataBrowser").WizardButtons.back,this.pageBackButton=(0,i.a)("DataBrowser").WizardButtons.back,this.cancelButton=(0,i.a)("DataBrowser").WizardButtons.cancel,this._initialStartup(),super.postCreate(),this._isCreated=!0}_initialStartup(){this._manager=this._contentFactory.createManager(this),this._manager.selectionLimit>0&&(this._manager.onLimit=this._onLimit.bind(this),1===this._manager.selectionLimit&&this._manager.watch("selection",this._onApply.bind(this))),Ll(this,this._manager,"variableQuery"),this._manager.multipleSelectIsAllowed()&&this._manager.watch("selection",this._updateSelectionFromManager.bind(this)),this._manager.allowShoppingCart&&(this._shoppingCart="function"==typeof this.shoppingCart?this.shoppingCart(this.variables):"object"==typeof this.shoppingCart&&this.shoppingCart.placeAt?this.shoppingCart:new Tl({variables:this.variables}),"object"!=typeof this.shoppingCart&&this.own(this._shoppingCart),this._syncManagerWithShoppingCart()),this._breadcrumb=this._contentFactory.createBreadcrumb({onCategoriesClick:this._loadCategoriesPage.bind(this),onDCsClick:this._loadCollectionsPage.bind(this)}),this._breadcrumb.domNode.style.display="none",this._manager.flyAnim=this._breadcrumb.flyAnim=new zi(this.domNode),ri(this.domNode,"esri4GEDataBrowser"),this._shoppingCart&&this._shoppingCart.placeAt(this.domNode),this._breadcrumb.placeAt(this.domNode),this._addTitleNode(),this._manager.createVariableGrid=(e,t)=>((e=e||{}).manager=this._manager,this._contentFactory.createVariableGrid(e,t)),this._addAutoTooltip()}_syncManagerWithShoppingCart(){Ll(this._manager,this._shoppingCart,"selection")}_addAutoTooltip(){xl(this.domNode)}_addTitleNode(){const e=_i("div",{style:"position: absolute; top: 0;"},this.domNode);this._titleNode=_i("div",{class:"esri4GEDataBrowser_Title",textContent:this.title},e)}_updateSelectionFromManager(){if(this.selection!==this._manager.selection){const e=this._manager.selection.length>this.selection.length;this._set("selection",this._manager.selection),e&&this._onSelect()}}_setSelection(e){return this._manager&&this._manager.multipleSelectIsAllowed()?(e=e||[],this.selection===e?null:(this._updateSelection(e),this._manager.changeSelection(e))):null}_updateSelection(e){this._set("selection",e.slice())}_setCountryID(e,t=!1){if(e!==this._getQueryCountryID()){if(e&&this.allowHierarchies){const t=e.substr(3);e=e.substr(0,2),this._set("hierarchyID",t)}this._set("countryID",e),this._manager&&!t&&(e=this._getQueryCountryID(),this._isCreated?this._loadCategoriesPage().changeCountry(e):(this._manager.variableQuery={countryID:e},this._manager.variables.synchronize(e)))}}_getQueryCountryID(e,t){return void 0===e&&(e=this.countryID,t=this.hierarchyID),this.allowHierarchies&&e&&t?e+"/"+t:e}launch(e){if(e){const t=this._getQueryCountryID();void 0===(e=Object.assign({},e)).countryID&&(e.countryID=t),this._manager.variableQuery=e,t!==e.countryID&&this._set("countryID",e.countryID)}this._launch()}_launch(){this._showProgress(this._manager.validateQuery().then((e=>{this._manager.validateSelection(),this._loadNextPage(e)})))}back(){this.currentPage&&this.currentPage.emit("back")}_loadNextPage(e){const t=this._manager.variableQuery;t.searchString||t.favorites||t.dataCollectionID?this._loadVariablesPage(e):t.categoryID?this._isNonEmptyCategory((e=>{e?this._loadCollectionsPage():this._loadVariablesPage()})):this._loadCategoriesPage()}_loadPreviousPage(){"collections"===this.currentPageId?this._loadCategoriesPage():this._isNonEmptyCategory((e=>{e?this._loadCollectionsPage():this._loadCategoriesPage()}))}_loadCategoriesPage(){let e=this._pages.categories;return e||(e=this._pages.categories=this._contentFactory.createCategoriesPage({countryBox:this.countryBox,allowHierarchies:this.allowHierarchies,manager:this._manager,backButton:this.backButton,applyButton:this._manager.multipleSelectIsAllowed()?this.applyButton:null,cancelButton:this.cancelButton,onSelect:()=>this._loadNextPage(null),onSearch:this._loadNextPage.bind(this),onCountryChange:e=>{this._setCountryID(e,!0)}}),e.on("back",this._onBack.bind(this)),e.on("apply",this._onApply.bind(this)),e.on("cancel",this._onCancel.bind(this))),this.loadPage("categories"),e}_loadCollectionsPage(){let e=this._pages.collections;return e||(e=this._pages.collections=this._contentFactory.createDataCollectionsPage({manager:this._manager,backButton:this.pageBackButton,applyButton:this._manager.multipleSelectIsAllowed()?this.applyButton:null,cancelButton:this.cancelButton,onSelect:this._loadNextPage.bind(this)}),e.on("back",this._loadPreviousPage.bind(this)),e.on("apply",this._onApply.bind(this)),e.on("cancel",this._onCancel.bind(this))),e.lastDataCollectionID=this._manager.variableQuery.dataCollectionID,this.loadPage("collections"),e}_loadVariablesPage(e){let t=this._pages.variables;return t||(t=this._pages.variables=this._contentFactory.createVariablesPage({manager:this._manager,backButton:this.pageBackButton,applyButton:this._manager.multipleSelectIsAllowed()?this.applyButton:null,cancelButton:this.cancelButton}),t.on("back",this._loadPreviousPage.bind(this)),t.on("apply",this._onApply.bind(this)),t.on("cancel",this._onCancel.bind(this))),t.searchResults=e,this.loadPage("variables"),t}loadPage(e){switch(e){case"categories":this._manager.variableQuery=this._manager.composeQuery();break;case"collections":this._manager.variableQuery=this._manager.composeQuery("categoryID")}super.loadPage(e),setTimeout((()=>{this._updateBreadcrumb(e)})),this.emit("pageLoaded",{pageName:e})}_updateBreadcrumb(e){if(this._breadcrumb.domNode)switch(e){case"categories":this._breadcrumb.domNode.style.display="none",this._breadcrumb.clearSelection();break;case"collections":this._breadcrumb.domNode.style.display="",this._breadcrumb.selectCategory(this._manager.getCategory());break;case"variables":this._breadcrumb.domNode.style.display="",this._isNonEmptyCategory(((e,t)=>{if(e||!t){let e=this._manager.getDataCollection();e||(e=this._prepareNoDCBreadcrumbInfo()),this._breadcrumb.selectDataCollection(e,t)}else this._breadcrumb.selectCategory(t)}))}}_prepareNoDCBreadcrumbInfo(){const e=this._manager.variableQuery;return{title:this._manager.variableQuery.favorites?(0,i.a)("DataBrowser").DataVariablesPage.favoriteVariablesTitle:e&&e.searchString&&"*"!==e.searchString?(0,i.s)((0,i.a)("DataBrowser").DataVariablesPage.customSearch,{searchKey:e.searchString}):(0,i.a)("DataBrowser").DataVariablesPage.allVariablesTitle}}_isNonEmptyCategory(e){(0,i.w)(this._manager.getCategory()).then((t=>{const r=!!t&&(this.variables.getPopularVariables(t).length||t.dataCollections.length>1);e(!!r,t)}))}_onLimit(){setTimeout((()=>{this.emit("limit",{selectionLimit:this._manager.selectionLimit})}))}_onBack(){this.emit("back")}_onApply(){1===this._manager.selectionLimit&&(this._updateSelectionFromManager(),this._manager.selection.length&&(this._manager.selection=[])),this.emit("apply",{selection:this.selection,variableQuery:this.variableQuery})}_onCancel(){this.emit("cancel")}_onSelect(){this.emit("select")}};function Rl(e,t){e.icon.className="DataCategoryItemIcon "+jl(t),e.icon.setAttribute("categoryId",t?t.id:""),e.children[1]&&(e.children[1].textContent=t&&t.name||"")}function jl(e){let t="string"==typeof e?e:e&&e.id,r="esri4GEDataCategoryImage";return t&&(t=t.toLowerCase().replace(/(\s|_|\d|\(|\))/g,""),t=t.split(/\W+/)[0],t&&(r+=" esri4GEDataCategoryImage_"+t)),r}s([Ee()],El.prototype,"applyButton",void 0),s([Ee()],El.prototype,"backButton",void 0),s([Ee()],El.prototype,"pageBackButton",void 0),s([Ee()],El.prototype,"cancelButton",void 0),s([Ee({constructOnly:!0})],El.prototype,"allowHierarchies",void 0),s([Ee({constructOnly:!0})],El.prototype,"countryBox",void 0),s([Ee({constructOnly:!0})],El.prototype,"variables",void 0),s([Ee({constructOnly:!0})],El.prototype,"selectionLimit",void 0),s([Ee({constructOnly:!0})],El.prototype,"displayAllGlobalVariables",void 0),s([Ee()],El.prototype,"variableQuery",void 0),s([Ee({constructOnly:!0})],El.prototype,"favorites",void 0),s([Ee({constructOnly:!0})],El.prototype,"variableInfo",void 0),s([Ee({constructOnly:!0})],El.prototype,"shoppingCart",void 0),s([Ee({constructOnly:!0})],El.prototype,"allowDerivativeVariables",void 0),s([Ee({constructOnly:!0})],El.prototype,"allowMultipleSelectInGroup",void 0),s([Ee()],El.prototype,"title",null),s([Ee({value:[]})],El.prototype,"selection",null),s([Ee()],El.prototype,"countryID",null),s([Ee()],El.prototype,"hierarchyID",null),El=s([St()],El);let Fl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString='\n  <div class="Breadcrumb BreadcrumbHeight">\n    <div class="Breadcrumb_Line" data-attach-point="_connect" style="display: none;"></div>\n    <div class="Breadcrumb_Line Breadcrumb_AnimatedConnect" data-attach-point="_animatedConnect" style="display: none;"></div>\n    <div class="Breadcrumb_AllCategories esri4GEDataCategoryImage_AllCategories" data-attach-point="_allCategoriesDiv">&nbsp;</div>\n    <div data-attach-point="_dcIcon" style="display: none;"></div>\n    <div class="Breadcrumb_Variables DataCollectionButton esriGETrimWithEllipses" data-attach-point="_varsNode" style="display: none;"></div>\n  </div>',this._categoryClickAllowed=!1,this._animationRate=700}postCreate(){Ei(this._allCategoriesDiv,"click",this._onCategoriesClick.bind(this)),Ei(this._dcIcon,"click",this._onDCsClick.bind(this))}selectCategory(e){this._lastDataCollection?this._updateDataCollection():this.clearSelection(),e&&this._selectCategory(e,this._updateCategory.bind(this))}selectDataCollection(e,t){t?this._updateConnectionLine("Breadcrumb_Connect"):this.clearSelection(),this._selectCategory(t,(t=>{this._updateCategory(t,!0),(0,i.w)(e).then(this._updateDataCollection.bind(this))}))}_selectCategory(e,t){(0,i.w)(e).then((e=>{(0,i.w)(this.flyAnim.getPromise()).then((()=>{t(e)}))}))}clearSelection(){this._updateCategory(),this._updateDataCollection()}_updateCategory(e,t=!1){this._categoryClickAllowed=t,this._lastCategory=e,e&&(this._dcIcon.className="Breadcrumb_DataCollections",this._updateCategoryIcon(this._dcIcon,e),oi(this._dcIcon,"esriGEClickable",t),t||this._updateConnectionLine("Breadcrumb_ConnectDC")),this._dcIcon.style.display=e?"":"none"}_updateCategoryIcon(e,t){ri(e,jl(t))}_updateDataCollection(e){let t;this._lastDataCollection=e,e&&(oi(this._varsNode,"Breadcrumb_VariablesNoDC",!this._lastCategory),this._varsNode.innerHTML=e.title),this._varsNode.style.display=e?"":"none",t=e?this._lastCategory?"Breadcrumb_ConnectDCVars":"Breadcrumb_ConnectVars":this._lastCategory?"Breadcrumb_Connect":"",this._updateConnectionLine(t)}_updateConnectionLine(e){if(this._stopAnimation(),e){const t="Breadcrumb_Connect"===e;si(this._connect,e,"Breadcrumb_Connect Breadcrumb_ConnectDC Breadcrumb_ConnectDCVars Breadcrumb_ConnectVars"),this._connect.style.display="",this._animateConnect(mi(this._connect),t)}else this._connect.style.display="none",this._animatedConnect.style.display="none"}_animateConnect(e,t=!1){if(t)return ui(this._animatedConnect,{width:e.w+"px",height:e.h+"px"}),void(this._animatedConnect.style.display="");let r;this._animatedConnect.style.display?(r={w:0,h:0},ui(this._animatedConnect,{width:"0",height:"0"}),this._animatedConnect.style.display=""):r=mi(this._animatedConnect),this._doAnimation(r,e)}_doAnimation(e,t){this._animation=Ta({obj:this._animatedConnect.style,duration:(t.w-e.w)/this._animationRate*1e3,properties:{width:{start:e.w,end:t.w,units:"px"}},onEnd:()=>{this._animation=Ta({obj:this._animatedConnect.style,duration:(t.h-e.h)/this._animationRate*1e3,properties:{height:{start:e.h,end:t.h,units:"px"}}})}})}_stopAnimation(){this._animation&&this._animation.cancel()}_onCategoriesClick(){this.onCategoriesClick()}onCategoriesClick(){}_onDCsClick(){this._categoryClickAllowed&&this.onDCsClick()}onDCsClick(){}};s([Ee()],Fl.prototype,"flyAnim",void 0),s([Ee()],Fl.prototype,"onCategoriesClick",null),s([Ee()],Fl.prototype,"onDCsClick",null),Fl=s([St()],Fl);let Bl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString='\n  <div class="esri4GEPagination">\n    <div class="esri4GEPagination_PageAndArrows">\n    <div class="esri4GEPagination_Items">\n      <div data-attach-point="_itemsNode" class="esri4GEPaginationItemsNode"></div></div>\n      <div data-attach-point="_backNode" class="esri4GEPagination_Triangle esri4GEPagination_TriangleBack" style="display: none;"></div>\n      <div data-attach-point="_forwardNode" class="esri4GEPagination_Triangle esri4GEPagination_TriangleForward" style="display: none;"></div>\n    </div>\n    <div data-attach-point="_bulletsNode" class="esri4GEPagination_Bullets"></div>\n  </div>',this.autoCenter=!1,this.scrollAnimation=!0,this.cyclicPagination=!1,this.alwaysShowArrows=!1,this._pageCount=0,this._pageSize=0}set items(e){this._setItems(e)}set currentPage(e){this.setCurrentPage(e,!1)}postCreate(){this._animation=new zi,Ei(this._backNode,"click",(()=>{this.setCurrentPage("prev",!1)})),Ei(this._forwardNode,"click",(()=>{this.setCurrentPage("next",!1)}))}createItemContainer(){throw new Error("Not implemented")}updateItemContainer(e,t){}resize(e){let t,r,i,s,o,n,a;this._animation.finish();const l=this.items;if(!l||!l.length)return void(this.items=[]);const c=this._itemsNode.parentNode;if(!c||!c.clientHeight)return;const h=this._parseAutoCenterOption(this.autoCenter);h.type&&ui(c,"padding","0px");let u=this._itemsNode.firstChild;function d(){return c.scrollHeight-2>c.clientHeight}u||(u=_i("div",null,this._itemsNode),ri(u,"esri4GEPaginationItemsNodeChildDiv")),"stretch"===h.type&&(this._itemMargins={},this._emptyNode(u));const p=u.children;for(;!d()&&(h.type||p.length<l.length);)t=this.createItemContainer(),Ei(t,"click",this._onItemClick.bind(this,t)),u.appendChild(t);for(;d()&&p.length>1;)this._destroyNode(u.lastChild);let f,y,m=p.length;if(h.type){t=u.firstChild;const e=di(t);a=function(e,t){const r=yi(e,t||di(e));return{l:e.offsetLeft-r.l,t:e.offsetTop-r.t,w:e.offsetWidth+r.w,h:e.offsetHeight+r.h}}(t,e),"stretch"===h.type&&(s=yi(t,e)),r=Math.max(1,Math.floor(u.clientHeight/a.h)),i=u.clientHeight/r,r=Math.max(Math.floor(c.clientHeight/i),r),o=Math.max(1,m/r),h.heightLimit&&r>h.heightLimit&&(r=h.heightLimit),h.widthLimit&&o>h.widthLimit&&(o=h.widthLimit),m=r*o,i=a.h,f=Math.max(c.clientWidth-o*a.w,0),y=Math.max(c.clientHeight-r*a.h,0)}const g=this._pageSize=Math.min(m,l.length),v=this._pageCount=Math.ceil(this.items.length/g);if(h.type&&h.height){if("stretch"===h.type&&(n=Math.floor(y/r),y-=n*r,this._itemMargins.marginTop=(Math.floor(n/2)+s.t).toString()+"px",this._itemMargins.marginBottom=(Math.ceil(n/2)+s.b).toString()+"px",i+=n),1===v&&h.allowVerticallyCenter){const e=Math.floor((g-1)/o)+1;e<r&&(y+=i*(r-e))}ui(c,{paddingTop:Math.floor(y/2).toString()+"px",paddingBottom:"0"})}this._set("currentPage",this._coerceCurrentPage("number"==typeof e?e:this.currentPage));let _=0,b=g*this.currentPage;for(;_<g&&b<l.length;){t=p[_++];const e=l[b++];this.updateItemContainer(t,e),this.onNodePlaced(t,e)}for(;_<p.length;)this._destroyNode(u.lastChild);if(h.type&&h.width){"stretch"===h.type?(n=Math.floor(f/o),f-=n*o,this._itemMargins.marginLeft=(Math.floor(n/2)+s.l).toString()+"px",this._itemMargins.marginRight=(Math.ceil(n/2)+s.r-1).toString()+"px"):n=0,1===v&&g<o&&!h.preventSingleRowCenter&&(f=Math.max(c.clientWidth-(a.w+n)*g,0));const e=Math.floor(f/2).toString()+"px";ui(c,{paddingLeft:e,paddingRight:e})}for(_=this._itemMargins?0:p.length;_<p.length;)ui(p[_++],this._itemMargins);if(this._bulletsNode&&(this._bulletsNode.innerHTML="",v>1))for(let e=0;e<v;e++){const t=_i("span",{class:"esri4GEPagination_Bullet",innerHTML:"&nbsp;"},this._bulletsNode);(e=>{Ei(t,"click",(()=>{this.currentPage=e,this.onPageChangedManually({currentPage:this.currentPage})}))})(e)}this._updateNavigationControls()}_parseAutoCenterOption(e){if(!e)return{};const t={type:"center"};"string"!=typeof e&&(e="");let r=!0;for(;r;){switch(e.charAt(0)){case"$":t.preventSingleRowCenter=!0;break;case"@":t.allowVerticallyCenter=!0;break;default:r=!1}r&&(e=e.substr(1))}switch(e){case"width":return t.width=!0,t;case"height":return t.height=!0,t;default:if(0!==e.indexOf("stretch"))return t.width=t.height=!0,t}t.type="stretch";let i=(e=e.substr(7)).indexOf(":");const s=i<0?e:e.substr(0,i);switch(e=i<0?"":e.substr(i+1),s){case"-width":t.width=!0;break;case"-height":t.height=!0;break;default:t.width=t.height=!0}if(!e)return t;const o=e.split(",");return i=0,["width","height"].forEach((e=>{if(!t[e])return;const r=Number(o[i++]);!isNaN(r)&&r>0&&(t[e+"Limit"]=r)})),t}_onItemClick(e){this.onSelect(e)}_coerceCurrentPage(e){return e>=this._pageCount&&(e=this._pageCount-1),e<0&&(e=0),e}_updateNavigationControls(){const e=this.currentPage,t=this._pageCount<=1,r=t&&!this.alwaysShowArrows?"none":"",i=["esri4GEPagination_TriangleDisabled","esri4GEPagination_TriangleEnabled"];let s;if(this._backNode&&(s=t||0===e&&!this.cyclicPagination?0:1,si(this._backNode,i[s],i[1-s]),this._backNode.style.display=r),this._forwardNode&&(s=t||e===this._pageCount-1&&!this.cyclicPagination?0:1,si(this._forwardNode,i[s],i[1-s]),this._forwardNode.style.display=r),this._bulletsNode){const t=this._bulletsNode.children;for(let r=0;r<t.length;r++)r===e?ri(t[r],"esri4GEPagination_BulletCurrent"):ii(t[r],"esri4GEPagination_BulletCurrent")}}_setItems(e){this._set("items",e),this._emptyNode(this._itemsNode),this._bulletsNode&&(this._bulletsNode.innerHTML=""),this._set("currentPage",0),this._pageCount=0,this._updateNavigationControls()}selectPageByItemIndex(e,t){e<0||!this.items||e>=this.items.length||this._pageCount<=1||this.setCurrentPage(Math.floor(e/this._pageSize),t)}selectItem(e){const t=this.items.indexOf(e);if(-1===t)return;if(t<0||!this.items||t>=this.items.length||this._pageCount<=1)return;const r=this.items.length%this._pageSize,i=this._itemsNode.firstChild.children[r];i&&this.onSelect(i)}navigateToItem(e){const t=this.items.indexOf(e);this.selectPageByItemIndex(t,!0)}setCurrentPageNoAnimation(e){this.setCurrentPage(e,!0)}setCurrentPage(e,t=!1){let r;if(this._animation.finish(),"next"===e?(r="forward",e=this.currentPage+1,this.cyclicPagination&&e===this._pageCount&&(e=0)):"prev"===e?(r="backward",e=this.currentPage-1,this.cyclicPagination&&-1===e&&(e=this._pageCount-1)):r=!0===this.scrollAnimation?"fade1":this.scrollAnimation,!0===t&&(r=""),e=this._coerceCurrentPage(e),this.currentPage===e)return;const i=this.items||[],s=this._itemsNode;let o=0,n=this._pageSize*e;const a=this._itemsNode.firstChild,l=_i("div");ri(l,"esri4GEPaginationItemsNodeChildDiv");const c=[];for(;o++<this._pageSize&&n<i.length;){const e=this.createItemContainer();Ei(e,"click",this._onItemClick.bind(this,e)),this._itemMargins&&ui(e,this._itemMargins),l.appendChild(e);const t=i[n++];this.updateItemContainer(e,t),c.push({node:e,item:t})}switch(r){case"forward":this._slideAnimation(s,a,l,!0,c);break;case"backward":this._slideAnimation(s,a,l,!1,c);break;default:if(r&&(r=r?"_"+r+"Animation":null,"function"==typeof this[r])){this[r](s,a,l,e>this.currentPage,c);break}this._emptyNode(s),s.appendChild(l),this._notifyNodesPlaced(c)}this._set("currentPage",e),this._updateNavigationControls(),this.onPageChanged({currentPage:this.currentPage})}_notifyNodesPlaced(e){e.forEach((e=>{this.onNodePlaced(e.node,e.item)}))}_slideAnimation(e,t,r,i,s){i?e.appendChild(r):e.insertBefore(r,e.firstChild),this._notifyNodesPlaced(s),e.parentNode.style.overflow="hidden",this._animation.start([{node:e,classes:["esri4GEPagination_SlideAnim",i?"Anim_SlideStart":"Anim_SlideEnd"]}],t).then((()=>{e.parentNode.style.overflow=""}))}_fade1Animation(e,t,r,i,s){e.appendChild(r),this._notifyNodesPlaced(s),this._animation.start([{node:t,classes:["esri4GEPagination_FadeAnim","Anim_FadeOut"]},{node:r,classes:["esri4GEPagination_FadeAnim","Anim_FadeIn"]}],t)}_fade2Animation(e,t,r,i,s){const o=this._animation;o.start([{node:t,classes:["esri4GEPagination_FadeAnim","Anim_FadeOut"]}],t).then((()=>{e.appendChild(r),this._notifyNodesPlaced(s),o.start([{node:r,classes:["esri4GEPagination_FadeAnim","Anim_FadeIn"]}],t)}))}_destroyNode(e){e&&e.parentNode&&e.parentNode.removeChild(e)}_emptyNode(e){e&&(e.innerHTML="")}getNumShownItems(){return this._itemsNode.children[0]&&this._itemsNode.children[0].children.length}onNodePlaced(e,t){}onSelect(e){}onPageChanged(e){}onPageChangedManually(e){}};s([Ee()],Bl.prototype,"autoCenter",void 0),s([Ee()],Bl.prototype,"scrollAnimation",void 0),s([Ee()],Bl.prototype,"cyclicPagination",void 0),s([Ee()],Bl.prototype,"alwaysShowArrows",void 0),s([Ee()],Bl.prototype,"items",null),s([Ee({value:0})],Bl.prototype,"currentPage",null),s([Ee()],Bl.prototype,"createItemContainer",null),s([Ee()],Bl.prototype,"updateItemContainer",null),s([Ee()],Bl.prototype,"onNodePlaced",null),s([Ee()],Bl.prototype,"onSelect",null),s([Ee()],Bl.prototype,"onPageChanged",null),s([Ee()],Bl.prototype,"onPageChangedManually",null),Bl=s([St()],Bl);let zl=class extends _n{constructor(e,t,r){super(e,t,r),this._templateString='<div class="esri4GEDataBrowser_CountryBoxContainer"><div class="DataBrowser_CountryBox" data-attach-point="_divCountrySelect"><calcite-select id="calciteCountrySelect" class="countrySelect calciteSelect" lang="he" /></div><div class="esri4GEDataBrowser_CountryBoxContainer" data-attach-point="_divHierarchySelect"><calcite-select id="calciteHierarchySelect" class="calciteSelect hierarchySelect" /></div></div>',this.allowHierarchies=!1,this._countries={}}postCreate(){this._countrySelectCalcite=this.domNode.querySelector("#calciteCountrySelect"),this._countrySelectCalcite.addEventListener("calciteSelectChange",(e=>{this._tryShowHierarchies(),this.onChange()})),this._hierarchySelectCalcite=this.domNode.querySelector("#calciteHierarchySelect"),this._hierarchySelectCalcite.addEventListener("calciteSelectChange",(e=>{this.onChange()})),this._updateHierarchiesVisibility()}setCountries(e){const t=document.createElement("calcite-option");t.label=(0,i.a)("DataBrowser").CountrySelect.global,t.value=this.globalCountryID,this._countrySelectCalcite.appendChild(t),e.map((e=>{this._countries[e.id]=e;const t=document.createElement("calcite-option");t.value=e.id,t.label=e.name,this._countrySelectCalcite.appendChild(t)}))}_tryShowHierarchies(){if(this._hierarchySelectCalcite.innerHTML="",!this.allowHierarchies)return;const e=this._countries[this._countrySelectCalcite.value],t=e&&e.hierarchies;if(!t||t.length<2)return void this._updateHierarchiesVisibility();const r=e.defaultDatasetID.toUpperCase();t.some((e=>!!e.datasets.some((e=>e.toUpperCase()===r))&&(this._defaultHierarchyID=e.ID,!0)));const s=new Array;if(!e.disableMultiHierarchySupport){const e=document.createElement("calcite-option");e.label=(0,i.a)("DataBrowser").CountrySelect.allHierarchies,e.value="all",s.push(e)}t.forEach((e=>{const t=document.createElement("calcite-option");t.label=e.alias,t.value=e.ID,s.push(t)})),s.forEach((e=>{this._hierarchySelectCalcite.appendChild(e)})),this._hierarchySelectCalcite.value=e.disableMultiHierarchySupport?this._defaultHierarchyID:"all",this._updateHierarchiesVisibility()}_updateHierarchiesVisibility(){var e;e=this._divHierarchySelect,this._hierarchySelectCalcite.children.length?Ii(e):Ci(e)}getValue(){return{countryID:this._countrySelectCalcite.value,hierarchyID:this._hierarchySelectCalcite.children.length&&"all"!==this._hierarchySelectCalcite.value&&this._hierarchySelectCalcite.value||null}}setValue(e){this._countrySelectCalcite.value=e.countryID,this._tryShowHierarchies();const t=this._countries[e.countryID];this._hierarchySelectCalcite.value=e.hierarchyID||t.disableMultiHierarchySupport?this._defaultHierarchyID:"all"}onChange(){}};s([Ee()],zl.prototype,"globalCountryID",void 0),s([Ee()],zl.prototype,"allowHierarchies",void 0),s([Ee()],zl.prototype,"onChange",null),zl=s([St()],zl);let Ul=class extends _n{get value(){return this._textBox&&this._textBox.value}set value(e){this._set("value",e),this._textBox&&(this._textBox.value=e)}set prompt(e){this._set("prompt",e),this._textBox&&(this._textBox.placeholder=e)}constructor(e,t,r){super(e,t,r),this._templateString='<calcite-input-text id="calciteSearchTextBox" icon="search" />'}postCreate(){this._textBox=this.domNode.parentElement.querySelector("#calciteSearchTextBox"),this._textBox.placeholder=this.prompt,this._textBox.addEventListener("calciteInputTextChange",(e=>{this.value=this._textBox.value,this._onSearch()}))}showTooltip(e){vl(this.domNode,e,{position:["above","below"]})}hideTooltip(){_l(this.domNode)}focus(){this._textBox.focus()}_onSearch(){this.value?this.onSearch():this._textBox&&this._textBox.focus()}onSearch(){}};function Gl(e){e.style.position="absolute",ri(e,"esri4GEGridCell_Measure");const t=e.scrollHeight;return ii(e,"esri4GEGridCell_Measure"),t}s([Ee()],Ul.prototype,"_textBox",void 0),s([Ee({dependsOn:["_textBox.value"]})],Ul.prototype,"value",null),s([Ee()],Ul.prototype,"prompt",null),s([Ee()],Ul.prototype,"onSearch",null),Ul=s([St()],Ul);let ql=class extends _n{constructor(e,t,r){super(e,t,r),this.rows=[]}postCreate(){ri(this.domNode,"esri4GELayoutGrid")}resize(){const e=[106];let t,r;for(t=1;t<this.rows.length;t++)e.push(0);const i=this._getChildren();for(ri(this.domNode,"esri4GEGrid_Measure"),t=0;t<i.length;t++){r=i[t];const s=Gl(r);s>e[t]&&(e[t]=s)}const s=mi(this.domNode).h;ii(this.domNode,"esri4GEGrid_Measure");const o=function(e,t,r){let i,s=0;for(i=0;i<e.length;i++)switch(t[i]){case"auto":r-=e[i];break;case"stretch":case"stack":s++}if(s>1)throw new Error("Multiple rows with flexible heights are not supported");const o=[0];for(i=0;i<e.length;i++){let s;switch(t[i]){case"auto":s=e[i];break;case"stretch":s=r;break;case"stack":s=Math.min(r,e[i])}o.push(o[i]+s)}return o}(e,this.rows,s);for(t=0;t<i.length;t++)r=i[t],r.style.top=o[t]+"px",r.style.height=o[t+1]-o[t]+"px";this._filler||(this._filler=_i("div",null,this.domNode,"first")),this._filler.style.height=o[o.length-2]+"px"}_getChildren(){const e=[];for(let t=0;t<this.domNode.children.length;t++)this.domNode.children[t]!==this._filler&&e.push(this.domNode.children[t]);return e}};s([Ee()],ql.prototype,"rows",void 0),ql=s([St()],ql);let Vl=class extends ql{set pageIsActive(e){}set stacking(e){switch(e){case"stretch":case"stack":this.rows[1]=e}}constructor(e,t,r){super(e,t,r),this.rows=["auto","auto","auto"]}postCreate(){super.postCreate(),this._addButtons()}_addButtons(){const e=this;function t(t){let r=e[t+"Button"];if(!0===r&&(r=(0,i.a)("DataBrowser").WizardButtons[t]),r){const i={id:t,label:r,onClick:()=>{!i.disabled&&e.emit(t)},node:null,disabled:!1};e._buttonInfos.push(i)}}this._buttonInfos=[],t("cancel"),t("apply"),t("back"),this._buttonInfos.length?this._addButtonsPane():this._buttonsNode&&(this._buttonsNode.style.display="none")}_addButtonsPane(){this._buttonsNode||(this._buttonsNode=_i("div",{class:"esri4GEWizard_Buttons"},this.domNode.children[2]));for(let e=0;e<this._buttonInfos.length;e++){const t=this._buttonInfos[e],r=_i("div",{class:"esri4GEWizard_Button",textContent:t.label||""},this._buttonsNode);t.onClick&&Ei(r,"click",t.onClick),t.node=r}}_setButtonEnabled(e,t){const r=this._buttonInfos.filter((t=>t.id===e))[0];r&&(r.disabled=!t,oi(r.node,"disabled",r.disabled))}_showProgress(e){return(0,i.w)(Ml(this._progressDiv||this.domNode,e))}};s([Ee()],Vl.prototype,"rows",void 0),s([Ee()],Vl.prototype,"pageIsActive",null),s([Ee()],Vl.prototype,"backButton",void 0),s([Ee()],Vl.prototype,"applyButton",void 0),s([Ee()],Vl.prototype,"cancelButton",void 0),s([Ee()],Vl.prototype,"stacking",null),Vl=s([St()],Vl);const Hl=()=>(0,i.a)("DataBrowser").DataCategoriesPage;let $l=class extends Vl{set pageIsActive(e){this._set("pageIsActive",e),this._searchTextBox&&(this._searchTextBox.value=""),e&&this.changeCountry(this.manager.variableQuery.countryID)}set items(e){this._pagination.items=e,this.resize()}constructor(e,t,r){super(e,t,r),this._templateString='\n  <div class="DataCategoriesPage">\n    <div>\n      <div class="DataCategoriesPage_Country" data-attach-point="_divCountrySelect"></div>\n      <div class="DataCategoriesPage_Search" data-attach-point="_txbSearchDiv"></div>\n    </div>\n    <div>\n      <div class="DataCategoriesPage_Pagination">\n        <div data-attach-point="_paginationDiv"></div>\n      </div>\n      <div data-attach-point="_progressDiv"></div>\n    </div>\n    <div>\n      <div class="esri4GEWizard_Link DataCategoriesPage_ShowFavorites" data-attach-point="_spnShowFavorites"></div>\n    </div>\n  </div>',this.countryBox=!0,this.allowHierarchies=!1,this._innerChange=!1}postCreate(){super.postCreate(),this.countryBox&&this._getVariableStore().countries&&this._divCountrySelect&&(this._countrySelect=!0===this.countryBox?new zl:"object"==typeof this.countryBox&&this.countryBox.domNode?this.countryBox:null,this._countrySelect&&(this._countrySelect.globalCountryID=this._getVariableStore().globalCountryID,this._countrySelect.allowHierarchies=this.allowHierarchies,this._countrySelect.placeAt(this._divCountrySelect),this._countrySelect.onChange=()=>{this._changeCountry(this._countrySelect.getValue())})),this.countryBox=!!this._countrySelect,this._divCountrySelect&&(this._divCountrySelect.style.display=this.countryBox?"":"none"),this._searchTextBox=new Ul({prompt:Hl().search,onSearch:this._search.bind(this)}).placeAt(this._txbSearchDiv),this._pagination=new Bl({autoCenter:!0,scrollAnimation:"fade2",createItemContainer:()=>function(e,t,r){const i=_i("div",{class:"DataCategoryItem esriGEClickable"},void 0),s=_i("div",{class:"DataCategoryItemIconMargins"},i);return i.icon=_i("div",null,s),_i("div",{class:"DataCategoryItemLabel esriGETrimWithEllipses"},i),Rl(i,void 0),i}(),updateItemContainer:(e,t)=>{this._updateCategoryNode(e,t)},onSelect:this._onItemClick.bind(this)}).placeAt(this._paginationDiv),Ei(this._spnShowFavorites,"click",this._showFavorites.bind(this)),this.manager.watch("selection",this._updateApplyButtonAvailability.bind(this)),this._updateApplyButtonAvailability(),this.countryBox?(0,i.w)(this._showProgress(this._getCountries())).then(this._onCountriesResponse.bind(this)):this._getCategories(!0)}_updateApplyButtonAvailability(){this._setButtonEnabled("apply",!!this.manager.selection.length)}_getVariableStore(){return this.manager.variables}changeCountry(e){return this._changeCountryPromise=(0,i.w)(this._changeCountryPromise).then((()=>(this._updateFavorites(),this.countryBox?(0,i.w)(this._getCountries()).then((()=>{this._setCountry(e)})):this._changeCountry(this._toCountryBoxID(e)))))}_getCountries(){return!this._getCountriesQuery&&this.countryBox&&(this._getCountriesQuery=(0,i.w)(this._getVariableStore().countries.query())),this._getCountriesQuery}_onCountriesResponse(e){this._countrySelect.setCountries(e),this._setCountry(this.manager.variableQuery.countryID)}_setCountry(e){const t=this._toCountryBoxID(e);return this._fullValueToQName(t)!==this._fullValueToQName(this._countrySelect.getValue())?(this._innerChange=!0,this._countrySelect.setValue(t),this._innerChange=!1,this._changeCountry(this._countrySelect.getValue())):null}_changeCountry(e){if(this._innerChange||!this.domNode)return null;const t=this._toCountryID(e);this.onCountryChange(t);const r=!this._paginationCountryID||this._paginationCountryID===this._fullValueToQName(e);return this._paginationCountryID=this._fullValueToQName(e),r||(this.manager.variableQuery={countryID:t}),this._getCategories(r)}_toCountryBoxID(e){return this._qNameToFullName(e||this._getVariableStore().globalCountryID)||null}_toCountryID(e){return e.countryID===this._getVariableStore().globalCountryID?null:this._fullValueToQName(e)}_fullValueToQName(e){return e.countryID+(e.hierarchyID?"/"+e.hierarchyID:"")}_qNameToFullName(e){return{countryID:e.split("/")[0],hierarchyID:e.split("/")[1]||null}}_getCategories(e){let t=0;return e?t=this._pagination.currentPage:this.manager.selection=[],this.manager.categoryPageIndex=t,this._showProgress(this.manager.getCategories().then((t=>(this.items=t,this._paginationCountryID=this._fullValueToQName(this._countrySelect.getValue()),e&&this._pagination.setCurrentPageNoAnimation(this.manager.categoryPageIndex),(0,i.w)(this._getVariableStore().synchronize()).then(this._updateFavorites.bind(this))))))}_updateCategoryNode(e,t){Rl(e,t)}_updateFavorites(){this._spnShowFavorites&&(this._spnShowFavorites.textContent=this._getVariableStore().favorites&&this._getVariableStore().favorites.getItemsCount()?Hl().showFavorites:"")}resize(){super.resize(),this._pagination.resize()}_onItemClick(e){const t=e.icon.cloneNode(!0);ii(t,"DataCategoryItemIcon"),this.manager.flyAnim.fly(e.icon,"Breadcrumb_SelectCategory",null,t),this.manager.variableQuery.categoryID=t.getAttribute("categoryId"),this.onSelect()}onSelect(){}_showFavorites(){this.manager.variableQuery.favorites=!0,this.onSearch()}_search(){const e=this._searchTextBox.value;e?(this.manager.variableQuery.searchString=e,this._showProgress(this.manager.queryVariables().then((t=>{t.length?this._onSearch(t):(delete this.manager.variableQuery.searchString,this._searchTextBox.showTooltip((0,i.s)(Hl().noResults,{seachKey:e})),this._searchTextBox.focus())})))):this._searchTextBox.value=""}_onSearch(e){this.onSearch(e)}onSearch(e){}onCountryChange(e){}};s([Ee()],$l.prototype,"manager",void 0),s([Ee()],$l.prototype,"countryBox",void 0),s([Ee()],$l.prototype,"allowHierarchies",void 0),s([Ee()],$l.prototype,"pageIsActive",null),s([Ee()],$l.prototype,"items",null),s([Ee()],$l.prototype,"onSelect",null),s([Ee()],$l.prototype,"onSearch",null),s([Ee()],$l.prototype,"onCountryChange",null),$l=s([St()],$l);const Wl=(0,i.a)("DataBrowser").DataCollectionsPage;let Jl=class extends Vl{set pageIsActive(e){this._set("pageIsActive",e),this._grid&&(this._grid.setVariables([]),this._pagination.items=[],this._searchTextBox.value=""),e&&this._querySelectedCategory()}set items(e){if(this._pagination.items=e,this.resize(),this.lastDataCollectionID){const e=this._pagination.items;for(let t=0;t<e.length;t++)if(e[t].id===this.lastDataCollectionID){this._pagination.selectPageByItemIndex(t,!0);break}this.lastDataCollectionID=null}}constructor(e,t,r){super(e,t,r),this._templateString=`\n  <div class="DataCollectionsPage">\n    <div>\n      <div class="BreadcrumbHeight"></div>\n      <div class="DataCollectionsPage_Panel DataCollectionsPage_PanelTop">\n        <div class="esri4GEDataBrowserVarHeader DataCollectionsPage_Header" data-attach-point="_categoryName"></div>\n        <div class="DataCollectionsPage_Search" data-attach-point="_txbSearchDiv"></div>\n        <div class="esri4GEDataBrowserVarHeader DataCollectionsPage_Header">\n          ${Wl.mapPopVar}\n        </div>\n        <div data-attach-point="_divVariables" class="DataCollectionsPage_PopularVariables"></div>\n        <div class="esri4GEDataBrowserVarHeader DataCollectionsPage_Header">\n          ${Wl.keepBrowse}\n        </div>\n      </div>\n    </div>\n    <div class="DataCollectionsPage_ContentPane_DataCollectionContainer">\n      <div class="DataCollectionsPage_DataCollectionContainer">\n        <div data-attach-point="_paginationDiv"></div>\n      </div>\n      <div data-attach-point="_progressDiv"></div>\n    </div>\n    <div class="DataCollectionsPageBottomContainer">\n      <div class="DataCollectionsPage_Panel DataCollectionsPage_PanelBottom">\n        <div data-attach-point="_spnShowAll" class="esri4GEWizard_Link DataCollectionsPage_ShowAll"></div>\n      </div>\n    </div>\n  <div>`}postCreate(){super.postCreate(),this._searchTextBox=new Ul({prompt:(0,i.a)("DataBrowser").DataCollectionsPage.search,onSearch:this._search.bind(this)}).placeAt(this._txbSearchDiv),this._grid=this.manager.createVariableGrid({groupCategories:!1},this._divVariables),this._pagination=new Bl({autoCenter:!0,scrollAnimation:"slide",createItemContainer:()=>{const e=_i("div",{class:"DataCollectionButtonContainer"});return _i("div",{class:"DataCollectionButton esriGEClickable esriGETrimWithEllipses"},e),e},updateItemContainer:(e,t)=>{e.children[0].textContent=t.title,e.data=t},onSelect:this._onSelectCollection.bind(this)}).placeAt(this._paginationDiv),this.manager.watch("selection",this._updateApplyButtonAvailability.bind(this)),this._updateApplyButtonAvailability(),Ei(this._spnShowAll,"click",this._showAll.bind(this)),this._querySelectedCategory()}_updateApplyButtonAvailability(){this._setButtonEnabled("apply",!!this.manager.selection.length)}_querySelectedCategory(){this._showProgress((0,i.w)(this.manager.getCategory()).then((e=>{e&&this._showCategory(e)})))}_showCategory(e){this._prepareCategoryTitle(e),this._spnShowAll.textContent=(0,i.s)(Wl.showAll,{categoryName:e.name});const t=this.manager.variables.getPopularVariables(e,{sort:[{attribute:"popularity",descending:!0}],start:0,count:3});this._grid.setVariables(t);const r=this.manager.composeQuery("categoryID");(0,i.w)(this._getDataCollections(r,{sort:[{attribute:"title"}]})).then((e=>{this.items=e}))}_getDataCollections(e,t){return this.manager.variables.dataCollections.query(e,t)}_prepareCategoryTitle(e){this._categoryName.textContent=(0,i.s)(Wl.categoryName,{categoryName:e.name})}resize(){super.resize(),this._pagination.resize()}_onSelectCollection(e){const t=e.data;if(!Yr()){const t=fi(e),r=window.innerWidth-t.x-t.w;e.style.right=r+"px"}this._animateButtonClick(e),Yr()||(e.style.right="auto"),this.manager.variableQuery.dataCollectionID=t.id,this.onSelect()}_animateButtonClick(e){return this.manager.flyAnim.fly(e.children[0],"Breadcrumb_SelectDC")}_showAll(){this.manager.variableQuery.searchString="*",this.onSelect()}_search(){const e=this._searchTextBox.value;e?(this.manager.variableQuery.searchString=e,this._showProgress(this.manager.queryVariables().then((t=>{t.length?this._onSearch(t):(delete this.manager.variableQuery.searchString,this._searchTextBox.showTooltip((0,i.s)(Wl.noResults,{seachKey:e})))})))):this._searchTextBox.value=""}_onSearch(e){this.onSelect(e)}onSelect(e){}};function Ql(e,t,r,i){const s=null==e;if(s!==(null==t)){const e=s?-1:1;return(void 0===i?r:i)?-e:e}return s?0:null}function Zl(e,t,r,i){let s=Ql(e,t,r,i);if(null!==s)return s;let o=typeof e;switch(typeof t!==o&&(o=""),o){case"number":case"boolean":break;case"object":e=e.valueOf(),t=t.valueOf();break;default:return function(e,t,r,i){let s=Ql(e,t,r,i);return null!==s?s:(e=String(e),t=String(t),s=e.localeCompare(t),r?-s:s)}(String(e),String(t),r,i)}return s=e>t?1:e<t?-1:0,r?-s:s}function Yl(){return function(e,t){return r=>{const i="function"==typeof e?e:t=>{for(const r in e){const i=e[r];if(i&&"function"==typeof i.test){if(!i.test(t[r],t))return!1}else if(i!==t[r])return!1}return!0};let s=r.filter(i);const o=t&&t.sort;if(o&&s.sort("function"==typeof o?o:(e,t)=>{let r;for(let i=0;i<o.length;i++){r=o[i];const s=Zl(e[r.attribute],t[r.attribute],r.descending);if(0!==s)return s}return 0}),t&&(t.start||t.count)){const e=s.length;s=s.slice(t.start||0,(t.start||0)+(t.count||1/0)),s.total=e}return s}}}s([Ee()],Jl.prototype,"manager",void 0),s([Ee()],Jl.prototype,"lastDataCollectionID",void 0),s([Ee()],Jl.prototype,"pageIsActive",null),s([Ee()],Jl.prototype,"items",null),s([Ee()],Jl.prototype,"onSelect",null),Jl=s([St()],Jl);class Kl extends Qo{constructor(e,t){super(),this.idProperty="id",this.autoIdentify=!0,this.queryEngine=Yl(),t&&t.idProperty&&(this.idProperty=t.idProperty),t&&void 0!==t.autoIdentify&&(this.autoIdentify=t.autoIdentify),this.root={label:t&&t.rootLabel,deepness:-1,selectCount:0,leafCount:0,children:e||[]},this._hash={},this.idProperty&&this.autoIdentify&&(this._autoId=1),this._initializeNode(this.root,0),this.data=this.root.children}_initializeNode(e,t){if(e.selected=!!e.selected,!e.children)return"number"!=typeof e.leafCount&&(e.leafCount=1),void(e.selectCount=e.selected?e.leafCount:0);e.selectCount=0,e.leafCount=0,e.children.forEach((r=>{this._registerNode(r),r.parent=e,r.deepness=t,this._initializeNode(r,t+1),e.selectCount+=r.selectCount,e.leafCount+=r.leafCount})),e.selectCount?e.selectCount===e.leafCount&&(e.selected=!0):e.selected=!1}isOwned(e,t=!1){return!t&&e===this.root||this.get(this.getIdentity(e))===e}_registerNode(e){this._autoId&&void 0===e[this.idProperty]&&(e[this.idProperty]=this._autoId++),this.idProperty&&(this._hash[e[this.idProperty]]=e)}_unregisterNode(e){this.isOwned(e,!0)&&delete this._hash[e[this.idProperty]]}clear(){this.root.children.length&&(this.root.children.forEach((e=>{this._unbindNode(e)})),this.data=this.root.children=[])}destroy(){this.clear()}_unbindNode(e){e.children&&e.children.forEach((e=>{delete e.parent,this._unbindNode(e)})),this._unregisterNode(e),e.parent&&(this._incrementCounts(e.parent,-e.selectCount,-e.leafCount),delete e.parent)}removeNodes(e,t=!1){e&&e.slice().forEach((e=>{if(!this.isOwned(e,!0))return;const t=e.parent,r=t.children.indexOf(e);r>=0&&t.children.splice(r,1),this._unbindNode(e)})),!t&&this.emit("updated")}addNodes(e,t,r=!1){if(t){if(!this.isOwned(t)||!t.children)return!1}else t=this.root;const i=t.deepness+1;let s=0,o=0;return e.forEach((e=>{this.isOwned(e)||(t.children.push(e),this._registerNode(e),e.parent=t,e.deepness=i,this._initializeNode(e,i+1),s+=e.selectCount,o+=e.leafCount)})),this._incrementCounts(t,s,o),!r&&this.emit("updated"),!0}select(e,t){return this.changeSelect(e,!0,t)}deselect(e){this.changeSelect(e,!1)}changeSelect(e,t,r){if(r=r||this.root.leafCount,!e)return!1;const i=((t=!!t)?e.leafCount:0)-e.selectCount,s=i<0||this.root.selectCount+i<=r;return e.children?(s&&(e.selected=t),e.children.forEach((e=>{this.changeSelect(e,t,r)})),s):(s&&(e.selected=t,i&&this._incrementCounts(e,i)),s)}_incrementCounts(e,t,r){e.selectCount+=t,r&&(e.leafCount+=r),e.selectCount?e.selectCount===e.leafCount&&(e.selected=!0):e.selected=!1,e.parent&&this._incrementCounts(e.parent,t,r)}getSelectionState(e){return!!this.isOwned(e)&&(e.selectCount&&e.selectCount!==e.leafCount?"mixed":e.selected=!!e.selectCount)}getSelectedNodes(e){return this.getDescendingNodes(this.root,!0,e)}getDescendingNodes(e,t,r){if(!this.isOwned(e))return[];const i=[];return this._collectNodes(e.children,i,t,r),i}_collectNodes(e,t,r,i){e.forEach((e=>{const s=null==r?e.leafCount:r?e.selectCount:e.leafCount-e.selectCount;s&&(!e.children||!i&&s===e.leafCount?t.push(e):this._collectNodes(e.children,t,r,i))}))}inspectChildren(e,t,r,i){i&&(t=t.bind(i));let s=(e=e||this.root).children;return s&&r&&(s=s.slice(),s.sort(r)),s.every((e=>{const i=t(e);return null!==i&&(!1===i||!e.children||this.inspectChildren(e,t,r))}))}updateExpandedNodes(e,t){for(const t in this._hash){const r=this._hash[t];this.updateExpand(r,!!e[t])}this._updateOddEven(null,t)}updateExpand(e,t,r=!1,i){if(!e)return null;let s=!1;e.children&&e.expanded!==t&&(s=!0,e.expanded=t);const o={};return s&&r&&this._updateOddEven(o,i),o}_updateOddEven(e,t){let r=!0;this.inspectChildren(null,(t=>(!1!==t.visible&&(r=!r),e&&t.isOdd!==r&&(e[this.getIdentity(t)]=r),t.isOdd=r,!(!t.children||!t.expanded))),t,this)}isOdd(e){return e&&e.isOdd}get(e){return this._hash[e]}getIdentity(e){return this.idProperty?e[this.idProperty]:null}query(e,t){return this._query(this.data,e,t)}_query(e,t,r){return this.queryEngine(t,r)(e)}mayHaveChildren(e){return!!e.children}}let Xl=class extends _n{onClick(e){}get scale(){return this._checkbox.scale}set scale(e){this._checkbox?(this._checkbox.scale=e,si(this._checkboxNode,"scale_"+e,"scale_s scale_m scale_l")):this._initialScale=e}get checked(){return this._checked}set checked(e){this._checked="mixed"===e?e:this._lastChecked=!!e,this._checkbox&&(this._checkbox.indeterminate="mixed"===e,this._checkbox.checked=this._lastChecked)}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._checkbox&&(this._checkbox.disabled=e)}get shadowRootReady(){return this._shadowRootReadyPromise?this._shadowRootReadyPromise:this._shadowRootReadyPromise=new Promise((e=>{const t=new MutationObserver(((r,i)=>{t.disconnect(),"STYLE"===r[0].addedNodes[0].tagName?e(r[1].addedNodes[0]):e(r[0].addedNodes[0])}));t.observe(this._checkbox.shadowRoot,{childList:!0,subtree:!0})}))}get inputNode(){var e;return null!==(e=this._inputNode)&&void 0!==e?e:this._inputNode=this.shadowRootReady.then((e=>this._checkbox.querySelector("input")))}set ariaLabel(e){this._ariaLabel=e,this._focusNode&&this._focusNode.setAttribute("aria-label",e)}get ariaLabel(){return this._ariaLabel}get focusNode(){return this._focusNode}constructor(e,t,r){super(e,t,r),this._lastChecked=!1}buildRendering(){let e,t=this._refNode;if(this.labelText)if(t instanceof HTMLLabelElement)t.innerHTML="&nbsp;"+this.labelText;else{const r=this.labelAttrs||{};r.innerHTML="&nbsp;"+this.labelText,e=_i("label",r),t&&bi(e,t),t=e}this._checkboxNode=_i("div",null,t,t instanceof HTMLLabelElement?"first":this._refPosition),t instanceof HTMLLabelElement&&(this._parentLabel=t),this.class&&ri(this._checkboxNode,this.class),this.domNode=e||this._checkboxNode,delete this._refNode,delete this._refPosition}postCreate(){void 0===this.autoToggle&&(this.autoToggle=!0),void 0===this._checked&&(this._checked=!1),void 0===this._disabled&&(this._disabled=!1),this._checkbox=document.createElement("calcite-checkbox"),this._checkbox.checked=this._lastChecked,this._checkbox.indeterminate="mixed"===this._checked,this._checkbox.disabled=this._disabled,this._checkbox.className="esriTriStateItemCalcite_checkbox",bi(this._checkbox,this._checkboxNode),ri(this._checkboxNode,"esriTriStateItemCalcite"),this.scale=this._initialScale||"m";const e=e=>{e.stopPropagation(),e.preventDefault(),this._disabled||(this.autoToggle?(this.toggle(),e.checked=this.checked,this.onClick(e)):setTimeout((()=>{this._checkbox.indeterminate="mixed"===this._checked,this._checkbox.checked=this._lastChecked,e.checked=this.checked,this.onClick(e)})))},t=this._checkboxNode.parentElement;var r,i;t instanceof HTMLLabelElement?(Ei(t,"click",e),ri(t,"esriTriStateCheckBoxLabel"),this._focusNode=t):(Ei(this._checkboxNode,"click",e),this._focusNode=this._checkboxNode),this.enableTabbing&&(r=this._focusNode,i=e,Ei(r,"keydown",(e=>{13===e.keyCode&&i(e)})));const s=this._ariaLabel||this.labelText;s&&(this.ariaLabel=s)}toggle(){return this._checkbox.indeterminate=!1,this._checkbox.checked=this._checked=this._lastChecked=!this._lastChecked,this._checked}updateLabel(e){this._parentLabel&&(this._parentLabel.removeChild(this._checkboxNode),this._parentLabel.innerHTML="&nbsp;"+e,bi(this._checkboxNode,this._parentLabel,"first"),this.ariaLabel=e)}};s([Ee({constructOnly:!0})],Xl.prototype,"labelText",void 0),s([Ee({constructOnly:!0})],Xl.prototype,"labelAttrs",void 0),s([Ee()],Xl.prototype,"onClick",null),s([Ee()],Xl.prototype,"autoToggle",void 0),s([Ee({constructOnly:!0})],Xl.prototype,"enableTabbing",void 0),Xl=s([St()],Xl);class ec extends Sl{constructor(){super(...arguments),this.childLists={},this._lastClickedItem=null,this._cache={}}createPresentation(e,t,r,i){const s=e.children&&e.children.length,o=s&&_i("div",{class:"childrenListRoot"},r),n=_i("div",{class:"esriGETrimWithEllipses listItem"},o||r),a=_i("div",{class:"expandoIcon"},n),l=new Xl(null,n);l.autoToggle=!1;const c={item:e,rowRoot:n,list:i,expandoIcon:a,checkbox:l};return this._cache[e[this.idProperty]]=c,this.topList.rowRenderer?this.topList.rowRenderer(e,n,l,c):(_i("div",{class:"itemSpacer",innerHTML:"&nbsp;"},n),_i("span",{textContent:e[this.topList.labelProperty]},n)),s?((c.childrenListRoot=_i("div",{class:"childrenListRoot"},o)).style[Yr()?"marginLeft":"marginRight"]=20*(e.deepness+1)+"px",Ei(a,"click",(()=>{this.setExpanded(e,!e.expanded,!1,!0),this.topList.onExpandChangedUser(e)})),this._handleExpand(e,!1)):(this.topList.hideInvisibleExpandoIcons?a.style.display="none":a.style.opacity="0.001",a.style.cursor="default"),this.updateSelection(e),l.onClick=t=>{this.executeSelectionClick(e,t)},n}executeSelectionClick(e,t){const r=this.topList.getSelectedState(!0),i=this._cache[e[this.idProperty]],s=i.list.items;if(t&&t.shiftKey&&this._lastClickedItem&&-1!==s.indexOf(this._lastClickedItem)){const t=s.indexOf(this._lastClickedItem),r=s.indexOf(e),i=Math.min(t,r),o=Math.max(t,r);for(let e=i;e<=o;e++){const t=s[e];t!==this._lastClickedItem&&this.tree.changeSelect(t,!this.tree.getSelectionState(t))}}else this.tree.changeSelect(e,!this.tree.getSelectionState(e));this._lastClickedItem=e,this.topList._onCheckboxClicked(r,i.rowRoot)}updateSelection(e){const t=this._cache[e[this.idProperty]];if(!t||!t.checkbox)return;const r=this.tree.getSelectionState(e);t.checkbox.checked=r,oi(t.rowRoot,"listItemSelected",!!r)}setExpanded(e,t,r,i){e.children&&e.children.length&&(this.tree.updateExpand(e,t),r||this._handleExpand(e,i))}_handleExpand(e,t){const r=this._cache[e[this.idProperty]];r&&(oi(r.expandoIcon,"open",!!e.expanded),t?(this._provideChildrenList(e),Ii(r.childrenListRoot),Ta({obj:r.childrenListRoot.style,duration:200,properties:{height:{start:e.expanded?0:r.childrenList.domNode.clientHeight,end:e.expanded?r.childrenList.domNode.clientHeight:0,units:"px"}},onEnd:()=>{!e.expanded&&Ci(r.childrenListRoot),r.childrenListRoot.style.height=""}})):(e.expanded&&this._provideChildrenList(e),e.expanded?Ii(r.childrenListRoot):Ci(r.childrenListRoot)))}_provideChildrenList(e){const t=this._cache[e[this.idProperty]];if(!t||t.childrenList)return;const r=t.childrenListRoot.style.marginLeft,i=t.childrenListRoot.style.marginRight;t.childrenList=this.createList(t.childrenListRoot),t.childrenListRoot=t.childrenList.domNode,t.childrenList.domNode.className="childrenListRoot",t.childrenList.domNode.style.marginLeft=r,t.childrenList.domNode.style.marginRight=i,t.childrenList.itemRenderer=this,this.childLists[e[this.idProperty]]=t.childrenList,t.childrenList.items=e.children}getItemBinding(e){return this._cache[e[this.idProperty]]}selectPresentation(e,t,r){}createList(e){return null}}var tc;let rc=tc=class extends Cl{constructor(e,t,r){super(e,t,r),this.hideInvisibleExpandoIcons=!1,this.hasSelectableItems=!1,this.itemRenderer=new ec,this.keepScrollPosition=!0}postCreate(){ri(this.domNode,"esri4GESelectableTreeList"),super.postCreate()}_setStore(e){this.itemRenderer.createList=e=>new tc(null,e),this.itemRenderer.idProperty=this.idProperty=e.idProperty,this.itemRenderer.tree=e,this.itemRenderer.topList=this,this._setItems(this.itemRenderer.tree.data)}getTree(){return this.itemRenderer.tree}getItemBinding(e){return this.itemRenderer.getItemBinding(e)}emulateManualSelectionToggle(e){this.itemRenderer.executeSelectionClick(e)}isItemSelected(e){return e&&e.selected}getSelectedItems(e){return this.getTree()?this.getTree().getSelectedNodes(e):[]}getSelectedState(e){const t={};return this.getTree()&&this.getTree().getSelectedNodes(e).forEach((e=>{t[e[this.idProperty]]=!0})),t}setSelectedState(e){if(this.getTree().changeSelect(this.getTree().root,!1),e)for(const t in e){const r=this.getTree().get(t);r&&this.getTree().changeSelect(r,!!e[t])}this._refreshCheckboxes()}setItemSelected(e,t,r=!1){this.getTree().changeSelect(e,t),r||this._refreshCheckboxes()}setItemsSelected(e,t,r=!1){e.forEach((e=>this.getTree().changeSelect(e,t))),r||this._refreshCheckboxes()}_onCheckboxClicked(e,t){this._refreshCheckboxes();const r=this.getSelectedState(!0),i=[];for(const t in r)r[t]&&!e[t]&&i.push(this.getTree().get(t));const s=[];for(const t in e)e[t]&&!r[t]&&s.push(this.getTree().get(t));this.onSelectionChanged({selectedItems:i,unselectedItems:s,clickNode:t})}_refreshCheckboxes(){function e(e){e.items.forEach((t=>e.itemRenderer.updateSelection(t)))}e(this);for(const t in this.itemRenderer.childLists)e(this.itemRenderer.childLists[t])}onSelectionChanged(e){}isExpanded(e){const t="string"==typeof e?this.getTree().get(e):e;return t&&t.expanded}setExpanded(e,t,r=!1){const i="string"==typeof e?this.getTree().get(e):e;i&&this.itemRenderer.setExpanded(i,t,r,!1)}toggleExpand(e){this.setExpanded(e,!this.isExpanded(e))}getExpandedState(){const e={};return this.getTree()&&this.getTree().inspectChildren(null,(t=>(t.children&&t.children.length&&(e[t[this.idProperty]]=!!t.expanded),!0))),e}setExpandedState(e,t=!1){for(const r in e)this.setExpanded(r,!!e[r],t)}onExpandChangedUser(e){}};s([Ee()],rc.prototype,"hideInvisibleExpandoIcons",void 0),s([Ee()],rc.prototype,"rowRenderer",void 0),s([Ee()],rc.prototype,"hasSelectableItems",void 0),s([Ee()],rc.prototype,"onSelectionChanged",null),s([Ee()],rc.prototype,"onExpandChangedUser",null),rc=tc=s([St()],rc);let ic=class extends _n{constructor(e,t,r){super(e,t,r),this.queryID="/",this.groupCategories=!0,this._inUpdate=!1,this._expansionCache={}}postCreate(){ri(this.domNode,"DataVariableGrid"),this._treeList=new rc({rowRenderer:this._renderNode.bind(this),onSelectionChanged:this._onSelectionChanged.bind(this),hideInvisibleExpandoIcons:!this.groupCategories}).placeAt(this.domNode),this.setVariables([])}refresh(){this._treeList.refresh()}setVariables(e){this.groupCategories&&(this._expansionCache[this.queryID]=Object.assign(Object.assign({},this._expansionCache[this.queryID]),this._treeList.getExpandedState())),this._cleanup();const t=this._prepareVariables(e);if(t.length&&(this._selectionHandler=this.manager.watch("selection",this._selectionUpdated.bind(this))),this._treeList.store=new Kl(t),this.groupCategories&&t.length){const e=this._expansionCache[this.queryID]=this._expansionCache[this.queryID]||{};1===t.length&&(e[t[0].id]=!0),this._treeList.setExpandedState(e)}}_prepareVariables(e){return this.groupCategories?this._prepareVariableCategories(e):e.map((e=>this._prepareVariableItem(e)))}_prepareVariableCategories(e){const t={};e.forEach((e=>{const r=e.fieldCategory;let i=t[r];i||(i={label:r,id:r,children:[]},t[r]=i),i.children.push(this._prepareVariableItem(e))}));const r=[];for(const e in t)r.push(t[e]);return this.manager.variables.queryEngine(null,{sort:[{attribute:"label"}]})(r)}_prepareVariableItem(e){const t=this._prepareVariableNode(e);return t.id=this.manager.variables.getIdentity(e),t}_prepareVariableNode(e){const t={label:e.description,variable:e,group:Nl(this.manager.variables,this.manager.variables.getIdentity(e))},r=this.manager.getSelectionGroups().hash[t.group.value];return r&&(t.selected=!0,t.group.value=r.value),t}_renderNode(e,t,r,i){return ri(t,"esri4GEDataBrowserVarCell"),function(e){return!!e.variable}(e)?this._renderVariableNode(e,t,r,i):this._renderCategoryNode(e,t)}_renderVariableNode(e,t,r,i){function s(e){return e&&bi(e,r.domNode,"before"),e}function o(e,r){return e&&bi(e,t,r),e}if(this.manager.variables.favorites){const t=s(this._createVariableFavoriteIcon());if(t){const r=this._getFavoriteId(e);this._updateFavorite(t,this.manager.variables.favorites.contains(r)),Ei(t,"click",(()=>{this._toggleFavorite(t,r)})),s(this._createSpacer())}}this.manager.multipleSelectIsAllowed()?o(this._createSpacer()):r.domNode.style.display="none";const n=_i("div",{class:"esriGETrimWithEllipses esri4GEDataBrowserVarLabel",textContent:e.label},t);if(e.group.states){o(this._createSpacer());const r=new Al({states:e.group.states,value:e.group.value,onChange:()=>{this._onVariableToggleChange(e,r)}}).placeAt(t);i.variableToggle=r}const a=this._createInfoIcon();a&&(o(this._createSpacer()),o(a),gl(a,(()=>(this.manager.variableInfo.variable=e.variable,this.manager.variableInfo.domNode.outerHTML)),{position:["above","below"],stayOnHover:!0,hideOnClick:!0})),this.manager.selectionLimit&&(ri(n,"esriGEClickable"),Ei(n,"click",(()=>{this._treeList.emulateManualSelectionToggle(e)})),1===this.manager.selectionLimit&&ri(t,"DataBrowser_Selectable"))}_renderCategoryNode(e,t){bi(this._createSpacer(),t);const r=_i("div",{class:"esriGETrimWithEllipses esri4GEDataBrowserVarLabel",textContent:e.label},t);ri(r,"esriGEClickable"),Ei(r,"click",(()=>{this._onCategoryExpand(e.id)}))}_createVariableFavoriteIcon(){return _i("div",{class:"esri4GEDataBrowserVarIcon FavoriteItemIcon"})}_getFavoriteId(e){return e.id}_createInfoIcon(){return this.manager.variableInfo?_i("div",{class:"esri4GEDataBrowserVarIcon esri4GEInfoIcon"}):null}_createSpacer(){return _i("div",{class:"esri4GEDataBrowserVarSpacer",innerHTML:"&nbsp;"})}_onCategoryExpand(e){this._treeList.toggleExpand(e)}_toggleFavorite(e,t){const r=this.manager.variables.favorites;r.contains(t)?r.remove(t):r.add(t);const s=r.contains(t);return this._updateFavorite(e,s),function(e,t,r,s,o){const n=e;n.__invokeInfo||(n.__invokeInfo={});let a=n.__invokeInfo[t];a&&clearTimeout(a.handle),a||(a={dfd:(0,i.c)(),handle:null},n.__invokeInfo[t]=a),a.handle=setTimeout((()=>{n.__invokeInfo[t]=void 0,(0,i.w)(n[t]()).then((e=>{a.dfd.resolve(e)}),(e=>{a.dfd.reject(e)}))}),1e3),a.dfd.promise}(this,"_saveFavorites"),s}_updateFavorite(e,t){t?(ii(e,"FavoriteItem"),ri(e,"FavoriteItemChecked")):(ii(e,"FavoriteItemChecked"),ri(e,"FavoriteItem"))}_saveFavorites(){this.manager.variables.favorites.save()}_onSelectionChanged(e){this._inUpdate=!0,this.manager.removeFromSelection(e.unselectedItems.map((e=>e.group.value)));const t=e.selectedItems.slice();if(this.manager.selectionLimit>0){const r=t.length;if(t.length=Math.max(0,Math.min(t.length,this.manager.selectionLimit-this.manager.selection.length)),t.length<r){const r=e.selectedItems.slice(t.length);this._treeList.setItemsSelected(r,!1)}}let r=!1;e.selectedItems.length&&(r=!!this.manager.addToSelection(e.selectedItems.map((e=>e.group.value)))),this._inUpdate=!1;const i=1===this.manager.selectionLimit;r&&!i&&this.animateSelection&&this.animateSelection(function(e,t){const r=[],i=e.split(".").filter((e=>!!e)),s=-1===e.indexOf(".")||e.indexOf(".")>0?i.shift().toLowerCase():null;return s||i.length?(ki(t||document.body,(e=>{const t=!i.length||i.every((t=>ni(e,t))),o=!s||e.nodeName.toLowerCase()===s;t&&o&&r.push(e)})),r):r}(".esri4GEDataBrowserVarLabel",e.clickNode)[0])}_onVariableToggleChange(e,t){e.group.value=t.value,this._inUpdate=!0,this.manager.updateSelection(t.value),this._inUpdate=!1,this.manager.allowMultipleSelectInGroup&&this._selectionUpdated()}_selectionUpdated(){if(this._inUpdate)return;const e={},t=this.manager.getSelectionGroups();this._treeList.getTree().data.forEach((r=>{(r.children||[r]).forEach((r=>{let i=t.hash[r.group.value];i&&(r.group.value=i.value);const s=this._treeList.getItemBinding(r),o=s&&s.variableToggle;o&&(i=o&&t.hash[o.value],i&&(o.value=i.value)),e[r.id]=!!i}))})),this._treeList.setSelectedState(e)}animateSelection(e){this.manager.allowShoppingCart&&this.manager.animateSelection(e)}destroy(){this._cleanup()}_cleanup(){this._selectionHandler&&(this._selectionHandler.remove(),this._selectionHandler=null)}};s([Ee()],ic.prototype,"manager",void 0),s([Ee()],ic.prototype,"queryID",void 0),s([Ee()],ic.prototype,"groupCategories",void 0),ic=s([St()],ic);const sc=(0,i.a)("DataBrowser").DataVariablesPage;let oc=class extends Vl{set pageIsActive(e){this._set("pageIsActive",e),this._grid&&this._grid.setVariables([]),e&&this._querySelectedVariables()}constructor(e,t,r){super(e,t,r),this._templateString='\n  <div class="DataVariablesPage">\n    <div>\n      <div class="BreadcrumbHeight"></div>\n      <div class="esri4GEDataBrowserVarHeader DataVariablesPage_VarCount" data-attach-point="_varCountNode">&nbsp;</div>\n    </div>\n    <div>\n      <div data-attach-point="_divTree" class="DataVariablesPage_Container DataVariablesPage_Variables"></div>\n      <div data-attach-point="_progressDiv"></div>\n    </div>\n    <div></div>\n  </div>'}postCreate(){super.postCreate(),this._grid=this.manager.createVariableGrid({groupCategories:!0},this._divTree),this.manager.watch("selection",this._updateApplyButtonAvailability.bind(this)),this._updateApplyButtonAvailability(),this._querySelectedVariables()}_updateApplyButtonAvailability(){this._setButtonEnabled("apply",!!this.manager.selection.length)}_querySelectedVariables(){this._varCountNode.innerHTML="&nbsp;";const e=this.searchResults||this.manager.queryVariables();this.searchResults=null,this._showProgress((0,i.w)(e).then((e=>{this._showVariables(e)})))}_showVariables(e){this._composeVarTitle(e.length),this._grid.setVariables(e)}_composeVarTitle(e){const t=this.manager.variableQuery;let r=t.searchString;const s=t.dataCollectionID?this.manager.getDataCollection()||{}:t.categoryID?this.manager.getCategory()||{}:null;return(0,i.w)(s).then((s=>{"*"===r&&s&&(r=null);const o=s?r?sc.searchInGroupVariables:sc.groupVariables:t.favorites?sc.favoriteVariables:"*"===r?sc.allVariables:sc.searchVariables,n={searchKey:r,groupName:s&&(s.title||s.name||"?")};this._varCountNode.textContent=(0,i.s)(o,n)+" ("+e+")";const a=["c:"+(t.countryID||"_")];n.searchKey&&a.push("s:"+n.searchKey),n.groupName&&a.push("g:"+n.groupName),t.favorites&&a.push("f"),this._grid.queryID=a.join("/")}))}};s([Ee()],oc.prototype,"searchResults",void 0),s([Ee()],oc.prototype,"manager",void 0),s([Ee()],oc.prototype,"pageIsActive",null),oc=s([St()],oc);const nc=(0,i.a)("DataBrowser").VariableInfo;let ac=class extends _n{set variable(e){this._set("variable",e),this._buildInfoFromVariable(e)}constructor(e,t,r){super(e,t,r),this._templateString=`\n  <div class="VariableInfo">\n    <div class="VariableInfo_Header" data-attach-point="descriptionHeader">${nc.name}</div>\n    <div class="VariableInfo_Value" data-attach-point="_descriptionValue"></div>\n    <div data-attach-point="fullNameGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="fullNameHeader">${nc.variable}</div>\n      <div class="VariableInfo_Value" data-attach-point="fullNameValue"></div>\n    </div>\n    <div data-attach-point="percentBaseGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="percentBaseHeader">${nc.percentBase}</div>\n      <div class="VariableInfo_Value" data-attach-point="percentBaseValue"></div>\n    </div>\n    <div data-attach-point="averageBaseGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="averageBaseHeader">${nc.averageBase}</div>\n      <div class="VariableInfo_Value" data-attach-point="averageBaseValue"></div>\n    </div>\n    <div data-attach-point="sourceGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="sourceHeader">${nc.source}</div>\n      <div class="VariableInfo_Value" data-attach-point="sourceValue"></div>\n    </div>\n    <div data-attach-point="vintageGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="vintageHeader">${nc.vintage}</div>\n      <div class="VariableInfo_Value" data-attach-point="vintageValue"></div>\n    </div>\n    <div data-attach-point="definitionGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="definitionHeader">${nc.definition}</div>\n      <div class="VariableInfo_Value" data-attach-point="definitionValue"></div>\n    </div>\n    <div data-attach-point="indexBaseGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="indexBaseHeader">${nc.indexBase}</div>\n      <div class="VariableInfo_Value" data-attach-point="indexBaseValue"></div>\n    </div>\n    <div data-attach-point="_filteringTagsGroup">\n      <div class="VariableInfo_Spacer">&nbsp;</div>\n      <div class="VariableInfo_Header" data-attach-point="filteringTagsHeader">${nc.filters}</div>\n      <div class="VariableInfo_Value" data-attach-point="_filteringTagsValue"></div>\n    </div>\n  </div>`}postCreate(){this._fieldsCache={},this.infoFields="string"==typeof this.infoFields?this.infoFields.split(","):this.infoFields||[];for(let e=0;e<this.infoFields.length;e++){let t=this.infoFields[e];const r=t.indexOf(":");if(r>0){const e=t.substr(r+1);t=t.substr(0,r);const i=this[t+"Header"];i&&(i.textContent=e)}this._fieldsCache[t]=!0}}_buildInfoFromVariable(e){this._descriptionValue.innerHTML=e.description,this._updateGroup(e,"vintage");const t=e.filteringTags.Source;this._updateGroup(e,"source",t&&t.value),this._updateGroup(e,"fullName",!0);const r=this._getOptionalField(e,"percentBase");this._updateGroup(e,"percentBase",r&&this._getBaseFieldDescription(e,"percentBase"));const i=this._getOptionalField(e,"averageBase");this._updateGroup(e,"averageBase",i&&this._getBaseFieldDescription(e,"averageBase")),this._updateGroup(e,"indexBase",!0),this._updateGroup(e,"definition");const s=this._getOptionalField(e,"filteringTags");if(this._filteringTagsGroup.style.display=s?"":"none",s){xi(this._filteringTagsValue);for(const e in s){const t=s[e];_i("div",{textContent:t.name+": "+t.value},this._filteringTagsValue)}}}_getBaseFieldDescription(e,t){return e[t+"Alias"]+" ("+e[t]+")"}_updateGroup(e,t,r){void 0===r?r=e[t]:!0===r&&(r=this._getOptionalField(e,t));let i=this[t+"Value"];i.innerHTML=r,i=this[t+"Group"],i.style.display=r?"":"none"}_getOptionalField(e,t){return this._fieldsCache["*"]||this._fieldsCache[t]?e[t]:null}};s([Ee()],ac.prototype,"infoFields",void 0),s([Ee()],ac.prototype,"variable",null),ac=s([St()],ac);let lc=class extends $o{set selection(e){this._selectionGroups=null,this._set("selection",e)}constructor(e){super(),this.selectionLimit=-1,this.allowShoppingCart=!1,this.allowMultipleSelectInGroup=!1,this.categoryPageIndex=0,this.variables=e.variables,this.selectionLimit=isNaN(e.selectionLimit)?-1:e.selectionLimit,this.allowShoppingCart=this.multipleSelectIsAllowed()&&!!e.shoppingCart,this.allowMultipleSelectInGroup=this.multipleSelectIsAllowed()&&!!e.allowMultipleSelectInGroup,e.variableQuery=this.variableQuery=e.variableQuery||{},e.countryID=this.variableQuery.countryID=this.variableQuery.countryID||e.countryID||null,e.favorites&&!this.variables.favorites&&(this.variables.favorites=e.favorites),this.variables.synchronize(e.countryID),e.selection&&e.selection.length&&this.multipleSelectIsAllowed()&&this.changeSelection(e.selection),this._set("selection",[]),e.selection=this.selection;let t=e.variableInfo;if(!1!==t){if(!0===t)t="fullName";else if(t instanceof ac)return void(this.variableInfo=t);this.variableInfo=new ac({infoFields:t})}}postscript(){}multipleSelectIsAllowed(){return this.selectionLimit<0||this.selectionLimit>1}changeSelection(e){const t=(0,i.c)();return(0,i.w)(this.variables.synchronize()).then((()=>{setTimeout((()=>{this._set("selection",[]),this.addToSelection(e,!0),t.resolve()}))})),t.promise}validateSelection(){const e=this.selection.filter((e=>this.variables.get(e)));e.length!==this.selection.length&&(this.selection=e)}addToSelection(e,t=!1){const r="string"==typeof e?[e]:e||[],i=this.selection.slice();let s={},o=!1;return r.forEach((e=>{if(!this.variables.get(e))return;if(this.selectionLimit>=0&&i.length===this.selectionLimit)return void(o=!0);const t=kl(this.variables,[e],this.allowMultipleSelectInGroup);i.every((e=>!t.hash[e]))&&(i.push(t.groups[0].value),s[e]=!0)})),i.length&&!this._ensureValidSelection(i)?null:(t||this.selection.length!==i.length?this.selection=i:s=null,o&&this.onLimit(),s)}_ensureValidSelection(e){return!0}removeFromSelection(e,t=!1){const r="string"==typeof e?[e]:e||[],i=[],s=kl(this.variables,r,!t&&this.allowMultipleSelectInGroup).hash,o={};return this.selection.forEach((e=>{s[e]?o[e]=!0:i.push(e)})),this.selection.length!==i.length?(this.selection=i,o):null}updateSelection(e){const t=kl(this.variables,[e],this.allowMultipleSelectInGroup);let r=-1;if(this.selection.some(((e,i)=>!!t.hash[e]&&(r=i,!0))),r>=0){const e=this.selection.slice();e[r]=t.groups[0].value,this.selection=e}}getSelectionGroups(){return this._selectionGroups||(this._selectionGroups=kl(this.variables,this.selection,this.allowMultipleSelectInGroup)),this._selectionGroups}animateSelection(e){this.flyAnim.fly(e,"esri4GEDataBrowser_SelectVar",["top",Yr()?"right":"left"])}composeQuery(e){const t="string"==typeof e?[e]:e||[],r={countryID:this._getQueryCountryID()};return t.forEach((e=>{const t=this.variableQuery[e];t&&(r[e]=t)})),r}_getQueryCountryID(){return this.variableQuery.countryID}validateQuery(){const e=this.variableQuery,t=e.dataCollectionID?this.getDataCollection():e.categoryID?this.getCategory():this.queryVariables();return(0,i.w)(t).then((t=>(t||(this.variableQuery=this.composeQuery()),e.dataCollectionID||e.categoryID?null:t)),(()=>{this.variableQuery=this.composeQuery()}))}getCategories(){return(0,i.w)(this.variables.categories.query(this.composeQuery()))}queryVariables(e){return(0,i.w)(this.variables.query(this.variableQuery,e))}getCategory(e){if(!(e=e||this.variableQuery.categoryID))return null;const t=this.composeQuery();t.id=e;const r=this.variables.categories.query(t);return"then"in r?(0,i.w)(r).then((t=>this._getCategory(t,e))):this._getCategory(r,e)}_getCategory(e,t){return e[0]}getDataCollection(e){if(!(e=e||this.variableQuery.dataCollectionID))return null;const t=this.composeQuery();t.id=e;const r=this.variables.dataCollections.query(t);return"then"in r?(0,i.w)(r).then((t=>this._getDataCollection(t,e))):this._getDataCollection(r,e)}_getDataCollection(e,t){return e[0]}onLimit(){}};s([Ee()],lc.prototype,"variables",void 0),s([Ee()],lc.prototype,"selectionLimit",void 0),s([Ee()],lc.prototype,"variableQuery",void 0),s([Ee()],lc.prototype,"variableInfo",void 0),s([Ee()],lc.prototype,"flyAnim",void 0),s([Ee()],lc.prototype,"allowShoppingCart",void 0),s([Ee()],lc.prototype,"allowMultipleSelectInGroup",void 0),s([Ee()],lc.prototype,"categoryPageIndex",void 0),s([Ee()],lc.prototype,"createVariableGrid",void 0),s([Ee()],lc.prototype,"selection",null),s([Ee()],lc.prototype,"onLimit",null),lc=s([St()],lc);class cc{createManager(e){return new lc(e)}createBreadcrumb(e){return new Fl(e)}createCategoriesPage(e){return new $l(e)}createDataCollectionsPage(e){return new Jl(e)}createVariablesPage(e){return new oc(e)}createVariableGrid(e,t){return new ic(e).placeAt(t)}}function hc(e,t,r){const s=e&&e(t);return(0,i.i)(s)?r():s.catch((()=>{})).then((()=>r()))}class uc{constructor(e){this.idProperty="id",this.indexIgnoreCase=!0,this.queryEngine=Yl(),Sn(this,e),this.setData(this.data)}setData(e){this.data=[],this.index={},e&&e.forEach(((e,t)=>{this.data[t]=e;let r=this.getIdentity(e);this.indexIgnoreCase&&(r=r.toUpperCase()),this.index[r]=t}))}get(e){return this.indexIgnoreCase&&e&&(e=e.toUpperCase()),this.data[this.index[e]]}getIdentity(e){return e[this.idProperty]}query(e,t){return hc(this.resolver,e,(()=>this.syncQuery(e,t)))}syncQuery(e,t){return this.queryEngine(e,t)(this.data)}}function dc(e,t,r){if(!e||!e.read||!1===e.read.enabled||!e.read.source)return!1;const i=e.read.source;if("string"==typeof i){if(i===t)return!0;if(i.indexOf(".")>-1&&0===i.indexOf(t)&&ke(i,r))return!0}else for(const e of i){if(e===t)return!0;if(e.indexOf(".")>-1&&0===e.indexOf(t)&&ke(e,r))return!0}return!1}function pc(e,t,r,i,s){let o=mt(t[r],s);(function(e){return e&&(!e.read||!1!==e.read.enabled&&!e.read.source)})(o)&&(e[r]=!0);for(const n of Object.getOwnPropertyNames(t))o=mt(t[n],s),dc(o,r,i)&&(e[n]=!0)}function fc(e,t,r,i){const s=vt(r.metadatas[t],"any",i),o=s&&s.default;if(void 0===o)return;const n="function"==typeof o?o.call(e,t,i):o;void 0!==n&&r.set(t,n)}uc.resolveCallback=hc;const yc={origin:"service"};function mc(e,t,r=yc){if(!t||"object"!=typeof t)return;const i=me(e),s=i.metadatas,o={};for(const e of Object.getOwnPropertyNames(t))pc(o,s,e,t,r);i.setDefaultOrigin(r.origin);for(const n of Object.getOwnPropertyNames(o)){const o=mt(s[n],r).read,a=o&&o.source;let l;l=a&&"string"==typeof a?Ie(t,a):t[n],o&&o.reader&&(l=o.reader.call(e,l,t,r)),void 0!==l&&i.set(n,l)}if(!r||!r.ignoreDefaults)for(const t of Object.getOwnPropertyNames(s))o[t]||fc(e,t,i,r);i.setDefaultOrigin("user")}function gc(e,t,r,i=yc){var s;const o={...i,messages:[]};r(o),null==(s=o.messages)||s.forEach((t=>{"warning"!==t.type||e.loaded?i&&i.messages&&i.messages.push(t):e.loadWarnings.push(t)}))}const vc=G.getLogger("esri.core.accessorSupport.write");function _c(e,t,r,i,s){var o,n;const a={};return null==(o=t.write)||null==(n=o.writer)||n.call(e,i,a,r,s),a}function bc(e,t,r,i,s,o){if(!i||!i.write)return!1;const n=e.get(r);if(!s&&i.write.overridePolicy){const t=i.write.overridePolicy.call(e,n,r,o);void 0!==t&&(s=t)}if(s||(s=i.write),!s||!1===s.enabled)return!1;if((null===n&&!s.allowNull||void 0===n)&&s.isRequired){const t=new At("web-document-write:property-required",`Missing value for required property '${r}' on '${e.declaredClass}'`,{propertyName:r,target:e});return t&&o&&o.messages?o.messages.push(t):t&&!o&&vc.error(t.name,t.message),!1}return!(void 0===n||null===n&&!s.allowNull||function(e,t,r,i,s){const o=i.default;return void 0!==o&&(null!=i.defaultEquals?i.defaultEquals(s):"function"==typeof o?!!Array.isArray(s)&&Ts(o.call(e,t,r),s):o===s)}(e,r,o,i,n)||void 0===i.default&&!s.ignoreOrigin&&o&&o.origin&&t.store.originOf(r)<Mr(o.origin))}function wc(e,t,r,i){const s=me(e),o=gt(s.metadatas[t],i);return!!o&&bc(e,s,t,o,r,i)}function xc(e,t,r){if(e&&"function"==typeof e.toJSON&&(!e.toJSON.isDefaultToJSON||!e.write))return ge(t,e.toJSON());const i=me(e),s=i.metadatas;for(const a in s){const l=gt(s[a],r);if(!bc(e,i,a,l,void 0,r))continue;const c=e.get(a),h=_c(e,l,l.write&&"string"==typeof l.write.target?l.write.target:a,c,r);var o,n;Object.keys(h).length>0&&(t=ge(t,h),null!=r&&null!=(o=r.resources)&&null!=(n=o.pendingOperations)&&n.length&&Promise.all(r.resources.pendingOperations).then((()=>ge(t,h))),r&&r.writtenProperties&&r.writtenProperties.push({target:e,propName:a,oldOrigin:Lr(i.store.originOf(a)),newOrigin:r.origin}))}return t}const Sc=e=>{let t=class extends e{constructor(...e){super(...e)}read(e,t){mc(this,e,t)}write(e={},t){return xc(this,e,t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return Cc.call(this,e,t)}};return t=Wi([St("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function Cc(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(e,t),r}let Ic,Ac=class extends(Sc($o)){};Ac=Wi([St("esri.core.JSONSupport")],Ac);const kc={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9367:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(Ic=2e3;Ic<=2045;Ic++)kc[Ic]=0;for(Ic=2056;Ic<=2065;Ic++)kc[Ic]=0;for(Ic=2067;Ic<=2135;Ic++)kc[Ic]=0;for(Ic=2137;Ic<=2154;Ic++)kc[Ic]=0;for(Ic=2161;Ic<=2170;Ic++)kc[Ic]=0;for(Ic=2172;Ic<=2193;Ic++)kc[Ic]=0;for(Ic=2195;Ic<=2198;Ic++)kc[Ic]=0;for(Ic=2200;Ic<=2203;Ic++)kc[Ic]=0;for(Ic=2205;Ic<=2217;Ic++)kc[Ic]=0;for(Ic=2222;Ic<=2224;Ic++)kc[Ic]=1;for(Ic=2225;Ic<=2250;Ic++)kc[Ic]=2;for(Ic=2251;Ic<=2253;Ic++)kc[Ic]=1;for(Ic=2257;Ic<=2264;Ic++)kc[Ic]=2;for(Ic=2274;Ic<=2279;Ic++)kc[Ic]=2;for(Ic=2280;Ic<=2282;Ic++)kc[Ic]=1;for(Ic=2283;Ic<=2289;Ic++)kc[Ic]=2;for(Ic=2290;Ic<=2292;Ic++)kc[Ic]=0;for(Ic=2308;Ic<=2313;Ic++)kc[Ic]=0;for(Ic=2315;Ic<=2491;Ic++)kc[Ic]=0;for(Ic=2494;Ic<=2866;Ic++)kc[Ic]=0;for(Ic=2867;Ic<=2869;Ic++)kc[Ic]=1;for(Ic=2870;Ic<=2888;Ic++)kc[Ic]=2;for(Ic=2891;Ic<=2895;Ic++)kc[Ic]=2;for(Ic=2896;Ic<=2898;Ic++)kc[Ic]=1;for(Ic=2902;Ic<=2908;Ic++)kc[Ic]=2;for(Ic=2915;Ic<=2920;Ic++)kc[Ic]=2;for(Ic=2921;Ic<=2923;Ic++)kc[Ic]=1;for(Ic=2924;Ic<=2930;Ic++)kc[Ic]=2;for(Ic=2931;Ic<=2962;Ic++)kc[Ic]=0;for(Ic=2964;Ic<=2968;Ic++)kc[Ic]=2;for(Ic=2969;Ic<=2973;Ic++)kc[Ic]=0;for(Ic=2975;Ic<=2991;Ic++)kc[Ic]=0;for(Ic=2995;Ic<=3051;Ic++)kc[Ic]=0;for(Ic=3054;Ic<=3079;Ic++)kc[Ic]=0;for(Ic=3081;Ic<=3088;Ic++)kc[Ic]=0;for(Ic=3092;Ic<=3101;Ic++)kc[Ic]=0;for(Ic=3106;Ic<=3138;Ic++)kc[Ic]=0;for(Ic=3146;Ic<=3151;Ic++)kc[Ic]=0;for(Ic=3153;Ic<=3166;Ic++)kc[Ic]=0;for(Ic=3168;Ic<=3172;Ic++)kc[Ic]=0;for(Ic=3174;Ic<=3203;Ic++)kc[Ic]=0;for(Ic=3294;Ic<=3358;Ic++)kc[Ic]=0;for(Ic=3367;Ic<=3403;Ic++)kc[Ic]=0;for(Ic=3408;Ic<=3416;Ic++)kc[Ic]=0;for(Ic=3417;Ic<=3438;Ic++)kc[Ic]=2;for(Ic=3441;Ic<=3446;Ic++)kc[Ic]=2;for(Ic=3447;Ic<=3450;Ic++)kc[Ic]=0;for(Ic=3451;Ic<=3459;Ic++)kc[Ic]=2;for(Ic=3460;Ic<=3478;Ic++)kc[Ic]=0;for(Ic=3554;Ic<=3559;Ic++)kc[Ic]=0;for(Ic=3560;Ic<=3570;Ic++)kc[Ic]=2;for(Ic=3571;Ic<=3581;Ic++)kc[Ic]=0;for(Ic=3594;Ic<=3597;Ic++)kc[Ic]=0;for(Ic=3601;Ic<=3604;Ic++)kc[Ic]=0;for(Ic=3637;Ic<=3639;Ic++)kc[Ic]=0;for(Ic=3665;Ic<=3667;Ic++)kc[Ic]=0;for(Ic=3693;Ic<=3695;Ic++)kc[Ic]=0;for(Ic=3701;Ic<=3727;Ic++)kc[Ic]=0;for(Ic=3728;Ic<=3739;Ic++)kc[Ic]=2;for(Ic=3740;Ic<=3751;Ic++)kc[Ic]=0;for(Ic=3753;Ic<=3760;Ic++)kc[Ic]=2;for(Ic=3761;Ic<=3773;Ic++)kc[Ic]=0;for(Ic=3775;Ic<=3777;Ic++)kc[Ic]=0;for(Ic=3779;Ic<=3781;Ic++)kc[Ic]=0;for(Ic=3783;Ic<=3785;Ic++)kc[Ic]=0;for(Ic=3788;Ic<=3791;Ic++)kc[Ic]=0;for(Ic=3797;Ic<=3802;Ic++)kc[Ic]=0;for(Ic=3814;Ic<=3816;Ic++)kc[Ic]=0;for(Ic=3825;Ic<=3829;Ic++)kc[Ic]=0;for(Ic=3832;Ic<=3841;Ic++)kc[Ic]=0;for(Ic=3844;Ic<=3852;Ic++)kc[Ic]=0;for(Ic=3873;Ic<=3885;Ic++)kc[Ic]=0;for(Ic=3890;Ic<=3893;Ic++)kc[Ic]=0;for(Ic=3907;Ic<=3912;Ic++)kc[Ic]=0;for(Ic=3942;Ic<=3950;Ic++)kc[Ic]=0;for(Ic=3968;Ic<=3970;Ic++)kc[Ic]=0;for(Ic=3973;Ic<=3976;Ic++)kc[Ic]=0;for(Ic=3986;Ic<=3989;Ic++)kc[Ic]=0;for(Ic=3994;Ic<=3997;Ic++)kc[Ic]=0;for(Ic=4048;Ic<=4051;Ic++)kc[Ic]=0;for(Ic=4056;Ic<=4063;Ic++)kc[Ic]=0;for(Ic=4093;Ic<=4096;Ic++)kc[Ic]=0;for(Ic=4390;Ic<=4398;Ic++)kc[Ic]=0;for(Ic=4399;Ic<=4413;Ic++)kc[Ic]=2;for(Ic=4418;Ic<=4433;Ic++)kc[Ic]=2;for(Ic=4455;Ic<=4457;Ic++)kc[Ic]=2;for(Ic=4484;Ic<=4489;Ic++)kc[Ic]=0;for(Ic=4491;Ic<=4554;Ic++)kc[Ic]=0;for(Ic=4568;Ic<=4589;Ic++)kc[Ic]=0;for(Ic=4652;Ic<=4656;Ic++)kc[Ic]=0;for(Ic=4766;Ic<=4800;Ic++)kc[Ic]=0;for(Ic=5014;Ic<=5016;Ic++)kc[Ic]=0;for(Ic=5069;Ic<=5072;Ic++)kc[Ic]=0;for(Ic=5105;Ic<=5130;Ic++)kc[Ic]=0;for(Ic=5173;Ic<=5188;Ic++)kc[Ic]=0;for(Ic=5253;Ic<=5259;Ic++)kc[Ic]=0;for(Ic=5269;Ic<=5275;Ic++)kc[Ic]=0;for(Ic=5292;Ic<=5311;Ic++)kc[Ic]=0;for(Ic=5329;Ic<=5331;Ic++)kc[Ic]=0;for(Ic=5343;Ic<=5349;Ic++)kc[Ic]=0;for(Ic=5355;Ic<=5357;Ic++)kc[Ic]=0;for(Ic=5387;Ic<=5389;Ic++)kc[Ic]=0;for(Ic=5459;Ic<=5463;Ic++)kc[Ic]=0;for(Ic=5479;Ic<=5482;Ic++)kc[Ic]=0;for(Ic=5518;Ic<=5520;Ic++)kc[Ic]=0;for(Ic=5530;Ic<=5539;Ic++)kc[Ic]=0;for(Ic=5550;Ic<=5552;Ic++)kc[Ic]=0;for(Ic=5562;Ic<=5583;Ic++)kc[Ic]=0;for(Ic=5623;Ic<=5625;Ic++)kc[Ic]=2;for(Ic=5631;Ic<=5639;Ic++)kc[Ic]=0;for(Ic=5649;Ic<=5653;Ic++)kc[Ic]=0;for(Ic=5663;Ic<=5680;Ic++)kc[Ic]=0;for(Ic=5682;Ic<=5685;Ic++)kc[Ic]=0;for(Ic=5875;Ic<=5877;Ic++)kc[Ic]=0;for(Ic=5896;Ic<=5899;Ic++)kc[Ic]=0;for(Ic=5921;Ic<=5940;Ic++)kc[Ic]=0;for(Ic=6050;Ic<=6125;Ic++)kc[Ic]=0;for(Ic=6244;Ic<=6275;Ic++)kc[Ic]=0;for(Ic=6328;Ic<=6348;Ic++)kc[Ic]=0;for(Ic=6350;Ic<=6356;Ic++)kc[Ic]=0;for(Ic=6366;Ic<=6372;Ic++)kc[Ic]=0;for(Ic=6381;Ic<=6387;Ic++)kc[Ic]=0;for(Ic=6393;Ic<=6404;Ic++)kc[Ic]=0;for(Ic=6480;Ic<=6483;Ic++)kc[Ic]=0;for(Ic=6511;Ic<=6514;Ic++)kc[Ic]=0;for(Ic=6579;Ic<=6581;Ic++)kc[Ic]=0;for(Ic=6619;Ic<=6624;Ic++)kc[Ic]=0;for(Ic=6625;Ic<=6627;Ic++)kc[Ic]=2;for(Ic=6628;Ic<=6632;Ic++)kc[Ic]=0;for(Ic=6634;Ic<=6637;Ic++)kc[Ic]=0;for(Ic=6669;Ic<=6692;Ic++)kc[Ic]=0;for(Ic=6707;Ic<=6709;Ic++)kc[Ic]=0;for(Ic=6720;Ic<=6723;Ic++)kc[Ic]=0;for(Ic=6732;Ic<=6738;Ic++)kc[Ic]=0;for(Ic=6931;Ic<=6933;Ic++)kc[Ic]=0;for(Ic=6956;Ic<=6959;Ic++)kc[Ic]=0;for(Ic=7005;Ic<=7007;Ic++)kc[Ic]=0;for(Ic=7057;Ic<=7070;Ic++)kc[Ic]=2;for(Ic=7074;Ic<=7082;Ic++)kc[Ic]=0;for(Ic=7109;Ic<=7118;Ic++)kc[Ic]=0;for(Ic=7119;Ic<=7127;Ic++)kc[Ic]=1;for(Ic=7374;Ic<=7376;Ic++)kc[Ic]=0;for(Ic=7528;Ic<=7586;Ic++)kc[Ic]=0;for(Ic=7587;Ic<=7645;Ic++)kc[Ic]=2;for(Ic=7692;Ic<=7696;Ic++)kc[Ic]=0;for(Ic=7755;Ic<=7787;Ic++)kc[Ic]=0;for(Ic=7791;Ic<=7795;Ic++)kc[Ic]=0;for(Ic=7799;Ic<=7801;Ic++)kc[Ic]=0;for(Ic=7803;Ic<=7805;Ic++)kc[Ic]=0;for(Ic=7825;Ic<=7831;Ic++)kc[Ic]=0;for(Ic=7845;Ic<=7859;Ic++)kc[Ic]=0;for(Ic=8013;Ic<=8032;Ic++)kc[Ic]=0;for(Ic=8065;Ic<=8068;Ic++)kc[Ic]=1;for(Ic=8518;Ic<=8529;Ic++)kc[Ic]=2;for(Ic=8533;Ic<=8536;Ic++)kc[Ic]=2;for(Ic=8538;Ic<=8540;Ic++)kc[Ic]=2;for(Ic=8677;Ic<=8679;Ic++)kc[Ic]=0;for(Ic=8836;Ic<=8840;Ic++)kc[Ic]=0;for(Ic=8857;Ic<=8859;Ic++)kc[Ic]=0;for(Ic=8908;Ic<=8910;Ic++)kc[Ic]=0;for(Ic=9154;Ic<=9159;Ic++)kc[Ic]=0;for(Ic=9205;Ic<=9218;Ic++)kc[Ic]=0;for(Ic=9271;Ic<=9273;Ic++)kc[Ic]=0;for(Ic=9295;Ic<=9297;Ic++)kc[Ic]=0;for(Ic=20002;Ic<=20032;Ic++)kc[Ic]=0;for(Ic=20062;Ic<=20092;Ic++)kc[Ic]=0;for(Ic=20135;Ic<=20138;Ic++)kc[Ic]=0;for(Ic=20248;Ic<=20258;Ic++)kc[Ic]=0;for(Ic=20348;Ic<=20358;Ic++)kc[Ic]=0;for(Ic=20436;Ic<=20440;Ic++)kc[Ic]=0;for(Ic=20822;Ic<=20824;Ic++)kc[Ic]=0;for(Ic=20934;Ic<=20936;Ic++)kc[Ic]=0;for(Ic=21035;Ic<=21037;Ic++)kc[Ic]=0;for(Ic=21095;Ic<=21097;Ic++)kc[Ic]=0;for(Ic=21148;Ic<=21150;Ic++)kc[Ic]=0;for(Ic=21413;Ic<=21423;Ic++)kc[Ic]=0;for(Ic=21453;Ic<=21463;Ic++)kc[Ic]=0;for(Ic=21473;Ic<=21483;Ic++)kc[Ic]=0;for(Ic=21780;Ic<=21782;Ic++)kc[Ic]=0;for(Ic=21891;Ic<=21894;Ic++)kc[Ic]=0;for(Ic=21896;Ic<=21899;Ic++)kc[Ic]=0;for(Ic=22171;Ic<=22177;Ic++)kc[Ic]=0;for(Ic=22181;Ic<=22187;Ic++)kc[Ic]=0;for(Ic=22191;Ic<=22197;Ic++)kc[Ic]=0;for(Ic=22234;Ic<=22236;Ic++)kc[Ic]=0;for(Ic=22521;Ic<=22525;Ic++)kc[Ic]=0;for(Ic=22991;Ic<=22994;Ic++)kc[Ic]=0;for(Ic=23028;Ic<=23038;Ic++)kc[Ic]=0;for(Ic=23830;Ic<=23853;Ic++)kc[Ic]=0;for(Ic=23866;Ic<=23872;Ic++)kc[Ic]=0;for(Ic=23877;Ic<=23884;Ic++)kc[Ic]=0;for(Ic=23886;Ic<=23894;Ic++)kc[Ic]=0;for(Ic=23946;Ic<=23948;Ic++)kc[Ic]=0;for(Ic=24311;Ic<=24313;Ic++)kc[Ic]=0;for(Ic=24342;Ic<=24347;Ic++)kc[Ic]=0;for(Ic=24370;Ic<=24374;Ic++)kc[Ic]=10;for(Ic=24375;Ic<=24381;Ic++)kc[Ic]=0;for(Ic=24718;Ic<=24721;Ic++)kc[Ic]=0;for(Ic=24817;Ic<=24821;Ic++)kc[Ic]=0;for(Ic=24877;Ic<=24882;Ic++)kc[Ic]=0;for(Ic=24891;Ic<=24893;Ic++)kc[Ic]=0;for(Ic=25391;Ic<=25395;Ic++)kc[Ic]=0;for(Ic=25828;Ic<=25838;Ic++)kc[Ic]=0;for(Ic=26191;Ic<=26195;Ic++)kc[Ic]=0;for(Ic=26391;Ic<=26393;Ic++)kc[Ic]=0;for(Ic=26701;Ic<=26722;Ic++)kc[Ic]=0;for(Ic=26729;Ic<=26799;Ic++)kc[Ic]=2;for(Ic=26801;Ic<=26803;Ic++)kc[Ic]=2;for(Ic=26811;Ic<=26813;Ic++)kc[Ic]=2;for(Ic=26847;Ic<=26870;Ic++)kc[Ic]=2;for(Ic=26891;Ic<=26899;Ic++)kc[Ic]=0;for(Ic=26901;Ic<=26923;Ic++)kc[Ic]=0;for(Ic=26929;Ic<=26946;Ic++)kc[Ic]=0;for(Ic=26948;Ic<=26998;Ic++)kc[Ic]=0;for(Ic=27037;Ic<=27040;Ic++)kc[Ic]=0;for(Ic=27205;Ic<=27232;Ic++)kc[Ic]=0;for(Ic=27258;Ic<=27260;Ic++)kc[Ic]=0;for(Ic=27391;Ic<=27398;Ic++)kc[Ic]=0;for(Ic=27561;Ic<=27564;Ic++)kc[Ic]=0;for(Ic=27571;Ic<=27574;Ic++)kc[Ic]=0;for(Ic=27581;Ic<=27584;Ic++)kc[Ic]=0;for(Ic=27591;Ic<=27594;Ic++)kc[Ic]=0;for(Ic=28191;Ic<=28193;Ic++)kc[Ic]=0;for(Ic=28348;Ic<=28358;Ic++)kc[Ic]=0;for(Ic=28402;Ic<=28432;Ic++)kc[Ic]=0;for(Ic=28462;Ic<=28492;Ic++)kc[Ic]=0;for(Ic=29118;Ic<=29122;Ic++)kc[Ic]=0;for(Ic=29168;Ic<=29172;Ic++)kc[Ic]=0;for(Ic=29177;Ic<=29185;Ic++)kc[Ic]=0;for(Ic=29187;Ic<=29195;Ic++)kc[Ic]=0;for(Ic=29900;Ic<=29903;Ic++)kc[Ic]=0;for(Ic=30161;Ic<=30179;Ic++)kc[Ic]=0;for(Ic=30491;Ic<=30494;Ic++)kc[Ic]=0;for(Ic=30729;Ic<=30732;Ic++)kc[Ic]=0;for(Ic=31251;Ic<=31259;Ic++)kc[Ic]=0;for(Ic=31265;Ic<=31268;Ic++)kc[Ic]=0;for(Ic=31275;Ic<=31279;Ic++)kc[Ic]=0;for(Ic=31281;Ic<=31297;Ic++)kc[Ic]=0;for(Ic=31461;Ic<=31469;Ic++)kc[Ic]=0;for(Ic=31491;Ic<=31495;Ic++)kc[Ic]=0;for(Ic=31917;Ic<=31922;Ic++)kc[Ic]=0;for(Ic=31965;Ic<=32e3;Ic++)kc[Ic]=0;for(Ic=32001;Ic<=32003;Ic++)kc[Ic]=2;for(Ic=32005;Ic<=32031;Ic++)kc[Ic]=2;for(Ic=32033;Ic<=32060;Ic++)kc[Ic]=2;for(Ic=32064;Ic<=32067;Ic++)kc[Ic]=2;for(Ic=32074;Ic<=32077;Ic++)kc[Ic]=2;for(Ic=32081;Ic<=32086;Ic++)kc[Ic]=0;for(Ic=32107;Ic<=32130;Ic++)kc[Ic]=0;for(Ic=32133;Ic<=32158;Ic++)kc[Ic]=0;for(Ic=32164;Ic<=32167;Ic++)kc[Ic]=2;for(Ic=32180;Ic<=32199;Ic++)kc[Ic]=0;for(Ic=32201;Ic<=32260;Ic++)kc[Ic]=0;for(Ic=32301;Ic<=32360;Ic++)kc[Ic]=0;for(Ic=32601;Ic<=32662;Ic++)kc[Ic]=0;for(Ic=32664;Ic<=32667;Ic++)kc[Ic]=2;for(Ic=32701;Ic<=32761;Ic++)kc[Ic]=0;for(Ic=53001;Ic<=53004;Ic++)kc[Ic]=0;for(Ic=53008;Ic<=53019;Ic++)kc[Ic]=0;for(Ic=53021;Ic<=53032;Ic++)kc[Ic]=0;for(Ic=53034;Ic<=53037;Ic++)kc[Ic]=0;for(Ic=53042;Ic<=53046;Ic++)kc[Ic]=0;for(Ic=53074;Ic<=53080;Ic++)kc[Ic]=0;for(Ic=54001;Ic<=54004;Ic++)kc[Ic]=0;for(Ic=54008;Ic<=54019;Ic++)kc[Ic]=0;for(Ic=54021;Ic<=54032;Ic++)kc[Ic]=0;for(Ic=54034;Ic<=54037;Ic++)kc[Ic]=0;for(Ic=54042;Ic<=54046;Ic++)kc[Ic]=0;for(Ic=54048;Ic<=54053;Ic++)kc[Ic]=0;for(Ic=54074;Ic<=54080;Ic++)kc[Ic]=0;for(Ic=54098;Ic<=54101;Ic++)kc[Ic]=0;for(Ic=102001;Ic<=102040;Ic++)kc[Ic]=0;for(Ic=102042;Ic<=102063;Ic++)kc[Ic]=0;for(Ic=102065;Ic<=102067;Ic++)kc[Ic]=0;for(Ic=102070;Ic<=102117;Ic++)kc[Ic]=0;for(Ic=102122;Ic<=102216;Ic++)kc[Ic]=0;for(Ic=102221;Ic<=102377;Ic++)kc[Ic]=0;for(Ic=102382;Ic<=102388;Ic++)kc[Ic]=0;for(Ic=102389;Ic<=102398;Ic++)kc[Ic]=2;for(Ic=102399;Ic<=102444;Ic++)kc[Ic]=0;for(Ic=102445;Ic<=102447;Ic++)kc[Ic]=2;for(Ic=102448;Ic<=102458;Ic++)kc[Ic]=0;for(Ic=102459;Ic<=102468;Ic++)kc[Ic]=2;for(Ic=102469;Ic<=102499;Ic++)kc[Ic]=0;for(Ic=102500;Ic<=102519;Ic++)kc[Ic]=1;for(Ic=102520;Ic<=102524;Ic++)kc[Ic]=0;for(Ic=102525;Ic<=102529;Ic++)kc[Ic]=2;for(Ic=102530;Ic<=102588;Ic++)kc[Ic]=0;for(Ic=102590;Ic<=102598;Ic++)kc[Ic]=0;for(Ic=102601;Ic<=102603;Ic++)kc[Ic]=0;for(Ic=102605;Ic<=102628;Ic++)kc[Ic]=0;for(Ic=102629;Ic<=102646;Ic++)kc[Ic]=2;for(Ic=102648;Ic<=102700;Ic++)kc[Ic]=2;for(Ic=102701;Ic<=102703;Ic++)kc[Ic]=0;for(Ic=102707;Ic<=102730;Ic++)kc[Ic]=2;for(Ic=102733;Ic<=102758;Ic++)kc[Ic]=2;for(Ic=102767;Ic<=102900;Ic++)kc[Ic]=0;for(Ic=102965;Ic<=102969;Ic++)kc[Ic]=0;for(Ic=102971;Ic<=102973;Ic++)kc[Ic]=0;for(Ic=102975;Ic<=102989;Ic++)kc[Ic]=0;for(Ic=102990;Ic<=102992;Ic++)kc[Ic]=1;for(Ic=102997;Ic<=103002;Ic++)kc[Ic]=0;for(Ic=103003;Ic<=103008;Ic++)kc[Ic]=2;for(Ic=103009;Ic<=103011;Ic++)kc[Ic]=0;for(Ic=103012;Ic<=103014;Ic++)kc[Ic]=2;for(Ic=103019;Ic<=103021;Ic++)kc[Ic]=0;for(Ic=103022;Ic<=103024;Ic++)kc[Ic]=2;for(Ic=103029;Ic<=103031;Ic++)kc[Ic]=0;for(Ic=103032;Ic<=103034;Ic++)kc[Ic]=2;for(Ic=103065;Ic<=103068;Ic++)kc[Ic]=0;for(Ic=103074;Ic<=103076;Ic++)kc[Ic]=0;for(Ic=103077;Ic<=103079;Ic++)kc[Ic]=1;for(Ic=103080;Ic<=103082;Ic++)kc[Ic]=0;for(Ic=103083;Ic<=103085;Ic++)kc[Ic]=2;for(Ic=103090;Ic<=103093;Ic++)kc[Ic]=0;for(Ic=103097;Ic<=103099;Ic++)kc[Ic]=0;for(Ic=103100;Ic<=103102;Ic++)kc[Ic]=2;for(Ic=103107;Ic<=103109;Ic++)kc[Ic]=0;for(Ic=103110;Ic<=103112;Ic++)kc[Ic]=2;for(Ic=103113;Ic<=103116;Ic++)kc[Ic]=0;for(Ic=103117;Ic<=103120;Ic++)kc[Ic]=2;for(Ic=103153;Ic<=103157;Ic++)kc[Ic]=0;for(Ic=103158;Ic<=103162;Ic++)kc[Ic]=2;for(Ic=103163;Ic<=103165;Ic++)kc[Ic]=0;for(Ic=103166;Ic<=103168;Ic++)kc[Ic]=1;for(Ic=103169;Ic<=103171;Ic++)kc[Ic]=2;for(Ic=103186;Ic<=103188;Ic++)kc[Ic]=0;for(Ic=103189;Ic<=103191;Ic++)kc[Ic]=2;for(Ic=103192;Ic<=103195;Ic++)kc[Ic]=0;for(Ic=103196;Ic<=103199;Ic++)kc[Ic]=2;for(Ic=103200;Ic<=103224;Ic++)kc[Ic]=0;for(Ic=103225;Ic<=103227;Ic++)kc[Ic]=1;for(Ic=103232;Ic<=103237;Ic++)kc[Ic]=0;for(Ic=103238;Ic<=103243;Ic++)kc[Ic]=2;for(Ic=103244;Ic<=103246;Ic++)kc[Ic]=0;for(Ic=103247;Ic<=103249;Ic++)kc[Ic]=2;for(Ic=103254;Ic<=103256;Ic++)kc[Ic]=0;for(Ic=103257;Ic<=103259;Ic++)kc[Ic]=2;for(Ic=103264;Ic<=103266;Ic++)kc[Ic]=0;for(Ic=103267;Ic<=103269;Ic++)kc[Ic]=2;for(Ic=103300;Ic<=103375;Ic++)kc[Ic]=0;for(Ic=103381;Ic<=103383;Ic++)kc[Ic]=0;for(Ic=103384;Ic<=103386;Ic++)kc[Ic]=1;for(Ic=103387;Ic<=103389;Ic++)kc[Ic]=0;for(Ic=103390;Ic<=103392;Ic++)kc[Ic]=2;for(Ic=103397;Ic<=103399;Ic++)kc[Ic]=0;for(Ic=103400;Ic<=103471;Ic++)kc[Ic]=2;for(Ic=103476;Ic<=103478;Ic++)kc[Ic]=0;for(Ic=103479;Ic<=103481;Ic++)kc[Ic]=2;for(Ic=103486;Ic<=103488;Ic++)kc[Ic]=0;for(Ic=103489;Ic<=103491;Ic++)kc[Ic]=2;for(Ic=103492;Ic<=103495;Ic++)kc[Ic]=0;for(Ic=103496;Ic<=103499;Ic++)kc[Ic]=2;for(Ic=103528;Ic<=103543;Ic++)kc[Ic]=0;for(Ic=103544;Ic<=103548;Ic++)kc[Ic]=2;for(Ic=103549;Ic<=103551;Ic++)kc[Ic]=0;for(Ic=103552;Ic<=103554;Ic++)kc[Ic]=1;for(Ic=103555;Ic<=103557;Ic++)kc[Ic]=2;for(Ic=103558;Ic<=103560;Ic++)kc[Ic]=0;for(Ic=103571;Ic<=103573;Ic++)kc[Ic]=0;for(Ic=103574;Ic<=103576;Ic++)kc[Ic]=2;for(Ic=103577;Ic<=103580;Ic++)kc[Ic]=0;for(Ic=103581;Ic<=103583;Ic++)kc[Ic]=2;for(Ic=103595;Ic<=103694;Ic++)kc[Ic]=0;for(Ic=103696;Ic<=103699;Ic++)kc[Ic]=0;for(Ic=103700;Ic<=103793;Ic++)kc[Ic]=2;for(Ic=103794;Ic<=103872;Ic++)kc[Ic]=0;for(Ic=103900;Ic<=103971;Ic++)kc[Ic]=2;const Nc={102113:!0,102100:!0,3857:!0,3785:!0},Oc={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},Tc='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',Pc=[-20037508.342788905,20037508.342788905],Mc=[-20037508.342787,20037508.342787],Dc={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Pc,origin:Mc,dx:1e-5},102100:{wkTemplate:Tc,valid:Pc,origin:Mc,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Pc,origin:Mc,dx:1e-5},3857:{wkTemplate:Tc,valid:Pc,origin:Mc,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Lc(e,t){return!w(e)&&!w(t)&&(e===t||(null!=e.wkid||null!=t.wkid?e.wkid===t.wkid||Bc(e)&&Bc(t)||null!=t.latestWkid&&e.wkid===t.latestWkid||null!=e.latestWkid&&t.wkid===e.latestWkid:!(!e.wkt||!t.wkt)&&e.wkt.toUpperCase()===t.wkt.toUpperCase()))}function Ec(e){return Vc(e)&&e.wkid?Dc[e.wkid]:null}function Rc(e){return!!Vc(e)&&(e.wkid?null==kc[e.wkid]:!!e.wkt&&!!/^\s*GEOGCS/i.test(e.wkt))}function jc(e){return!(Uc(e)||qc(e))}function Fc(e){return Vc(e)&&4326===e.wkid}function Bc(e){return Vc(e)&&null!=e.wkid&&!0===Nc[e.wkid]}function zc(e){return 104971===e||104905===e}function Uc(e){return Vc(e)&&null!=e.wkid&&zc(e.wkid)}function Gc(e){return 104903===e}function qc(e){return Vc(e)&&null!=e.wkid&&Gc(e.wkid)}function Vc(e){return b(e)&&(null!=e.wkid&&e.wkid>=2e3||null!=e.wkt)}const Hc={wkid:4326,wkt:j(Dc[4326].wkTemplate,{Central_Meridian:"0.0"})};var $c;let Wc=$c=class extends Ac{constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}static fromJSON(e){if(!e)return null;if(e.wkid){if(102100===e.wkid)return $c.WebMercator;if(4326===e.wkid)return $c.WGS84}const t=new $c;return t.read(e),t}normalizeCtorArgs(e){return e&&"object"==typeof e?e:{["string"==typeof e?"wkt":"wkid"]:e}}get isWGS84(){return Fc(this)}get isWebMercator(){return Bc(this)}get isGeographic(){return Rc(this)}get isWrappable(){return function(e){return Vc(e)&&null!=e.wkid&&!0===Oc[e.wkid]}(this)}writeWkt(e,t){this.wkid||(t.wkt=e)}clone(){if(this===$c.WGS84)return $c.WGS84;if(this===$c.WebMercator)return $c.WebMercator;const e=new $c;return null!=this.wkid?(e.wkid=this.wkid,null!=this.latestWkid&&(e.latestWkid=this.latestWkid),null!=this.vcsWkid&&(e.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(e.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(e.wkt=this.wkt),this.imageCoordinateSystem&&(e.imageCoordinateSystem=d(this.imageCoordinateSystem)),e}equals(e){if(null==e)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==e.imageCoordinateSystem)return!1;const{id:t,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,s=this.imageCoordinateSystem;return null==t||i?JSON.stringify(s)===JSON.stringify(e.imageCoordinateSystem):r?s.id===t&&s.referenceServiceName===r:s.id===t}return Lc(this,e)}toJSON(e){return this.write(void 0,e)}};Wc.GCS_NAD_1927=null,Wc.WGS84=null,Wc.WebMercator=null,Wi([Ee({readOnly:!0})],Wc.prototype,"isWGS84",null),Wi([Ee({readOnly:!0})],Wc.prototype,"isWebMercator",null),Wi([Ee({readOnly:!0})],Wc.prototype,"isGeographic",null),Wi([Ee({readOnly:!0})],Wc.prototype,"isWrappable",null),Wi([Ee({type:ce,json:{write:!0}})],Wc.prototype,"latestWkid",void 0),Wi([Ee({type:ce,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkt}}}}}}})],Wc.prototype,"wkid",void 0),Wi([Ee({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkid}}}}}}})],Wc.prototype,"wkt",void 0),Wi([It("wkt"),It("web-scene","wkt")],Wc.prototype,"writeWkt",null),Wi([Ee({type:ce,json:{write:!0}})],Wc.prototype,"vcsWkid",void 0),Wi([Ee({type:ce,json:{write:!0}})],Wc.prototype,"latestVcsWkid",void 0),Wi([Ee()],Wc.prototype,"imageCoordinateSystem",void 0),Wc=$c=Wi([St("esri.geometry.SpatialReference")],Wc),Wc.prototype.toJSON.isDefaultToJSON=!0,Wc.GCS_NAD_1927=new Wc({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),Wc.WGS84=new Wc(Hc),Wc.WebMercator=new Wc({wkid:102100,latestWkid:3857}),Object.freeze&&(Object.freeze(Wc.GCS_NAD_1927),Object.freeze(Wc.WGS84),Object.freeze(Wc.WebMercator));var Jc=Wc;let Qc=class extends Ac{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Jc.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,t){if(e instanceof Jc)return e;if(null!=e){const r=new Jc;return r.read(e,t),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,t){this.cache[e]=t}};Wi([Ee()],Qc.prototype,"type",void 0),Wi([Ee({readOnly:!0})],Qc.prototype,"cache",null),Wi([Ee({readOnly:!0})],Qc.prototype,"extent",null),Wi([Ee({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Qc.prototype,"hasM",void 0),Wi([Ee({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Qc.prototype,"hasZ",void 0),Wi([Ee({type:Jc,json:{write:!0}})],Qc.prototype,"spatialReference",void 0),Wi([Je("spatialReference")],Qc.prototype,"readSpatialReference",null),Qc=Wi([St("esri.geometry.Geometry")],Qc);var Zc=Qc;class Yc{constructor(e,t,r,i){this.semiMajorAxis=e,this.flattening=t,this.outerAtmosphereRimWidth=r;const s=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*s,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=i||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const Kc=new Yc(6378137,1/298.257223563,3e5,.006694379990137799),Xc=new Yc(3396190,1/169.8944472236118,23e4),eh=new Yc(1737400,0,0),th=57.29577951308232,rh=.017453292519943;function ih(e){return e*th}function sh(e){return e*rh}function oh(e){return null!=e.wkid||null!=e.wkt}const nh=[0,0];function ah(e,t,r,i,s){const o=e,n=s;if(n.spatialReference=r,"x"in o&&"x"in n)[n.x,n.y]=t(o.x,o.y,nh,i);else if("xmin"in o&&"xmin"in n)[n.xmin,n.ymin]=t(o.xmin,o.ymin,nh,i),[n.xmax,n.ymax]=t(o.xmax,o.ymax,nh,i);else if("paths"in o&&"paths"in n||"rings"in o&&"rings"in n){const e="paths"in o?o.paths:o.rings,r=[];let s;for(let o=0;o<e.length;o++){const n=e[o];s=[],r.push(s);for(let e=0;e<n.length;e++)s.push(t(n[e][0],n[e][1],[0,0],i)),n[e].length>2&&s[e].push(n[e][2]),n[e].length>3&&s[e].push(n[e][3])}"paths"in n?n.paths=r:n.rings=r}else if("points"in o&&"points"in n){const e=o.points,r=[];for(let s=0;s<e.length;s++)r[s]=t(e[s][0],e[s][1],[0,0],i),e[s].length>2&&r[s].push(e[s][2]),e[s].length>3&&r[s].push(e[s][3]);n.points=r}return s}function lh(e,t){const r=e&&(oh(e)?e:e.spatialReference),i=t&&(oh(t)?t:t.spatialReference);return!(e&&"type"in e&&"mesh"===e.type||t&&"type"in t&&"mesh"===t.type||!r||!i)&&(!!Lc(i,r)||Bc(i)&&Fc(r)||Bc(r)&&Fc(i))}function ch(e,t){const r=e&&e.spatialReference,i=t&&(oh(t)?t:t.spatialReference);return lh(r,i)?Lc(r,i)?d(e):Bc(i)?ah(e,hh,Jc.WebMercator,!1,d(e)):Fc(i)?ah(e,uh,Jc.WGS84,!1,d(e)):null:null}function hh(e,t,r=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const i=sh(t);return r[0]=sh(e)*Kc.radius,r[1]=Kc.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function uh(e,t,r=[0,0],i=!1){const s=ih(e/Kc.radius);return r[0]=i?s:s-360*Math.floor((s+180)/360),r[1]=ih(Math.PI/2-2*Math.atan(Math.exp(-1*t/Kc.radius))),r}function dh(e,t=!1,r=d(e)){return ah(e,hh,Jc.WebMercator,t,r)}function ph(e,t=!1,r=d(e)){return ah(e,uh,Jc.WGS84,t,r)}var fh;const yh=[0,0];function mh(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}const gh=G.getLogger("esri.geometry.Point");let vh=fh=class extends Zc{constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone())}normalizeCtorArgs(e,t,r,i,s){let o;if(Array.isArray(e))o=e,s=t,e=o[0],t=o[1],r=o[2],i=o[3];else if(e&&"object"==typeof e){if(o=e,e=null!=o.x?o.x:o.longitude,t=null!=o.y?o.y:o.latitude,r=o.z,i=o.m,(s=o.spatialReference)&&"esri.geometry.SpatialReference"!==s.declaredClass&&(s=new Jc(s)),null!=o.longitude||null!=o.latitude)if(null==o.longitude)gh.warn(".longitude=","Latitude was defined without longitude");else if(null==o.latitude)gh.warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&s&&s.isWebMercator){const r=hh(o.longitude,o.latitude,yh);e=r[0],t=r[1]}}else mh(r)?(s=r,r=null):mh(i)&&(s=i,i=null);const n={x:e,y:t};return null==n.x&&null!=n.y?gh.warn(".y=","Y coordinate was defined without an X coordinate"):null==n.y&&null!=n.x&&gh.warn(".x=","X coordinate was defined without a Y coordinate"),null!=s&&(n.spatialReference=s),null!=r&&(n.z=r),null!=i&&(n.m=i),n}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(e){e!==(void 0!==this._get("m"))&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return void 0!==this.z}set hasZ(e){e!==(void 0!==this._get("z"))&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const{spatialReference:e,x:t,y:r}=this;if(e){if(e.isWebMercator)return uh(t,r,yh)[1];if(e.isGeographic)return r}return null}set latitude(e){const{spatialReference:t,x:r}=this;t&&(t.isWebMercator?this._set("y",hh(r,e,yh)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const{x:e,y:t,spatialReference:r}=this;if(r){if(r.isWebMercator)return uh(e,t,yh)[0];if(r.isGeographic)return e}return NaN}set longitude(e){const{y:t,spatialReference:r}=this;r&&(r.isWebMercator?this._set("x",hh(e,t,yh)[0]):r.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,r){t[r]=isNaN(e)?"NaN":e}readX(e){return"string"==typeof e?NaN:e}clone(){const e=new fh;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return fh.copy(e,this),this}equals(e){if(!e)return!1;const{x:t,y:r,z:i,m:s,spatialReference:o}=this,{z:n,m:a}=e;let{x:l,y:c,spatialReference:h}=e;if(!o.equals(h))if(o.isWebMercator&&h.isWGS84)[l,c]=hh(l,c),h=o;else{if(!o.isWGS84||!h.isWebMercator)return!1;[l,c]=uh(l,c),h=o}return t===l&&r===c&&i===n&&s===a&&o.wkid===h.wkid}offset(e,t,r){return function(e,t,r,i){return e.x=e.x+t,e.y=e.y+r,null!=i&&null!=e.z&&(e.z=e.z+i),e}(this,e,t,r)}normalize(){if(!this.spatialReference)return this;const e=Ec(this.spatialReference);if(!e)return this;let t=this.x;const[r,i]=e.valid,s=2*i;let o;return t>i?(o=Math.ceil(Math.abs(t-i)/s),t-=o*s):t<r&&(o=Math.ceil(Math.abs(t-r)/s),t+=o*s),this._set("x",t),this}distance(e){return function(e,t){const r=e.x-t.x,i=e.y-t.y,s=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(r*r+i*i+s*s)}(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write(null,e)}};Wi([Ee({readOnly:!0})],vh.prototype,"cache",null),Wi([Ee({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],vh.prototype,"hasM",null),Wi([Ee({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],vh.prototype,"hasZ",null),Wi([Ee({type:Number})],vh.prototype,"latitude",null),Wi([Ee({type:Number})],vh.prototype,"longitude",null),Wi([Ee({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ge((e=>isNaN(e)?e:W(e)))],vh.prototype,"x",void 0),Wi([It("x")],vh.prototype,"writeX",null),Wi([Je("x")],vh.prototype,"readX",null),Wi([Ee({type:Number,json:{write:!0}})],vh.prototype,"y",void 0),Wi([Ee({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],vh.prototype,"z",void 0),Wi([Ee({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],vh.prototype,"m",void 0),vh=fh=Wi([St("esri.geometry.Point")],vh),vh.prototype.toJSON.isDefaultToJSON=!0;var _h=vh;const bh=[0,0];function wh(e,t){return Ih(e,t.x,t.y,t.z)}function xh(e,t){if(!t.points||t.points.length)return!1;for(const r of t.points)if(!Sh(e,r))return!1;return!0}function Sh(e,t){return Ih(e,t[0],t[1])}function Ch(e,t){return Ih(e,t[0],t[1],t[2])}function Ih(e,t,r,i){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax&&(null==i||!e.hasZ||i>=e.zmin&&i<=e.zmax)}function Ah(e,t){return function(e,t){if(!e)return!1;if(function(e){return!Array.isArray(e[0][0])}(e))return kh(!1,e,t);let r=!1;for(let i=0,s=e.length;i<s;i++)r=kh(r,e[i],t);return r}(e.rings,t)}function kh(e,t,r){const[i,s]=r;let o=e,n=0;for(let e=0,r=t.length;e<r;e++){n++,n===r&&(n=0);const[a,l]=t[e],[c,h]=t[n];(l<s&&h>=s||h<s&&l>=s)&&a+(s-l)/(h-l)*(c-a)<i&&(o=!o)}return o}function Nh(e,t){return wh(e,t)}function Oh(e,t){const r=e.hasZ&&t.hasZ;let i,s,o;if(e.xmin<=t.xmin){if(i=t.xmin,e.xmax<i)return!1}else if(i=e.xmin,t.xmax<i)return!1;if(e.ymin<=t.ymin){if(s=t.ymin,e.ymax<s)return!1}else if(s=e.ymin,t.ymax<s)return!1;if(r&&t.hasZ)if(e.zmin<=t.zmin){if(o=t.zmin,e.zmax<o)return!1}else if(o=e.zmin,t.zmax<o)return!1;return!0}function Th(e,t){const{points:r,hasZ:i}=t,s=i?Ch:Sh;for(const t of r)if(s(e,t))return!0;return!1}const Ph=[0,0],Mh=[0,0],Dh=[0,0],Lh=[0,0],Eh=[Ph,Mh,Dh,Lh],Rh=[[Dh,Ph],[Ph,Mh],[Mh,Lh],[Lh,Dh]];function jh(e,t){Ph[0]=e.xmin,Ph[1]=e.ymax,Mh[0]=e.xmax,Mh[1]=e.ymax,Dh[0]=e.xmin,Dh[1]=e.ymin,Lh[0]=e.xmax,Lh[1]=e.ymin;for(const e of Eh)if(Ah(t,e))return!0;for(const r of t.rings){if(!r.length)continue;let t=r[0];if(Sh(e,t))return!0;for(let i=1;i<r.length;i++){const s=r[i];if(Sh(e,s)||zh(t,s,Rh))return!0;t=s}}return!1}function Fh(e,t){Ph[0]=e.xmin,Ph[1]=e.ymax,Mh[0]=e.xmax,Mh[1]=e.ymax,Dh[0]=e.xmin,Dh[1]=e.ymin,Lh[0]=e.xmax,Lh[1]=e.ymin;const r=t.paths;for(const t of r){if(!r.length)continue;let i=t[0];if(Sh(e,i))return!0;for(let r=1;r<t.length;r++){const s=t[r];if(Sh(e,s)||zh(i,s,Rh))return!0;i=s}}return!1}const Bh=[0,0];function zh(e,t,r){for(let i=0;i<r.length;i++)if(Uh(e,t,r[i][0],r[i][1]))return!0;return!1}function Uh(e,t,r,i,s){const[o,n]=e,[a,l]=t,[c,h]=r,[u,d]=i,p=u-c,f=o-c,y=a-o,m=d-h,g=n-h,v=l-n,_=m*y-p*v;if(0===_)return!1;const b=(p*g-m*f)/_,w=(y*g-v*f)/_;return b>=0&&b<=1&&w>=0&&w<=1&&(s&&(s[0]=o+b*(a-o),s[1]=n+b*(l-n)),!0)}function Gh(e){switch(e){case"esriGeometryEnvelope":case"extent":case"mesh":return Oh;case"esriGeometryMultipoint":case"multipoint":return Th;case"esriGeometryPoint":case"point":return Nh;case"esriGeometryPolygon":case"polygon":return jh;case"esriGeometryPolyline":case"polyline":return Fh}}var qh;function Vh(e,t,r){return null==t?r:null==r?t:e(t,r)}let Hh=qh=class extends Zc{constructor(...e){super(...e),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(e,t,r,i,s){return function(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof e?(e.spatialReference=null==e.spatialReference?Jc.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:r,ymax:i,spatialReference:null==s?Jc.WGS84:s}}static fromBounds(e,t){return new qh({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const e=new _h({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(e){const t=this.center;return null!=e.z&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}clone(){const e=new qh;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,null!=this.zmin&&(e.zmin=this.zmin,e.zmax=this.zmax),null!=this.mmin&&(e.mmin=this.mmin,e.mmax=this.mmax),e}contains(e){if(!e)return!1;const t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&lh(t,r)&&(e=t.isWebMercator?dh(e):ph(e,!0)),"point"===e.type?wh(this,e):"extent"===e.type&&function(e,t){const{xmin:r,ymin:i,zmin:s,xmax:o,ymax:n,zmax:a}=t;return e.hasZ&&t.hasZ?Ih(e,r,i,s)&&Ih(e,r,n,s)&&Ih(e,o,n,s)&&Ih(e,o,i,s)&&Ih(e,r,i,a)&&Ih(e,r,n,a)&&Ih(e,o,n,a)&&Ih(e,o,i,a):Ih(e,r,i)&&Ih(e,r,n)&&Ih(e,o,n)&&Ih(e,o,i)}(this,e)}equals(e){if(!e)return!1;const t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&lh(t,r)&&(e=t.isWebMercator?dh(e):ph(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}expand(e){const t=.5*(1-e),r=this.width*t,i=this.height*t;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const e=(this.zmax-this.zmin)*t;this.zmin+=e,this.zmax-=e}if(this.hasM){const e=(this.mmax-this.mmin)*t;this.mmin+=e,this.mmax-=e}return this}intersects(e){if(w(e))return!1;"mesh"===e.type&&(e=e.extent);const t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&lh(t,r)&&(e=t.isWebMercator?dh(e):ph(e,!0)),Gh(e.type)(this,e)}normalize(){const e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}offset(e,t,r){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,null!=r&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(e){return this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=Vh(Math.min,this.zmin,e.zmin),this.zmax=Vh(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=Vh(Math.min,this.mmin,e.mmin),this.mmax=Vh(Math.max,this.mmax,e.mmax)),this}intersection(e){return this.intersects(e)?(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=Vh(Math.max,this.zmin,e.zmin),this.zmax=Vh(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=Vh(Math.max,this.mmin,e.mmin),this.mmax=Vh(Math.min,this.mmax,e.mmax)),this):null}toJSON(e){return this.write(null,e)}_shiftCM(e=Ec(this.spatialReference)){if(!e||!this.spatialReference)return this;const t=this.spatialReference,r=this._getCM(e);if(r){const i=t.isWebMercator?ph(r):r;this.xmin-=r.x,this.xmax-=r.x,t.isWebMercator||(i.x=this._normalizeX(i.x,e).x),this.spatialReference=new Jc(j(t.isWGS84?e.altTemplate:e.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(e){let t=null;const[r,i]=e.valid,s=this.xmin,o=this.xmax;return s>=r&&s<=i&&o>=r&&o<=i||(t=this.center),t}_normalize(e,t,r){const i=this.spatialReference;if(!i)return this;if(!(r=r||Ec(i)))return this;const s=this._getParts(r).map((e=>e.extent));if(s.length<2)return s[0]||this;if(s.length>2)return e?this._shiftCM(r):this.set({xmin:r.valid[0],xmax:r.valid[1]});if(e)return this._shiftCM(r);if(t)return s;let o=!0,n=!0;return s.forEach((e=>{e.hasZ||(o=!1),e.hasM||(n=!1)})),{rings:s.map((e=>{const t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(o){const r=(e.zmax-e.zmin)/2;for(let e=0;e<t.length;e++)t[e].push(r)}if(n){const r=(e.mmax-e.mmin)/2;for(let e=0;e<t.length;e++)t[e].push(r)}return t})),hasZ:o,hasM:n,spatialReference:i}}_getParts(e){let t=this.cache._parts;if(!t){t=[];const{ymin:r,ymax:i,spatialReference:s}=this,o=this.width,n=this.xmin,a=this.xmax;let l;e=e||Ec(s);const[c,h]=e.valid;l=this._normalizeX(this.xmin,e);const u=l.x,d=l.frameId;l=this._normalizeX(this.xmax,e);const p=l.x,f=l.frameId,y=u===p&&o>0;if(o>2*h){const e=new qh(n<a?u:p,r,h,i,s),o=new qh(c,r,n<a?p:u,i,s),l=new qh(0,r,h,i,s),y=new qh(c,r,0,i,s),m=[],g=[];e.contains(l)&&m.push(d),e.contains(y)&&g.push(d),o.contains(l)&&m.push(f),o.contains(y)&&g.push(f);for(let e=d+1;e<f;e++)m.push(e),g.push(e);t.push({extent:e,frameIds:[d]},{extent:o,frameIds:[f]},{extent:l,frameIds:m},{extent:y,frameIds:g})}else u>p||y?t.push({extent:new qh(u,r,h,i,s),frameIds:[d]},{extent:new qh(c,r,p,i,s),frameIds:[f]}):t.push({extent:new qh(u,r,p,i,s),frameIds:[d]});this.cache._parts=t}const r=this.hasZ,i=this.hasM;if(r||i){const e={};r&&(e.zmin=this.zmin,e.zmax=this.zmax),i&&(e.mmin=this.mmin,e.mmax=this.mmax);for(let r=0;r<t.length;r++)t[r].extent.set(e)}return t}_normalizeX(e,t){const[r,i]=t.valid,s=2*i;let o,n=0;return e>i?(o=Math.ceil(Math.abs(e-i)/s),e-=o*s,n=o):e<r&&(o=Math.ceil(Math.abs(e-r)/s),e+=o*s,n=-o),{x:e,frameId:n}}};Wi([Ee({readOnly:!0})],Hh.prototype,"cache",null),Wi([Ee({readOnly:!0})],Hh.prototype,"center",null),Wi([Ee({readOnly:!0})],Hh.prototype,"extent",null),Wi([Ee({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Hh.prototype,"hasM",null),Wi([Ee({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Hh.prototype,"hasZ",null),Wi([Ee({readOnly:!0})],Hh.prototype,"height",null),Wi([Ee({readOnly:!0})],Hh.prototype,"width",null),Wi([Ee({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Hh.prototype,"xmin",void 0),Wi([Ee({type:Number,json:{write:!0}})],Hh.prototype,"ymin",void 0),Wi([Ee({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Hh.prototype,"mmin",void 0),Wi([Ee({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Hh.prototype,"zmin",void 0),Wi([Ee({type:Number,json:{write:!0}})],Hh.prototype,"xmax",void 0),Wi([Ee({type:Number,json:{write:!0}})],Hh.prototype,"ymax",void 0),Wi([Ee({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Hh.prototype,"mmax",void 0),Wi([Ee({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Hh.prototype,"zmax",void 0),Hh=qh=Wi([St("esri.geometry.Extent")],Hh),Hh.prototype.toJSON.isDefaultToJSON=!0;var $h,Wh=Hh;function Jh(e,t,r=!1){let{hasM:i,hasZ:s}=e;Array.isArray(t)?4!==t.length||i||s?3===t.length&&r&&!i?(s=!0,i=!1):3===t.length&&i&&s&&(i=!1,s=!1):(i=!0,s=!0):(s=!s&&t.hasZ&&(!i||t.hasM),i=!i&&t.hasM&&(!s||t.hasZ)),e.hasZ=s,e.hasM=i}function Qh(e){return(t,r)=>null==t?r:null==r?t:e(t,r)}let Zh=$h=class extends Zc{constructor(...e){super(...e),this.points=[],this.type="multipoint"}normalizeCtorArgs(e,t){if(!e&&!t)return null;const r={};Array.isArray(e)?(r.points=e,r.spatialReference=t):function(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}(e)?r.spatialReference=e:(e.points&&(r.points=e.points),e.spatialReference&&(r.spatialReference=e.spatialReference),e.hasZ&&(r.hasZ=e.hasZ),e.hasM&&(r.hasM=e.hasM));const i=r.points&&r.points[0];return i&&(void 0===r.hasZ&&void 0===r.hasM?(r.hasZ=i.length>2,r.hasM=!1):void 0===r.hasZ?r.hasZ=i.length>3:void 0===r.hasM&&(r.hasM=i.length>3)),r}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const e=this.points;if(!e.length)return null;const t=new Wh,r=this.hasZ,i=this.hasM,s=r?3:2,o=e[0],n=Qh(Math.min),a=Qh(Math.max);let l,c,h,u,[d,p]=o,[f,y]=o;for(let t=0,o=e.length;t<o;t++){const o=e[t],[m,g]=o;if(d=n(d,m),p=n(p,g),f=a(f,m),y=a(y,g),r&&o.length>2){const e=o[2];l=n(l,e),h=a(h,e)}if(i&&o.length>s){const e=o[s];c=n(c,e),u=a(u,e)}}return t.xmin=d,t.ymin=p,t.xmax=f,t.ymax=y,t.spatialReference=this.spatialReference,r?(t.zmin=l,t.zmax=h):(t.zmin=null,t.zmax=null),i?(t.mmin=c,t.mmax=u):(t.mmin=null,t.mmax=null),t}writePoints(e,t){t.points=d(this.points)}addPoint(e){return Jh(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}clone(){const e={points:d(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new $h(e)}getPoint(e){if(!this._validateInputs(e))return null;const t=this.points[e],r={x:t[0],y:t[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=t[2],i=3),this.hasM&&(r.m=t[i]),new _h(r)}removePoint(e){if(!this._validateInputs(e))return null;const t=new _h(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}setPoint(e,t){return this._validateInputs(e)?(Jh(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}toJSON(e){return this.write(null,e)}_validateInputs(e){return null!=e&&e>=0&&e<this.points.length}};Wi([Ee({readOnly:!0})],Zh.prototype,"cache",null),Wi([Ee()],Zh.prototype,"extent",null),Wi([Ee({type:[[Number]],json:{write:{isRequired:!0}}})],Zh.prototype,"points",void 0),Wi([It("points")],Zh.prototype,"writePoints",null),Zh=$h=Wi([St("esri.geometry.Multipoint")],Zh),Zh.prototype.toJSON.isDefaultToJSON=!0;var Yh=Zh;function Kh(e,t){const r=t[0]-e[0],i=t[1]-e[1];if(e.length>2&&t.length>2){const s=e[2]-t[2];return Math.sqrt(r*r+i*i+s*s)}return Math.sqrt(r*r+i*i)}function Xh(e,t){return function(e,t,r){const i=e[0]+.5*(t[0]-e[0]),s=e[1]+.5*(t[1]-e[1]);return e.length>2&&t.length>2?[i,s,e[2]+.5*(t[2]-e[2])]:[i,s]}(e,t)}function eu(e,t,r){const i=e.length;let s=0,o=0,n=0;for(let a=0;a<i;a++){const l=e[a],c=e[(a+1)%i];let h=2;s+=l[0]*c[1]-c[0]*l[1],l.length>2&&c.length>2&&r&&(o+=l[0]*c[2]-c[0]*l[2],h=3),l.length>h&&c.length>h&&t&&(n+=l[0]*c[h]-c[0]*l[h])}return s<=0&&o<=0&&n<=0}function tu(e,t,r){let i=0,s=0,o=0,n=0,a=0;for(let l=0;l<e.length;l++){const c=e[l],[h,u,d]=c,p=e[(l+1)%e.length],[f,y,m]=p;let g=h*y-f*u;n+=g,i+=(h+f)*g,s+=(u+y)*g,t&&c.length>2&&p.length>2&&(g=h*m-f*d,o+=(d+m)*g,a+=g),h<r[0]&&(r[0]=h),h>r[1]&&(r[1]=h),u<r[2]&&(r[2]=u),u>r[3]&&(r[3]=u),t&&(d<r[4]&&(r[4]=d),d>r[5]&&(r[5]=d))}if(n>0&&(n*=-1),a>0&&(a*=-1),!n)return null;const l=[i,s,.5*n];return t&&(l[3]=o,l[4]=.5*a),l}function ru(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function iu(e){return void 0!==e.points}function su(e){return void 0!==e.x&&void 0!==e.y}function ou(e){return void 0!==e.paths}function nu(e){return void 0!==e.rings}function au(e){return(t,r)=>null==t?r:null==r?t:e(t,r)}const lu=au(Math.min),cu=au(Math.max);function hu(e,t){return ou(t)?du(e,t.paths,!1,!1):nu(t)?du(e,t.rings,!1,!1):iu(t)?fu(e,t.points,!1,!1,!1,!1):ru(t)?pu(e,t):(su(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function uu(e,t){return ou(t)?du(e,t.paths,!0,!1):nu(t)?du(e,t.rings,!0,!1):iu(t)?fu(e,t.points,!0,!1,!0,!1):ru(t)?pu(e,t,0,0,!0,!1):(su(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function du(e,t,r,i){const s=r?3:2;if(!t.length||!t[0].length)return null;let o,n,a,l,[c,h]=t[0][0],[u,d]=t[0][0];for(let e=0;e<t.length;e++){const p=t[e];for(let e=0;e<p.length;e++){const t=p[e],[f,y]=t;if(c=lu(c,f),h=lu(h,y),u=cu(u,f),d=cu(d,y),r&&t.length>2){const e=t[2];o=lu(o,e),n=cu(n,e)}if(i&&t.length>s){const e=t[s];a=lu(o,e),l=cu(n,e)}}}return r?i?(e[0]=c,e[1]=h,e[2]=o,e[3]=a,e[4]=u,e[5]=d,e[6]=n,e[7]=l,e.length=8,e):(e[0]=c,e[1]=h,e[2]=o,e[3]=u,e[4]=d,e[5]=n,e.length=6,e):i?(e[0]=c,e[1]=h,e[2]=a,e[3]=u,e[4]=d,e[5]=l,e.length=6,e):(e[0]=c,e[1]=h,e[2]=u,e[3]=d,e.length=4,e)}function pu(e,t,r,i,s,o){const n=t.xmin,a=t.xmax,l=t.ymin,c=t.ymax;let h=t.zmin,u=t.zmax,d=t.mmin,p=t.mmax;return s?(h=h||0,u=u||0,o?(d=d||0,p=p||0,e[0]=n,e[1]=l,e[2]=h,e[3]=d,e[4]=a,e[5]=c,e[6]=u,e[7]=p,e):(e[0]=n,e[1]=l,e[2]=h,e[3]=a,e[4]=c,e[5]=u,e)):o?(d=d||0,p=p||0,e[0]=n,e[1]=l,e[2]=d,e[3]=a,e[4]=c,e[5]=p,e):(e[0]=n,e[1]=l,e[2]=a,e[3]=c,e)}function fu(e,t,r,i,s,o){const n=r?3:2,a=i&&o,l=r&&s;if(!t.length||!t[0].length)return null;let c,h,u,d,[p,f]=t[0],[y,m]=t[0];for(let e=0;e<t.length;e++){const r=t[e],[i,s]=r;if(p=lu(p,i),f=lu(f,s),y=cu(y,i),m=cu(m,s),l&&r.length>2){const e=r[2];c=lu(c,e),h=cu(h,e)}if(a&&r.length>n){const e=r[n];u=lu(c,e),d=cu(h,e)}}return s?(c=c||0,h=h||0,o?(u=u||0,d=d||0,e[0]=p,e[1]=f,e[2]=c,e[3]=u,e[4]=y,e[5]=m,e[6]=h,e[7]=d,e):(e[0]=p,e[1]=f,e[2]=c,e[3]=y,e[4]=m,e[5]=h,e)):o?(u=u||0,d=d||0,e[0]=p,e[1]=f,e[2]=u,e[3]=y,e[4]=m,e[5]=d,e):(e[0]=p,e[1]=f,e[2]=y,e[3]=m,e)}const yu=[];function mu(e,t,r,i){return{xmin:e,ymin:t,xmax:r,ymax:i}}function gu(e,t,r,i,s,o){return{xmin:e,ymin:t,zmin:r,xmax:i,ymax:s,zmax:o}}function vu(e,t,r,i,s,o){return{xmin:e,ymin:t,mmin:r,xmax:i,ymax:s,mmax:o}}function _u(e,t,r,i,s,o,n,a){return{xmin:e,ymin:t,zmin:r,mmin:i,xmax:s,ymax:o,zmax:n,mmax:a}}function bu(e,t=!1,r=!1){return t?r?_u(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):gu(e[0],e[1],e[2],e[3],e[4],e[5]):r?vu(e[0],e[1],e[2],e[3],e[4],e[5]):mu(e[0],e[1],e[2],e[3])}function wu(e){return e?function(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}(e)?e:function(e){return void 0!==e.x&&void 0!==e.y}(e)?function(e){const{x:t,y:r,z:i,m:s}=e,o=null!=s;return null!=i?o?_u(t,r,i,s,t,r,i,s):gu(t,r,i,t,r,i):o?vu(t,r,s,t,r,s):mu(t,r,t,r)}(e):function(e){return void 0!==e.rings}(e)?xu(e):function(e){return void 0!==e.paths}(e)?Su(e):function(e){return void 0!==e.points}(e)?function(e){const{hasZ:t,hasM:r,points:i}=e;return bu(fu(yu,i,t,r),t,r)}(e):null:null}function xu(e){const{hasZ:t,hasM:r,rings:i}=e,s=du(yu,i,t,r);return s?bu(s,t,r):null}function Su(e){const{hasZ:t,hasM:r,paths:i}=e,s=du(yu,i,t,r);return s?bu(s,t,r):null}var Cu;function Iu(e){return!Array.isArray(e[0])}let Au=Cu=class extends Zc{constructor(...e){super(...e),this.rings=[],this.type="polygon"}static fromExtent(e){const t=e.clone().normalize(),r=e.spatialReference;let i=!1,s=!1;t.map((e=>{e.hasZ&&(i=!0),e.hasM&&(s=!0)}));const o={rings:t.map((function(e){const t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(i&&e.hasZ){const r=e.zmin+.5*(e.zmax-e.zmin);for(let e=0;e<t.length;e++)t[e].push(r)}if(s&&e.hasM){const r=e.mmin+.5*(e.mmax-e.mmin);for(let e=0;e<t.length;e++)t[e].push(r)}return t})),spatialReference:r};return i&&(o.hasZ=!0),s&&(o.hasM=!0),new Cu(o)}normalizeCtorArgs(e,t){let r,i,s=null,o=null;return e&&!Array.isArray(e)?(s=e.rings?e.rings:null,t||(e.spatialReference?t=e.spatialReference:e.rings||(t=e)),r=e.hasZ,i=e.hasM):s=e,s=s||[],t=t||Jc.WGS84,s.length&&s[0]&&null!=s[0][0]&&"number"==typeof s[0][0]&&(s=[s]),o=s[0]&&s[0][0],o&&(void 0===r&&void 0===i?(r=o.length>2,i=!1):void 0===r?r=!i&&o.length>3:void 0===i&&(i=!r&&o.length>3)),{rings:s,spatialReference:t,hasZ:r,hasM:i}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const e=(t=this)?function(e,t){if(!e||!e.length)return null;const r=[],i=[],s=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let r=0,o=e.length;r<o;r++){const o=tu(e[r],t,s);o&&i.push(o)}if(i.sort(((e,r)=>{let i=e[2]-r[2];return 0===i&&t&&(i=e[4]-r[4]),i})),i.length){let e=6*i[0][2];r[0]=i[0][0]/e,r[1]=i[0][1]/e,t&&(e=6*i[0][4],r[2]=0!==e?i[0][3]/e:0),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||t&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)}if(!r.length){const i=e[0]&&e[0].length?function(e,t){const r=t?[0,0,0]:[0,0],i=t?[0,0,0]:[0,0];let s=0,o=0,n=0,a=0;for(let l=0,c=e.length;l<c-1;l++){const c=e[l],h=e[l+1];if(c&&h){r[0]=c[0],r[1]=c[1],i[0]=h[0],i[1]=h[1],t&&c.length>2&&h.length>2&&(r[2]=c[2],i[2]=h[2]);const e=Kh(r,i);if(e){s+=e;const r=Xh(c,h);o+=e*r[0],n+=e*r[1],t&&r.length>2&&(a+=e*r[2])}}}return s>0?t?[o/s,n/s,a/s]:[o/s,n/s]:e.length?e[0]:null}(e[0],t):null;if(!i)return null;r[0]=i[0],r[1]=i[1],t&&i.length>2&&(r[2]=i[2])}return r}(t.rings,t.hasZ):null;var t;if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;const r=new _h;return r.x=e[0],r.y=e[1],r.spatialReference=this.spatialReference,this.hasZ&&(r.z=e[2]),r}get extent(){const{spatialReference:e}=this,t=xu(this);if(!t)return null;const r=new Wh(t);return r.spatialReference=e,r}get isSelfIntersecting(){return function(e){for(let t=0;t<e.length;t++){const r=e[t];for(let i=0;i<r.length-1;i++){const s=r[i],o=r[i+1];for(let r=t+1;r<e.length;r++)for(let t=0;t<e[r].length-1;t++){const i=e[r][t],n=e[r][t+1];if(Uh(s,o,i,n,Bh)&&!(Bh[0]===s[0]&&Bh[1]===s[1]||Bh[0]===i[0]&&Bh[1]===i[1]||Bh[0]===o[0]&&Bh[1]===o[1]||Bh[0]===n[0]&&Bh[1]===n[1]))return!0}}const i=r.length;if(!(i<=4))for(let e=0;e<i-3;e++){let t=i-1;0===e&&(t=i-2);const s=r[e],o=r[e+1];for(let i=e+2;i<t;i++){const e=r[i],t=r[i+1];if(Uh(s,o,e,t,Bh)&&!(Bh[0]===s[0]&&Bh[1]===s[1]||Bh[0]===e[0]&&Bh[1]===e[1]||Bh[0]===o[0]&&Bh[1]===o[1]||Bh[0]===t[0]&&Bh[1]===t[1]))return!0}}}return!1}(this.rings)}writeRings(e,t){t.rings=d(this.rings)}addRing(e){if(!e)return;const t=this.rings,r=t.length;if(Iu(e)){const i=[];for(let t=0,r=e.length;t<r;t++)i[t]=e[t].toArray();t[r]=i}else t[r]=e.concat();return this.notifyChange("rings"),this}clone(){const e=new Cu;return e.spatialReference=this.spatialReference,e.rings=d(this.rings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}contains(e){return!!e&&(lh(e,this.spatialReference)&&(e=ch(e,this.spatialReference)),function(e,t){return bh[1]=t.y,bh[0]=t.x,Ah(e,bh)}(this,e))}isClockwise(e){let t;return t=Iu(e)?e.map((e=>this.hasZ?this.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y])):e,eu(t,this.hasM,this.hasZ)}getPoint(e,t){if(!this._validateInputs(e,t))return null;const r=this.rings[e][t],i=this.hasZ,s=this.hasM;return i&&!s?new _h(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new _h(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new _h(r[0],r[1],r[2],r[3],this.spatialReference):new _h(r[0],r[1],this.spatialReference)}insertPoint(e,t,r){return this._validateInputs(e,t,!0)?(Jh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e].splice(t,0,r),this.notifyChange("rings"),this):this}removePoint(e,t){if(!this._validateInputs(e,t))return null;const r=new _h(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(e){if(!this._validateInputs(e,null))return null;const t=this.rings.splice(e,1)[0],r=this.spatialReference,i=t.map((e=>new _h(e,r)));return this.notifyChange("rings"),i}setPoint(e,t,r){return this._validateInputs(e,t)?(Jh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e][t]=r,this.notifyChange("rings"),this):this}_validateInputs(e,t,r=!1){if(null==e||e<0||e>=this.rings.length)return!1;if(null!=t){const i=this.rings[e];if(r&&(t<0||t>i.length))return!1;if(!r&&(t<0||t>=i.length))return!1}return!0}toJSON(e){return this.write(null,e)}};Wi([Ee({readOnly:!0})],Au.prototype,"cache",null),Wi([Ee({readOnly:!0})],Au.prototype,"centroid",null),Wi([Ee({readOnly:!0})],Au.prototype,"extent",null),Wi([Ee({readOnly:!0})],Au.prototype,"isSelfIntersecting",null),Wi([Ee({type:[[[Number]]],json:{write:{isRequired:!0}}})],Au.prototype,"rings",void 0),Wi([It("rings")],Au.prototype,"writeRings",null),Au=Cu=Wi([St("esri.geometry.Polygon")],Au),Au.prototype.toJSON.isDefaultToJSON=!0;var ku,Nu=Au;let Ou=ku=class extends Zc{constructor(...e){super(...e),this.paths=[],this.type="polyline"}normalizeCtorArgs(e,t){let r,i,s=null,o=null;return e&&!Array.isArray(e)?(s=e.paths?e.paths:null,t||(e.spatialReference?t=e.spatialReference:e.paths||(t=e)),r=e.hasZ,i=e.hasM):s=e,s=s||[],t=t||Jc.WGS84,s.length&&s[0]&&null!=s[0][0]&&"number"==typeof s[0][0]&&(s=[s]),o=s[0]&&s[0][0],o&&(void 0===r&&void 0===i?(r=o.length>2,i=!1):void 0===r?r=!i&&o.length>3:void 0===i&&(i=!r&&o.length>3)),{paths:s,spatialReference:t,hasZ:r,hasM:i}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:e}=this,t=Su(this);if(!t)return null;const r=new Wh(t);return r.spatialReference=e,r}writePaths(e,t){t.paths=d(this.paths)}addPath(e){if(!e)return;const t=this.paths,r=t.length;if(function(e){return!Array.isArray(e[0])}(e)){const i=[];for(let t=0,r=e.length;t<r;t++)i[t]=e[t].toArray();t[r]=i}else t[r]=e.concat();return this.notifyChange("paths"),this}clone(){const e=new ku;return e.spatialReference=this.spatialReference,e.paths=d(this.paths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}getPoint(e,t){if(!this._validateInputs(e,t))return null;const r=this.paths[e][t],i=this.hasZ,s=this.hasM;return i&&!s?new _h(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new _h(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new _h(r[0],r[1],r[2],r[3],this.spatialReference):new _h(r[0],r[1],this.spatialReference)}insertPoint(e,t,r){return this._validateInputs(e,t,!0)?(Jh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e].splice(t,0,r),this.notifyChange("paths"),this):this}removePath(e){if(!this._validateInputs(e,null))return null;const t=this.paths.splice(e,1)[0],r=this.spatialReference,i=t.map((e=>new _h(e,r)));return this.notifyChange("paths"),i}removePoint(e,t){if(!this._validateInputs(e,t))return null;const r=new _h(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(e,t,r){return this._validateInputs(e,t)?(Jh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e][t]=r,this.notifyChange("paths"),this):this}_validateInputs(e,t,r=!1){if(null==e||e<0||e>=this.paths.length)return!1;if(null!=t){const i=this.paths[e];if(r&&(t<0||t>i.length))return!1;if(!r&&(t<0||t>=i.length))return!1}return!0}toJSON(e){return this.write(null,e)}};Wi([Ee({readOnly:!0})],Ou.prototype,"cache",null),Wi([Ee({readOnly:!0})],Ou.prototype,"extent",null),Wi([Ee({type:[[[Number]]],json:{write:{isRequired:!0}}})],Ou.prototype,"paths",void 0),Wi([It("paths")],Ou.prototype,"writePaths",null),Ou=ku=Wi([St("esri.geometry.Polyline")],Ou),Ou.prototype.toJSON.isDefaultToJSON=!0;var Tu=Ou;const Pu=$e()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Mu=$e()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function Du(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function Lu(e){return void 0!==e.points}function Eu(e){return void 0!==e.x&&void 0!==e.y}function Ru(e){return void 0!==e.paths}function ju(e){return void 0!==e.rings}function Fu(e){return e?e instanceof Zc?e:Eu(e)?_h.fromJSON(e):Ru(e)?Tu.fromJSON(e):ju(e)?Nu.fromJSON(e):Lu(e)?Yh.fromJSON(e):Du(e)?Wh.fromJSON(e):null:null}function Bu(e){return e?Eu(e)?"esriGeometryPoint":Ru(e)?"esriGeometryPolyline":ju(e)?"esriGeometryPolygon":Du(e)?"esriGeometryEnvelope":Lu(e)?"esriGeometryMultipoint":null:null}const zu={esriGeometryPoint:_h,esriGeometryPolyline:Tu,esriGeometryPolygon:Nu,esriGeometryEnvelope:Wh,esriGeometryMultipoint:Yh};function Uu(e){return e&&zu[e]||null}const Gu={base:Zc,key:"type",typeMap:{extent:Wh,multipoint:Yh,point:_h,polyline:Tu,polygon:Nu}};le(Gu);class qu{constructor(e){e&&(this.layerID=e.layer||e.layerID||null,this.hierarchy=e.hierarchy||null,this.countryID=e.sourceCountry||e.countryID||null)}toJSON(){const e={};return this.layerID&&(e.layer=this.layerID),this.hierarchy&&(e.hierarchy=this.hierarchy),this.countryID&&(e.sourceCountry=this.countryID),e}static fromJsonArray(e){const t=[];if(!e)return t;for(let r=0;r<e.length;r++){let i=e[r];i instanceof qu||(i=new qu(i)),t.push(i)}return t}static toJsonArray(e){if(!e||0===e.length)return null;const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toJSON());return t}}class Vu{}class Hu extends Vu{constructor(e){super(),e&&(e.bufferRadii?this.radii=e.bufferRadii:e.radius?this.radii=[e.radius]:e.radii&&(this.radii=e.radii),this.units=e.bufferUnits||e.units),this.radii||(this.radii=[5]),this.units||(this.units="esriDriveTimeUnitsMinutes")}toJSON(){return{areaType:"DriveTimeBuffer",bufferUnits:this.units,bufferRadii:this.radii&&this.radii.slice()}}}class $u extends Vu{constructor(e){let t;super(),t=e?e.intersectingGeographies||e.levels||e.geographyLevels:[{layer:"Admin2"}],this.geographyLevels=qu.fromJsonArray(t)}toJSON(){return{areaType:"StandardGeography",intersectingGeographies:qu.toJsonArray(this.geographyLevels)}}}class Wu extends Vu{constructor(e){super(),e&&(e.bufferRadii?this.radii=e.bufferRadii:e.radius?this.radii=[e.radius]:e.radii&&(this.radii=e.radii),this.units=e.bufferUnits||e.units),this.radii||(this.radii=[1]),this.units||(this.units="esriMiles")}toJSON(){return{areaType:"RingBuffer",bufferUnits:this.units,bufferRadii:this.radii&&this.radii.slice()}}}const Ju=function(e){if(e){switch(e.areaType){case"DriveTimeBuffer":return new Hu(e);case"StandardGeography":return new $u(e)}return new Wu(e)}return new Wu};class Qu{constructor(e){this.returnGeometry=!1,e&&(e.attributes&&(this.attributes=e.attributes),e.areaType?this.options=Ju(e):e.options instanceof Vu&&(this.options=e.options),this.returnGeometry=!!e.returnGeometry,this.comparisonGeographyLevels=qu.fromJsonArray(e.comparisonGeographyLevels||e.comparisonLevels)),this.comparisonGeographyLevels=this.comparisonGeographyLevels||[]}getGeomType(){throw new Error("Not implemented")}toJSON(){const e=this.options?this.options.toJSON():{};this.attributes&&(e.attributes=this.attributes),this.returnGeometry&&(e.returnGeometry=!0);const t=qu.toJsonArray(this.comparisonGeographyLevels);return t&&(e.comparisonLevels=t),e}}class Zu extends Qu{constructor(e){super(e),this.address=null,this.address=e&&e.address}getGeomType(){return"point"}toJSON(){const e=super.toJSON();return e.address=this.address,e}}const Yu=new He({inherited:"inherited",codedValue:"coded-value",range:"range"});let Ku=class extends Ac{constructor(e){super(e),this.name=null,this.type=null}};Wi([Ee({type:String,json:{write:!0}})],Ku.prototype,"name",void 0),Wi([We(Yu)],Ku.prototype,"type",void 0),Ku=Wi([St("esri.layers.support.Domain")],Ku);var Xu,ed=Ku;let td=Xu=class extends Ac{constructor(e){super(e),this.name=null,this.code=null}clone(){return new Xu({name:this.name,code:this.code})}};Wi([Ee({type:String,json:{write:!0}})],td.prototype,"name",void 0),Wi([Ee({type:[String,Number],json:{write:!0}})],td.prototype,"code",void 0),td=Xu=Wi([St("esri.layers.support.CodedValue")],td);var rd,id=td;let sd=rd=class extends ed{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const r=String(e);this.codedValues.some((e=>(String(e.code)===r&&(t=e.name),!!t)))}return t}clone(){return new rd({codedValues:d(this.codedValues),name:this.name})}};Wi([Ee({type:[id],json:{write:!0}})],sd.prototype,"codedValues",void 0),Wi([We({codedValue:"coded-value"})],sd.prototype,"type",void 0),sd=rd=Wi([St("esri.layers.support.CodedValueDomain")],sd);var od,nd=sd;let ad=od=class extends ed{constructor(e){super(e),this.type="inherited"}clone(){return new od}};Wi([We({inherited:"inherited"})],ad.prototype,"type",void 0),ad=od=Wi([St("esri.layers.support.InheritedDomain")],ad);var ld,cd=ad;let hd=ld=class extends ed{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new ld({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};Wi([Ee({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,r){t[r]=[this.minValue||0,e]}}}})],hd.prototype,"maxValue",void 0),Wi([Ee({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[0]},write:{target:"range",writer(e,t,r){t[r]=[e,this.maxValue||0]}}}})],hd.prototype,"minValue",void 0),Wi([We({range:"range"})],hd.prototype,"type",void 0),hd=ld=Wi([St("esri.layers.support.RangeDomain")],hd);var ud,dd=hd;!function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(ud||(ud={}));const pd={key:"type",base:ed,typeMap:{range:dd,"coded-value":nd,inherited:cd}};function fd(e){if(!e||!e.type)return null;switch(e.type){case"range":return dd.fromJSON(e);case"codedValue":return nd.fromJSON(e);case"inherited":return cd.fromJSON(e)}return null}let yd;async function md(){return yd||(yd=(async()=>{const e=await r.e(77802).then(r.bind(r,77802)).then((function(e){return e.aq}));return await e.arcade.load(),{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),yd}const gd=(e,t,r)=>bd.create(e,t,r,null,["$feature"]),vd=(e,t,r)=>bd.create(e,t,r,null,["$feature","$view"]),_d=(e,t,r,i)=>bd.create(e,t,r,i,["$feature","$view"]);class bd{constructor(e,t,r,i,s,o,n,a){this.script=e,this.evaluate=s,this.fields=n,this._syntaxTree=i,this._arcade=t,this._arcadeDictionary=r,this._arcadeFeature=o,this._spatialReference=a,this._referencesGeometry=t.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(e,t,r,i,s,o){const{arcade:n,Feature:a,Dictionary:l}=await md(),c=Jc.fromJSON(t),h=n.parseScript(e,o),u=s.reduce(((e,t)=>({...e,[t]:null})),{});let d=null;b(i)&&(d=new l(i),d.immutable=!0,u.$config=null);const p=n.scriptUsesGeometryEngine(h)&&n.enableGeometrySupport(),f=n.scriptUsesFeatureSet(h)&&n.enableFeatureSetSupport(),y=n.scriptIsAsync(h)&&n.enableAsyncSupport(),m={vars:u,spatialReference:c,useAsync:!!y},g=new l;g.immutable=!1,g.setField("scale",0);const v=n.compileScript(h,m);return await Promise.all([p,f,y]),new bd(e,n,l,h,(e=>("$view"in e&&e.$view&&(g.setField("scale",e.$view.scale),e.$view=g),d&&(e.$config=d),v({vars:e,spatialReference:c}))),new a,r,c)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}repurposeAdapter(e){return this._arcadeFeature.repurposeFromAdapter(e,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(e){return this._arcade.referencesMember(this._syntaxTree,e)}referencesFunction(e){return this._arcade.referencesFunction(this._syntaxTree,e)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(e){return this._arcade.extractFieldLiterals(this._syntaxTree,e)}}const wd=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],xd=["field","normalizationField"];function Sd(e,t){if(null!=e&&null!=t)for(const r of Array.isArray(e)?e:[e])if(Cd(wd,r,t),"visualVariables"in r&&r.visualVariables)for(const e of r.visualVariables)Cd(xd,e,t)}function Cd(e,t,r){if(e)for(const i of e){const e=y(i,t),s=e&&"function"!=typeof e&&Td(r,e);s&&m(i,s.name,t)}}function Id(e,t){if(null!=e&&null!=t)if("startField"in e){const r=Td(t,e.startField),i=Td(t,e.endField);e.startField=r&&r.name||null,e.endField=i&&i.name||null}else{const r=Td(t,e.startTimeField),i=Td(t,e.endTimeField);e.startTimeField=r&&r.name||null,e.endTimeField=i&&i.name||null}}const Ad=new Set;function kd(e,t){return e&&t?(Ad.clear(),Nd(Ad,e,t),Array.from(Ad).sort()):[]}function Nd(e,t,r){if(r)if(t&&t.length)if(r.includes("*"))for(const{name:r}of t)e.add(r);else for(const i of r)Od(e,t,i);else{if(r.includes("*"))return e.clear(),void e.add("*");for(const t of r)e.add(t)}}function Od(e,t,r){if(t&&t.length){const i=Td(t,r);i&&e.add(i.name)}else"string"==typeof r&&e.add(r)}function Td(e,t){if("string"!=typeof t)return null;if(null!=e){t=t.toLowerCase();for(const r of e)if(r&&r.name.toLowerCase()===t)return r}return null}function Pd(e,t){if(!e||!t||"string"!=typeof t)return!1;t=t.toLowerCase();for(const r of e)if(r&&r.name.toLowerCase()===t)return!0;return!1}async function Md(e,t,r){if(!r)return;const{arcadeUtils:i}=await md(),s=i.extractFieldNames(r);for(const r of s)Od(e,t,r)}function Dd({displayField:e,fields:t}){return e||(t&&t.length?Ld(t,"name-or-title")||Ld(t,"unique-identifier")||Ld(t,"type-or-category")||function(e){for(const t of e){if(!t||!t.name)continue;const e=t.name.toLowerCase();if(e.indexOf("name")>-1||e.indexOf("title")>-1)return t.name}return null}(t):null)}function Ld(e,t){for(const r of e)if(r&&r.valueType&&r.valueType===t)return r.name;return null}function Ed(e){const t=e.defaultValue;return void 0!==t&&qd(e,t)?t:e.nullable?null:void 0}function Rd(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function jd(e){return null===e||Rd(e)}const Fd="isInteger"in Number?Number.isInteger:e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e;function Bd(e){return null===e||Fd(e)}function zd(e){return null!=e&&"string"==typeof e}function Ud(e){return null===e||zd(e)}function Gd(){return!0}function qd(e,t){let r;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":r=e.nullable?Bd:Fd;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=e.nullable?jd:Rd;break;case"string":case"esriFieldTypeString":r=e.nullable?Ud:zd;break;default:r=Gd}return 1===arguments.length?r:r(t)}const Vd=new Set(["integer","small-integer","single","double","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function Hd(e){return null!=e&&Vd.has(e.type)}function $d(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)}var Wd,Jd;function Qd(e){return null==e||"number"==typeof e&&isNaN(e)?null:e}function Zd(e,t){return e.nullable&&null===t?null:Hd(e)&&!function(e,t){const r="string"==typeof e?Yd(e):e;return!!r&&(r.isInteger?Fd(t)&&t>=r.min&&t<=r.max:t>=r.min&&t<=r.max)}(e.type,Number(t))?Wd.OUT_OF_RANGE:qd(e,t)?e.domain?function(e,t){switch(e.type){case"range":{const r="range"in e?e.range[0]:e.minValue,i="range"in e?e.range[1]:e.maxValue;if(+t<r||+t>i)return ud.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==e.codedValues||e.codedValues.every((e=>null==e||e.code!==t)))return ud.INVALID_CODED_VALUE}return null}(e.domain,t):null:Jd.INVALID_TYPE}function Yd(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return Kd;case"esriFieldTypeInteger":case"integer":return Xd;case"esriFieldTypeSingle":case"single":return ep;case"esriFieldTypeDouble":case"double":return tp}}!function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"}(Wd||(Wd={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}(Jd||(Jd={}));const Kd={min:-32768,max:32767,isInteger:!0},Xd={min:-2147483648,max:2147483647,isInteger:!0},ep={min:-34e37,max:12e37,isInteger:!1},tp={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function rp(e,t,r){switch(e){case ud.INVALID_CODED_VALUE:return`Value ${r} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case ud.VALUE_OUT_OF_RANGE:return`Value ${r} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Jd.INVALID_TYPE:return`Value ${r} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case Wd.OUT_OF_RANGE:{const{min:e,max:i}=Yd(t.type);return`Value ${r} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${e} to ${i}`}}}let ip=class extends Ac{constructor(e){super(e),this.type=null}};Wi([Ee({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],ip.prototype,"type",void 0),ip=Wi([St("esri.popup.content.Content")],ip);var sp,op=ip;let np=sp=class extends op{constructor(e){super(e),this.description=null,this.displayType=null,this.title=null,this.type="attachments"}clone(){return new sp({description:this.description,displayType:this.displayType,title:this.title})}};Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],np.prototype,"description",void 0),Wi([Ee({type:["preview","list"],json:{write:!0}})],np.prototype,"displayType",void 0),Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],np.prototype,"title",void 0),Wi([Ee({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],np.prototype,"type",void 0),np=sp=Wi([St("esri.popup.content.AttachmentsContent")],np);var ap,lp=np;let cp=ap=class extends op{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new ap({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?d(this.outFields):null})}};Wi([Ee()],cp.prototype,"creator",void 0),Wi([Ee()],cp.prototype,"destroyer",void 0),Wi([Ee()],cp.prototype,"outFields",void 0),Wi([Ee({type:["custom"],readOnly:!0})],cp.prototype,"type",void 0),cp=ap=Wi([St("esri.popup.content.CustomContent")],cp);var hp=cp;const up=$e()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});up.toJSON.bind(up),up.fromJSON.bind(up);const dp={year:"numeric",month:"numeric",day:"numeric"},pp={year:"numeric",month:"long",day:"numeric"},fp={year:"numeric",month:"short",day:"numeric"},yp={year:"numeric",month:"long",weekday:"long",day:"numeric"},mp={hour:"numeric",minute:"numeric"},gp={...mp,second:"numeric"},vp={"short-date":dp,"short-date-short-time":{...dp,...mp},"short-date-short-time-24":{...dp,...mp,hour12:!1},"short-date-long-time":{...dp,...gp},"short-date-long-time-24":{...dp,...gp,hour12:!1},"short-date-le":dp,"short-date-le-short-time":{...dp,...mp},"short-date-le-short-time-24":{...dp,...mp,hour12:!1},"short-date-le-long-time":{...dp,...gp},"short-date-le-long-time-24":{...dp,...gp,hour12:!1},"long-month-day-year":pp,"long-month-day-year-short-time":{...pp,...mp},"long-month-day-year-short-time-24":{...pp,...mp,hour12:!1},"long-month-day-year-long-time":{...pp,...gp},"long-month-day-year-long-time-24":{...pp,...gp,hour12:!1},"day-short-month-year":fp,"day-short-month-year-short-time":{...fp,...mp},"day-short-month-year-short-time-24":{...fp,...mp,hour12:!1},"day-short-month-year-long-time":{...fp,...gp},"day-short-month-year-long-time-24":{...fp,...gp,hour12:!1},"long-date":yp,"long-date-short-time":{...yp,...mp},"long-date-short-time-24":{...yp,...mp,hour12:!1},"long-date-long-time":{...yp,...gp},"long-date-long-time-24":{...yp,...gp,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":mp,"long-time":gp},_p=$e()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});_p.toJSON.bind(_p),_p.fromJSON.bind(_p);const bp={ar:"ar-u-nu-latn-ca-gregory"};let wp=new WeakMap,xp=vp["short-date-short-time"];function Sp(e){return vp[e]||null}function Cp(e,t){return function(e){const t=e||xp;if(!wp.has(t)){const e=(0,i.b)(),r=bp[(0,i.b)()]||e;wp.set(t,new Intl.DateTimeFormat(r,t))}return wp.get(t)}(t).format(e)}(0,i.d)((()=>{wp=new WeakMap,xp=vp["short-date-short-time"]}));const Ip={ar:"ar-u-nu-latn"};let Ap=new WeakMap,kp={};function Np(e,t){return function(e){const t=e||kp;if(!Ap.has(t)){const r=(0,i.b)(),s=Ip[(0,i.b)()]||r;Ap.set(t,new Intl.NumberFormat(s,e))}return Ap.get(t)}(t).format(e)}var Op;(0,i.d)((()=>{Ap=new WeakMap,kp={}}));let Tp=Op=class extends Ac{constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}clone(){return new Op({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(e){return this.dateFormat?Cp(e,Sp(this.dateFormat)):Np(e,function(e={}){const t={};return null!=e.digitSeparator&&(t.useGrouping=e.digitSeparator),null!=e.places&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}(this))}};Wi([We(up)],Tp.prototype,"dateFormat",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],Tp.prototype,"digitSeparator",void 0),Wi([Ee({type:ce,json:{write:!0}})],Tp.prototype,"places",void 0),Tp=Op=Wi([St("esri.popup.support.FieldInfoFormat")],Tp);var Pp,Mp=Tp;let Dp=Pp=class extends Ac{constructor(e){super(e),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new Pp({fieldName:this.fieldName,format:this.format?d(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};Wi([Ee({type:String,json:{write:!0}})],Dp.prototype,"fieldName",void 0),Wi([Ee({type:Mp,json:{write:!0}})],Dp.prototype,"format",void 0),Wi([Ee({type:Boolean,json:{write:!0,default:!1}})],Dp.prototype,"isEditable",void 0),Wi([Ee({type:String,json:{write:!0}})],Dp.prototype,"label",void 0),Wi([We(new He({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Dp.prototype,"stringFieldOption",void 0),Wi([Ee({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Dp.prototype,"statisticType",void 0),Wi([Ee({type:String,json:{write:!0}})],Dp.prototype,"tooltip",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],Dp.prototype,"visible",void 0),Dp=Pp=Wi([St("esri.popup.FieldInfo")],Dp);var Lp,Ep=Dp;let Rp=Lp=class extends op{constructor(e){super(e),this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,t){t.fieldInfos=e&&e.map((e=>e.toJSON()))}clone(){return new Lp({description:this.description,fieldInfos:Array.isArray(this.fieldInfos)?d(this.fieldInfos):null,title:this.title})}};Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rp.prototype,"description",void 0),Wi([Ee({type:[Ep]})],Rp.prototype,"fieldInfos",void 0),Wi([It("fieldInfos")],Rp.prototype,"writeFieldInfos",null),Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rp.prototype,"title",void 0),Wi([Ee({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],Rp.prototype,"type",void 0),Rp=Lp=Wi([St("esri.popup.content.FieldsContent")],Rp);var jp=Rp;let Fp=class extends Ac{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};Wi([Ee({type:String,json:{write:!0}})],Fp.prototype,"altText",void 0),Wi([Ee({type:String,json:{write:!0}})],Fp.prototype,"caption",void 0),Wi([Ee({type:String,json:{write:!0}})],Fp.prototype,"title",void 0),Wi([Ee({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Fp.prototype,"type",void 0),Fp=Wi([St("esri.popup.content.mixins.MediaInfo")],Fp);var Bp,zp=Fp;let Up=Bp=class extends $o{constructor(e){super(e),this.tooltip=null,this.value=null,this.x=null,this.y=null}clone(){return new Bp({tooltip:this.tooltip,value:this.value})}};Wi([Ee()],Up.prototype,"tooltip",void 0),Wi([Ee()],Up.prototype,"value",void 0),Wi([Fe("value")],Up.prototype,"x",void 0),Wi([Fe("tooltip")],Up.prototype,"y",void 0),Up=Bp=Wi([St("esri.popup.content.support.ChartMediaInfoValueSeries")],Up);var Gp,qp=Up;let Vp=Gp=class extends Ac{constructor(e){super(e),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new Gp({fields:d(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};Wi([Ee({type:[String],json:{write:!0}})],Vp.prototype,"fields",void 0),Wi([Ee({type:String,json:{write:!0}})],Vp.prototype,"normalizeField",void 0),Wi([Ee({type:[qp],json:{read:!1}})],Vp.prototype,"series",void 0),Wi([Ee({type:String,json:{write:!0}})],Vp.prototype,"tooltipField",void 0),Vp=Gp=Wi([St("esri.popup.content.support.ChartMediaInfoValue")],Vp);var Hp=Vp;let $p=class extends zp{constructor(e){super(e),this.type=null,this.value=null}};Wi([Ee({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],$p.prototype,"type",void 0),Wi([Ee({type:Hp,json:{write:!0}})],$p.prototype,"value",void 0),$p=Wi([St("esri.popup.content.mixins.ChartMediaInfo")],$p);var Wp=$p;const Jp=$e()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var Qp;let Zp=Qp=class extends Wp{constructor(e){super(e),this.type="bar-chart"}clone(){return new Qp({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};Wi([Ee({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:Jp.write}})],Zp.prototype,"type",void 0),Zp=Qp=Wi([St("esri.popup.content.BarChartMediaInfo")],Zp);var Yp,Kp=Zp;let Xp=Yp=class extends Wp{constructor(e){super(e),this.type="column-chart"}clone(){return new Yp({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};Wi([Ee({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:Jp.write}})],Xp.prototype,"type",void 0),Xp=Yp=Wi([St("esri.popup.content.ColumnChartMediaInfo")],Xp);var ef,tf=Xp;let rf=ef=class extends Ac{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new ef({linkURL:this.linkURL,sourceURL:this.sourceURL})}};Wi([Ee({type:String,json:{write:!0}})],rf.prototype,"linkURL",void 0),Wi([Ee({type:String,json:{write:!0}})],rf.prototype,"sourceURL",void 0),rf=ef=Wi([St("esri.popup.content.support.ImageMediaInfoValue")],rf);var sf,of=rf;let nf=sf=class extends zp{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new sf({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};Wi([Ee({type:Number,json:{write:!0}})],nf.prototype,"refreshInterval",void 0),Wi([Ee({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],nf.prototype,"type",void 0),Wi([Ee({type:of,json:{write:!0}})],nf.prototype,"value",void 0),nf=sf=Wi([St("esri.popup.content.ImageMediaInfo")],nf);var af,lf=nf;let cf=af=class extends Wp{constructor(e){super(e),this.type="line-chart"}clone(){return new af({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};Wi([Ee({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:Jp.write}})],cf.prototype,"type",void 0),cf=af=Wi([St("esri.popup.content.LineChartMediaInfo")],cf);var hf,uf=cf;let df=hf=class extends Wp{constructor(e){super(e),this.type="pie-chart"}clone(){return new hf({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};Wi([Ee({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:Jp.write}})],df.prototype,"type",void 0),df=hf=Wi([St("esri.popup.content.PieChartMediaInfo")],df);var pf=df;const ff={base:zp,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Kp,"column-chart":tf,"line-chart":uf,"pie-chart":pf,image:lf}};var yf;let mf=yf=class extends op{constructor(e){super(e),this.activeMediaInfoIndex=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map((e=>"image"===e.type?lf.fromJSON(e):"barchart"===e.type?Kp.fromJSON(e):"columnchart"===e.type?tf.fromJSON(e):"linechart"===e.type?uf.fromJSON(e):"piechart"===e.type?pf.fromJSON(e):void 0)).filter(Boolean)}writeMediaInfos(e,t){t.mediaInfos=e&&e.map((e=>e.toJSON()))}clone(){return new yf({activeMediaInfoIndex:this.activeMediaInfoIndex,description:this.description,mediaInfos:this.mediaInfos?d(this.mediaInfos):null,title:this.title})}};Wi([Ee()],mf.prototype,"activeMediaInfoIndex",void 0),Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],mf.prototype,"description",void 0),Wi([Ee({types:[ff]})],mf.prototype,"mediaInfos",void 0),Wi([Je("mediaInfos")],mf.prototype,"readMediaInfos",null),Wi([It("mediaInfos")],mf.prototype,"writeMediaInfos",null),Wi([Ee({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],mf.prototype,"title",void 0),Wi([Ee({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],mf.prototype,"type",void 0),mf=yf=Wi([St("esri.popup.content.MediaContent")],mf);var gf,vf=mf;let _f=gf=class extends op{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new gf({text:this.text})}};Wi([Ee({type:String,json:{write:!0}})],_f.prototype,"text",void 0),Wi([Ee({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],_f.prototype,"type",void 0),_f=gf=Wi([St("esri.popup.content.TextContent")],_f);var bf=_f;const wf={base:null,key:"type",typeMap:{attachment:lp,media:vf,text:bf,field:jp}};var xf;let Sf=xf=class extends Ac{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new xf({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};Wi([Ee({type:String,json:{write:!0}})],Sf.prototype,"name",void 0),Wi([Ee({type:String,json:{write:!0}})],Sf.prototype,"title",void 0),Wi([Ee({type:String,json:{write:!0}})],Sf.prototype,"expression",void 0),Wi([Ee({type:["string","number"],json:{write:!0}})],Sf.prototype,"returnType",void 0),Sf=xf=Wi([St("esri.popup.ExpressionInfo")],Sf);var Cf,If=Sf;let Af=Cf=class extends Ac{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new Cf({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};Wi([Ee({type:Boolean,json:{write:!0}})],Af.prototype,"returnTopmostRaster",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],Af.prototype,"showNoDataRecords",void 0),Af=Cf=Wi([St("esri.popup.LayerOptions")],Af);var kf,Nf=Af;let Of=kf=class extends Ac{constructor(e){super(e),this.field=null,this.order=null}clone(){return new kf({field:this.field,order:this.order})}};Wi([Ee({type:String,json:{write:!0}})],Of.prototype,"field",void 0),Wi([Ee({type:["asc","desc"],json:{write:!0}})],Of.prototype,"order",void 0),Of=kf=Wi([St("esri.popup.support.RelatedRecordsInfoFieldOrder")],Of);var Tf,Pf=Of;let Mf=Tf=class extends Ac{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new Tf({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?d(this.orderByFields):null})}};Wi([Ee({type:Boolean,json:{write:!0}})],Mf.prototype,"showRelatedRecords",void 0),Wi([Ee({type:[Pf],json:{write:!0}})],Mf.prototype,"orderByFields",void 0),Mf=Tf=Wi([St("esri.popup.RelatedRecordsInfo")],Mf);var Df=Mf;let Lf=0;const Ef=e=>{let t=class extends e{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Lf++})}};return t=Wi([St("esri.core.Identifiable")],t),t};let Rf=class extends(Ef(class{})){};var jf;Rf=Wi([St("esri.core.Identifiable")],Rf);let Ff=jf=class extends(Ef($o)){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new jf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};Wi([Ee()],Ff.prototype,"active",void 0),Wi([Ee()],Ff.prototype,"className",void 0),Wi([Ee()],Ff.prototype,"disabled",void 0),Wi([Ee()],Ff.prototype,"id",void 0),Wi([Ee()],Ff.prototype,"indicator",void 0),Wi([Ee()],Ff.prototype,"title",void 0),Wi([Ee()],Ff.prototype,"type",void 0),Wi([Ee()],Ff.prototype,"visible",void 0),Ff=jf=Wi([St("esri.support.actions.ActionBase")],Ff);var Bf,zf=Ff;let Uf=Bf=class extends zf{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new Bf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};Wi([Ee()],Uf.prototype,"image",void 0),Uf=Bf=Wi([St("esri.support.Action.ActionButton")],Uf);var Gf,qf=Uf;let Vf=Gf=class extends zf{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new Gf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};Wi([Ee()],Vf.prototype,"image",void 0),Wi([Ee()],Vf.prototype,"value",void 0),Vf=Gf=Wi([St("esri.support.Action.ActionToggle")],Vf);var Hf,$f=Vf;const Wf=hn.ofType({key:"type",defaultKeyValue:"button",base:zf,typeMap:{button:qf,toggle:$f}}),Jf={base:op,key:"type",typeMap:{media:vf,custom:hp,text:bf,attachments:lp,fields:jp}},Qf="esri.PopupTemplate",Zf=G.getLogger(Qf),Yf=["attachments","fields","media","text"];let Kf=Hf=class extends Ac{constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title="",this.relatedRecordsInfo=null}castContent(e){return Array.isArray(e)?e.map((e=>le(Jf,e))):"string"==typeof e||"function"==typeof e||e instanceof HTMLElement||uo(e)?e:(Zf.error("content error","unsupported content value",{value:e}),null)}readContent(e,t){const{popupElements:r}=t;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(t):this._readPopupInfo(t)}writeContent(e,t,r,i){"string"!=typeof e?Array.isArray(e)&&(t.popupElements=e.filter((e=>-1!==Yf.indexOf(e.type))).map((e=>e&&e.toJSON(i))),t.popupElements.forEach((e=>{"attachments"===e.type?this._writeAttachmentContent(t):"media"===e.type?this._writeMediaContent(e,t):"text"===e.type&&this._writeTextContent(e,t)}))):t.description=e}writeFieldInfos(e,t,r,i){const{content:s}=this,o=Array.isArray(s)?s:null;if(e){const r=o?o.filter((e=>"fields"===e.type)):[],s=r.length&&r.every((e=>{var t;return null==(t=e.fieldInfos)?void 0:t.length}));t.fieldInfos=e.filter(Boolean).map((e=>{const t=e.toJSON(i);return s&&(t.visible=!1),t}))}if(o)for(const e of o)"fields"===e.type&&this._writeFieldsContent(e,t)}writeLayerOptions(e,t,r,i){t[r]=!e||null===e.showNoDataRecords&&null===e.returnTopmostRaster?null:e.toJSON(i)}writeTitle(e,t){t.title=e||""}clone(){const{actions:e}=this,t=e?d(e.toArray()):[];return new Hf({actions:t,content:Array.isArray(this.content)?d(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?d(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?d(this.fieldInfos):null,layerOptions:this.layerOptions?d(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?d(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?d(this.relatedRecordsInfo):null})}async collectRequiredFields(e,t){await this._collectExpressionInfoFields(e,t,this.expressionInfos),Nd(e,t,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const t=new Set;return await this.collectRequiredFields(t,e),[...t].sort()}_writeFieldsContent(e,t){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const r=d(e.fieldInfos);Array.isArray(t.fieldInfos)?r.forEach((e=>{const r=t.fieldInfos.find((t=>t.fieldName.toLowerCase()===e.fieldName.toLowerCase()));r?r.visible=!0:t.fieldInfos.push(e)})):t.fieldInfos=r}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeTextContent(e,t){!t.description&&e.text&&(t.description=e.text)}_writeMediaContent(e,t){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=d(e.mediaInfos);Array.isArray(t.mediaInfos)?t.mediaInfos=[...t.mediaInfos,...r]:t.mediaInfos=r}_readPopupInfoElements({description:e,mediaInfos:t,popupElements:r}){const i={description:!1,mediaInfos:!1};return r.map((r=>"media"===r.type?(r.mediaInfos||!t||i.mediaInfos||(r.mediaInfos=t,i.mediaInfos=!0),vf.fromJSON(r)):"text"===r.type?(r.text||!e||i.description||(r.text=e,i.description=!0),bf.fromJSON(r)):"attachments"===r.type?lp.fromJSON(r):"fields"===r.type?jp.fromJSON(r):void 0)).filter(Boolean)}_readPopupInfo({description:e,mediaInfos:t,showAttachments:r}){const i=[];return e?i.push(new bf({text:e})):i.push(new jp),Array.isArray(t)&&t.length&&i.push(vf.fromJSON({mediaInfos:t})),r&&i.push(lp.fromJSON({displayType:"list"})),i.length?i:e}_getContentElementFields(e){return e&&"attachments"!==e.type?"custom"===e.type?e.outFields||[]:"fields"===e.type?this._getFieldInfoFields(e.fieldInfos||this.fieldInfos):"media"===e.type?(e.mediaInfos||[]).reduce(((e,t)=>[...e,...this._getMediaInfoFields(t)]),[]):"text"===e.type?this._extractFieldNames(e.text):void 0:[]}_getMediaInfoFields(e){const{caption:t,title:r,value:i}=e,s=i||{},{fields:o=[],normalizeField:n,tooltipField:a,sourceURL:l,linkURL:c}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(t),...this._extractFieldNames(l),...this._extractFieldNames(c),...o];return n&&h.push(n),a&&h.push(a),h}_getContentFields(e){return"string"==typeof e?this._extractFieldNames(e):Array.isArray(e)?e.reduce(((e,t)=>[...e,...this._getContentElementFields(t)]),[]):[]}async _collectExpressionInfoFields(e,t,r){r&&await Promise.all(r.map((r=>Md(e,t,r.expression))))}_getFieldInfoFields(e){return e?e.filter((e=>void 0===e.visible||!!e.visible)).map((e=>e.fieldName)).filter((e=>-1===e.indexOf("relationships/")&&-1===e.indexOf("expression/"))):[]}_getActionsFields(e){return e?e.toArray().reduce(((e,t)=>[...e,...this._getActionFields(t)]),[]):[]}_getActionFields(e){const{className:t,title:r,type:i}=e,s="button"===i||"toggle"===i?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(t),...this._extractFieldNames(s)]}_getTitleFields(e){return"string"==typeof e?this._extractFieldNames(e):[]}_extractFieldNames(e){if(!e||"string"!=typeof e)return[];const t=e.match(/{[^}]*}/g);if(!t)return[];const r=/\{(\w+):.+\}/,i=t.filter((e=>!(0===e.indexOf("{relationships/")||0===e.indexOf("{expression/")))).map((e=>e.replace(r,"{$1}")));return i?i.map((e=>e.slice(1,-1))):[]}};Wi([Ee({type:Wf})],Kf.prototype,"actions",void 0),Wi([Ee()],Kf.prototype,"content",void 0),Wi([Ge("content")],Kf.prototype,"castContent",null),Wi([Je("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments"])],Kf.prototype,"readContent",null),Wi([It("content",{popupElements:{type:hn.ofType(wf)},showAttachments:{type:Boolean},mediaInfos:{type:hn.ofType(ff)},description:{type:String}})],Kf.prototype,"writeContent",null),Wi([Ee({type:[If],json:{write:!0}})],Kf.prototype,"expressionInfos",void 0),Wi([Ee({type:[Ep]})],Kf.prototype,"fieldInfos",void 0),Wi([It("fieldInfos")],Kf.prototype,"writeFieldInfos",null),Wi([Ee({type:Nf})],Kf.prototype,"layerOptions",void 0),Wi([It("layerOptions")],Kf.prototype,"writeLayerOptions",null),Wi([Ee({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Kf.prototype,"lastEditInfoEnabled",void 0),Wi([Ee()],Kf.prototype,"outFields",void 0),Wi([Ee()],Kf.prototype,"overwriteActions",void 0),Wi([Ee()],Kf.prototype,"returnGeometry",void 0),Wi([Ee({json:{type:String}})],Kf.prototype,"title",void 0),Wi([It("title")],Kf.prototype,"writeTitle",null),Wi([Ee({type:Df,json:{write:!0}})],Kf.prototype,"relatedRecordsInfo",void 0),Kf=Hf=Wi([St(Qf)],Kf);var Xf=Kf;const ey=new He({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let ty=0,ry=class extends Ac{constructor(e){super(e),this.id="sym"+ty++,this.type=null}set color(e){this._set("color",e)}readColor(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,t){}hash(){return JSON.stringify(this.toJSON())}clone(){}};Wi([Ee({type:ey.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:ey.write}}})],ry.prototype,"type",void 0),Wi([Ee({type:$a,value:new $a([0,0,0,1]),json:{write:{allowNull:!0}}})],ry.prototype,"color",null),Wi([Je("color")],ry.prototype,"readColor",null),ry=Wi([St("esri.symbols.Symbol")],ry);var iy,sy=ry;let oy=iy=class extends sy{constructor(e){super(e),this.data=null,this.type="cim"}readData(e,t){return t}writeData(e,t){if(e)for(const r in e)t[r]=e[r]}async collectRequiredFields(e,t){if("CIMSymbolReference"===this.data.type){const r=this.data.primitiveOverrides;if(r){const i=r.map((r=>{const i=r.valueExpressionInfo;return Md(e,t,i.expression)}));await Promise.all(i)}}}clone(){return new iy({data:d(this.data)})}hash(){return B(JSON.stringify(this.data)).toString()}};Wi([Ee({json:{write:!1}})],oy.prototype,"color",void 0),Wi([Ee({json:{write:!0}})],oy.prototype,"data",void 0),Wi([Je("data",["symbol"])],oy.prototype,"readData",null),Wi([It("data")],oy.prototype,"writeData",null),Wi([We({CIMSymbolReference:"cim"},{readOnly:!0})],oy.prototype,"type",void 0),oy=iy=Wi([St("esri.symbols.CIMSymbol")],oy);var ny=oy;let ay=class extends Ac{constructor(e){super(e),this.enabled=!0,this.type=null}writeEnabled(e,t,r){e||(t[r]=e)}};Wi([Ee({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ay.prototype,"enabled",void 0),Wi([It("enabled")],ay.prototype,"writeEnabled",null),Wi([Ee({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],ay.prototype,"type",void 0),ay=Wi([St("esri.symbols.Symbol3DLayer")],ay);var ly=ay;const cy=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,hy="screenUtils.toPt: input not recognized!",uy=96;function dy(e){return e?e/72*uy:0}function py(e){return e?72*e/uy:0}function fy(e){if("string"==typeof e){if(cy.test(e)){const t=e.match(cy),r=Number(t[1]),i=t[3]&&t[3].toLowerCase(),s="-"===e.charAt(0),o="px"===i?py(r):r;return s?-o:o}return console.warn(hy),null}return e}function yy(e=0,t=0){return{x:e,y:t}}function my(e){return e}function gy(e){const t=J(100*(1-e));return Math.max(0,Math.min(t,100))}function vy(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}const _y={type:$a,json:{type:[ce],default:null,read:{source:["color","transparency"],reader:function(e,t){const r=null!=t.transparency?vy(t.transparency):1,i=t.color;return i&&Array.isArray(i)?new $a([i[0]||0,i[1]||0,i[2]||0,r]):null}},write:{target:{color:{type:[ce]},transparency:{type:ce}},writer:function(e,t){t.color=e.toJSON().slice(0,3);const r=gy(e.a);0!==r&&(t.transparency=r)}}}},by={type:Number,cast:fy,json:{write:!0}},wy={type:[Number],cast:e=>null!=e?e:Array.isArray(e)?e.map(fy):null,json:{read:!1,write:!1}};let xy=class extends Ac{constructor(e){super(e),this.color=new $a([0,0,0,1]),this.extensionLength=0,this.size=py(1)}clone(){}cloneProperties(){return{color:d(this.color),size:this.size,extensionLength:this.extensionLength}}};Wi([Ee({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],xy.prototype,"type",void 0),Wi([Ee(_y)],xy.prototype,"color",void 0),Wi([Ee({...by,json:{write:{overridePolicy:e=>({enabled:!!e})}}})],xy.prototype,"extensionLength",void 0),Wi([Ee(by)],xy.prototype,"size",void 0),xy=Wi([St("esri.symbols.edges.Edges3D")],xy);var Sy,Cy=xy;let Iy=Sy=class extends Cy{constructor(e){super(e),this.type="sketch"}clone(){return new Sy(this.cloneProperties())}};Wi([We({sketch:"sketch"},{readOnly:!0})],Iy.prototype,"type",void 0),Iy=Sy=Wi([St("esri.symbols.edges.SketchEdges3D")],Iy);var Ay,ky=Iy;let Ny=Ay=class extends Cy{constructor(e){super(e),this.type="solid"}clone(){return new Ay(this.cloneProperties())}};Wi([We({solid:"solid"},{readOnly:!0})],Ny.prototype,"type",void 0),Ny=Ay=Wi([St("esri.symbols.support.SolidEdges3D")],Ny);const Oy={types:{key:"type",base:Cy,typeMap:{solid:Ny,sketch:ky}},json:{write:!0}};var Ty;let Py=Ty=class extends Ac{constructor(){super(...arguments),this.color=null}clone(){return new Ty({color:b(this.color)?this.color.clone():null})}};Wi([Ee(_y)],Py.prototype,"color",void 0),Py=Ty=Wi([St("esri.symbols.support.Symbol3DMaterial")],Py);var My,Dy=Py;let Ly=My=class extends ly{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new My({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:b(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};Wi([We({Extrude:"extrude"},{readOnly:!0})],Ly.prototype,"type",void 0),Wi([Ee({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Ly.prototype,"size",void 0),Wi([Ee({type:Dy,json:{write:!0}})],Ly.prototype,"material",void 0),Wi([Ee({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Ly.prototype,"castShadows",void 0),Wi([Ee(Oy)],Ly.prototype,"edges",void 0),Ly=My=Wi([St("esri.symbols.ExtrudeSymbol3DLayer")],Ly);var Ey=Ly;let Ry=class extends sy{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};Wi([We({esriSLS:"simple-line"},{readOnly:!0})],Ry.prototype,"type",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Ry.prototype,"width",void 0),Ry=Wi([St("esri.symbols.LineSymbol")],Ry);var jy,Fy=Ry;let By=jy=class extends Ac{constructor(e){super(e),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(e,t,r,i){"web-map"===(null==i?void 0:i.origin)?t[r]="arrow":t[r]=e}set color(e){this._set("color",e)}readColor(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}writeColor(e,t,r,i){"web-map"===(null==i?void 0:i.origin)||(t[r]=e)}clone(){return new jy({color:d(this.color),placement:this.placement,style:this.style})}hash(){var e;return`${this.placement}.${null==(e=this.color)?void 0:e.hash()}.${this.style}`}};Wi([Ee({type:["begin","end","begin-end"],json:{write:!0}})],By.prototype,"placement",void 0),Wi([We({"line-marker":"line-marker"},{readOnly:!0}),Ee({json:{origins:{"web-map":{write:!1}}}})],By.prototype,"type",void 0),Wi([Ee({type:["arrow","circle","square","diamond","cross","x"]})],By.prototype,"style",void 0),Wi([It("style")],By.prototype,"writeStyle",null),Wi([Ee({type:$a,value:null,json:{write:{allowNull:!0}}})],By.prototype,"color",null),Wi([Je("color")],By.prototype,"readColor",null),Wi([It("color")],By.prototype,"writeColor",null),By=jy=Wi([St("esri.symbols.LineSymbolMarker")],By);var zy,Uy=By;const Gy=new He({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let qy=zy=class extends Fy{constructor(...e){super(...e),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(e,t,r,i,s,o){if(e&&"string"!=typeof e)return e;const n={};return null!=e&&(n.style=e),null!=t&&(n.color=t),null!=r&&(n.width=fy(r)),null!=i&&(n.cap=i),null!=s&&(n.join=s),null!=o&&(n.miterLimit=fy(o)),n}clone(){var e;return new zy({color:d(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(e=this.marker)?void 0:e.clone()})}hash(){var e,t;return`${super.hash()}.${null==(e=this.color)?void 0:e.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${null==(t=this.marker)?void 0:t.hash()}`}};Wi([We({esriSLS:"simple-line"},{readOnly:!0})],qy.prototype,"type",void 0),Wi([Ee({type:Gy.apiValues,json:{read:Gy.read,write:Gy.write}})],qy.prototype,"style",void 0),Wi([Ee({type:["butt","round","square"],json:{write:{overridePolicy:(e,t,r)=>({enabled:"round"!==e&&(null==r||null==r.origin)})}}})],qy.prototype,"cap",void 0),Wi([Ee({type:["miter","round","bevel"],json:{write:{overridePolicy:(e,t,r)=>({enabled:"round"!==e&&(null==r||null==r.origin)})}}})],qy.prototype,"join",void 0),Wi([Ee({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Uy}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],qy.prototype,"marker",void 0),Wi([Ee({type:Number,json:{read:!1,write:!1}})],qy.prototype,"miterLimit",void 0),qy=zy=Wi([St("esri.symbols.SimpleLineSymbol")],qy);var Vy=qy;let Hy=class extends sy{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};Wi([Ee({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Vy}},json:{default:null,write:!0}})],Hy.prototype,"outline",void 0),Wi([Ee({type:["simple-fill","picture-fill"],readOnly:!0})],Hy.prototype,"type",void 0),Hy=Wi([St("esri.symbols.FillSymbol")],Hy);var $y=Hy;let Wy=class extends Ac{constructor(e){super(e)}clone(){}};Wi([Ee({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Wy.prototype,"type",void 0),Wy=Wi([St("esri.symbols.patterns.Pattern3D")],Wy);var Jy,Qy=Wy;let Zy=Jy=class extends Qy{constructor(e){super(e),this.type="style",this.style="solid"}clone(){return new Jy({style:this.style})}};Wi([Ee({type:["style"]})],Zy.prototype,"type",void 0),Wi([Ee({type:["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"],json:{read:!0,write:!0}})],Zy.prototype,"style",void 0),Zy=Jy=Wi([St("esri.symbols.patterns.StylePattern3D")],Zy);var Yy=Zy;const Ky={types:{key:"type",base:Qy,typeMap:{style:Yy}},json:{read:function(e,t,r){if(!e)return e;if("style"===e.type){const t=new Yy;return t.read(e,r),t}},write:!0}},Xy=new $a("white");new $a("black");const em=new $a([255,255,255,0]);var tm;let rm=tm=class extends Dy{clone(){return new tm({color:b(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})}};Wi([We({multiply:"multiply",replace:"replace",tint:"tint"})],rm.prototype,"colorMixMode",void 0),rm=tm=Wi([St("esri.symbols.support.Symbol3DFillMaterial")],rm);var im,sm=rm;let om=im=class extends Ac{constructor(){super(...arguments),this.color=new $a([0,0,0,1]),this.size=py(1),this.stipplePattern=null,this.stippleOffColor=null}clone(){return new im({color:b(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}};Wi([Ee(_y)],om.prototype,"color",void 0),Wi([Ee(by)],om.prototype,"size",void 0),Wi([Ee(wy)],om.prototype,"stipplePattern",void 0),Wi([Ee({type:$a})],om.prototype,"stippleOffColor",void 0),om=im=Wi([St("esri.symbols.support.Symbol3DOutline")],om);var nm,am=om;let lm=nm=class extends ly{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){return new nm({edges:b(this.edges)?this.edges.clone():null,enabled:this.enabled,material:b(this.material)?this.material.clone():null,pattern:b(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:b(this.outline)?this.outline.clone():null})}static fromSimpleFillSymbol(e){return new nm({material:{color:(e.color||em).clone()},pattern:e.style&&"solid"!==e.style?new Yy({style:e.style}):null,outline:e.outline?new am({size:e.outline.width||0,color:(e.outline.color||Xy).clone()}):null})}};Wi([We({Fill:"fill"},{readOnly:!0})],lm.prototype,"type",void 0),Wi([Ee({type:sm,json:{write:!0}})],lm.prototype,"material",void 0),Wi([Ee(Ky)],lm.prototype,"pattern",void 0),Wi([Ee({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],lm.prototype,"castShadows",void 0),Wi([Ee({type:am,json:{write:!0}})],lm.prototype,"outline",void 0),Wi([Ee(Oy)],lm.prototype,"edges",void 0),lm=nm=Wi([St("esri.symbols.FillSymbol3DLayer")],lm);var cm,hm=lm;let um=cm=class extends Ac{constructor(e){super(e),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(e){return fy(e)}clone(){return new cm({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};Wi([Ee({type:["underline","line-through","none"],json:{default:"none",write:!0}})],um.prototype,"decoration",void 0),Wi([Ee({type:String,json:{write:!0}})],um.prototype,"family",void 0),Wi([Ee({type:Number,json:{write:{overridePolicy:(e,t,r)=>({enabled:!r||!r.textSymbol3D})}}})],um.prototype,"size",void 0),Wi([Ge("size")],um.prototype,"castSize",null),Wi([Ee({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],um.prototype,"style",void 0),Wi([Ee({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],um.prototype,"weight",void 0),um=cm=Wi([St("esri.symbols.Font")],um);var dm,pm=um;const fm=$e()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let ym=dm=class extends Ac{constructor(e){super(e)}readHref(e,t,r){return e?zr(e,r):t.dataURI}writeHref(e,t,r,i){e&&(cr(e)?t.dataURI=e:(t.href=Ur(e,i),ar(t.href)&&(t.href=sr(t.href))))}clone(){return new dm({href:this.href,primitive:this.primitive})}};Wi([Ee({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],ym.prototype,"href",void 0),Wi([Je("href")],ym.prototype,"readHref",null),Wi([It("href",{href:{type:String},dataURI:{type:String}})],ym.prototype,"writeHref",null),Wi([We(fm)],ym.prototype,"primitive",void 0),ym=dm=Wi([St("esri.symbols.support.IconSymbol3DLayerResource")],ym);var mm,gm=ym;let vm=mm=class extends $o{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new mm({x:this.x,y:this.y})}};var _m;Wi([Ee({type:Number})],vm.prototype,"x",void 0),Wi([Ee({type:Number})],vm.prototype,"y",void 0),vm=mm=Wi([St("esri.symbols.support.Symbol3DAnchorPosition2D")],vm);const bm=G.getLogger("esri.symbols.IconSymbol3DLayer");let wm=_m=class extends ly{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new _m({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:b(this.material)?this.material.clone():null,outline:b(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(e){const t=e.color||Xy,r=xm(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||Xy).clone()}:null;return new _m({size:e.size,resource:{primitive:Im(e.style)},material:{color:t},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const t=e.color&&(0!==(i=e.color).r||0!==i.g||0!==i.b)?e.color:Xy,r=xm(e);var i;return new _m({size:e.width<=e.height?e.height:e.width,resource:{href:e.url},material:{color:t.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new _m({resource:{href:pr({mediaType:"application/json",data:JSON.stringify(e.data)})}})}};function xm(e){const t="width"in e?e.width:e.size,r="height"in e?e.height:e.size,i=Sm(e.xoffset),s=Sm(e.yoffset);return(i||s)&&t&&r?{x:-i/t,y:s/r}:null}function Sm(e){return isFinite(e)?e:0}Wi([Ee({type:Dy,json:{write:!0}})],wm.prototype,"material",void 0),Wi([Ee({type:gm,json:{write:!0}})],wm.prototype,"resource",void 0),Wi([We({Icon:"icon"},{readOnly:!0})],wm.prototype,"type",void 0),Wi([Ee(by)],wm.prototype,"size",void 0),Wi([We({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),Ee({json:{default:"center"}})],wm.prototype,"anchor",void 0),Wi([Ee({type:vm,json:{type:[Number],read:{reader:e=>new vm({x:e[0],y:e[1]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],wm.prototype,"anchorPosition",void 0),Wi([Ee({type:am,json:{write:!0}})],wm.prototype,"outline",void 0),wm=_m=Wi([St("esri.symbols.IconSymbol3DLayer")],wm);const Cm={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Im(e){return Cm[e]||(bm.warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}var Am,km=wm;let Nm=Am=class extends ly{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=py(1),this.stipplePattern=null,this.stippleOffColor=null}clone(){return new Am({enabled:this.enabled,material:b(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}static fromSimpleLineSymbol(e){return new Am({size:e.width||1,cap:e.cap||"butt",join:e.join||"miter",material:{color:(e.color||Xy).clone()}})}};Wi([Ee({type:Dy,json:{write:!0}})],Nm.prototype,"material",void 0),Wi([We({Line:"line"},{readOnly:!0})],Nm.prototype,"type",void 0),Wi([Ee({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],Nm.prototype,"join",void 0),Wi([Ee({type:["butt","square","round"],json:{write:!0,default:"butt"}})],Nm.prototype,"cap",void 0),Wi([Ee(by)],Nm.prototype,"size",void 0),Wi([Ee(wy)],Nm.prototype,"stipplePattern",void 0),Wi([Ee({type:$a})],Nm.prototype,"stippleOffColor",void 0),Nm=Am=Wi([St("esri.symbols.LineSymbol3DLayer")],Nm);var Om,Tm=Nm;const Pm=$e()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Mm=Om=class extends Ac{clone(){return new Om({href:this.href,primitive:this.primitive})}};Wi([Ee({type:String,json:{read:Gr,write:qr}})],Mm.prototype,"href",void 0),Wi([We(Pm)],Mm.prototype,"primitive",void 0),Mm=Om=Wi([St("esri.symbols.support.ObjectSymbol3DLayerResource")],Mm);var Dm,Lm=Mm;let Em=Dm=class extends $o{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new Dm({x:this.x,y:this.y,z:this.z})}};var Rm;Wi([Ee({type:Number})],Em.prototype,"x",void 0),Wi([Ee({type:Number})],Em.prototype,"y",void 0),Wi([Ee({type:Number})],Em.prototype,"z",void 0),Em=Dm=Wi([St("esri.symbols.support.Symbol3DAnchorPosition3D")],Em);let jm=Rm=class extends ly{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new Rm({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:b(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};Wi([Ee({type:Dy,json:{write:!0}})],jm.prototype,"material",void 0),Wi([Ee({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],jm.prototype,"castShadows",void 0),Wi([Ee({type:Lm,json:{write:!0}})],jm.prototype,"resource",void 0),Wi([We({Object:"object"},{readOnly:!0})],jm.prototype,"type",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"width",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"height",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"depth",void 0),Wi([We({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),Ee({json:{default:"origin"}})],jm.prototype,"anchor",void 0),Wi([Ee({type:Em,json:{type:[Number],read:{reader:e=>new Em({x:e[0],y:e[1],z:e[2]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y,e.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],jm.prototype,"anchorPosition",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"heading",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"tilt",void 0),Wi([Ee({type:Number,json:{write:!0}})],jm.prototype,"roll",void 0),Wi([Ee({readOnly:!0})],jm.prototype,"isPrimitive",null),jm=Rm=Wi([St("esri.symbols.ObjectSymbol3DLayer")],jm);var Fm,Bm=jm;let zm=Fm=class extends ly{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}get size(){return this.width&&this.height?this.width===this.height?this.width:void 0:this.width?this.width:this.height?this.height:void 0}set size(e){this.width=e,this.height=e}readSize(e,t){return t.height||t.width?e:t.size}clone(){return new Fm({enabled:this.enabled,material:b(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};Wi([Ee({type:Dy,json:{write:!0}})],zm.prototype,"material",void 0),Wi([Ee({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],zm.prototype,"castShadows",void 0),Wi([We({Path:"path"},{readOnly:!0})],zm.prototype,"type",void 0),Wi([Ee({type:Number})],zm.prototype,"size",null),Wi([Je("size")],zm.prototype,"readSize",null),Wi([Ee({type:["circle","quad"],json:{write:!0,default:"circle"}})],zm.prototype,"profile",void 0),Wi([Ee({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],zm.prototype,"join",void 0),Wi([Ee({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],zm.prototype,"cap",void 0),Wi([Ee({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],zm.prototype,"width",void 0),Wi([Ee({type:Number,json:{write:!0}})],zm.prototype,"height",void 0),Wi([Ee({type:["center","bottom","top"],json:{write:!0,default:"center"}})],zm.prototype,"anchor",void 0),Wi([Ee({type:["heading","all"],json:{write:!0,default:"all"}})],zm.prototype,"profileRotation",void 0),zm=Fm=Wi([St("esri.symbols.PathSymbol3DLayer")],zm);var Um,Gm=zm;let qm=Um=class extends Ac{constructor(){super(...arguments),this.color=new $a([0,0,0,1]),this.size=0}clone(){return new Um({color:d(this.color),size:this.size})}};Wi([Ee(_y)],qm.prototype,"color",void 0),Wi([Ee(by)],qm.prototype,"size",void 0),qm=Um=Wi([St("esri.symbols.support.Symbol3DHalo")],qm);var Vm,Hm=qm;let $m=Vm=class extends ly{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.material=null,this.text=void 0,this.type="text"}get font(){return this._get("font")||null}set font(e){e&&this._userSize&&(e.size=this._userSize),this._set("font",e)}writeFont(e,t,r,i){const s={...i,textSymbol3D:!0};t.font=e.write({},s),delete t.font.size}get size(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9}set size(e){this._userSize=e,this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){return new Vm({enabled:this.enabled,font:this.font&&d(this.font),halo:this.halo&&d(this.halo),material:b(this.material)?this.material.clone():null,size:this.size,text:this.text})}static fromTextSymbol(e){const t=function(e,t){return e&&t>0?{color:d(e),size:t}:null}(e.haloColor,e.haloSize),r=e.font?e.font.clone():new pm;return new Vm({size:r.size,font:r,halo:t,material:e.color?{color:e.color.clone()}:null,text:e.text})}};Wi([Ee({type:pm,json:{write:!0}})],$m.prototype,"font",null),Wi([It("font")],$m.prototype,"writeFont",null),Wi([Ee({type:Hm,json:{write:!0}})],$m.prototype,"halo",void 0),Wi([Ee({type:Dy,json:{write:!0}})],$m.prototype,"material",void 0),Wi([Ee(by),Ee()],$m.prototype,"size",null),Wi([Ee({type:String,json:{write:!0}})],$m.prototype,"text",void 0),Wi([We({Text:"text"},{readOnly:!0})],$m.prototype,"type",void 0),$m=Vm=Wi([St("esri.symbols.TextSymbol3DLayer")],$m);var Wm,Jm=$m;let Qm=Wm=class extends ly{constructor(e){super(e),this.color=Zm.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new Wm({color:d(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};Wi([Ee({type:$a,nonNullable:!0,json:{type:[ce],write:(e,t,r)=>t[r]=e.toArray(1),default:()=>Zm.clone(),defaultEquals:e=>e.toCss(!0)===Zm.toCss(!0)}})],Qm.prototype,"color",void 0),Wi([We({Water:"water"},{readOnly:!0})],Qm.prototype,"type",void 0),Wi([Ee({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Qm.prototype,"waterbodySize",void 0),Wi([Ee({type:Number,json:{write:!0,default:null}})],Qm.prototype,"waveDirection",void 0),Wi([Ee({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Qm.prototype,"waveStrength",void 0),Qm=Wm=Wi([St("esri.symbols.WaterSymbol3DLayer")],Qm);const Zm=new $a([0,119,190]);var Ym=Qm;function Km(e,t,r=hn){return t||(t=new r),t===e||(t.removeAll(),function(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}(e)?t.addMany(e):e&&t.add(e)),t}function Xm(e){return e}const eg=G.getLogger("esri.intl");function tg(e){switch(typeof e){case"string":return e;case"number":return Np(e);case"boolean":return""+e;default:return e instanceof Date?Cp(e):""}}const rg=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,ig=new Set(["ar","bs","ca","cs","da","de","el","en","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"]),sg=[],og=new Map;async function ng(e){const t=(0,i.b)();og.has(e)||og.set(e,async function(e,t){const r=[];for(const i of sg)if(ag(i.pattern,e))try{return await i.fetchMessageBundle(e,t)}catch(e){r.push(e)}if(r.length)throw new At("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:r});throw new At("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}(e,t));const r=og.get(e);return await lg.add(r),r}function ag(e,t){return"string"==typeof e?t.startsWith(e):e.test(t)}(0,i.d)((()=>{og.clear()}));const lg=new class{constructor(){this._numLoading=0}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=no())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function cg(e){if(b(ug.fetchBundleAsset))return ug.fetchBundleAsset(e);const t=await En(e,{responseType:"text"});return JSON.parse(t.data)}class hg{constructor({base:e="",pattern:t,location:r=new URL(window.location.href)}){let s;s="string"==typeof r?e=>new URL(e,new URL(r,i.e.location)).href:r instanceof URL?e=>new URL(e,r).href:r,this.pattern="string"==typeof t?new RegExp(`^${t}`):t,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,t){return async function(e,t,r,i){const s=t.exec(r);if(!s)throw new At("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${t}"`);const o=s[1]?`${s[1]}/`:"",n=s[2],a=function(e){if(!rg.test(e))return null;const[,t,r]=rg.exec(e),i=t+(r?"-"+r.toUpperCase():"");return ig.has(i)?i:ig.has(t)?t:null}(i),l=`${o}${n}.json`,c=a?`${o}${n}_${a}.json`:l;let h;try{h=await cg(e(c))}catch(t){if(c===l)throw new At("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:t});try{h=await cg(e(l))}catch(e){throw new At("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:e})}}return h}(this.getAssetUrl,this.matcher,e,t)}}const ug={},dg=G.getLogger("esri.assets");function pg(e){if(!_.assetsPath)throw dg.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new At("assets:path-not-set","config.assetsPath is not set");return or(_.assetsPath,e)}!function(e){if(!sg.includes(e)){for(const t of og.keys())ag(e.pattern,t)&&og.delete(t);sg.unshift(e)}}(function(e){return new hg(e)}({pattern:"esri/",location:pg}));class fg{constructor(e){this.instance=e,this._resolver=no(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp()}),(()=>{this._status=2,this._cleanUp()}))}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(Js())}when(e,t){return this._resolver.promise.then(e,t)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const e=no(),t=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(t);r.then((()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve(this.instance)}),(e=>{this.isFulfilled()||this._allPromise!==r||so(e)||this._resolver.reject(e)})),e.resolve()}}const yg=e=>{let t=class extends e{constructor(...e){super(...e),this._promiseProps=new fg(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(e,t){return new Promise(((e,t)=>{this._promiseProps.when(e,t)})).then(e,t)}catch(e){return this.when(null,e)}addResolvingPromise(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)}};return t=Wi([St("esri.core.Promise")],t),t};let mg=class extends(yg($o)){};mg=Wi([St("esri.core.Promise")],mg);const gg="loaded",vg=e=>{let t=class extends e{constructor(...e){super(...e),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((e=>{const t=this.load.bind(this);this.load=r=>{const i=new Promise(((e,t)=>{const i=ro(r,t);this.destroyed&&t(new At("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(e,t).finally((()=>{i&&i.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const e=this._loadController=Qs();t({signal:e.signal}),to(e.signal,(()=>{this._promiseProps.abort()}))}return e(),i}}))),this.when((()=>{this._set("loadStatus",gg),this._loadController=null}),(e=>{this._set("loadStatus","failed"),this._set("loadError",e),this._loadController=null}))}get loaded(){return this.loadStatus===gg}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var e;return this.isFulfilled()||(this._set("loadError",new At("load:cancelled","Cancelled")),null==(e=this._loadController)||e.abort()),this}};return Wi([Ee({readOnly:!0})],t.prototype,"loaded",null),Wi([Ee({readOnly:!0})],t.prototype,"loadError",void 0),Wi([Ee()],t.prototype,"loadStatus",void 0),Wi([Ee({type:[Ze],readOnly:!0})],t.prototype,"loadWarnings",null),t=Wi([St("esri.core.Loadable")],t),t};let _g=class extends(vg(mg)){};_g=Wi([St("esri.core.Loadable")],_g),function(e){e.LoadableMixin=vg,e.isLoadable=function(e){return!(!e||!e.load)}}(_g||(_g={}));var bg,wg=_g;const xg=new He({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Sg=bg=class extends $o{constructor(e){super(e),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(e){"asc"!==e&&"desc"!==e||this._set("sortOrder",e)}clone(){return new bg({categories:this.categories?d(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(e,t){let r,i;if(this.categories&&(r=this.categories.map((e=>Array.isArray(e)?JSON.stringify(e):e))),this.extent){const e=ch(this.extent,Jc.WGS84);e&&(i=`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`)}let s=this.query;!this.disableExtraQuery&&e.extraQuery&&(s="("+s+")"+e.extraQuery);const o={categories:r,bbox:i,q:s,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(o.sortField=this.sortField.split(",").map((e=>xg.toJSON(e.trim()))).join(","),o.sortOrder=this.sortOrder),{query:{...t,...o}}}};Wi([Ee()],Sg.prototype,"categories",void 0),Wi([Ee()],Sg.prototype,"disableExtraQuery",void 0),Wi([Ee({type:Wh})],Sg.prototype,"extent",void 0),Wi([Ee()],Sg.prototype,"num",void 0),Wi([Ee()],Sg.prototype,"query",void 0),Wi([Ee()],Sg.prototype,"sortField",void 0),Wi([Ee()],Sg.prototype,"sortOrder",null),Wi([Ee()],Sg.prototype,"start",void 0),Sg=bg=Wi([St("esri.portal.PortalQueryParams")],Sg);var Cg=Sg;let Ig=class extends $o{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};Wi([Ee()],Ig.prototype,"nextQueryParams",void 0),Wi([Ee()],Ig.prototype,"queryParams",void 0),Wi([Ee()],Ig.prototype,"results",void 0),Wi([Ee()],Ig.prototype,"total",void 0),Ig=Wi([St("esri.portal.PortalQueryResult")],Ig);var Ag=Ig;let kg=class extends Ac{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new At("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};Wi([Ee({type:Date})],kg.prototype,"created",void 0),Wi([Ee()],kg.prototype,"id",void 0),Wi([Ee()],kg.prototype,"portal",void 0),Wi([Ee()],kg.prototype,"title",void 0),Wi([Ee({readOnly:!0})],kg.prototype,"url",null),Wi([Ee()],kg.prototype,"username",void 0),kg=Wi([St("esri.portal.PortalFolder")],kg);var Ng=kg;let Og=class extends Ac{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal._normalizeUrl(`${e}/info/${t}?f=json`):null}get url(){const e=this.get("portal.restUrl");return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return this.portal._request(this.url+"/categorySchema",e).then((t=>{const r=t.categorySchema||[];return r.some((e=>"contentCategorySetsGroupQuery.LivingAtlas"===e.source))?this._fetchCategorySchemaSet("LivingAtlas",e):r}))}fetchMembers(e){return this.portal._request(this.url+"/users",e)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}toJSON(){throw new At("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(e,t){let r=re(Cg,e);return parseFloat(this.portal.currentVersion)>5?(r=r||new Cg,this.portal._queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",t)):(r=r?r.clone():new Cg,r.query="group:"+this.id+(r.query?" "+r.query:""),this.portal.queryItems(r,t))}_fetchCategorySchemaSet(e,t){return this.portal._fetchSelf(this.portal.authMode,!0,t).then((e=>{const r=e.contentCategorySetsGroupQuery;if(r){const e=new Cg;return e.disableExtraQuery=!0,e.num=1,e.query=r,this.portal.queryGroups(e,t)}throw new At("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((r=>{if(r.total){const i=r.results[0],s=new Cg;return s.num=1,s.query=`typekeywords:"${e}"`,i.queryItems(s,t)}throw new At("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((e=>e.total?e.results[0].fetchData("json",t).then((e=>{const t=e&&e.categorySchema;return t&&t.length?t:[]})):[]))}};Wi([Ee()],Og.prototype,"access",void 0),Wi([Ee({type:Date})],Og.prototype,"created",void 0),Wi([Ee()],Og.prototype,"description",void 0),Wi([Ee()],Og.prototype,"id",void 0),Wi([Ee()],Og.prototype,"isInvitationOnly",void 0),Wi([Ee({type:Date})],Og.prototype,"modified",void 0),Wi([Ee()],Og.prototype,"owner",void 0),Wi([Ee()],Og.prototype,"portal",void 0),Wi([Ee()],Og.prototype,"snippet",void 0),Wi([Ee()],Og.prototype,"sortField",void 0),Wi([Ee()],Og.prototype,"sortOrder",void 0),Wi([Ee()],Og.prototype,"tags",void 0),Wi([Ee()],Og.prototype,"thumbnail",void 0),Wi([Ee({readOnly:!0})],Og.prototype,"thumbnailUrl",null),Wi([Ee()],Og.prototype,"title",void 0),Wi([Ee({readOnly:!0})],Og.prototype,"url",null),Og=Wi([St("esri.portal.PortalGroup")],Og);var Tg=Og;const Pg=Object.freeze({__proto__:null,default:Tg});var Mg;let Dg=Mg=class extends Ac{constructor(...e){super(...e),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal._normalizeUrl(`${e}/info/${t}?f=json`):null}get userContentUrl(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}`:null}get url(){const e=this.get("portal.restUrl");return e?`${e}/community/users/${this.username}`:null}addItem(e){const t=e&&e.item,r=e&&e.data,i=e&&e.folder,s={method:"post"};t&&(s.query=t.createPostQuery(),null!=r&&("string"==typeof r?s.query.text=r:"object"==typeof r&&(s.query.text=JSON.stringify(r))));let o=this.userContentUrl;return i&&(o+="/"+("string"==typeof i?i:i.id)),this.portal._request(o+"/addItem",s).then((e=>(t.id=e.id,t.portal=this.portal,t.loaded?t.reload():t.load())))}deleteItem(e){let t=this.userContentUrl;return e.ownerFolder&&(t+="/"+e.ownerFolder),this.portal._request(t+`/items/${e.id}/delete`,{method:"post"}).then((()=>{e.id=null,e.portal=null}))}deleteItems(e){const t=this.userContentUrl+"/deleteItems",r=e.map((e=>e.id));if(r.length){const i={method:"post",query:{items:r.join(",")}};return this.portal._request(t,i).then((()=>{e.forEach((e=>{e.id=null,e.portal=null}))}))}return Promise.resolve(void 0)}fetchFolders(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then((e=>{let t;return t=e&&e.folders?e.folders.map((e=>{const t=Ng.fromJSON(e);return t.portal=this.portal,t})):[],t}))}fetchGroups(){return this.portal._request(this.url).then((e=>{let t;return t=e&&e.groups?e.groups.map((e=>{const t=Tg.fromJSON(e);return t.portal=this.portal,t})):[],t}))}fetchItems(e){e||(e={});let t,i=this.userContentUrl;return e.folder&&(i+="/"+e.folder.id),r.e(72304).then(r.bind(r,72304)).then((({default:r})=>{t=r;const s={folders:!1,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"};return this.portal._request(i,{query:s})})).then((e=>{let r;return e&&e.items?(r=e.items.map((e=>{const r=t.fromJSON(e);return r.portal=this.portal,r})),Promise.all(r.map((e=>e.load()))).catch((e=>e)).then((()=>({items:r,nextStart:e.nextStart,total:e.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal._request(this.url+"/tags").then((e=>e.tags))}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}queryFavorites(e){return this.favGroupId?(this._favGroup||(this._favGroup=new Tg({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new At("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new At("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new Mg;return t.sourceJSON=e,t.read(e),t}};Wi([Ee()],Dg.prototype,"access",void 0),Wi([Ee({type:Date})],Dg.prototype,"created",void 0),Wi([Ee()],Dg.prototype,"culture",void 0),Wi([Ee()],Dg.prototype,"description",void 0),Wi([Ee()],Dg.prototype,"email",void 0),Wi([Ee()],Dg.prototype,"favGroupId",void 0),Wi([Ee()],Dg.prototype,"fullName",void 0),Wi([Ee({type:Date})],Dg.prototype,"modified",void 0),Wi([Ee()],Dg.prototype,"orgId",void 0),Wi([Ee()],Dg.prototype,"portal",void 0),Wi([Ee()],Dg.prototype,"preferredView",void 0),Wi([Ee()],Dg.prototype,"privileges",void 0),Wi([Ee()],Dg.prototype,"region",void 0),Wi([Ee()],Dg.prototype,"role",void 0),Wi([Ee()],Dg.prototype,"roleId",void 0),Wi([Ee()],Dg.prototype,"sourceJSON",void 0),Wi([Ee()],Dg.prototype,"thumbnail",void 0),Wi([Ee({readOnly:!0})],Dg.prototype,"thumbnailUrl",null),Wi([Ee()],Dg.prototype,"units",void 0),Wi([Ee({readOnly:!0})],Dg.prototype,"userContentUrl",null),Wi([Ee({readOnly:!0})],Dg.prototype,"url",null),Wi([Ee()],Dg.prototype,"username",void 0),Wi([Ee()],Dg.prototype,"userType",void 0),Dg=Mg=Wi([St("esri.portal.PortalUser")],Dg);var Lg=Dg;const Eg=Object.freeze({__proto__:null,default:Lg});var Rg;let jg;const Fg={PortalGroup:()=>Promise.resolve().then((function(){return Pg})),PortalItem:()=>r.e(72304).then(r.bind(r,72304)),PortalUser:()=>Promise.resolve().then((function(){return Eg}))};let Bg=Rg=class extends(Sc(wg)){constructor(e){super(e),this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=_.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e}destroy(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)}readAuthorizedCrossOriginDomains(e){if(e)for(const t of e)-1===_.request.trustedServers.indexOf(t)&&_.request.trustedServers.push(t);return e}readDefaultBasemap(e){if(e){const t=jg.fromJSON(e);return t.portalItem={portal:this},t}return null}readDefaultVectorBasemap(e){if(e){const t=jg.fromJSON(e);return t.portalItem={portal:this},t}return null}get extraQuery(){const e=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get restUrl(){let e=this.url;if(e){const t=e.indexOf("/sharing");e=t>0?e.substring(0,t):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,t=this.thumbnail;return e&&t?this._normalizeSSL(e+"/portals/self/resources/"+t):null}readUrlKey(e){return e?e.toLowerCase():e}readUser(e){let t=null;return e&&(t=Lg.fromJSON(e),t.portal=this),t}load(e){const t=r.e(16409).then(r.bind(r,16409)).then((({default:t})=>{Zs(e),jg=t})).then((()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,e))).then((e=>{if(Tn){const e=Tn;this.credential=e.findCredential(this.restUrl),this.credential||this.authMode!==Rg.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=e.on("credential-create",(()=>{e.findCredential(this.restUrl)&&this._signIn()})))}this.sourceJSON=e,this.read(e)}));return this.addResolvingPromise(t),Promise.resolve(this)}async createClosestFacilityTask(){await this.load();const e=this._getHelperServiceUrl("closestFacility");return new((await Promise.all([r.e(72172),r.e(35605)]).then(r.bind(r,35605))).default)(e)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),t=(await Promise.all([r.e(33896),r.e(89289),r.e(94935),r.e(36550)]).then(r.bind(r,36550))).default;return e?e.map((e=>new t({id:e.id,url:e.url}))):[]}async createGeometryService(){await this.load();const e=this._getHelperServiceUrl("geometry");return new((await r.e(26576).then(r.bind(r,26576))).default)({url:e})}async createPrintTask(){await this.load();const e=this._getHelperServiceUrl("printTask");return new((await Promise.all([r.e(78624),r.e(48110)]).then(r.bind(r,48110))).default)(e)}async createRouteTask(){await this.load();const e=this._getHelperServiceUrl("route");return new((await Promise.all([r.e(72172),r.e(21024)]).then(r.bind(r,21024))).default)(e)}async createServiceAreaTask(){await this.load();const e=this._getHelperServiceUrl("serviceArea");return new((await Promise.all([r.e(72172),r.e(20981)]).then(r.bind(r,20981))).default)(e)}fetchBasemaps(e,t){const r=new Cg;return r.query=e||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0,this.queryGroups(r,t).then((e=>{if(r.num=100,r.query='type:"Web Map" -type:"Web Application"',e.total){const i=e.results[0];return r.sortField=i.sortField||"name",r.sortOrder=i.sortOrder||"desc",i.queryItems(r,t)}return null})).then((e=>{let t;return t=e&&e.total?e.results.filter((e=>"Web Map"===e.type)).map((e=>new jg({portalItem:e}))):[],t}))}fetchCategorySchema(e){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",e).then((e=>e.categorySchema)):Ks(e)?Promise.reject(Js()):Promise.resolve([])}fetchFeaturedGroups(e){const t=this.featuredGroups,r=new Cg;if(r.num=100,r.sortField="title",t&&t.length){const i=[];for(const e of t)i.push(`(title:"${e.title}" AND owner:${e.owner})`);return r.query=i.join(" OR "),this.queryGroups(r,e).then((e=>e.results))}return Ks(e)?Promise.reject(Js()):Promise.resolve([])}fetchRegions(e){const t=this.user&&this.user.culture||this.culture||(0,i.b)();return this._request(this.restUrl+"/portals/regions",{...e,query:{culture:t}})}static getDefault(){return Rg._default&&!Rg._default.destroyed||(Rg._default=new Rg),Rg._default}queryGroups(e,t){return this._queryPortal("/community/groups",e,"PortalGroup",t)}queryItems(e,t){return this._queryPortal("/search",e,"PortalItem",t)}queryUsers(e,t){return e.sortField||(e.sortField="username"),this._queryPortal("/community/users",e,"PortalUser",t)}toJSON(){throw new At("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Rg({sourceJSON:e})}_getHelperService(e){const t=this.helperServices&&this.helperServices[e];if(!t)throw new At("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return t}_getHelperServiceUrl(e){const t=this._getHelperService(e);if(!t.url)throw new At("portal:service-url-not-found",`The \`helperServices\` entry "${e}" does not include a \`url\` value`);return t.url}_fetchSelf(e=this.authMode,t=!1,r){const s=this.restUrl+"/portals/self",o={authMode:e,query:{culture:(0,i.b)().toLowerCase()},...r};return"auto"===o.authMode&&(o.authMode="no-prompt"),t&&(o.query.default=!0),this._request(s,o)}_queryPortal(e,t,r,i){const s=re(Cg,t),o=t=>this._request(this.restUrl+e,{...s.toRequestOptions(this),...i}).then((e=>{const r=s.clone();return r.start=e.nextStart,new Ag({nextQueryParams:r,queryParams:s,total:e.total,results:Rg._resultsToTypedArray(t,{portal:this},e,i)})})).then((e=>Promise.all(e.results.map((t=>"function"==typeof t.when?t.when():e))).then((()=>e),(t=>(Xs(t),e)))));return r&&Fg[r]?Fg[r]().then((({default:e})=>(Zs(i),o(e)))):o()}_signIn(){if(this.authMode===Rg.AUTH_MODE_ANONYMOUS)return Promise.reject(new At("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const e=e=>Promise.resolve().then((()=>"not-loaded"===this.loadStatus?(e||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=e,this._fetchSelf("immediate")))):this.user&&this.credential===e?null:(this.credential=e,this._fetchSelf("immediate")))).then((e=>{e&&(this.sourceJSON=e,this.read(e))}));return Tn?Tn.getCredential(this.restUrl).then((t=>e(t))):e(this.credential)}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(e){const t=this.credential&&this.credential.token;return this._normalizeSSL(t?e+(e.indexOf("?")>-1?"&":"?")+"token="+t:e)}_requestToTypedArray(e,t,r){return this._request(e,t).then((e=>{const t=Rg._resultsToTypedArray(r,{portal:this},e);return Promise.all(t.map((t=>"function"==typeof t.when?t.when():e))).then((()=>t),(()=>t))}))}_request(e,t={}){const r={f:"json",...t.query},{authMode:i=(this.authMode===Rg.AUTH_MODE_ANONYMOUS?"anonymous":"auto"),body:s=null,cacheBust:o=!1,method:n="auto",responseType:a="json",signal:l}=t,c={authMode:i,body:s,cacheBust:o,method:n,query:r,responseType:a,timeout:0,signal:l};return En(this._normalizeSSL(e),c).then((e=>e.data))}static _resultsToTypedArray(e,t,r,i){let s;if(r){const o=b(i)?i.signal:null;s=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||t)&&(s=s.map((r=>{const i=Object.assign(e?e.fromJSON(r):r,t);return"function"==typeof i.load&&i.load(o),i})))}else s=[];return s}};Bg.AUTH_MODE_ANONYMOUS="anonymous",Bg.AUTH_MODE_AUTO="auto",Bg.AUTH_MODE_IMMEDIATE="immediate",Wi([Ee()],Bg.prototype,"access",void 0),Wi([Ee()],Bg.prototype,"allSSL",void 0),Wi([Ee()],Bg.prototype,"authMode",void 0),Wi([Ee()],Bg.prototype,"authorizedCrossOriginDomains",void 0),Wi([Je("authorizedCrossOriginDomains")],Bg.prototype,"readAuthorizedCrossOriginDomains",null),Wi([Ee()],Bg.prototype,"basemapGalleryGroupQuery",void 0),Wi([Ee()],Bg.prototype,"bingKey",void 0),Wi([Ee()],Bg.prototype,"canListApps",void 0),Wi([Ee()],Bg.prototype,"canListData",void 0),Wi([Ee()],Bg.prototype,"canListPreProvisionedItems",void 0),Wi([Ee()],Bg.prototype,"canProvisionDirectPurchase",void 0),Wi([Ee()],Bg.prototype,"canSearchPublic",void 0),Wi([Ee()],Bg.prototype,"canShareBingPublic",void 0),Wi([Ee()],Bg.prototype,"canSharePublic",void 0),Wi([Ee()],Bg.prototype,"canSignInArcGIS",void 0),Wi([Ee()],Bg.prototype,"canSignInIDP",void 0),Wi([Ee()],Bg.prototype,"colorSetsGroupQuery",void 0),Wi([Ee()],Bg.prototype,"commentsEnabled",void 0),Wi([Ee({type:Date})],Bg.prototype,"created",void 0),Wi([Ee()],Bg.prototype,"credential",void 0),Wi([Ee()],Bg.prototype,"culture",void 0),Wi([Ee()],Bg.prototype,"currentVersion",void 0),Wi([Ee()],Bg.prototype,"customBaseUrl",void 0),Wi([Ee()],Bg.prototype,"defaultBasemap",void 0),Wi([Je("defaultBasemap")],Bg.prototype,"readDefaultBasemap",null),Wi([Ee({type:Wh})],Bg.prototype,"defaultExtent",void 0),Wi([Ee()],Bg.prototype,"defaultVectorBasemap",void 0),Wi([Je("defaultVectorBasemap")],Bg.prototype,"readDefaultVectorBasemap",null),Wi([Ee()],Bg.prototype,"description",void 0),Wi([Ee()],Bg.prototype,"eueiEnabled",void 0),Wi([Ee({readOnly:!0})],Bg.prototype,"extraQuery",null),Wi([Ee()],Bg.prototype,"featuredGroups",void 0),Wi([Ee()],Bg.prototype,"featuredItemsGroupQuery",void 0),Wi([Ee()],Bg.prototype,"galleryTemplatesGroupQuery",void 0),Wi([Ee()],Bg.prototype,"livingAtlasGroupQuery",void 0),Wi([Ee()],Bg.prototype,"hasCategorySchema",void 0),Wi([Ee()],Bg.prototype,"helpBase",void 0),Wi([Ee()],Bg.prototype,"helperServices",void 0),Wi([Ee()],Bg.prototype,"helpMap",void 0),Wi([Ee()],Bg.prototype,"homePageFeaturedContent",void 0),Wi([Ee()],Bg.prototype,"homePageFeaturedContentCount",void 0),Wi([Ee()],Bg.prototype,"httpPort",void 0),Wi([Ee()],Bg.prototype,"httpsPort",void 0),Wi([Ee()],Bg.prototype,"id",void 0),Wi([Ee()],Bg.prototype,"ipCntryCode",void 0),Wi([Ee({readOnly:!0})],Bg.prototype,"isOrganization",null),Wi([Ee()],Bg.prototype,"isPortal",void 0),Wi([Ee()],Bg.prototype,"isReadOnly",void 0),Wi([Ee()],Bg.prototype,"layerTemplatesGroupQuery",void 0),Wi([Ee()],Bg.prototype,"maxTokenExpirationMinutes",void 0),Wi([Ee({type:Date})],Bg.prototype,"modified",void 0),Wi([Ee()],Bg.prototype,"name",void 0),Wi([Ee()],Bg.prototype,"portalHostname",void 0),Wi([Ee()],Bg.prototype,"portalMode",void 0),Wi([Ee()],Bg.prototype,"portalProperties",void 0),Wi([Ee()],Bg.prototype,"region",void 0),Wi([Ee({readOnly:!0})],Bg.prototype,"restUrl",null),Wi([Ee()],Bg.prototype,"rotatorPanels",void 0),Wi([Ee()],Bg.prototype,"showHomePageDescription",void 0),Wi([Ee()],Bg.prototype,"sourceJSON",void 0),Wi([Ee()],Bg.prototype,"staticImagesUrl",void 0),Wi([Ee()],Bg.prototype,"stylesGroupQuery",void 0),Wi([Ee()],Bg.prototype,"supportsHostedServices",void 0),Wi([Ee()],Bg.prototype,"symbolSetsGroupQuery",void 0),Wi([Ee()],Bg.prototype,"templatesGroupQuery",void 0),Wi([Ee()],Bg.prototype,"thumbnail",void 0),Wi([Ee({readOnly:!0})],Bg.prototype,"thumbnailUrl",null),Wi([Ee()],Bg.prototype,"units",void 0),Wi([Ee()],Bg.prototype,"url",void 0),Wi([Ee()],Bg.prototype,"urlKey",void 0),Wi([Je("urlKey")],Bg.prototype,"readUrlKey",null),Wi([Ee()],Bg.prototype,"user",void 0),Wi([Je("user")],Bg.prototype,"readUser",null),Wi([Ee()],Bg.prototype,"useStandardizedQuery",void 0),Wi([Ee()],Bg.prototype,"useVectorBasemaps",void 0),Wi([Ee()],Bg.prototype,"vectorBasemapGalleryGroupQuery",void 0),Bg=Rg=Wi([St("esri.portal.Portal")],Bg);var zg,Ug=Bg;let Gg=zg=class extends $o{constructor(){super(...arguments),this.portal=null}clone(){return new zg({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};Wi([Ee({type:String})],Gg.prototype,"name",void 0),Wi([Ee({type:String})],Gg.prototype,"styleUrl",void 0),Wi([Ee({type:String})],Gg.prototype,"styleName",void 0),Wi([Ee({type:Ug})],Gg.prototype,"portal",void 0),Gg=zg=Wi([St("esri.symbols.support.StyleOrigin")],Gg);var qg,Vg=Gg;let Hg=qg=class extends $o{clone(){return new qg({url:this.url})}};Wi([Ee({type:String})],Hg.prototype,"url",void 0),Hg=qg=Wi([St("esri.symbols.support.Thumbnail")],Hg);var $g=Hg;const Wg={icon:km,object:Bm,line:Tm,path:Gm,fill:hm,extrude:Ey,text:Jm,water:Ym},Jg=hn.ofType({base:ly,key:"type",typeMap:Wg,errorContext:"symbol-layer"}),Qg=G.getLogger("esri.symbols.Symbol3D");let Zg=class extends sy{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const t=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers,r=t&&t.type||hn;this._set("symbolLayers",new r)}get color(){return null}set color(e){Qg.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Km(e,this._get("symbolLayers"))}readStyleOrigin(e,t,r){if(e.styleUrl&&e.name){const t=zr(e.styleUrl,r);return new Vg({styleUrl:t,name:e.name})}if(e.styleName&&e.name)return new Vg({portal:r&&r.portal||Ug.getDefault(),styleName:e.styleName,name:e.name});r&&r.messages&&r.messages.push(new Ze("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,t,r,i){if(e.styleUrl&&e.name){let r=Ur(e.styleUrl,i);ar(r)&&(r=sr(r)),t.styleOrigin={styleUrl:r,name:e.name}}else e.styleName&&e.name&&(e.portal&&i&&i.portal&&!Yt(e.portal.restUrl,i.portal.restUrl)?i&&i.messages&&i.messages.push(new Ze("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):t.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof ly||e&&Wg[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};Wi([Ee({json:{read:!1,write:!1}})],Zg.prototype,"color",null),Wi([Ee({type:Jg,nonNullable:!0,json:{write:!0}}),Ge(Xm)],Zg.prototype,"symbolLayers",null),Wi([Ee({type:Vg})],Zg.prototype,"styleOrigin",void 0),Wi([Je("styleOrigin")],Zg.prototype,"readStyleOrigin",null),Wi([It("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Zg.prototype,"writeStyleOrigin",null),Wi([Ee({type:$g,json:{read:!1}})],Zg.prototype,"thumbnail",void 0),Wi([Ee({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Zg.prototype,"type",void 0),Zg=Wi([St("esri.symbols.Symbol3D")],Zg);var Yg,Kg=Zg;let Xg=Yg=class extends Ac{constructor(){super(...arguments),this.color=new $a("white")}clone(){return new Yg({color:d(this.color)})}};Wi([Ee(_y)],Xg.prototype,"color",void 0),Xg=Yg=Wi([St("esri.symbols.callouts.LineCallout3DBorder")],Xg);var ev=Xg;Object.freeze({__proto__:null,get LineCallout3DBorder(){return Xg},default:ev});let tv=class extends Ac{constructor(e){super(e),this.visible=!0}clone(){}};Wi([Ee({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],tv.prototype,"type",void 0),Wi([Ee({readOnly:!0})],tv.prototype,"visible",void 0),tv=Wi([St("esri.symbols.callouts.Callout3D")],tv);var rv,iv=tv;let sv=rv=class extends iv{constructor(e){super(e),this.type="line",this.color=new $a([0,0,0,1]),this.size=py(1),this.border=null}get visible(){return this.size>0&&b(this.color)&&this.color.a>0}clone(){return new rv({color:d(this.color),size:this.size,border:d(this.border)})}};Wi([We({line:"line"},{readOnly:!0})],sv.prototype,"type",void 0),Wi([Ee(_y)],sv.prototype,"color",void 0),Wi([Ee(by)],sv.prototype,"size",void 0),Wi([Ee({type:ev,json:{write:!0}})],sv.prototype,"border",void 0),Wi([Ee({readOnly:!0})],sv.prototype,"visible",null),sv=rv=Wi([St("esri.symbols.callouts.LineCallout3D")],sv);var ov,nv=sv;let av=ov=class extends Ac{constructor(){super(...arguments),this.screenLength=0,this.minWorldLength=0}clone(){return new ov({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};Wi([Ee(by)],av.prototype,"screenLength",void 0),Wi([Ee({type:Number,json:{write:!0,default:0}})],av.prototype,"minWorldLength",void 0),Wi([Ee({type:Number,json:{write:!0}})],av.prototype,"maxWorldLength",void 0),av=ov=Wi([St("esri.symbols.support.Symbol3DVerticalOffset")],av);var lv=av;function cv(e){if(!e)return!1;const t=e.verticalOffset;return!!t&&!(t.screenLength<=0||t.maxWorldLength<=0)}function hv(e){if(!e)return!1;if(!e.supportsCallout||!e.supportsCallout())return!1;const t=e.callout;return!!t&&!!t.visible&&!!cv(e)}const uv={types:{key:"type",base:iv,typeMap:{line:nv}},json:{write:!0}};var dv;const pv=hn.ofType({base:null,key:"type",typeMap:{text:Jm}});let fv=dv=class extends Kg{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new pv,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return hv(this)}hasVisibleVerticalOffset(){return cv(this)}clone(){return new dv({styleOrigin:d(this.styleOrigin),symbolLayers:d(this.symbolLayers),thumbnail:d(this.thumbnail),callout:d(this.callout),verticalOffset:d(this.verticalOffset)})}static fromTextSymbol(e){return new dv({symbolLayers:[Jm.fromTextSymbol(e)]})}};Wi([Ee({type:lv,json:{write:!0}})],fv.prototype,"verticalOffset",void 0),Wi([Ee(uv)],fv.prototype,"callout",void 0),Wi([Ee({json:{read:!1,write:!1}})],fv.prototype,"styleOrigin",void 0),Wi([Ee({type:pv})],fv.prototype,"symbolLayers",void 0),Wi([We({LabelSymbol3D:"label-3d"},{readOnly:!0})],fv.prototype,"type",void 0),fv=dv=Wi([St("esri.symbols.LabelSymbol3D")],fv);var yv,mv=fv;const gv=hn.ofType({base:null,key:"type",typeMap:{line:Tm,path:Gm}}),vv=hn.ofType({base:null,key:"type",typeMap:{line:Tm,path:Gm}});let _v=yv=class extends Kg{constructor(e){super(e),this.symbolLayers=new gv,this.type="line-3d"}clone(){return new yv({styleOrigin:d(this.styleOrigin),symbolLayers:d(this.symbolLayers),thumbnail:d(this.thumbnail)})}static fromSimpleLineSymbol(e){return new yv({symbolLayers:[Tm.fromSimpleLineSymbol(e)]})}};Wi([Ee({type:gv,json:{type:vv}})],_v.prototype,"symbolLayers",void 0),Wi([We({LineSymbol3D:"line-3d"},{readOnly:!0})],_v.prototype,"type",void 0),_v=yv=Wi([St("esri.symbols.LineSymbol3D")],_v);var bv=_v;let wv=class extends sy{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};Wi([Ee({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],wv.prototype,"angle",void 0),Wi([Ee({type:["simple-marker","picture-marker"],readOnly:!0})],wv.prototype,"type",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],wv.prototype,"xoffset",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],wv.prototype,"yoffset",void 0),Wi([Ee({type:Number,cast:e=>"auto"===e?e:fy(e),json:{write:!0}})],wv.prototype,"size",void 0),wv=Wi([St("esri.symbols.MarkerSymbol")],wv);var xv,Sv=wv;const Cv=hn.ofType({base:null,key:"type",typeMap:{fill:hm}});let Iv=xv=class extends Kg{constructor(e){super(e),this.symbolLayers=new Cv,this.type="mesh-3d"}clone(){return new xv({styleOrigin:d(this.styleOrigin),symbolLayers:d(this.symbolLayers),thumbnail:d(this.thumbnail)})}};Wi([Ee({type:Cv})],Iv.prototype,"symbolLayers",void 0),Wi([We({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Iv.prototype,"type",void 0),Iv=xv=Wi([St("esri.symbols.MeshSymbol3D")],Iv);var Av=Iv;function kv(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!ar(e)&&t.layer.parsedUrl?or(t.layer.parsedUrl.path,"images",e):zr(e,t)}const Nv={json:{read:{source:["imageData","url"],reader:function(e,t,r){return t.imageData?pr({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):kv(t.url,r)}},write:{writer(e,t,r,i){!function(e,t,r,i){if(cr(e)){const s=dr(e);t.contentType=s.mediaType,t.imageData=s.data,r&&r.imageData===t.imageData&&r.url&&qr(r.url,t,"url",i)}else qr(e,t,"url",i)}(e,t,this.source,i)}}}},Ov={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,t,r){const i={};return t.imageData&&(i.imageData=t.imageData),t.contentType&&(i.contentType=t.contentType),t.url&&(i.url=kv(t.url,r)),i}}}};var Tv;let Pv=Tv=class extends $y{constructor(...e){super(...e),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(e,t,r,i){if(e&&"string"!=typeof e&&null==e.imageData)return e;const s={};return e&&(s.url=e),t&&(s.outline=t),null!=r&&(s.width=fy(r)),null!=i&&(s.height=fy(i)),s}clone(){const e=new Tv({color:d(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",d(this.source)),e}hash(){var e;return`${super.hash()}.${null==(e=this.color)?void 0:e.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};Wi([We({esriPFS:"picture-fill"},{readOnly:!0})],Pv.prototype,"type",void 0),Wi([Ee(Nv)],Pv.prototype,"url",void 0),Wi([Ee({type:Number,json:{write:!0}})],Pv.prototype,"xscale",void 0),Wi([Ee({type:Number,json:{write:!0}})],Pv.prototype,"yscale",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Pv.prototype,"width",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Pv.prototype,"height",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Pv.prototype,"xoffset",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Pv.prototype,"yoffset",void 0),Wi([Ee(Ov)],Pv.prototype,"source",void 0),Pv=Tv=Wi([St("esri.symbols.PictureFillSymbol")],Pv);var Mv,Dv=Pv;let Lv=Mv=class extends Sv{constructor(...e){super(...e),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(e,t,r){if(e&&"string"!=typeof e&&null==e.imageData)return e;const i={};return e&&(i.url=e),null!=t&&(i.width=fy(t)),null!=r&&(i.height=fy(r)),i}readHeight(e,t){return t.size||e}readWidth(e,t){return t.size||e}clone(){const e=new Mv({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",d(this.source)),e}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};Wi([Ee({json:{write:!1}})],Lv.prototype,"color",void 0),Wi([We({esriPMS:"picture-marker"},{readOnly:!0})],Lv.prototype,"type",void 0),Wi([Ee(Nv)],Lv.prototype,"url",void 0),Wi([Ee(Ov)],Lv.prototype,"source",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Lv.prototype,"height",void 0),Wi([Je("height",["height","size"])],Lv.prototype,"readHeight",null),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],Lv.prototype,"width",void 0),Wi([Ee({json:{write:!1}})],Lv.prototype,"size",void 0),Lv=Mv=Wi([St("esri.symbols.PictureMarkerSymbol")],Lv);var Ev,Rv=Lv;const jv=hn.ofType({base:null,key:"type",typeMap:{icon:km,object:Bm,text:Jm}}),Fv=hn.ofType({base:null,key:"type",typeMap:{icon:km,object:Bm}});let Bv=Ev=class extends Kg{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new jv,this.type="point-3d"}writeSymbolLayers(e,t,r,i){const s=e.filter((e=>"text"!==e.type));if(i&&i.messages&&s.length<e.length){const t=e.find((e=>"text"===e.type));i.messages.push(new At("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:t}))}t[r]=s.map((e=>e.write({},i))).toArray()}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return hv(this)}hasVisibleVerticalOffset(){return cv(this)}clone(){return new Ev({verticalOffset:d(this.verticalOffset),callout:d(this.callout),styleOrigin:d(this.styleOrigin),symbolLayers:d(this.symbolLayers),thumbnail:d(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new Ev({symbolLayers:[km.fromSimpleMarkerSymbol(e)]})}static fromPictureMarkerSymbol(e){return new Ev({symbolLayers:[km.fromPictureMarkerSymbol(e)]})}static fromCIMSymbol(e){if(e.data&&e.data.symbol){const t=e.data.symbol;if("CIMPointSymbol"===t.type&&t.callout)return new Ev({symbolLayers:[km.fromCIMSymbol(e)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})}return new Ev({symbolLayers:[km.fromCIMSymbol(e)]})}static fromTextSymbol(e){return new Ev({symbolLayers:[Jm.fromTextSymbol(e)]})}};Wi([Ee({type:lv,json:{write:!0}})],Bv.prototype,"verticalOffset",void 0),Wi([Ee(uv)],Bv.prototype,"callout",void 0),Wi([Ee({type:jv,json:{type:Fv,origins:{"web-scene":{type:Fv}}}})],Bv.prototype,"symbolLayers",void 0),Wi([It("web-scene","symbolLayers")],Bv.prototype,"writeSymbolLayers",null),Wi([We({PointSymbol3D:"point-3d"},{readOnly:!0})],Bv.prototype,"type",void 0),Bv=Ev=Wi([St("esri.symbols.PointSymbol3D")],Bv);var zv,Uv=Bv;const Gv=hn.ofType({base:null,key:"type",typeMap:{extrude:Ey,fill:hm,icon:km,line:Tm,object:Bm,text:Jm,water:Ym}}),qv=hn.ofType({base:null,key:"type",typeMap:{extrude:Ey,fill:hm,icon:km,line:Tm,object:Bm,water:Ym}});let Vv=zv=class extends Kg{constructor(e){super(e),this.symbolLayers=new Gv,this.type="polygon-3d"}writeSymbolLayers(e,t,r,i){const s=e.filter((e=>"text"!==e.type));if(i&&i.messages&&s.length<e.length){const t=e.find((e=>"text"===e.type));i.messages.push(new At("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:t}))}t[r]=s.map((e=>e.write({},i))).toArray()}clone(){return new zv({styleOrigin:d(this.styleOrigin),symbolLayers:d(this.symbolLayers),thumbnail:d(this.thumbnail)})}static fromJSON(e){const t=new zv;if(t.read(e),2===t.symbolLayers.length&&"fill"===t.symbolLayers.getItemAt(0).type&&"line"===t.symbolLayers.getItemAt(1).type){const r=t.symbolLayers.getItemAt(0),i=t.symbolLayers.getItemAt(1);!i.enabled||e.symbolLayers&&e.symbolLayers[1]&&!1===e.symbolLayers[1].enable||(r.outline={size:i.size,color:b(i.material)?i.material.color:null}),t.symbolLayers.removeAt(1)}return t}static fromSimpleFillSymbol(e){return new zv({symbolLayers:[hm.fromSimpleFillSymbol(e)]})}};Wi([Ee({type:Gv,json:{type:qv}})],Vv.prototype,"symbolLayers",void 0),Wi([It("web-scene","symbolLayers")],Vv.prototype,"writeSymbolLayers",null),Wi([We({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Vv.prototype,"type",void 0),Vv=zv=Wi([St("esri.symbols.PolygonSymbol3D")],Vv);var Hv,$v=Vv;const Wv=new He({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Jv=Hv=class extends $y{constructor(...e){super(...e),this.color=new $a([0,0,0,.25]),this.outline=new Vy,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(e,t,r){if(e&&"string"!=typeof e)return e;const i={};return e&&(i.style=e),t&&(i.outline=t),r&&(i.color=r),i}clone(){return new Hv({color:d(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};Wi([Ee()],Jv.prototype,"color",void 0),Wi([Ee()],Jv.prototype,"outline",void 0),Wi([We({esriSFS:"simple-fill"},{readOnly:!0})],Jv.prototype,"type",void 0),Wi([Ee({type:Wv.apiValues,json:{read:Wv.read,write:Wv.write}})],Jv.prototype,"style",void 0),Jv=Hv=Wi([St("esri.symbols.SimpleFillSymbol")],Jv);var Qv,Zv=Jv;const Yv=new He({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Kv=Qv=class extends Sv{constructor(...e){super(...e),this.color=new $a([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Vy}normalizeCtorArgs(e,t,r,i){if(e&&"string"!=typeof e)return e;const s={};return e&&(s.style=e),null!=t&&(s.size=fy(t)),r&&(s.outline=r),i&&(s.color=i),s}writeColor(e,t){e&&"x"!==this.style&&"cross"!==this.style&&(t.color=e.toJSON()),null===e&&(t.color=null)}set path(e){this.style="path",this._set("path",e)}clone(){return new Qv({angle:this.angle,color:d(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${null==(e=this.outline)?void 0:e.hash()}`}};Wi([Ee()],Kv.prototype,"color",void 0),Wi([It("color")],Kv.prototype,"writeColor",null),Wi([We({esriSMS:"simple-marker"},{readOnly:!0})],Kv.prototype,"type",void 0),Wi([Ee()],Kv.prototype,"size",void 0),Wi([Ee({type:Yv.apiValues,json:{read:Yv.read,write:Yv.write}})],Kv.prototype,"style",void 0),Wi([Ee({type:String,json:{write:!0}})],Kv.prototype,"path",null),Wi([Ee({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Vy}},json:{default:null,write:!0}})],Kv.prototype,"outline",void 0),Kv=Qv=Wi([St("esri.symbols.SimpleMarkerSymbol")],Kv);var Xv,e_=Kv;let t_=Xv=class extends sy{constructor(...e){super(...e),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new pm,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment=null,this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(e,t,r){if(e&&"string"!=typeof e)return e;const i={};return e&&(i.text=e),t&&(i.font=t),r&&(i.color=r),i}writeLineWidth(e,t,r,i){i&&"string"!=typeof i?i.origin:t[r]=e}castLineWidth(e){return fy(e)}writeLineHeight(e,t,r,i){i&&"string"!=typeof i?i.origin:t[r]=e}clone(){return new Xv({angle:this.angle,backgroundColor:d(this.backgroundColor),borderLineColor:d(this.borderLineColor),borderLineSize:this.borderLineSize,color:d(this.color),font:this.font&&this.font.clone(),haloColor:d(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};Wi([Ee({type:$a,json:{write:!0}})],t_.prototype,"backgroundColor",void 0),Wi([Ee({type:$a,json:{write:!0}})],t_.prototype,"borderLineColor",void 0),Wi([Ee({type:Number,json:{write:!0}})],t_.prototype,"borderLineSize",void 0),Wi([Ee({type:pm,json:{write:!0}})],t_.prototype,"font",void 0),Wi([Ee({type:["left","right","center","justify"],json:{write:!0}})],t_.prototype,"horizontalAlignment",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],t_.prototype,"kerning",void 0),Wi([Ee({type:$a,json:{write:!0}})],t_.prototype,"haloColor",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],t_.prototype,"haloSize",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],t_.prototype,"rightToLeft",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],t_.prototype,"rotated",void 0),Wi([Ee({type:String,json:{write:!0}})],t_.prototype,"text",void 0),Wi([We({esriTS:"text"},{readOnly:!0})],t_.prototype,"type",void 0),Wi([Ee({type:["baseline","top","middle","bottom"],json:{write:!0}})],t_.prototype,"verticalAlignment",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],t_.prototype,"xoffset",void 0),Wi([Ee({type:Number,cast:fy,json:{write:!0}})],t_.prototype,"yoffset",void 0),Wi([Ee({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],t_.prototype,"angle",void 0),Wi([Ee({type:Number,json:{write:!0}})],t_.prototype,"width",void 0),Wi([Ee({type:Number})],t_.prototype,"lineWidth",void 0),Wi([It("lineWidth")],t_.prototype,"writeLineWidth",null),Wi([Ge("lineWidth")],t_.prototype,"castLineWidth",null),Wi([Ee({type:Number})],t_.prototype,"lineHeight",void 0),Wi([It("lineHeight")],t_.prototype,"writeLineHeight",null),t_=Xv=Wi([St("esri.symbols.TextSymbol")],t_);var r_,i_=t_;const s_=G.getLogger("esri.symbols.WebStyleSymbol");let o_=r_=class extends sy{constructor(e){super(e),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}read(e,t){this.portal=t?t.portal:void 0,super.read(e,t)}clone(){return new r_({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol("webRef",e)}fetchCIMSymbol(e){return this._fetchSymbol("cimRef",e)}async _fetchSymbol(e,t){const i=await r.e(3271).then(r.bind(r,3271)).then((function(e){return e.s}));Zs(t);const s=i.resolveWebStyleSymbol(this,{portal:this.portal},e,t);return s.catch((e=>{s_.error("#fetchSymbol()","Failed to create symbol from style",e)})),s}};Wi([Ee({json:{write:!1}})],o_.prototype,"color",void 0),Wi([Ee({type:String,json:{write:!0}})],o_.prototype,"styleName",void 0),Wi([Ee({type:Ug,json:{write:!1}})],o_.prototype,"portal",void 0),Wi([Ee({type:String,json:{read:Gr,write:qr}})],o_.prototype,"styleUrl",void 0),Wi([Ee({type:$g,json:{read:!1}})],o_.prototype,"thumbnail",void 0),Wi([Ee({type:String,json:{write:!0}})],o_.prototype,"name",void 0),Wi([We({styleSymbolReference:"web-style"},{readOnly:!0})],o_.prototype,"type",void 0),o_=r_=Wi([St("esri.symbols.WebStyleSymbol")],o_);var n_=o_;function a_(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function l_(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const c_={base:sy,key:"type",typeMap:{"simple-fill":Zv,"picture-fill":Dv,"picture-marker":Rv,"simple-line":Vy,"simple-marker":e_,text:i_,"label-3d":mv,"line-3d":bv,"mesh-3d":Av,"point-3d":Uv,"polygon-3d":$v,"web-style":n_,cim:ny},errorContext:"symbol"},h_={base:sy,key:"type",typeMap:{"picture-marker":Rv,"simple-marker":e_,text:i_,"web-style":n_,cim:ny},errorContext:"symbol"},u_=et({types:c_}),d_={base:sy,key:"type",typeMap:{"simple-fill":Zv,"picture-fill":Dv,"picture-marker":Rv,"simple-line":Vy,"simple-marker":e_,text:i_,"line-3d":bv,"mesh-3d":Av,"point-3d":Uv,"polygon-3d":$v,"web-style":n_,cim:ny},errorContext:"symbol"},p_={base:sy,key:"type",typeMap:{text:i_,"label-3d":mv},errorContext:"symbol"},f_={base:sy,key:"type",typeMap:{"line-3d":bv,"mesh-3d":Av,"point-3d":Uv,"polygon-3d":$v,"web-style":n_},errorContext:"symbol"},y_={base:sy,key:"type",typeMap:{"label-3d":mv},errorContext:"symbol"},m_=le(c_);let g_=0;function v_(){return++g_}var __;let b_=__=class extends Ac{constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:v_(),configurable:!0})}normalizeCtorArgs(e,t,r,i){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:r,popupTemplate:i}}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(e=!1){return this.popupTemplate?this.popupTemplate:this.sourceLayer?"popupTemplate"in this.sourceLayer&&this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:e&&"defaultPopupTemplate"in this.sourceLayer&&b(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null}getAttribute(e){return this.attributes&&this.attributes[e]}setAttribute(e,t){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",r,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:b(this.geometry)?this.geometry.toJSON():null,symbol:b(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new __(this.cloneProperties())}cloneProperties(){return{attributes:d(this.attributes),geometry:d(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:d(this.symbol),visible:this.visible}}_notifyLayer(e,t,r,i){if(!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:t,newValue:r};"attributes"===e&&(s.attributeName=i),this.layer.graphicChanged(s)}};Wi([Ee({value:null})],b_.prototype,"attributes",null),Wi([Ee({value:null,types:Gu,json:{read:Fu}})],b_.prototype,"geometry",null),Wi([Ee({type:Boolean})],b_.prototype,"isAggregate",void 0),Wi([Ee()],b_.prototype,"layer",void 0),Wi([Ee({type:Xf})],b_.prototype,"popupTemplate",void 0),Wi([Ee()],b_.prototype,"sourceLayer",void 0),Wi([Ee({value:null,types:c_})],b_.prototype,"symbol",null),Wi([Ee({type:Boolean,value:!0})],b_.prototype,"visible",null),b_=__=Wi([St("esri.Graphic")],b_),function(e){e.generateUID=v_}(b_||(b_={}));var w_=b_;const x_=new He({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});var S_;const C_=new He({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let I_=S_=class extends Ac{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(e,{description:t}){let r;try{r=JSON.parse(t)}catch(e){}return r?r.value:null}readValueType(e,{description:t}){let r;try{r=JSON.parse(t)}catch(e){}return r?C_.fromJSON(r.fieldValueType):null}clone(){return new S_({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};Wi([Ee({type:String,json:{write:!0}})],I_.prototype,"alias",void 0),Wi([Ee({type:[String,Number],json:{write:{allowNull:!0}}})],I_.prototype,"defaultValue",void 0),Wi([Ee()],I_.prototype,"description",void 0),Wi([Je("description")],I_.prototype,"readDescription",null),Wi([Ee({types:pd,json:{read:{reader:fd},write:!0}})],I_.prototype,"domain",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],I_.prototype,"editable",void 0),Wi([Ee({type:ce,json:{write:!0}})],I_.prototype,"length",void 0),Wi([Ee({type:String,json:{write:!0}})],I_.prototype,"name",void 0),Wi([Ee({type:Boolean,json:{write:!0}})],I_.prototype,"nullable",void 0),Wi([We(x_)],I_.prototype,"type",void 0),Wi([Ee()],I_.prototype,"valueType",void 0),Wi([Je("valueType",["description"])],I_.prototype,"readValueType",null),I_=S_=Wi([St("esri.layers.support.Field")],I_);var A_=I_;const k_=new He({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let N_=class extends Ac{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const r=Jc.fromJSON(t.spatialReference),i=[];for(let t=0;t<e.length;t++){const s=e[t],o=w_.fromJSON(s),n=s.geometry&&s.geometry.spatialReference;b(o.geometry)&&!n&&(o.geometry.spatialReference=r),i.push(o)}return i}writeGeometryType(e,t,r,i){if(e)return void k_.write(e,t,r,i);const{features:s}=this;if(s)for(const e of s)if(e&&b(e.geometry))return void k_.write(e.geometry.type,t,r,i)}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,i=Fu(e);return!r&&t.spatialReference&&(i.spatialReference=Jc.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:r}=this;if(r)for(const e of r)if(e&&b(e.geometry)&&e.geometry.spatialReference)return void(t.spatialReference=e.geometry.spatialReference.toJSON())}toJSON(e){const t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const i=t.features[r];if(i.geometry){const t=e&&e[r];i.geometry=t&&t.toJSON()||i.geometry}}return t}quantize(e){const{scale:[t,r],translate:[i,s]}=e,o=this.features,n=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((s-e)/r)));for(let e=0,t=o.length;e<t;e++)n(o[e].geometry)||(o.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:r}=this;if(!r)return this;const{translate:[i,s],scale:[o,n]}=r,a=this._getHydrationFunction(e,(e=>e*o+i),(e=>s-e*n));for(const{geometry:e}of t)b(e)&&a(e);return this.transform=null,this}_quantizePoints(e,t,r){let i,s;const o=[];for(let n=0,a=e.length;n<a;n++){const a=e[n];if(n>0){const e=t(a[0]),n=r(a[1]);e===i&&n===s||(o.push([e-i,n-s]),i=e,s=n)}else i=t(a[0]),s=r(a[1]),o.push([i,s])}return o.length>0?o:null}_getQuantizationFunction(e,t,r){return"point"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):"polyline"===e||"polygon"===e?e=>{const i=ju(e)?e.rings:e.paths,s=[];for(let e=0,o=i.length;e<o;e++){const o=i[e],n=this._quantizePoints(o,t,r);n&&s.push(n)}return s.length>0?(ju(e)?e.rings=s:e.paths=s,e):null}:"multipoint"===e?e=>{const i=this._quantizePoints(e.points,t,r);return i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,r){return"point"===e?e=>{e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?e=>{const i=ju(e)?e.rings:e.paths;let s,o;for(let e=0,n=i.length;e<n;e++){const n=i[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];e>0?(s+=i[0],o+=i[1]):(s=i[0],o=i[1]),i[0]=t(s),i[1]=r(o)}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?e=>{const i=e.points;let s,o;for(let e=0,n=i.length;e<n;e++){const n=i[e];e>0?(s+=n[0],o+=n[1]):(s=n[0],o=n[1]),n[0]=t(s),n[1]=r(o)}}:void 0}};Wi([Ee({type:String,json:{write:!0}})],N_.prototype,"displayFieldName",void 0),Wi([Ee({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],N_.prototype,"exceededTransferLimit",void 0),Wi([Ee({type:[w_],json:{write:!0}})],N_.prototype,"features",void 0),Wi([Je("features")],N_.prototype,"readFeatures",null),Wi([Ee({type:[A_],json:{write:!0}})],N_.prototype,"fields",void 0),Wi([Ee({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:k_.read}}})],N_.prototype,"geometryType",void 0),Wi([It("geometryType")],N_.prototype,"writeGeometryType",null),Wi([Ee({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],N_.prototype,"hasM",void 0),Wi([Ee({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],N_.prototype,"hasZ",void 0),Wi([Ee({types:Gu,json:{write:!0}})],N_.prototype,"queryGeometry",void 0),Wi([Je("queryGeometry")],N_.prototype,"readQueryGeometry",null),Wi([Ee({type:Jc,json:{write:!0}})],N_.prototype,"spatialReference",void 0),Wi([It("spatialReference")],N_.prototype,"writeSpatialReference",null),Wi([Ee({json:{write:!0}})],N_.prototype,"transform",void 0),N_=Wi([St("esri.tasks.support.FeatureSet")],N_),N_.prototype.toJSON.isDefaultToJSON=!0,N_||(N_={});var O_=N_;const T_=Object.freeze({__proto__:null,default:O_});class P_ extends Qu{constructor(e){super(e),e&&e.featureSet&&(e.featureSet instanceof O_?this.featureSet=e.featureSet:this.featureSet=O_.fromJSON(e.featureSet))}toJSON(){const e=super.toJSON();return e.featureSet=this.featureSet&&this.featureSet.toJSON(),e}}function M_(e){e.forEach((e=>{e[0]=parseFloat(e[0].toFixed(10)),e[1]=parseFloat(e[1].toFixed(10))}))}class D_ extends Qu{constructor(e){super(e),e&&e.geometry&&(e.geometry instanceof Zc?this.geometry=e.geometry:this.geometry=Fu(e.geometry))}getGeomType(){return this.geometry.type}toJSON(){const e=super.toJSON();e.geometry=this.geometry&&this.geometry.toJSON();const t=e.geometry;return t&&(t.points?M_(t.points):t.paths?t.paths.forEach(M_):t.rings&&t.rings.forEach(M_)),e}}class L_ extends Qu{constructor(e){if(super(e),e){const t=e.sourceCountry||e.countryID;t&&(this.countryID=t);const r=e.layer||e.geographyLayerID;r&&(this.geographyLayerID=r),e.ids&&(this.ids=e.ids)}}getGeomType(){return"polygon"}toJSON(){const e=super.toJSON();return this.countryID&&(e.sourceCountry=this.countryID),this.geographyLayerID&&(e.layer=this.geographyLayerID),this.ids&&(e.ids=this.ids.slice()),e}}function E_(e){return!!e.geometry}class R_{constructor(e){if(this.studyAreas=[],!e)return;if(e.studyAreas){let r;e.inSR&&(r=e.inSR);const i=e.studyAreas;for(let e=0;e<i.length;e++){const s=(t=i[e]).geometry?new D_(t):t.featureSet?new P_(t):t.address?new Zu(t):t.layer?new L_(t):null;r&&E_(s)&&(s.geometry.spatialReference=new Jc(r)),this.studyAreas.push(s)}}var t;e.studyAreasOptions?this.studyAreaOptions=Ju(e.studyAreasOptions):e.studyAreaOptions&&(e.studyAreaOptions instanceof Vu?this.studyAreaOptions=e.studyAreaOptions:this.studyAreaOptions=Ju(e.studyAreaOptions));const r=e.useData;r?(r.sourceCountry&&(this.countryID=r.sourceCountry),r.hierarchy&&(this.hierarchy=r.hierarchy)):(e.countryID&&(this.countryID=e.countryID),e.hierarchy&&(this.hierarchy=e.hierarchy))}toJSON(){const e={},t=[];for(let e=0;e<this.studyAreas.length;e++){const r=this.studyAreas[e];t.push(r.toJSON())}if(t.length>0&&(e.studyAreas=t),this.studyAreaOptions&&(e.studyAreasOptions=this.studyAreaOptions.toJSON()),this.countryID||this.hierarchy){const t={};this.countryID&&(t.sourceCountry=this.countryID),this.hierarchy&&(t.hierarchy=this.hierarchy),e.useData=t}return e}}class j_{constructor(e){this.geometryType="esriGeometryPoint",this.spatialRel="esriSpatialRelIntersects",e&&(this.name=e.name||null,this.outFields=e.outFields||null,e.intersectionInfo?(e.intersectionInfo.geometryType&&(this.geometryType=e.intersectionInfo.geometryType),e.intersectionInfo.spatialRel&&(this.spatialRel=e.intersectionInfo.spatialRel)):(e.geometryType&&(this.geometryType=e.geometryType),e.spatialRel&&(this.spatialRel=e.spatialRel)))}toJSON(){return{name:this.name,outFields:this.outFields,intersectionInfo:{geometryType:this.geometryType,spatialRel:this.spatialRel}}}}class F_ extends j_{constructor(e){super(e),e&&(this.geographyLayerID=e.geographyLayer||e.geographyLayerID||null)}toJSON(){const e=super.toJSON();return e.geographyType="standard",e.geographyLayer=this.geographyLayerID,e}}class B_ extends R_{constructor(e){if(super(e),this.returnGeometry=!1,this.forStorage=!0,this.variables=[],e&&(this.variables=e.analysisVariables||e.variables||null,e.returnGeometry&&(this.returnGeometry=!0),e.outSR&&(this.outSR=new Jc(e.outSR)),e.forStorage&&(this.forStorage=e.forStorage),e.intersectingGeographies)){this.intersectingGeographies=[];for(let t=0;t<e.intersectingGeographies.length;t++){const r=e.intersectingGeographies[t];if("standard"===r.geographyType)this.intersectingGeographies.push(new F_(r));else if("external"===r.geographyType)throw new Error("Not implemented")}}}toJSON(){const e=super.toJSON();if(e.analysisVariables=this.variables,this.returnGeometry&&(e.returnGeometry=!0),this.outSR&&(e.outSR=this.outSR.toJSON()),this.forStorage||(e.forStorage=!1),this.intersectingGeographies){e.intersectingGeographies=[];for(let t=0;t<this.intersectingGeographies.length;t++)e.intersectingGeographies.push(this.intersectingGeographies[t].toJSON())}return e}}class z_{constructor(e){var t;e&&(this.fields=e.fields&&e.fields.map((e=>{return{name:e.name,type:(t=e.type,t&&t.replace("esriFieldType","").toLowerCase()),alias:e.alias,description:e.description,length:e.length,units:e.units,decimals:e.decimals,fullName:e.fullName};var t}))||[],this.features=e.features&&e.features.map((t=>(t.geometry&&(t.geometry.spatialReference=e.spatialReference&&d(e.spatialReference)),new w_({attributes:t.attributes,geometry:t.geometry&&Fu(t.geometry)}))))||[],this.geometryType=(t=e.geometryType)&&t.replace("esriGeometry","").toLowerCase(),this.fieldAliases=e.fieldAliases,this.spatialReference=e.spatialReference&&new Jc(e.spatialReference))}toJSON(){return{fields:this.fields.map((e=>{return{name:e.name,type:(t=e.type,t&&"esriFieldType"+t.charAt(0).toUpperCase()+t.substr(1)),alias:e.alias,description:e.description,length:e.length,units:e.units,decimals:e.decimals,fullName:e.fullName};var t})),features:this.features.map((e=>e.toJSON())),geometryType:(e=this.geometryType,e&&"esriGeometry"+e.charAt(0).toUpperCase()+e.substr(1)),fieldAliases:this.fieldAliases&&d(this.fieldAliases),spatialReference:this.spatialReference&&this.spatialReference.toJSON()};var e}static fromField(e){return{name:e.name,type:e.type,alias:e.alias,description:e.description,length:e.length}}static toField(e){return new A_({name:e.name,type:e.type,alias:e.alias,description:e.description,length:e.length})}static fromFeatureSet(e){if(e instanceof z_)return e;const t=new z_;return t.fields=e.fields.map(this.fromField)||[],t.features=e.features.slice(),t.geometryType=e.geometryType,t.spatialReference=e.spatialReference,t}static toFeatureSet(e){const t=new O_;return t.fields=e.fields.map(this.toField)||[],t.features=e.features.slice(),t.geometryType=e.geometryType,t.spatialReference=e.spatialReference,t}}var U_,G_,q_=Function.prototype,V_=Object.prototype,H_=q_.toString,$_=V_.hasOwnProperty,W_=H_.call(Object),J_=V_.toString,Q_=(U_=Object.getPrototypeOf,G_=Object,function(e){return U_(G_(e))});function Z_(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},r.exports),r.exports}function Y_(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var K_=/javascript\s*\:/gim,X_={whiteList:{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},getDefaultWhiteList:Y_,onAttr:function(e,t,r){},onIgnoreAttr:function(e,t,r){},safeAttrValue:function(e,t){return K_.test(t)?"":t}},eb=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},tb=function(e,t){var r;";"!==(r=e,e=String.prototype.trimRight?r.trimRight():r.replace(/(\s*$)/g,""))[e.length-1]&&(e+=";");var i=e.length,s=!1,o=0,n=0,a="";function l(){if(!s){var r=eb(e.slice(o,n)),i=r.indexOf(":");if(-1!==i){var l=eb(r.slice(0,i)),c=eb(r.slice(i+1));if(l){var h=t(o,a.length,l,c,r);h&&(a+=h+"; ")}}}o=n+1}for(;n<i;n++){var c=e[n];if("/"===c&&"*"===e[n+1]){var h=e.indexOf("*/",n+2);if(-1===h)break;o=(n=h+1)+1,s=!1}else"("===c?s=!0:")"===c?s=!1:";"===c?s||l():"\n"===c&&l()}return eb(a)};function rb(e){return null==e}function ib(e){e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{}),e.whiteList=e.whiteList||X_.whiteList,e.onAttr=e.onAttr||X_.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||X_.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||X_.safeAttrValue,this.options=e}ib.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,i=t.onAttr,s=t.onIgnoreAttr,o=t.safeAttrValue,n=tb(e,(function(e,t,n,a,l){var c=r[n],h=!1;if(!0===c?h=c:"function"==typeof c?h=c(a):c instanceof RegExp&&(h=c.test(a)),!0!==h&&(h=!1),a=o(n,a)){var u,d={position:t,sourcePosition:e,source:l,isWhite:h};return h?rb(u=i(n,a,d))?n+":"+a:u:rb(u=s(n,a,d))?void 0:u}}));return n};var sb=ib,ob=Z_((function(e,t){for(var r in(t=e.exports=function(e,t){return new sb(t).process(e)}).FilterCSS=sb,X_)t[r]=X_[r]})),nb={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var i,s;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,s=e.length;i<s;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}},ab=ob.FilterCSS,lb=ob.getDefaultWhiteList;var cb=new ab;function hb(e){return e.replace(ub,"&lt;").replace(db,"&gt;")}var ub=/</g,db=/>/g,pb=/"/g,fb=/&quot;/g,yb=/&#([a-zA-Z0-9]*);?/gim,mb=/&colon;?/gim,gb=/&newline;?/gim,vb=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,_b=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,bb=/u\s*r\s*l\s*\(.*/gi;function wb(e){return e.replace(pb,"&quot;")}function xb(e){return e.replace(fb,'"')}function Sb(e){return e.replace(yb,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}function Cb(e){return e.replace(mb,":").replace(gb," ")}function Ib(e){for(var t="",r=0,i=e.length;r<i;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return nb.trim(t)}function Ab(e){return Ib(e=Cb(e=Sb(e=xb(e))))}function kb(e){return hb(e=wb(e))}var Nb=/<!--[\s\S]*?-->/g,Ob={whiteList:{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},getDefaultWhiteList:function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}},onTag:function(e,t,r){},onIgnoreTag:function(e,t,r){},onTagAttr:function(e,t,r){},onIgnoreTagAttr:function(e,t,r){},safeAttrValue:function(e,t,r,i){if(r=Ab(r),"href"===t||"src"===t){if("#"===(r=nb.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(vb.lastIndex=0,vb.test(r))return""}else if("style"===t){if(_b.lastIndex=0,_b.test(r))return"";if(bb.lastIndex=0,bb.test(r)&&(vb.lastIndex=0,vb.test(r)))return"";!1!==i&&(r=(i=i||cb).process(r))}return kb(r)},escapeHtml:hb,escapeQuote:wb,unescapeQuote:xb,escapeHtmlEntities:Sb,escapeDangerHtml5Entities:Cb,clearNonPrintableCharacter:Ib,friendlyAttrValue:Ab,escapeAttrValue:kb,onIgnoreTagStripAll:function(){return""},StripTagBody:function(e,t){"function"!=typeof t&&(t=function(){});var r=!Array.isArray(e),i=[],s=!1;return{onIgnoreTag:function(o,n,a){if(function(t){return!!r||-1!==nb.indexOf(e,t)}(o)){if(a.isClosing){var l=a.position+10;return i.push([!1!==s?s:a.position,l]),s=!1,"[/removed]"}return s||(s=a.position),"[removed]"}return t(o,n,a)},remove:function(e){var t="",r=0;return nb.forEach(i,(function(i){t+=e.slice(r,i[0]),r=i[1]})),t+=e.slice(r)}}},stripCommentTag:function(e){return e.replace(Nb,"")},stripBlankChar:function(e){var t=e.split("");return t=t.filter((function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})),t.join("")},cssFilter:cb,getDefaultCSSWhiteList:lb};function Tb(e){var t=nb.spaceIndex(e);if(-1===t)var r=e.slice(1,-1);else r=e.slice(1,t+1);return"/"===(r=nb.trim(r).toLowerCase()).slice(0,1)&&(r=r.slice(1)),"/"===r.slice(-1)&&(r=r.slice(0,-1)),r}function Pb(e){return"</"===e.slice(0,2)}var Mb=/[^a-zA-Z0-9_:\.\-]/gim;function Db(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}}function Lb(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}}function Eb(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}var Rb={parseTag:function(e,t,r){var i="",s=0,o=!1,n=!1,a=0,l=e.length,c="",h="";e:for(a=0;a<l;a++){var u=e.charAt(a);if(!1===o){if("<"===u){o=a;continue}}else if(!1===n){if("<"===u){i+=r(e.slice(s,a)),o=a,s=a;continue}if(">"===u){i+=r(e.slice(s,o)),c=Tb(h=e.slice(o,a+1)),i+=t(o,i.length,c,h,Pb(h)),s=a+1,o=!1;continue}if('"'===u||"'"===u)for(var d=1,p=e.charAt(a-d);" "===p||"="===p;){if("="===p){n=u;continue e}p=e.charAt(a-++d)}}else if(u===n){n=!1;continue}}return s<e.length&&(i+=r(e.substr(s))),i},parseAttr:function(e,t){var r=0,i=[],s=!1,o=e.length;function n(e,r){if(!((e=(e=nb.trim(e)).replace(Mb,"").toLowerCase()).length<1)){var s=t(e,r||"");s&&i.push(s)}}for(var a=0;a<o;a++){var l,c=e.charAt(a);if(!1!==s||"="!==c)if(!1===s||a!==r||'"'!==c&&"'"!==c||"="!==e.charAt(a-1)){if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===s){if(-1===(l=Db(e,a))){n(nb.trim(e.slice(r,a))),s=!1,r=a+1;continue}a=l-1;continue}if(-1===(l=Lb(e,a-1))){n(s,Eb(nb.trim(e.slice(r,a)))),s=!1,r=a+1;continue}}}else{if(-1===(l=e.indexOf(c,a+1)))break;n(s,nb.trim(e.slice(r+1,l))),s=!1,r=(a=l)+1}else s=e.slice(r,a),r=a+1}return r<e.length&&(!1===s?n(e.slice(r)):n(s,Eb(nb.trim(e.slice(r))))),nb.trim(i.join(" "))}},jb=ob.FilterCSS,Fb=Rb.parseTag,Bb=Rb.parseAttr;function zb(e){return null==e}function Ub(e){e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=Ob.onIgnoreTagStripAll),e.whiteList=e.whiteList||Ob.whiteList,e.onTag=e.onTag||Ob.onTag,e.onTagAttr=e.onTagAttr||Ob.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||Ob.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||Ob.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||Ob.safeAttrValue,e.escapeHtml=e.escapeHtml||Ob.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new jb(e.css))}Ub.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,i=t.onTag,s=t.onIgnoreTag,o=t.onTagAttr,n=t.onIgnoreTagAttr,a=t.safeAttrValue,l=t.escapeHtml,c=this.cssFilter;t.stripBlankChar&&(e=Ob.stripBlankChar(e)),t.allowCommentTag||(e=Ob.stripCommentTag(e));var h=!1;t.stripIgnoreTagBody&&(h=Ob.StripTagBody(t.stripIgnoreTagBody,s),s=h.onIgnoreTag);var u=Fb(e,(function(e,t,h,u,d){var p,f={sourcePosition:e,position:t,isClosing:d,isWhite:r.hasOwnProperty(h)};if(!zb(p=i(h,u,f)))return p;if(f.isWhite){if(f.isClosing)return"</"+h+">";var y=function(e){var t=nb.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=nb.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=nb.trim(e.slice(0,-1))),{html:e,closing:r}}(u),m=r[h],g=Bb(y.html,(function(e,t){var r,i=-1!==nb.indexOf(m,e);return zb(r=o(h,e,t,i))?i?(t=a(h,e,t,c))?e+'="'+t+'"':e:zb(r=n(h,e,t,i))?void 0:r:r}));return u="<"+h,g&&(u+=" "+g),y.closing&&(u+=" /"),u+">"}return zb(p=s(h,u,f))?l(u):p}),l);return h&&(u=h.remove(u)),u};var Gb=Ub,qb=Z_((function(e,t){function r(e,t){return new Gb(t).process(e)}for(var i in(t=e.exports=r).filterXSS=r,t.FilterXSS=Gb,Ob)t[i]=Ob[i];for(var i in Rb)t[i]=Rb[i];"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)})),Vb=function(){function e(e,t){var r,i=this;this.arcgisWhiteList={a:["href","target","style"],img:["src","width","height","border","alt","style"],video:["autoplay","controls","height","loop","muted","poster","preload","width"],audio:["autoplay","controls","loop","muted","preload"],source:["media","src","type"],span:["style"],table:["width","height","cellpadding","cellspacing","border","style"],div:["style","align"],font:["size","color","style"],tr:["height","valign","align","style"],td:["height","width","valign","align","colspan","rowspan","nowrap","style"],th:["height","width","valign","align","colspan","rowspan","nowrap","style"],p:["style"],b:[],strong:[],i:[],em:[],u:[],br:[],li:[],ul:[],ol:[],hr:[],tbody:[]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(e,t,r,s){return"a"===e&&"href"===t||("img"===e||"source"===e)&&"src"===t?i.sanitizeUrl(r):qb.safeAttrValue(e,t,r,s)}},e&&!t?r=e:e&&t?(r=Object.create(this.arcgisFilterOptions),Object.keys(e).forEach((function(t){"whiteList"===t?r.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]):r[t]=e[t]}))):(r=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=r,this._xssFilter=new qb.FilterXSS(r)}return e.prototype.sanitize=function(e,t){switch(void 0===t&&(t={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,t);default:if(t.allowUndefined&&void 0===e)return;return null}},e.prototype.sanitizeUrl=function(e){var t=this._trim(e.substring(0,e.indexOf(":")));return"/"===e||"#"===e||"#"===e[0]||this.allowedProtocols.indexOf(t.toLowerCase())>-1?qb.escapeAttrValue(e):""},e.prototype.sanitizeHTMLAttribute=function(e,t,r,i){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(e,t,r,i):qb.safeAttrValue(e,t,r,i)},e.prototype.validate=function(e,t){void 0===t&&(t={});var r=this.sanitize(e,t);return{isValid:e===r,sanitized:r}},e.prototype._extendObjectOfArrays=function(e){var t={};return e.forEach((function(e){Object.keys(e).forEach((function(r){Array.isArray(e[r])&&Array.isArray(t[r])?t[r]=t[r].concat(e[r]):t[r]=e[r]}))})),t},e.prototype._iterateOverObject=function(e,t){var r=this;void 0===t&&(t={});try{var i=!1,s=void 0;if(Array.isArray(e))s=e.reduce((function(e,s){var o=r.validate(s,t);return o.isValid?e.concat([s]):(i=!0,e.concat([o.sanitized]))}),[]);else{if(!function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=J_.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=Q_(e);if(null===t)return!0;var r=$_.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&H_.call(r)==W_}(e)){if(t.allowUndefined&&void 0===e)return;return null}s=Object.keys(e).reduce((function(s,o){var n=e[o],a=r.validate(n,t);return a.isValid?s[o]=n:(i=!0,s[o]=a.sanitized),s}),{})}return i?s:e}catch(e){return null}},e.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},e}();function Hb(e){const t=ws.acquire();for(let e=0;e<arguments.length;e++){const r=arguments[e],i=typeof r;if("string"===i)t.push(r);else if(Array.isArray(r))t.push.apply(t,r);else if("object"===i)for(const e in r)r[e]&&t.push(e)}const r=t.join(" ");return ws.release(t),r}function $b(e){this[e.getAttribute("data-node-ref")]=e}G.getLogger("esri.widgets.support.widgetUtils");const Wb=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce(((e,t)=>(e[t]=[],e)),{}),Jb=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Qb=new Vb({whiteList:Wb,onTagAttr:(e,t,r)=>{const i=`${t}="${r}"`;if(Jb.includes(t))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Zb(e){return function(t,r){t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}var Yb=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},Kb=function(e,t){for(var r=0,i=e.length;r<i;r++){var s=e[r];Array.isArray(s)?Kb(s,t):null!=s&&!1!==s&&(s.hasOwnProperty("vnodeSelector")||(s=Yb(s)),t.push(s))}},Xb=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(1===r.length&&"string"==typeof r[0])return{vnodeSelector:e,properties:t||void 0,children:void 0,text:r[0],domNode:null};var s=[];return Kb(r,s),{vnodeSelector:e,properties:t||void 0,children:s,text:void 0,domNode:null}};function ew(e,t,r,i,s){const o="function"==typeof i?i:null,n="object"==typeof i?i:null;"boolean"==typeof i&&(s=i);let a,l=!1;function c(){a&&(a.remove(),a=null)}const h=no();to(n,(()=>{c(),h.reject(Js())}));const u={then:h.promise.then.bind(h.promise),catch:h.promise.catch.bind(h.promise),remove:c};return Object.freeze(u),a=function(e,t,r,i,s){const o=e.watch(t,((t,s,o,n)=>{r&&!r(t)||null==i||i.call(e,t,s,o,n)}),s);if(Array.isArray(t))for(const s of t){const o=e.get(s);r&&r(o)&&(null==i||i.call(e,o,o,t,e))}else{const s=e.get(t);r&&r(s)&&(null==i||i.call(e,s,s,t,e))}return o}(e,t,r,((t,r,i,s)=>{l=!0,c(),o&&o.call(e,t,r,i,s),h.resolve({value:t,oldValue:r,propertyName:i,target:s})}),s),l&&c(),u}function tw(e){return!!e}function rw(e){return!e}function iw(e){return!0===e}function sw(e){return!1===e}const ow=/\?(\.|$)/g;function nw(e,t,r,i){const s=Array.isArray(t)?t:t.indexOf(",")>-1?t.split(","):[t],o=function(e,t,r,i){return e.watch(t,r,i)}(e,t,r,i);for(const t of s){const i=t.trim().replace(ow,"$1"),s=e.get(i);r.call(e,s,s,i,e)}return o}function aw(e,t,r,i){return ew(e,t,tw,r,i)}function lw(e,t,r,i){return ew(e,t,rw,r,i)}function cw(e,t,r,i){return ew(e,t,iw,r,i)}function hw(e,t,r,i){return ew(e,t,sw,r,i)}function uw(e,t,r,i,s,o,n){const a={};function l(t){const i=a[t];i&&(o&&o(i.target,t,e,r),i.handle.remove(),delete a[t])}const c=nw(e,t,((t,o,n)=>{l(n),Ni(t)&&(a[n]={handle:Oi(t,r,i),target:t},s&&s(t,n,e,r))}),n);return{remove(){c.remove();for(const e in a)l(e)}}}const dw="http://www.w3.org/",pw=`${dw}2000/svg`,fw=`${dw}1999/xlink`;let yw,mw=[],gw=(e,t)=>{let r={};return Object.keys(e).forEach((t=>{r[t]=e[t]})),t&&Object.keys(t).forEach((e=>{r[e]=t[e]})),r},vw=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),_w=e=>{if("string"!=typeof e)throw new Error("Style values must be strings")},bw=(e,t,r)=>{if(""!==t.vnodeSelector)for(let i=r;i<e.length;i++)if(vw(e[i],t))return i;return-1},ww=(e,t,r,i)=>{let s=e[t];if(""===s.vnodeSelector)return;let o=s.properties;if(!(o?void 0===o.key?o.bind:o.key:void 0))for(let o=0;o<e.length;o++)if(o!==t){let t=e[o];if(vw(t,s))throw new Error(`${r.vnodeSelector} had a ${s.vnodeSelector} child ${"added"===i?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},xw=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},Sw=[],Cw=!1,Iw=e=>{(e.children||[]).forEach(Iw),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},Aw=()=>{Cw=!1,Sw.forEach(Iw),Sw.length=0},kw=e=>{Sw.push(e),Cw||(Cw=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(Aw,{timeout:16}):setTimeout(Aw,16))},Nw=e=>{let t=e.domNode;if(e.properties){let r=e.properties.exitAnimation;if(r){t.style.pointerEvents="none";let i=()=>{t.parentNode&&(t.parentNode.removeChild(t),kw(e))};return void r(t,i,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),kw(e))},Ow=(e,t,r)=>{if(!t)return;let i=r.eventHandlerInterceptor,s=Object.keys(t),o=s.length;for(let n=0;n<o;n++){let o=s[n],a=t[o];if("className"===o)throw new Error('Property "className" is not supported, use "class".');if("class"===o)Mw(e,a,!0);else if("classes"===o){let t=Object.keys(a),r=t.length;for(let i=0;i<r;i++){let r=t[i];a[r]&&e.classList.add(r)}}else if("styles"===o){let t=Object.keys(a),i=t.length;for(let s=0;s<i;s++){let i=t[s],o=a[i];o&&(_w(o),r.styleApplyer(e,i,o))}}else if("key"!==o&&null!=a){let s=typeof a;"function"===s?(0===o.lastIndexOf("on",0)&&(i&&(a=i(o,a,e,t)),"oninput"===o&&function(){let e=a;a=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[o]=a):r.namespace===pw?"href"===o?e.setAttributeNS(fw,o,a):e.setAttribute(o,a):"string"===s&&"value"!==o?"innerHTML"===o?e[o]=Qb.sanitize(a):e.setAttribute(o,a):e[o]=a}}},Tw=(e,t,r)=>{((e,t,r)=>{if(t)for(let i of t)Pw(i,e,void 0,r)})(e,t.children,r),t.text&&(e.textContent=t.text),Ow(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},Pw=(e,t,r,i)=>{let s,o=0,n=e.vnodeSelector,a=t.ownerDocument;if(""===n)s=e.domNode=a.createTextNode(e.text),void 0!==r?t.insertBefore(s,r):t.appendChild(s);else{for(let l=0;l<=n.length;++l){let c=n.charAt(l);if(l===n.length||"."===c||"#"===c){let c=n.charAt(o-1),h=n.slice(o,l);"."===c?s.classList.add(h):"#"===c?s.id=h:("svg"===h&&(i=gw(i,{namespace:pw})),void 0!==i.namespace?s=e.domNode=a.createElementNS(i.namespace,h):(s=e.domNode=e.domNode||a.createElement(h),"input"===h&&e.properties&&void 0!==e.properties.type&&s.setAttribute("type",e.properties.type)),void 0!==r?t.insertBefore(s,r):s.parentNode!==t&&t.appendChild(s)),o=l+1}}Tw(s,e,i)}},Mw=(e,t,r)=>{t&&t.split(" ").forEach((t=>{t&&e.classList.toggle(t,r)}))};yw=(e,t,r)=>{let i=e.domNode,s=!1;if(e===t)return!1;let o=!1;if(""===t.vnodeSelector){if(t.text!==e.text){let e=i.ownerDocument.createTextNode(t.text);return i.parentNode.replaceChild(e,i),t.domNode=e,s=!0,s}t.domNode=i}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(r=gw(r,{namespace:pw})),e.text!==t.text&&(o=!0,void 0===t.text?i.removeChild(i.firstChild):i.textContent=t.text),t.domNode=i,o=((e,t,r,i,s)=>{if(r===i)return!1;i=i||mw;let o,n=(r=r||mw).length,a=i.length,l=0,c=0,h=!1;for(;c<a;){let a=l<n?r[l]:void 0,u=i[c];if(void 0!==a&&vw(a,u))h=yw(a,u,s)||h,l++;else{let a=bw(r,u,l+1);if(a>=0){for(o=l;o<a;o++)Nw(r[o]),ww(r,o,e,"removed");h=yw(r[a],u,s)||h,l=a+1}else Pw(u,t,l<n?r[l].domNode:void 0,s),xw(u),ww(i,c,e,"added")}c++}if(n>l)for(o=l;o<n;o++)Nw(r[o]),ww(r,o,e,"removed");return h})(t,i,e.children,t.children,r)||o,o=((e,t,r,i)=>{if(!r)return;let s=!1,o=Object.keys(r),n=o.length;for(let a=0;a<n;a++){let n=o[a],l=r[n],c=t[n];if("class"===n)c!==l&&(Mw(e,c,!1),Mw(e,l,!0));else if("classes"===n){let t=e.classList,r=Object.keys(l),i=r.length;for(let e=0;e<i;e++){let i=r[e],o=!!l[i];o!==!!c[i]&&(s=!0,o?t.add(i):t.remove(i))}}else if("styles"===n){let t=Object.keys(l),r=t.length;for(let o=0;o<r;o++){let r=t[o],n=l[r];n!==c[r]&&(s=!0,n?(_w(n),i.styleApplyer(e,r,n)):i.styleApplyer(e,r,""))}}else if(l||"string"!=typeof c||(l=""),"value"===n){let t=e[n];t!==l&&(e["oninput-value"]?t===e["oninput-value"]:l!==c)&&(e[n]=l,e["oninput-value"]=void 0),l!==c&&(s=!0)}else if(l!==c){let t=typeof l;"function"===t&&i.eventHandlerInterceptor||(i.namespace===pw?"href"===n?e.setAttributeNS(fw,n,l):e.setAttribute(n,l):"string"===t?"innerHTML"===n?e[n]=Qb.sanitize(l):"role"===n&&""===l?e.removeAttribute(n):e.setAttribute(n,l):e[n]!==l&&(e[n]=l),s=!0)}}return s})(i,e.properties,t.properties,r)||o,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[i,r,t.vnodeSelector,t.properties,t.children]);return o&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(i,t.properties,e.properties),s};let Dw=(e,t)=>({getLastRender:()=>e,update:r=>{if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=e;e=r,yw(i,r,t)},domNode:e.domNode});const Lw={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{"-"===t.charAt(0)?e.style.setProperty(t,r):e.style[t]=r}};let Ew,Rw=e=>gw(Lw,e),jw=(e,t,r)=>(r=Rw(r),Pw(t,e,void 0,r),Dw(t,r)),Fw=(e,t,r)=>(r=Rw(r),Pw(t,e.parentNode,e,r),Dw(t,r)),Bw=(e,t,r)=>(r=Rw(r),t.domNode=e,Tw(e,t,r),Dw(t,r)),zw=(e,t,r)=>(r=Rw(r),Pw(t,e.parentNode,e,r),e.parentNode.removeChild(e),Dw(t,r));Ew=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let Uw=(e,t,r)=>{let i=function(i){r("domEvent",i);let s=t(),o=((e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r})(i.currentTarget,s.domNode);o.reverse();let n,a=((e,t)=>{let r=e;return t.forEach((e=>{r=r&&r.children?Ew(r.children,(t=>t.domNode===e)):void 0})),r})(s.getLastRender(),o);return e.scheduleRender(),a&&(n=a.properties[`on${i.type}`].apply(a.properties.bind||this,arguments)),r("domEventProcessed",i),n};return(e,t,r,s)=>i};const Gw=G.getLogger("esri.widgets.Widget");let qw=0;const Vw=(e=>{let t,r,i=Rw(void 0),s=i.performanceLogger,o=!0,n=!1,a=[],l=[],c=(e,r,o)=>{let n;i.eventHandlerInterceptor=Uw(t,(()=>n),s),n=e(r,o(),i),a.push(n),l.push(o)},h=()=>{if(r=void 0,o){o=!1,s("renderStart",void 0);for(let e=0;e<a.length;e++){let t=l[e]();s("rendered",void 0),a[e].update(t),s("patched",void 0)}s("renderDone",void 0),o=!0}};return t={renderNow:h,scheduleRender:()=>{r||n||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),n=!0},resume:()=>{n=!1,o=!0,t.scheduleRender()},append:(e,t)=>{c(jw,e,t)},insertBefore:(e,t)=>{c(Fw,e,t)},merge:(e,t)=>{c(Bw,e,t)},replace:(e,t)=>{c(zw,e,t)},detach:e=>{for(let t=0;t<l.length;t++)if(l[t]===e)return l.splice(t,1),a.splice(t,1)[0];throw new Error("renderFunction was not found")}},t})();let Hw=!1,$w=class extends(yg(Qo.EventedAccessor)){constructor(e,t){super(e,t),this._attached=!1,this._internalHandles=new dn,this._projector=Vw,this.domNode=null,this.iconClass="esri-icon-checkbox-unchecked",this.label=this.declaredClass.split(".").pop(),this.visible=!0,this._loadLocale=fo((async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const e=await ao(this._messageBundleProps.map((async({bundlePath:e,propertyName:t})=>{this[t]=await ng(e)})));for(const t of e)t.error&&Gw.error("widget-intl:locale-error",this.declaredClass,t.error)}await this.loadLocale()}));const r=getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")||"light";["light","dark"].includes(r)||Ve(Gw,"The following themes are deprecated: light-blue, dark-blue, light-green, dark-green, light-purple, dark-purple, light-red, and dark-red.",{version:"4.19",warnOnce:!0,see:"https://developers.arcgis.com/javascript/latest/styling/"});const i="esri-widget-uid-"+Or(),s=this.render.bind(this);let o=!1;this._trackingTarget=new Po((()=>this.scheduleRender()));const n=()=>{if(!o||this.destroyed)return null;const e=s();return e.properties?e.properties.key||(e.properties.key=i):e.properties={key:i},e};this.render=()=>{if(Hw)return n();let e;this._trackingTarget.clear(),Hw=!0;try{e=ns(this._trackingTarget,n)}finally{Hw=!1}return e},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then((()=>{o=!0,this._postInitialize()})))}normalizeCtorArgs(e,t){const r={...e};return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){return this._loadLocale().catch(eo)}async loadLocale(){}destroy(){this.destroyed||(this._trackingTarget.destroy(),this._trackingTarget=null,this.viewModel&&(this.viewModel.destroy(),this.viewModel=null),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null)}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return function(e){return"string"==typeof e?document.getElementById(e):e}(e)}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+qw++}set id(e){e&&this._set("id",e)}get renderable(){return this._resourcesFetch}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||this._projector.scheduleRender()}classes(...e){return Hb.apply(this,e)}own(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments)),this._internalHandles.add(e)}renderNow(){this._projector.renderNow()}_postInitialize(){var e;this.destroyed||(this.scheduleRender(),null!=(e=this._delegatedEventNames)&&e.length&&this._internalHandles.add(nw(this,"viewModel",((e,t)=>{t&&this._internalHandles.remove("delegated-events"),e&&this._internalHandles.add(this._delegatedEventNames.map((t=>e.on(t,(e=>{this.emit(t,e)})))),"delegated-events")}))),this.postInitialize(),this._internalHandles.add((0,i.f)((async()=>{await this._loadLocale().catch(eo),this.scheduleRender()}))),this._internalHandles.add(aw(this,"container",(async e=>{this.destroyed||this._attach(e)}))))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){e&&this._attached&&(this._projector.detach(this.render),e.parentNode&&e.parentNode.removeChild(e),this._attached=!1)}};Wi([Ee({value:null})],$w.prototype,"container",null),Wi([Ge("container")],$w.prototype,"castContainer",null),Wi([Ee({aliasOf:"container"})],$w.prototype,"domNode",void 0),Wi([Ee()],$w.prototype,"iconClass",void 0),Wi([Ee()],$w.prototype,"id",null),Wi([Ee()],$w.prototype,"label",void 0),Wi([Ee()],$w.prototype,"renderable",null),Wi([Ee()],$w.prototype,"viewModel",void 0),Wi([Ee()],$w.prototype,"visible",void 0),$w=Wi([St("esri.widgets.Widget")],$w);var Ww=$w;const Jw="esri-identity-form__group",Qw="esri-identity-form__label",Zw="esri-input",Yw="esri-button";let Kw=class extends Ww{constructor(e,t){super(e,t),this._usernameInputNode=null,this._passwordInputNode=null,this.messages=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:e,server:t,resource:r,signingIn:i,oAuthPrompt:s,messages:o}=this,n=Xb("div",{class:Jw},function(e,t,r={}){const{format:i={}}=r;return j(e,(e=>function(e,t,r){let i,s;const o=e.indexOf(":");if(-1===o?i=e.trim():(i=e.slice(0,o).trim(),s=e.slice(o+1).trim()),!i)return"";const n=y(i,t);if(null==n)return"";const a=r[s]||r[i];return a?function(e,t){switch(t.type){case"date":return Cp(e,t.intlOptions);case"number":return Np(e,t.intlOptions);default:return eg.warn("missing format descriptor for key {key}"),tg(e)}}(n,a):s?function(e,t){switch(t.toLowerCase()){case"dateformat":return Cp(e);case"numberformat":return Np(e);default:return eg.warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?Cp(e):/^numberformat/i.test(t)?Np(e):tg(e)}}(n,s):tg(n)}(e,t,i)))}(s?o.oAuthInfo:o.info,{server:/\.arcgis\.com/i.test(t)?"ArcGIS Online":t,resource:`(${r||o.lblItem})`})),a=s?null:Xb("div",{class:Jw},Xb("label",{class:Qw},o.lblUser,Xb("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:$b,"data-node-ref":"_usernameInputNode",class:Zw}))),l=s?null:Xb("div",{class:Jw},Xb("label",{class:Qw},o.lblPwd,Xb("input",{value:"",required:!0,type:"password",bind:this,afterCreate:$b,"data-node-ref":"_passwordInputNode",class:Zw}))),c=Xb("div",{class:this.classes(Jw,"esri-identity-form__footer")},Xb("input",{type:"submit",disabled:!!i,value:i?o.lblSigning:o.lblOk,class:Yw}),Xb("input",{type:"button",value:o.lblCancel,bind:this,onclick:this._cancel,class:this.classes(Yw,"esri-button--secondary")})),h=e?Xb("div",null,e.details&&e.details.httpStatus?o.invalidUser:o.noAuthService):null;return Xb("form",{class:"esri-identity-form",bind:this,onsubmit:this._submit},n,h,a,l,c)}_cancel(){this._set("signingIn",!1),this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(e){e.preventDefault(),this._set("signingIn",!0);const t=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit("submit",t)}};Wi([Ee(),Zb("esri/identity/t9n/identity")],Kw.prototype,"messages",void 0),Wi([Ee()],Kw.prototype,"signingIn",void 0),Wi([Ee()],Kw.prototype,"server",void 0),Wi([Ee()],Kw.prototype,"resource",void 0),Wi([Ee()],Kw.prototype,"error",void 0),Wi([Ee()],Kw.prototype,"oAuthPrompt",void 0),Kw=Wi([St("esri.identity.IdentityForm")],Kw);var Xw,ex=Kw,tx=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],rx=tx.join(","),ix="undefined"==typeof Element,sx=ix?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ox=!ix&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},nx=function e(t,r,i){for(var s=[],o=Array.from(t);o.length;){var n=o.shift();if("SLOT"===n.tagName){var a=n.assignedElements(),l=e(a.length?a:n.children,!0,i);i.flatten?s.push.apply(s,l):s.push({scope:n,candidates:l})}else{sx.call(n,rx)&&i.filter(n)&&(r||!t.includes(n))&&s.push(n);var c=n.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(n),h=!i.shadowRootFilter||i.shadowRootFilter(n);if(c&&h){var u=e(!0===c?n.children:c.children,!0,i);i.flatten?s.push.apply(s,u):s.push({scope:n,candidates:u})}else o.unshift.apply(o,n.children)}}return s},ax=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},lx=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},cx=function(e){return"INPUT"===e.tagName},hx=function(e){var t=e.getBoundingClientRect(),r=t.width,i=t.height;return 0===r&&0===i},ux=function(e,t){return!(t.disabled||function(e){return cx(e)&&"hidden"===e.type}(t)||function(e,t){var r=t.displayCheck,i=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var s=sx.call(e,"details>summary:first-of-type")?e.parentElement:e;if(sx.call(s,"details:not([open]) *"))return!0;var o=ox(e).host,n=(null==o?void 0:o.ownerDocument.contains(o))||e.ownerDocument.contains(e);if(r&&"full"!==r){if("non-zero-area"===r)return hx(e)}else{if("function"==typeof i){for(var a=e;e;){var l=e.parentElement,c=ox(e);if(l&&!l.shadowRoot&&!0===i(l))return hx(e);e=e.assignedSlot?e.assignedSlot:l||c===e.ownerDocument?l:c.host}e=a}if(n)return!e.getClientRects().length}return!1}(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var r=0;r<t.children.length;r++){var i=t.children.item(r);if("LEGEND"===i.tagName)return!!sx.call(t,"fieldset[disabled] *")||!i.contains(e)}return!0}t=t.parentElement}return!1}(t))},dx=function(e,t){return!(function(e){return function(e){return cx(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,r=e.form||ox(e),i=function(e){return r.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=i(window.CSS.escape(e.name));else try{t=i(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var s=function(e,t){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===t)return e[r]}(t,e.form);return!s||s===e}(e)}(t)||ax(t)<0||!ux(e,t))},px=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},fx=function e(t){var r=[],i=[];return t.forEach((function(t,s){var o=!!t.scope,n=o?t.scope:t,a=ax(n,o),l=o?e(t.candidates):n;0===a?o?r.push.apply(r,l):r.push(n):i.push({documentOrder:s,tabIndex:a,item:t,isScope:o,content:l})})),i.sort(lx).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(r)},yx=function(e,t){var r;return r=(t=t||{}).getShadowRoot?nx([e],t.includeContainer,{filter:dx.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:px}):function(e,t,r){var i=Array.prototype.slice.apply(e.querySelectorAll(rx));return t&&sx.call(e,rx)&&i.unshift(e),i.filter(r)}(e,t.includeContainer,dx.bind(null,t)),fx(r)},mx=tx.concat("iframe").join(","),gx=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==sx.call(e,mx)&&ux(t,e)};function vx(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}var bx,wx=(bx=[],{activateTrap:function(e){if(bx.length>0){var t=bx[bx.length-1];t!==e&&t.pause()}var r=bx.indexOf(e);-1===r||bx.splice(r,1),bx.push(e)},deactivateTrap:function(e){var t=bx.indexOf(e);-1!==t&&bx.splice(t,1),bx.length>0&&bx[bx.length-1].unpause()}}),xx=function(e){return setTimeout(e,0)},Sx=function(e,t){var r=-1;return e.every((function(e,i){return!t(e)||(r=i,!1)})),r},Cx=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return"function"==typeof e?e.apply(void 0,r):e};const Ix="esri-identity-modal__content";let Ax=class extends Ww{constructor(e,t){super(e,t),this.container=document.createElement("div"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch("open",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const e=this.id,{open:t,content:r,title:i,messages:s}=this,o=t&&!!r,n={"esri-identity-modal--open":o,"esri-identity-modal--closed":!o},a=Xb("button",{class:"esri-identity-modal__close-button","aria-label":s.close,title:s.close,bind:this,onclick:this._close},Xb("span",{"aria-hidden":"true",class:"esri-icon-close"})),l=`${e}_title`,c=`${e}_content`,h=i?Xb("h1",{id:l,class:"esri-identity-modal__title"},i):null,u=o?Xb("div",{bind:this,class:"esri-identity-modal__dialog",role:"dialog","aria-labelledby":l,"aria-describedby":c,afterCreate:this._createFocusTrap},a,h,this._renderContent(c)):null;return Xb("div",{tabIndex:-1,class:this.classes("esri-identity-modal",n)},u)}_destroyFocusTrap(){var e;null==(e=this._focusTrap)||e.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:e,open:t}=this;e&&(t?e.activate():e.deactivate())}_createFocusTrap(e){this._destroyFocusTrap();const t=requestAnimationFrame((()=>{var t,r,i,s,o,n,a,l,c,h,u,d,p,f,y,m,g;this._focusTrap=(t=e,r={initialFocus:"input",onDeactivate:this._close},s=document,o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_x(Object(r),!0).forEach((function(t){vx(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},r),n={containers:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1},a=function(e){return n.containers.some((function(t){return t.contains(e)}))},l=function(e){var t=o[e];if(!t)return null;var r=t;if("string"==typeof t&&!(r=s.querySelector(t)))throw new Error("`".concat(e,"` refers to no known node"));if("function"==typeof t&&!(r=t()))throw new Error("`".concat(e,"` did not return a node"));return r},c=function(){var e;if(null!==l("initialFocus"))e=l("initialFocus");else if(a(s.activeElement))e=s.activeElement;else{var t=n.tabbableGroups[0];e=t&&t.firstTabbableNode||l("fallbackFocus")}if(!e)throw new Error("Your focus-trap needs to have at least one focusable element");return e},h=function(){if(n.tabbableGroups=n.containers.map((function(e){var t=yx(e);if(t.length>0)return{container:e,firstTabbableNode:t[0],lastTabbableNode:t[t.length-1]}})).filter((function(e){return!!e})),n.tabbableGroups.length<=0&&!l("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},u=function e(t){t!==s.activeElement&&(t&&t.focus?(t.focus({preventScroll:!!o.preventScroll}),n.mostRecentlyFocusedNode=t,function(e){return e.tagName&&"input"===e.tagName.toLowerCase()&&"function"==typeof e.select}(t)&&t.select()):e(c()))},d=function(e){a(e.target)||(Cx(o.clickOutsideDeactivates,e)?i.deactivate({returnFocus:o.returnFocusOnDeactivate&&!gx(e.target)}):Cx(o.allowOutsideClick,e)||e.preventDefault())},p=function(e){var t=a(e.target);t||e.target instanceof Document?t&&(n.mostRecentlyFocusedNode=e.target):(e.stopImmediatePropagation(),u(n.mostRecentlyFocusedNode||c()))},f=function(e){if(!1!==o.escapeDeactivates&&function(e){return"Escape"===e.key||"Esc"===e.key||27===e.keyCode}(e))return e.preventDefault(),void i.deactivate();(function(e){return"Tab"===e.key||9===e.keyCode})(e)&&function(e){h();var t=null;if(n.tabbableGroups.length>0)if(Sx(n.tabbableGroups,(function(t){return t.container.contains(e.target)}))<0)t=e.shiftKey?n.tabbableGroups[n.tabbableGroups.length-1].lastTabbableNode:n.tabbableGroups[0].firstTabbableNode;else if(e.shiftKey){var r=Sx(n.tabbableGroups,(function(t){var r=t.firstTabbableNode;return e.target===r}));if(r>=0){var i=0===r?n.tabbableGroups.length-1:r-1;t=n.tabbableGroups[i].lastTabbableNode}}else{var s=Sx(n.tabbableGroups,(function(t){var r=t.lastTabbableNode;return e.target===r}));if(s>=0){var o=s===n.tabbableGroups.length-1?0:s+1;t=n.tabbableGroups[o].firstTabbableNode}}else t=l("fallbackFocus");t&&(e.preventDefault(),u(t))}(e)},y=function(e){Cx(o.clickOutsideDeactivates,e)||a(e.target)||Cx(o.allowOutsideClick,e)||(e.preventDefault(),e.stopImmediatePropagation())},m=function(){if(n.active)return wx.activateTrap(i),Xw=o.delayInitialFocus?xx((function(){u(c())})):u(c()),s.addEventListener("focusin",p,!0),s.addEventListener("mousedown",d,{capture:!0,passive:!1}),s.addEventListener("touchstart",d,{capture:!0,passive:!1}),s.addEventListener("click",y,{capture:!0,passive:!1}),s.addEventListener("keydown",f,{capture:!0,passive:!1}),i},g=function(){if(n.active)return s.removeEventListener("focusin",p,!0),s.removeEventListener("mousedown",d,!0),s.removeEventListener("touchstart",d,!0),s.removeEventListener("click",y,!0),s.removeEventListener("keydown",f,!0),i},(i={activate:function(e){if(n.active)return this;h(),n.active=!0,n.paused=!1,n.nodeFocusedBeforeActivation=s.activeElement;var t=e&&e.onActivate?e.onActivate:o.onActivate;return t&&t(),m(),this},deactivate:function(e){if(!n.active)return this;clearTimeout(Xw),g(),n.active=!1,n.paused=!1,wx.deactivateTrap(i);var t=e&&void 0!==e.onDeactivate?e.onDeactivate:o.onDeactivate;return t&&t(),(e&&void 0!==e.returnFocus?e.returnFocus:o.returnFocusOnDeactivate)&&xx((function(){var e;u((e=n.nodeFocusedBeforeActivation,l("setReturnFocus")||e))})),this},pause:function(){return n.paused||!n.active||(n.paused=!0,g()),this},unpause:function(){return n.paused&&n.active?(n.paused=!1,h(),m(),this):this},updateContainerElements:function(e){var t=[].concat(e).filter(Boolean);return n.containers=t.map((function(e){return"string"==typeof e?s.querySelector(e):e})),n.active&&h(),this}}).updateContainerElements(t),i),this._toggleFocusTrap()}));this.own(ye((()=>cancelAnimationFrame(t))))}_renderContent(e){const t=this.content;return"string"==typeof t?Xb("div",{class:Ix,id:e,innerHTML:t}):function(e){return e&&"function"==typeof e.render}(t)?Xb("div",{class:Ix,id:e},t.render()):t instanceof HTMLElement?Xb("div",{class:Ix,id:e,bind:t,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};Wi([Ee({readOnly:!0})],Ax.prototype,"container",void 0),Wi([Ee()],Ax.prototype,"content",void 0),Wi([Ee()],Ax.prototype,"open",void 0),Wi([Ee(),Zb("esri/t9n/common")],Ax.prototype,"messages",void 0),Wi([Ee({aliasOf:"messages.auth.signIn"})],Ax.prototype,"title",void 0),Ax=Wi([St("esri.identity.IdentityModal")],Ax);var kx=Ax;const Nx="esriJSAPIOAuth";class Ox{constructor(e,t){this.oAuthInfo=null,this.storage=null,this.appId=null,this.expires=null,this.ssl=null,this.token=null,this.userId=null,this.oAuthInfo=e,this.storage=t,this._init()}isValid(){let e=!1;if(this.oAuthInfo&&this.token&&this.userId){const t=Date.now();this.expires>t&&(this.expires-t)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(e=!0)}return e}save(){if(!this.storage)return;const e=this._load(),t=this.oAuthInfo;if(t&&t.authNamespace&&t.portalUrl){let r=e[t.authNamespace];r||(r=e[t.authNamespace]={}),r[t.portalUrl]={appId:this.appId=t.appId,expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem(Nx,JSON.stringify(e))}catch(e){console.log(e)}}}destroy(){const e=this._load(),t=this.oAuthInfo;if(t&&t.appId&&t.portalUrl&&this.token&&this.expires>Date.now()){const e=t.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",r=new FormData;if(r.append("f","json"),r.append("auth_token",this.token),r.append("client_id",t.appId),r.append("token_type_hint","access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(e,r);else{const t=new XMLHttpRequest;t.open("POST",e),t.send(r)}}if(t&&t.authNamespace&&t.portalUrl&&this.storage){const r=e[t.authNamespace];if(r){delete r[t.portalUrl];try{this.storage.setItem(Nx,JSON.stringify(e))}catch(e){console.log(e)}}}t&&(t._oAuthCred=null,this.oAuthInfo=null)}_init(){const e=this._load(),t=this.oAuthInfo;if(t&&t.authNamespace&&t.portalUrl){let r=e[t.authNamespace];r&&(r=r[t.portalUrl],r&&(this.appId=r.appId,this.expires=r.expires,this.ssl=r.ssl,this.token=r.token,this.userId=r.userId))}}_load(){let e={};if(this.storage){const t=this.storage.getItem(Nx);if(t)try{e=JSON.parse(t)}catch(e){console.log(e)}}return e}}var Tx;Ox.prototype.declaredClass="esri.identity.OAuthCredential";let Px=Tx=class extends Ac{constructor(e){super(e),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return Tx.fromJSON(this.toJSON())}};Wi([Ee({json:{write:!0}})],Px.prototype,"appId",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"authNamespace",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"expiration",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"forceLogin",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"forceUserId",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"locale",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"minTimeUntilExpiration",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"popup",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"popupCallbackUrl",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"popupWindowFeatures",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"portalUrl",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"preserveUrlHash",void 0),Wi([Ee({json:{write:!0}})],Px.prototype,"userId",void 0),Px=Tx=Wi([St("esri.identity.OAuthInfo")],Px);var Mx=Px;let Dx=class extends Ac{constructor(e){super(e),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};Wi([Ee({json:{write:!0}})],Dx.prototype,"adminTokenServiceUrl",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"currentVersion",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"hasPortal",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"hasServer",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"owningSystemUrl",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"owningTenant",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"server",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"shortLivedTokenValidity",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"tokenServiceUrl",void 0),Wi([Ee({json:{write:!0}})],Dx.prototype,"webTierAuth",void 0),Dx=Wi([St("esri.identity.ServerInfo")],Dx);var Lx=Dx;const Ex={},Rx=e=>{const t=new Ft(e.owningSystemUrl).host,r=new Ft(e.server).host,i=/.+\.arcgis\.com$/i;return i.test(t)&&i.test(r)},jx=(e,t)=>!!(Rx(e)&&t&&t.some((t=>t.test(e.server))));let Fx=null,Bx=null;try{Fx=window.localStorage,Bx=window.sessionStorage}catch{}let zx=class extends Qo{constructor(){super(),this._portalConfig=i.e.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this.defaultOAuthInfo=null,this.defaultTokenValidity=60,this.dialog=null,this.formConstructor=ex,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appUrlObj=Gt(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthHash=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\/users\/([^\/]+)\/?.*/i,this._gwItem=/http.+\/items\/([^\/]+)\/?.*/i,this._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthHash(),window.addEventListener("pageshow",(e=>{this._pageShowHandler(e)}))}registerServers(e){const t=this.serverInfos;t?(e=e.filter((e=>!this.findServerInfo(e.server))),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach((e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)}))}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const r of e){const e=this.findOAuthInfo(r.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),r=this._isServerRsrc(t);let i,s=this.findServerInfo(t),o=!0;s||(s=new Lx,s.server=this._getServerInstanceRoot(t),r?s.hasServer=!0:(s.tokenServiceUrl=this._getTokenSvcUrl(t),s.hasPortal=!0),this.registerServers([s])),i=this._findCredential(t),i?(delete e.server,Object.assign(i,e),o=!1):(i=new Ux({userId:e.userId,server:s.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:r?"server":"portal"}),i.resources=[t],this.credentials.push(i)),i.emitTokenChange(!1),o||i.refreshServerTokens()}toJSON(){return u({serverInfos:this.serverInfos.map((e=>e.toJSON())),oAuthInfos:this.oAuthInfos.map((e=>e.toJSON())),credentials:this.credentials.map((e=>e.toJSON()))})}initialize(e){if(!e)return;"string"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,r=e.oAuthInfos,i=e.credentials;if(t){const e=[];t.forEach((t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new Lx(t))})),e.length&&this.registerServers(e)}if(r){const e=[];r.forEach((t=>{t.appId&&e.push(t.declaredClass?t:new Mx(t))})),e.length&&this.registerOAuthInfos(e)}i&&i.forEach((e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new Ux(e)).emitTokenChange(),this.credentials.push(e))}))}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const r of this.serverInfos)if(this._hasSameServerInstance(r.server,e)){t=r;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const r of this.oAuthInfos)if(this._hasSameServerInstance(r.portalUrl,e)){t=r;break}return t}findCredential(e,t){let r;e=this._sanitizeUrl(e);const i=this._isServerRsrc(e)?"server":"portal";if(t){for(const s of this.credentials)if(this._hasSameServerInstance(s.server,e)&&t===s.userId&&s.scope===i){r=s;break}}else for(const t of this.credentials)if(this._hasSameServerInstance(t.server,e)&&-1!==this._getIdenticalSvcIdx(e,t)&&t.scope===i){r=t;break}return r}getCredential(e,t){let r,i,s=!0;t&&(r=!!t.token,i=t.error,s=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=Qs(),n=yo();if(t.signal&&to(t.signal,(()=>{o.abort()})),to(o,(()=>{n.reject(new At("identity-manager:user-aborted","ABORTED"))})),Ks(o))return n.promise;t.signal=o.signal;const a=this._isAdminResource(e),l=r?this.findCredential(e):null;let c;if(l&&i&&i.details&&498===i.details.httpStatus)l.destroy();else if(l)return c=new At("identity-manager:not-authorized","You are currently signed in as: '"+l.userId+"'. You do not have access to this resource: "+e,{error:i}),n.reject(c),n.promise;const h=this._findCredential(e,t);if(h)return n.resolve(h),n.promise;let u=this.findServerInfo(e);if(u)!u.hasServer&&this._isServerRsrc(e)&&(u._restInfoPms=this._getTokenSvcUrl(e),u.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return c=new At("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),n.reject(c),n.promise;u=new Lx,u.server=this._getServerInstanceRoot(e),"string"==typeof t?(u.tokenServiceUrl=t,u.hasPortal=!0):(u._restInfoPms=t,u.hasServer=!0),this.registerServers([u])}return u.hasPortal&&void 0===u._selfReq&&(s||Xt(u.tokenServiceUrl,window.location.origin)||this._gwDomains.some((e=>e.tokenServiceUrl===u.tokenServiceUrl)))&&(u._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(u.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),e)}),this._enqueue(e,u,t,n,a)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(e)&&e.replace(this._gwUser,"$1")||this._gwItem.test(e)&&e.replace(this._gwItem,"$1")||this._gwGroup.test(e)&&e.replace(this._gwGroup,"$1")||""}generateToken(e,t,r){const i=this._rePortalTokenSvc.test(e.tokenServiceUrl),s=new Ft(window.location.href.toLowerCase()),o=e.shortLivedTokenValidity;let n,a,l,c,h,u,d,p;t&&(p=this.tokenValidity||o||this.defaultTokenValidity,p>o&&o>0&&(p=o)),r&&(n=r.isAdmin,a=r.serverUrl,l=r.token,u=r.signal,d=r.ssl,e.customParameters=r.customParameters),n?c=e.adminTokenServiceUrl:(c=e.tokenServiceUrl,h=new Ft(c.toLowerCase()),e.webTierAuth&&r&&r.serverUrl&&!d&&"http"===s.scheme&&(Xt(s.uri,c,!0)||"https"===h.scheme&&s.host===h.host&&"7080"===s.port&&"7443"===h.port)&&(c=c.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));const f={query:{request:"getToken",username:null==t?void 0:t.username,password:null==t?void 0:t.password,serverUrl:a,token:l,expiration:p,referer:n||i?window.location.host:null,client:n?"referer":null,f:"json",...e.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(e,r),signal:u,...null==r?void 0:r.ioArgs};return i||(f.withCredentials=!1),En(c,f).then((r=>{const i=r.data;if(!i||!i.token)return new At("identity-manager:authentication-failed","Unable to generate token");const s=e.server;return Ex[s]||(Ex[s]={}),t&&(Ex[s][t.username]=t.password),i.validity=p,i}))}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,"").then((e=>e.credential))}checkAppAccess(e,t,r){let i=!1;return this.getCredential(e,{prompt:!1}).then((s=>{let o;const n={f:"json"};if("portal"===s.scope)if(t&&(this._doPortalSignIn(e)||r&&r.force))o=s.server+"/sharing/rest/oauth2/validateAppAccess",n.client_id=t;else{if(!s.token)return{credential:s};o=s.server+"/sharing/rest"}else{if(!s.token)return{credential:s};o=s.server+"/rest/services"}return s.token&&(n.token=s.token),En(o,{query:n,authMode:"anonymous"}).then((e=>{if(!1===e.data.valid)throw new At("identity-manager:not-authorized",`You are currently signed in as: '${s.userId}'.`,e.data);return i=!!e.data.viewOnlyUserTypeApp,{credential:s}})).catch((e=>{if("identity-manager:not-authorized"===e.name)throw e;const t=e.details&&e.details.httpStatus;if(498===t)throw s.destroy(),new At("identity-manager:not-authenticated","User is not signed in.");if(400===t)throw new At("identity-manager:invalid-request");return{credential:s}}))})).then((e=>({credential:e.credential,viewOnly:i})))}setOAuthResponseHash(e){var t;const r=this._oAuthDfd;if(this._oAuthDfd=null,!r||!e)return;clearInterval(this._oAuthIntervalId),null==(t=this._oAuthOnHashHandle)||t.remove(),"#"===e.charAt(0)&&(e=e.substring(1));const i=qt(e);if(i.error){const e="access_denied"===i.error,t=new At(e?"identity-manager:user-aborted":"identity-manager:authentication-failed",e?"ABORTED":"OAuth: "+i.error+" - "+i.error_description);r.reject(t)}else{const e=r.sinfo_,t=r.oinfo_,s=t._oAuthCred,o=new Ux({userId:i.username,server:e.server,token:i.access_token,expires:Date.now()+1e3*Number(i.expires_in),ssl:"true"===i.ssl,_oAuthCred:s});t.userId=o.userId,s.storage=i.persist?Fx:Bx,s.token=o.token,s.expires=o.expires,s.userId=o.userId,s.ssl=o.ssl,s.save(),r.resolve(o)}}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,r={}){const i=yo(),s=()=>{var e,t,r,i,s;null==(e=a)||e.remove(),null==(t=l)||t.remove(),null==(r=c)||r.remove(),null==(i=n)||i.destroy(),null==(s=this.dialog)||s.destroy(),this.dialog=n=a=l=c=null},o=()=>{s(),this._oAuthDfd=null,i.reject(new At("identity-manager:user-aborted","ABORTED"))};r.signal&&to(r.signal,(()=>{o()}));let n=new this.formConstructor;n.resource=this.getResourceName(e),n.server=t.server,this.dialog=new kx,this.dialog.content=n,this.dialog.open=!0,this.emit("dialog-create");let a=n.on("cancel",o),l=this.dialog.watch("open",o),c=n.on("submit",(e=>{this.generateToken(t,e,{isAdmin:r.isAdmin,signal:r.signal}).then((o=>{s();const n=new Ux({userId:e.username,server:t.server,token:o.token,expires:null!=o.expires?Number(o.expires):null,ssl:!!o.ssl,isAdmin:r.isAdmin,validity:o.validity});i.resolve(n)})).catch((e=>{n.error=e,n.signingIn=!1}))}));return i.promise}oAuthSignIn(e,t,r,i){this._oAuthDfd=yo();const s=this._oAuthDfd;null!=i&&i.signal&&to(i.signal,(()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&a()})),s.resUrl_=e,s.sinfo_=t,s.oinfo_=r;const o=!i||!1!==i.oAuthPopupConfirmation;if(!r.popup||!o)return this._doOAuthSignIn(e,t,r),s.promise;const n=new this.formConstructor;n.oAuthPrompt=!0,n.server=t.server,this.dialog=new kx,this.dialog.content=n,this.dialog.open=!0,this.emit("dialog-create");const a=()=>{u(),this._oAuthDfd=null,s.reject(new At("identity-manager:user-aborted","ABORTED"))},l=n.on("cancel",a),c=this.dialog.watch("open",a),h=n.on("submit",(()=>{u(),this._doOAuthSignIn(e,t,r)})),u=()=>{l.remove(),c.remove(),h.remove(),n.destroy(),this.dialog.destroy(),this.dialog=null};return s.promise}destroyCredentials(){this.credentials&&this.credentials.slice().forEach((e=>{e.destroy()})),this.emit("credentials-destroy")}enablePostMessageAuth(e="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=Oi(window,"message",(t=>{var r;if((t.origin===window.location.origin||t.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===(null==(r=t.data)?void 0:r.type)){const r=t.source;this.getCredential(e).then((e=>{r.postMessage({type:"arcgis:auth:credential",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)})).catch((e=>{r.postMessage({type:"arcgis:auth:error",error:{name:e.name,message:e.message}},t.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthHash(){let e=window.location.hash;if(e){"#"===e.charAt(0)&&(e=e.substring(1));const t=qt(e);let r=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty("username"))try{t.state=JSON.parse(t.state),"object"==typeof t.state&&t.state.portalUrl&&(this._oAuthHash=t,r=!0)}catch{}else t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(r=!0));r&&(window.location.hash="object"==typeof t.state&&t.state.hash||"")}}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new At("identity-manager:user-aborted","ABORTED");this._errbackFunc(e)}}_findCredential(e,t){let r,i,s,o,n=-1;const a=t&&t.token,l=t&&t.resource,c=this._isServerRsrc(e)?"server":"portal",h=this.credentials.filter((t=>this._hasSameServerInstance(t.server,e)&&t.scope===c));if(e=l||e,h.length)if(1===h.length){if(r=h[0],o=this.findServerInfo(r.server),i=o&&o.owningSystemUrl,s=i&&this.findCredential(i,r.userId),n=this._getIdenticalSvcIdx(e,r),!a)return-1===n&&r.resources.push(e),this._addResource(e,s),r;-1!==n&&(r.resources.splice(n,1),this._removeResource(e,s))}else{let t,r;if(h.some((a=>(r=this._getIdenticalSvcIdx(e,a),-1!==r&&(t=a,o=this.findServerInfo(t.server),i=o&&o.owningSystemUrl,s=i&&this.findCredential(i,t.userId),n=r,!0)))),a)t&&(t.resources.splice(n,1),this._removeResource(e,s));else if(t)return this._addResource(e,s),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const r of this.oAuthInfos)if(this._isIdProvider(r.portalUrl,e)){t=r;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let r=-1;t&&(r=this._getIdenticalSvcIdx(e,t),r>-1&&t.resources.splice(r,1))}_useProxy(e,t){return t&&t.isAdmin&&!Xt(e.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(e.tokenServiceUrl)&&"10.1"===String(e.currentVersion)&&!Xt(e.tokenServiceUrl,window.location.href)}_getOrigin(e){const t=new Ft(e);return t.scheme+"://"+t.host+(null!=t.port?":"+t.port:"")}_getServerInstanceRoot(e){const t=e.toLowerCase();let r=t.indexOf(this._agsRest);return-1===r&&this._isAdminResource(e)&&(r=this._agsAdmin.test(e)?e.replace(this._agsAdmin,"$1").length:e.search(this._adminSvcs)),-1===r&&(r=t.indexOf("/sharing")),-1===r&&"/"===t.substr(-1)&&(r=t.length-1),r>-1?e.substring(0,r):e}_hasSameServerInstance(e,t){return"/"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(":")))===t.substr(t.indexOf(":"))}_normalizeAGOLorgDomain(e){const t=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return t.test(e)?e=e.replace(t,"https://www.arcgis.com"):r.test(e)?e=e.replace(r,"https://devext.arcgis.com"):i.test(e)&&(e=e.replace(i,"https://qaext.arcgis.com")),e}_sanitizeUrl(e){const t=(_.request.proxyUrl||"").toLowerCase(),r=t?e.toLowerCase().indexOf(t+"?"):-1;return-1!==r&&(e=e.substring(r+t.length+1)),Gt(e=sr(e)).path}_isRESTService(e){return e.indexOf(this._agsRest)>-1}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let r;if(this._isRESTService(e)&&this._isRESTService(t)){const i=this._getSuffix(e).toLowerCase(),s=this._getSuffix(t).toLowerCase();if(r=i===s,!r){const e=/(.*)\/(MapServer|FeatureServer).*/gi;r=i.replace(e,"$1")===s.replace(e,"$1")}}else this._isAdminResource(e)&&this._isAdminResource(t)?r=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(r=!0);return r}_isPortalDomain(e){const t=new Ft(e.toLowerCase()),r=this._portalConfig;let i=this._gwDomains.some((e=>e.regex.test(t.uri)));return!i&&r&&(i=this._hasSameServerInstance(this._getServerInstanceRoot(r.restBaseUrl),t.uri)),i||_.portalUrl&&(i=Xt(t,_.portalUrl,!0)),i||(i=this._portals.some((e=>this._hasSameServerInstance(e,t.uri)))),i=i||this._agsPortal.test(t.path),i}_isIdProvider(e,t){let r=-1,i=-1;this._gwDomains.forEach(((s,o)=>{-1===r&&s.regex.test(e)&&(r=o),-1===i&&s.regex.test(t)&&(i=o)}));let s=!1;if(r>-1&&i>-1&&(0===r||4===r?0!==i&&4!==i||(s=!0):1===r?1!==i&&2!==i||(s=!0):2===r?2===i&&(s=!0):3===r&&3===i&&(s=!0)),!s){const r=this.findServerInfo(t),i=r&&r.owningSystemUrl;i&&Rx(r)&&this._isPortalDomain(i)&&this._isIdProvider(e,i)&&(s=!0)}return s}_getIdenticalSvcIdx(e,t){let r=-1;for(let i=0;i<t.resources.length;i++){const s=t.resources[i];if(this._isIdenticalService(e,s)){r=i;break}}return r}_getSuffix(e){return e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(e){let t,r,i;if(this._isRESTService(e)||this._isAdminResource(e)){const i=this._getServerInstanceRoot(e);return t=i+"/admin/generateToken",r=En(e=i+"/rest/info",{query:{f:"json"}}).then((e=>e.data)),{adminUrl:t,promise:r}}if(this._isPortalDomain(e)){let t="";if(this._gwDomains.some((r=>(r.regex.test(e)&&(t=r.tokenServiceUrl),!!t))),t||this._portals.some((r=>(this._hasSameServerInstance(r,e)&&(t=r+this._gwTokenUrl),!!t))),t||(i=e.toLowerCase().indexOf("/sharing"),-1!==i&&(t=e.substring(0,i)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const r=new Ft(e).port;/^http:\/\//i.test(e)&&"7080"===r&&(t=t.replace(/:7080/i,":7443")),t=t.replace(/http:/i,"https:")}return t}if(-1!==e.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"}_exchangeToken(e,t,r){return En(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:t,token:r}}).then((e=>e.data.token))}_getPlatformSelf(e,t){return En(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json"},withCredentials:!0}).then((e=>e.data))}_getPortalSelf(e,t){let r;return this._gwDomains.some((t=>(t.regex.test(e)&&(r=t.customBaseUrl),!!r))),r?Promise.resolve({allSSL:!0,currentVersion:"4.4",customBaseUrl:r,portalMode:"multitenant",supportsOAuth:!0}):("https:"===window.location.protocol?e=e.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),En(e,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then((e=>e.data)))}_doPortalSignIn(e){const t=this._portalConfig,r=window.location.href,i=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(r)||!(i?i.hasPortal||i.owningSystemUrl&&this._isPortalDomain(i.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(r,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||Xt(r,e,!0)))}_checkProtocol(e,t,r,i){let s=!0;const o=i?t.adminTokenServiceUrl:t.tokenServiceUrl;return 0===o.trim().toLowerCase().indexOf("https:")&&0!==window.location.href.toLowerCase().indexOf("https:")&&Zt(o)&&(s=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!s)&&r(new At("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection.")),s}_enqueue(e,t,r,i,s,o){return i||(i=yo()),i.resUrl_=e,i.sinfo_=t,i.options_=r,i.admin_=s,i.refresh_=o,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(i)):this._xoReqs.push(i):this._doSignIn(i),i.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const r=e.options_&&e.options_.resource,i=e.resUrl_,s=e.refresh_;let o=!1;-1===this.credentials.indexOf(t)&&(s&&-1!==this.credentials.indexOf(s)?(s.userId=t.userId,s.token=t.token,s.expires=t.expires,s.validity=t.validity,s.ssl=t.ssl,s.creationTime=t.creationTime,o=!0,t=s):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.push(r||i),t.scope=this._isServerRsrc(i)?"server":"portal",t.emitTokenChange();const n=this._soReqs,a={};this._soReqs=[],n.forEach((e=>{if(!this._isIdenticalService(i,e.resUrl_)){const r=this._getSuffix(e.resUrl_);a[r]||(a[r]=!0,t.resources.push(e.resUrl_))}})),e.resolve(t),n.forEach((e=>{this._hasSameServerInstance(this._getServerInstanceRoot(i),e.resUrl_)?e.resolve(t):this._soReqs.push(e)})),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,o||this.emit("credential-create",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},r=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=(i,s,o,n)=>{var a,l;const c=e.sinfo_,h=!e.options_||!1!==e.options_.prompt,u=c.hasPortal&&this._findOAuthInfo(e.resUrl_);let d,p;if(i)t(new Ux({userId:i,server:c.server,token:o||null,expires:null!=n?Number(n):null,ssl:!!s}));else if(window!==window.parent&&null!=(a=this._appUrlObj.query)&&a["arcgis-auth-origin"]&&null!=(l=this._appUrlObj.query)&&l["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),e.resUrl_)){var f;window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const i=Oi(window,"message",(e=>{e.source===window.parent&&e.data&&("arcgis:auth:credential"===e.data.type?(i.remove(),t(new Ux(e.data.credential))):"arcgis:auth:error"===e.data.type&&(i.remove(),r(At.fromJSON(e.data.error))))}));to(null==(f=e.options_)?void 0:f.signal,(()=>{i.remove()}))}else if(u){let i=u._oAuthCred;if(!i){const e=new Ox(u,Fx),t=new Ox(u,Bx);e.isValid()&&t.isValid()?e.expires>t.expires?(i=e,t.destroy()):(i=t,e.destroy()):i=e.isValid()?e:t,u._oAuthCred=i}if(i.isValid())d=new Ux({userId:i.userId,server:c.server,token:i.token,expires:i.expires,ssl:i.ssl,_oAuthCred:i}),u.appId!==i.appId&&this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._exchangeToken(d.server,u.appId,d.token).then((e=>{d.token=e,i.token=e,i.save(),t(d)})).catch((()=>{t(d)})):t(d);else if(this._oAuthHash&&this._hasSameServerInstance(u.portalUrl,this._oAuthHash.state.portalUrl)){const e=this._oAuthHash;d=new Ux({userId:e.username,server:c.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:"true"===e.ssl,oAuthState:e.state,_oAuthCred:i}),u.userId=d.userId,i.storage=e.persist?Fx:Bx,i.token=d.token,i.expires=d.expires,i.userId=d.userId,i.ssl=d.ssl,i.save(),this._oAuthHash=null,t(d)}else{const i=()=>{h?e._pendingDfd=this.oAuthSignIn(e.resUrl_,c,u,e.options_).then(t,r):(p=new At("identity-manager:not-authenticated","User is not signed in."),r(p))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(c.server,u.appId).then((({portalUrl:e,token:r,username:s})=>{!e||Xt(e,window.location.origin,!0)?(d=new Ux({server:c.server,userId:s,token:r}),t(d)):i()})).catch(i):i()}}else if(h){if(this._checkProtocol(e.resUrl_,c,r,e.admin_)){let i=e.options_;e.admin_&&(i=i||{},i.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,c,i).then(t,r)}}else p=new At("identity-manager:not-authenticated","User is not signed in."),r(p)},s=()=>{const i=e.sinfo_,s=i.owningSystemUrl,o=e.options_;let n,a,l,c;if(o&&(n=o.token,a=o.error,l=o.prompt),c=this._findCredential(s,{token:n,resource:e.resUrl_}),!c)for(const e of this.credentials)if(this._isIdProvider(s,e.server)){c=e;break}if(c){const s=this.findCredential(e.resUrl_,c.userId);if(s)t(s);else if(jx(i,this._legacyFed)){const e=c.toJSON();e.server=i.server,e.resources=null,t(new Ux(e))}else(e._pendingDfd=this.generateToken(this.findServerInfo(c.server),null,{serverUrl:e.resUrl_,token:c.token,signal:e.options_.signal,ssl:c.ssl})).then((r=>{t(new Ux({userId:c.userId,server:i.server,token:r.token,expires:null!=r.expires?Number(r.expires):null,ssl:!!r.ssl,isAdmin:e.admin_,validity:r.validity}))}),r)}else this._busy=null,n&&(e.options_.token=null),(e._pendingDfd=this.getCredential(s.replace(/\/?$/,"/sharing"),{resource:e.resUrl_,owningTenant:i.owningTenant,signal:e.options_.signal,token:n,error:a,prompt:l})).then((()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)}),(e=>{r(e)}))};this._errbackFunc=r;const o=e.sinfo_.owningSystemUrl,n=this._isServerRsrc(e.resUrl_),a=e.sinfo_._restInfoPms;a?a.promise.then((t=>{const r=e.sinfo_;if(r._restInfoPms){r.adminTokenServiceUrl=r._restInfoPms.adminUrl,r._restInfoPms=null,r.tokenServiceUrl=y("authInfo.tokenServicesUrl",t)||y("authInfo.tokenServiceUrl",t)||y("tokenServiceUrl",t),r.shortLivedTokenValidity=y("authInfo.shortLivedTokenValidity",t),r.currentVersion=t.currentVersion,r.owningTenant=t.owningTenant;const e=r.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}n&&r.owningSystemUrl?s():i()}),(()=>{e.sinfo_._restInfoPms=null;const t=new At("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");r(t)})):n&&o?s():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then((t=>{const r={};let i,s,o,n;return t&&(i=t.user&&t.user.username,r.username=i,r.allSSL=t.allSSL,s=t.supportsOAuth,o=t.currentVersion,"multitenant"===t.portalMode&&(n=t.customBaseUrl)),e.sinfo_.webTierAuth=!!i,i&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:r.allSSL}).catch((()=>null)).then((e=>(r.portalToken=e&&e.token,r.tokenExpiration=e&&e.expires,r))):!i&&s&&parseFloat(o)>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:n,owningTenant:e.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>r)):r})).catch((()=>null)).then((t=>{e.sinfo_._selfReq=null,t?i(t.username,t.allSSL,t.portalToken,t.tokenExpiration):i()})):i()}_generateOAuthInfo(e){let t,r,i=e.portalUrl;const s=e.customBaseUrl,o=e.owningTenant,n=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(n){r=window.location.href;let e=r.indexOf("?");e>-1&&(r=r.slice(0,e)),e=r.search(/\/(apps|home)\//),r=e>-1?r.slice(0,e):null}return n&&r?(this._hasTestedIfAppIsOnPortal=!0,t=En(r+"/sharing/rest",{query:{f:"json"}}).then((()=>{this.defaultOAuthInfo=new Mx({appId:"arcgisonline",popupCallbackUrl:r+"/home/oauth-callback.html"})}))):t=Promise.resolve(),t.then((()=>{if(this.defaultOAuthInfo)return i=i.replace(/^http:/i,"https:"),En(i+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:o,client_id:this.defaultOAuthInfo.appId,redirect_uri:rr(this.defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then((e=>{if(e.data.valid){const t=this.defaultOAuthInfo.clone();e.data.urlKey&&s?t.portalUrl="https://"+e.data.urlKey.toLowerCase()+"."+s:t.portalUrl=i,t.popup=window!==window.top||!(Xt(i,window.location.origin)||this._gwDomains.some((e=>e.regex.test(i)&&e.regex.test(window.location.origin)))),this.oAuthInfos.push(t)}}))}))}_doOAuthSignIn(e,t,r){const s={portalUrl:r.portalUrl};!r.popup&&r.preserveUrlHash&&window.location.hash&&(s.hash=window.location.hash);const o={client_id:r.appId,response_type:"token",state:JSON.stringify(s),expiration:r.expiration,locale:r.locale,redirect_uri:r.popup?rr(r.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};r.forceLogin&&(o.force_login=!0),r.forceUserId&&r.userId&&(o.prepopulatedusername=r.userId),!r.popup&&this._doPortalSignIn(e)&&(o.redirectToUserOrgUrl=!0);const n=r.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",a=n+"?"+Ht(o);if(r.popup){const e=window.open(a,"esriJSAPIOAuth",r.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval((()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnHashHandle.remove();const e=this._oAuthDfd;if(e){const t=new At("identity-manager:user-aborted","ABORTED");e.reject(t)}}}),500),this._oAuthOnHashHandle=Oi(i.e,"arcgis:auth:hash",(e=>{this.setOAuthResponseHash(e.detail)}));else{const e=new At("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:n,resourceUrl:e,serverInfo:t,oAuthInfo:r}):window.location.href=a}};zx=Wi([St("esri.identity.IdentityManagerBase")],zx);let Ux=class extends Qo.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=Tn.findServerInfo(this.server),t=e&&e.owningSystemUrl,r=!!t&&"server"===this.scope,i=r&&jx(e,Tn._legacyFed),s=e.webTierAuth,o=s&&Tn.normalizeWebTierAuth,n=Ex[this.server],a=n&&n[this.userId];let l,c=this.resources&&this.resources[0],h=r&&Tn.findServerInfo(t),u={username:this.userId,password:a};if(s&&!o)return;r&&!h&&Tn.serverInfos.some((e=>(Tn._isIdProvider(t,e.server)&&(h=e),!!h)));const d=h&&Tn.findCredential(h.server,this.userId);if(!r||d){if(!i){if(r)l={serverUrl:c,token:d&&d.token,ssl:d&&d.ssl};else if(o)u=null,l={ssl:this.ssl};else{if(!a){let t;return c&&(c=Tn._sanitizeUrl(c),this._enqueued=1,t=Tn._enqueue(c,e,null,null,this.isAdmin,this),t.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),t}this.isAdmin&&(l={isAdmin:!0})}return Tn.generateToken(r?h:e,r?null:u,l).then((e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}d.refreshToken()}}refreshServerTokens(){"portal"===this.scope&&Tn.credentials.forEach((e=>{const t=Tn.findServerInfo(e.server),r=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&r&&"server"===e.scope&&(Tn._hasSameServerInstance(this.server,r)||Tn._isIdProvider(r,this.server))&&(jx(t,Tn._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=this.server&&Tn.findServerInfo(this.server),r=t&&t.owningSystemUrl,i=r&&Tn.findServerInfo(r);!1===e||r&&"portal"!==this.scope&&(!i||!i.webTierAuth||Tn.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=Tn.credentials.indexOf(this);e>-1&&Tn.credentials.splice(e,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){const e=u({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let r=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();r<0?r=0:r>t&&(r=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),r>e?r-e:r)}};Wi([Ee()],Ux.prototype,"creationTime",void 0),Wi([Ee()],Ux.prototype,"expires",void 0),Wi([Ee()],Ux.prototype,"isAdmin",void 0),Wi([Ee()],Ux.prototype,"oAuthState",void 0),Wi([Ee()],Ux.prototype,"resources",void 0),Wi([Ee()],Ux.prototype,"scope",void 0),Wi([Ee()],Ux.prototype,"server",void 0),Wi([Ee()],Ux.prototype,"ssl",void 0),Wi([Ee()],Ux.prototype,"token",void 0),Wi([Ee()],Ux.prototype,"tokenRefreshBuffer",void 0),Wi([Ee()],Ux.prototype,"userId",void 0),Wi([Ee()],Ux.prototype,"validity",void 0),Ux=Wi([St("esri.identity.Credential")],Ux);let Gx=class extends zx{};Gx=Wi([St("esri.identity.IdentityManager")],Gx);const qx=new Gx;!function(e){Tn=e}(qx);const Vx=Object.freeze({__proto__:null,default:qx}),Hx="define"in window&&"function"==typeof window.define&&"amd"in window.define;function $x(e,t,r,s){const o=(0,i.c)();function n(e){let t;try{t=s(e)}catch(e){return void a(e)}o.resolve(t)}function a(e){o.reject(e)}try{const i=r?r():{};i.f=i.f||"json",async function(e){if(Hx){const t=await async function(){return async function(e){return new Promise((e=>window.require(["esri/identity/IdentityManager"],(t=>{e(t)}))))}()}();return await t.getCredential(e,{oAuthPopupConfirmation:!1})}return await qx.getCredential(e,{oAuthPopupConfirmation:!1})}(e.url).then((r=>{(null==r?void 0:r.token)&&(i.token=r.token),En(e.url+t,{query:i,responseType:"json"}).then(n,a)}))}catch(e){a(e)}return o.promise}function Wx(e){const t=e.extent;return new _h({x:(t.xmin+t.xmax)/2,y:(t.ymin+t.ymax)/2,spatialReference:t.spatialReference})}class Jx{constructor(e,t){if(e){const r=Gt(e);e=r.path,this._query=Sn({langCode:(0,i.b)()},r.query||{}),t&&(this._query.token=t)}this.url=e||"https://geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer",this.token=t}enrich(e){return $x(this,"/Geoenrichment/enrich",(()=>function(e,t){t=Object.assign({},t);for(const i in e)if("string"==typeof e[i])t[i]=e[i];else{const s=e[i];t[i]=JSON.stringify("function"==typeof(r=s).toJSON?r.toJSON():r)}var r;return t}(e instanceof B_?e.toJSON():new B_(e).toJSON(),this._query)),(e=>{const t=e.data;(!t.results||t.results.length<1||!t.results[0].value||!t.results[0].value.FeatureSet||t.results[0].value.FeatureSet.length<1)&&function(){throw new Error("Geoenrichment service returned empty response")}();const r={featureSets:[],messages:t.messages},i=t.results[0].value.FeatureSet;for(let e=0;e<i.length;e++)r.featureSets.push(new z_(i[e]));return r}))}getDataCollections(e,t,r,i){let s;return t?s="/GetDataCollections/execute":(s="/Geoenrichment/DataCollections",e&&(s+="/"+e)),$x(this,s,(()=>{const s=Object.assign({},this._query);return s.suppressNullValues=!0,r&&(0===r.length?s.outFields="none":s.outFields=JSON.stringify(r)),t&&(e&&(s.sourcecountry=e),s.searchtext="id:"+t),i&&(s.addDerivativeVariables=JSON.stringify(i)),s}),(e=>{const t=e.data;if(t.error)throw t.error;return t.results||t.dataCollections||t.DataCollections}))}getReports(e){return $x(this,"/Geoenrichment/Reports/"+e,(()=>Object.assign({},this._query)),(e=>e.data.reports))}getAvailableCountries(){return $x(this,"/Geoenrichment/Countries",(()=>Object.assign({},this._query)),(e=>{const t=e.data;if(t.error)throw t.error;return t.countries}))}getCountries(e){let t;switch(e.type){case"point":t=e;break;case"polyline":const r=e.paths[0],i=new Tu({spatialReference:e.spatialReference});i.addPath(r),t=Wx(i);break;case"polygon":const s=e.rings[0],o=new Nu({spatialReference:e.spatialReference});o.addRing(s),t=Wx(o)}return this.enrich(new B_({analysisVariables:["GlobalIntersect.*"],studyAreas:[{geometry:t}],forStorage:!1})).then((e=>{const t=[],r=e.featureSets[0].features;for(let e=0;e<r.length;e++){const i=r[e].attributes.sourceCountry;t.indexOf(i)<0&&t.push(i)}if(0===t.length)throw new Error("There is no data for the selected area.");return t}))}getDataLayerInfos(e){return $x(this,"/Geoenrichment/DataLayers"+e,(()=>Object.assign({},this._query)),(e=>e.data.layers))}getDataLayerInfo(e,t){return $x(this,"/Geoenrichment/DataLayers"+e+"/"+t,(()=>Object.assign({},this._query)),(e=>e.data.layer))}}const Qx="n_",Zx={n_:"",p_:" (%)",a_:" (avg)",i_:" (index)"},Yx={n_p_:{labels:["#","%"],names:["n_","p_"],ids:null},n_a_:{labels:["#","Avg"],names:["n_","a_"],ids:null},n_i_:{labels:["#","Index"],names:["n_","i_"],ids:null},n_p_i_:{labels:["#","%","Index"],names:["n_","p_","i_"],ids:null},n_a_i_:{labels:["#","Avg","Index"],names:["n_","a_","i_"],ids:null}};class Kx{setCache(e){this._variables=e}get(e){if(!e)return null;const t=this._parseId(e);let r=this._variables[t.id];return r&&t.state!==Qx&&(r={fullName:e,alias:r.alias+Zx[t.state],description:r.description+Zx[t.state]}),r}getStates(e){e=e&&this._parseId(e).id;const t=this._variables[e];if(!t)return null;let r=Qx;t.percentBase&&(r+="p_"),t.averageBase&&(r+="a_"),Number(t.indexBase)&&(r+="i_");let i=Yx[r];return i&&(i=Object.assign({},i),i.ids=i.names.map((t=>t+e))),i||null}_parseId(e){const t=e.substr(0,2);return Zx.hasOwnProperty(t)?{id:e.substr(2),state:t}:{id:e,state:Qx}}}class Xx{constructor(e,t){this.isKeywordFilter=!0,this.searchString="",this.delimiters=/[\s;,\/?:@&=\$#'%"`~!^\(\)\[\]\{\}\\*|\u0000-\u001f\u007f-\u009f\u2000-\u2bff\ud800-\uffff]+/,this.totalCount=0,this.bitIndex=0,this.matchCount=0,this.update(e),this.searchFields=t?"string"==typeof t?[t]:t:["alias","description","fieldCategory"]}update(e){this.searchString=e&&e.trim()||"",this._keywords=this.searchString&&"*"!==this.searchString?this.searchString.toLowerCase().split(this.delimiters):null}isActive(){return!!this._keywords}match(e){return!this._keywords||this.searchFields.some((t=>this._matchField(e[t])))}_matchField(e){return!!e&&(e=e.toLowerCase(),this._keywords.every((t=>e.indexOf(t)>=0)))}}class eS{constructor(e){this.displayAllGlobalVariables=!1,this.idProperty="fullName",this.queryEngine=Yl(),this.derivativeVariables=!1,Sn(this,e),this.categories=new uc({syncQuery:this._queryCategories.bind(this)}),this.dataCollections=new uc({syncQuery:this._queryDataCollections.bind(this)}),!0===this.derivativeVariables&&(this.derivativeVariables=new Kx)}_queryCategories(e,t){let r;if((e=this._cleanUpCountryID(e))&&e.dataCollectionID){const t=this.dataCollections.get(e.dataCollectionID);delete e.dataCollectionID,r=t?t.categories:[]}else r=this.categories.data;return this.categories.queryEngine(e,t)(r)}_queryDataCollections(e,t){let r;if("object"==typeof(e=this._cleanUpCountryID(e))&&e.categoryID){const t=this.categories.get(e.categoryID);delete e.categoryID,r=t?t.dataCollections:[]}else r=this.dataCollections.data;return this.dataCollections.queryEngine(e,t)(r)}_cleanUpCountryID(e){return e&&delete(e=Object.assign({},e)).countryID,e}_clearAllStores(){this._data=[],this._variables={},this.derivativeVariables&&this.derivativeVariables.setCache(this._variables),this.categories.setData(),this.dataCollections.setData()}synchronize(e){return Promise.resolve()}get(e){return this.derivativeVariables?this.derivativeVariables.get(e):this._variables[e]||null}getIdentity(e){return e&&e[this.idProperty]||null}getLabel(e){return e.alias}query(e,t){return this._asyncQuery(e,t)}_asyncQuery(e,t,r){return uc.resolveCallback(r&&r.resolver||this.categories.resolver,e,(()=>this._syncQuery(e,t,r)))}_syncQuery(e,t,r){const i={},s=[r&&r.queryFilter||this.queryFilter.bind(this)];let o;if("function"==typeof e)s.push(e);else{let t;e=e||{};for(const n in e)switch(n){case"countryID":break;case"categoryID":case"dataCollectionID":i[n]=e[n];break;case"searchString":const a=new Xx(e[n]);s.push((e=>a.match(e)));break;case"favorites":if(e[n]){const e=r&&r.favorites||this.favorites;s.push((t=>e&&e.contains&&e.contains(this.getIdentity(t))))}break;case"filters":const l=this._prepareFilterHash(e[n]);l&&s.push((e=>{for(const t in e.filteringTags)if(l[t]||l["*"])return!0;return!1}));break;case"additionalData":o=e[n];break;default:t=t||{},t[n]=e[n]}t&&s.push((e=>{for(const r in t){const i=t[r];if(i&&"object"==typeof i&&"test"in i){if(!i.test(e[r],e))return!1}else if(i!==e[r])return!1}return!0}))}const n=this._composeQuery(s);return i.dataCollectionID?this._queryDCVariables(i.dataCollectionID,n,t,o):i.categoryID?this._queryCategoryVariables(i.categoryID,n,t,o):this._queryAllVariables(n,t,o)}_queryDCVariables(e,t,r,i){let s=this.dataCollections.get(e);return!s&&i&&(s=i.getDataCollection(e)),s&&this._query(s.getVisibleVariables(),t,r)||[]}_queryCategoryVariables(e,t,r,i){let s=this.categories.get(e);return!s&&i&&(s=i.getCategory(e)),s&&this._query(s.data,t,r)||[]}_queryAllVariables(e,t,r){return this._query(this._data,e,t,r&&r.getVariables())}_composeQuery(e){return 1===e.length?e[0]:t=>e.every((e=>e(t)))}queryFilter(e){return!e.missedInCategories}_query(e,t,r,i){const s=e.length;this._addAdditionalData(e,i);const o=this.queryEngine(t,r)(e);return e.length=s,o}_addAdditionalData(e,t){t&&t.forEach((t=>{Array.isArray(t)?this._addAdditionalData(e,t):t&&e.push(t)}))}getPopularVariables(e,t,r){return e&&e.getPopularVariables?e.getPopularVariables(t,r):[]}getRefineFilters(e){let t={};if(e.dataCollectionID){let r=this.dataCollections.get(e.dataCollectionID);!r&&e.additionalData&&(r=e.additionalData.getDataCollection(e.dataCollectionID)),r&&r.filters&&this._combineFilters(r.filters,t)}else if(e.categoryID){let r=this.categories.get(e.categoryID);!r&&e.additionalData&&(r=e.additionalData.getCategory(e.categoryID)),r&&this._collectCategoryFilters(r,t)}else this._collectAllFilters(t,e.additionalData);const r=this._prepareFilterHash(e.filters);if(r&&!r["*"]){const e=t;t={};for(const i in e)r[i]&&(t[i]=e[i])}return t}_prepareFilterHash(e){if("string"==typeof e&&(e=e.split(",")),!e||!e.length)return null;const t={};return e.forEach((e=>{t[e.trim()]=!0})),t}_collectAllFilters(e,t){this.categories.data.forEach((t=>{this._collectCategoryFilters(t,e)})),t&&t.getCategories().forEach((t=>{this._collectCategoryFilters(t,e)}))}_collectCategoryFilters(e,t){e.dataCollections.forEach((e=>{this._combineFilters(e.filters,t)}))}_combineFilters(e,t){for(const r in e){const i=e[r];let s=t[i.id];s?this._mergeFilter(s,i):(s=Object.assign({},i),t[i.id]=s)}}_mergeFilter(e,t){if("Range"===e.type&&"Range"===t.type){let r=e.rangeMin,i=t.rangeMin;!isNaN(r)&&!isNaN(i)&&r>i&&(e.rangeMin=i),r=e.rangeMax,i=t.rangeMax,!isNaN(r)&&!isNaN(i)&&r<i&&(e.rangeMax=i)}else if("Enumeration"===e.type&&"Enumeration"===t.type){const r=this._arrayToObject(e.enumValues.split(","));t.enumValues.split(",").forEach((t=>{r[t]||(e.enumValues+=","+t)}))}}getStates(e){return this.derivativeVariables?this.derivativeVariables.getStates(e):null}_processDataCollections(e,t){t=t||{variables:{},categories:{},dataCollections:[]},e.forEach((e=>{if(this._isDataCollectionDisallowed(e))return;const r=e.data,i=e;i.id=e.dataCollectionID;const s=e.metadata;i.title=s.title,i.name=s.name,i.shortDescription=s.shortDescription,i.longDescription=s.longDescription,i.countries=s.countries,i.keywords=s.keywords,i.datasets=s.datasets,i.hierarchies=s.hierarchies,i.author=s.author,i.filters=this._arrayToObject(e.metadata.filters,"id",(e=>this._prepareFilter(e))),i.hasVariable=function(e){const t=e&&e.id;return!(!t||void 0===this.hash[t.toUpperCase()])},i.getVisibleVariables=function(){return this.data.filter((e=>this.hash[e.id.toUpperCase()]))},i.categories=[],e.metadata.categories.map((e=>{const r=this._prepareCategory(e,i,t);r&&i.categories.push(r)})),i.data=[],i.hash={},this._testOneYearIncrements(r),r.forEach((e=>{this._processVariable(e,i,t)})),t.dataCollections.push(i)}));const r=this.categories.queryEngine({},{sort:[{attribute:"displayOrder",descending:!0}]})(this._objectToArray(t.categories));return this.categories.setData(r),this.dataCollections.setData(t.dataCollections),t}_testOneYearIncrements(e){function t(e){const t=e.filteringTags;let r;for(let e=0,i=t?t.length:0;e<i;e++)if("Age"===t[e].id){r=t[e].value;break}return r}const r=e.length;let i=0;for(let s=0;s<r;s++){const r=t(e[s]);if(!r)continue;const o=r.split("-");if(2!==o.length||o[0]!==o[1])return;i++}if(!(i<50))for(let i=0;i<r;i++)t(e[i])&&(e[i].strictFilterTag="Age")}_prepareFilter(e){if("Range"===e.type){const t=e;return t.rangeMin=Number(e.rangeMin),t.rangeMin||(t.rangeMin=0),t.rangeMax=Number(e.rangeMax),t}return e.enumValues=this._trimArray(e.enumValues.split(",")).join(","),e}_prepareCategory(e,t,r){const i=Number(e.displayOrder)||0;let s=r.categories[e.id];if(s)s.displayOrder=Math.max(i,s.displayOrder);else{s=e,s.hash={},s.data=[],s.dataCollections=[],s.displayOrder=i,s.popularityHash={};const t=this;s.getPopularVariables=function(e,r){return this.popularityArray||(this.popularityArray=t._objectToArray(this.popularityHash)),t._queryPopularVariables(this.popularityArray,e,r)},r.categories[e.id]=s}return s.dataCollections.push(t),s}_queryPopularVariables(e,t,r){const i=r&&r.queryFilter||this.queryFilter;return this.queryEngine((e=>{const t=this.get(e.id);return!!t&&i(t)}),t)(e).map((e=>this.get(e.id)))}_processVariable(e,t,r){let i=e.popularity;if(void 0!==i&&(delete e.popularity,i=Number(i)),t.categories&&t.categories.length||(e.missedInCategories=!0),this._isVariableDisallowed(e))return;this._prepareVariable(e);const s=this._createUniqueVariableId(e).toUpperCase();let o=t.id+"."+e.id;const n=this._isVariableAllowedInCategories(e,t);let a=r.variables[s];if(a){const t=!e.missedInCategories,r=a.hideInDataBrowser&&e.hideInDataBrowser&&this._hideGlobalHiddenVariables();let i=a.missedInCategories?e.__sourceDesc||a.__sourceDesc:a.__sourceDesc||e.__sourceDesc;a.missedInCategories&&t&&delete a.missedInCategories,t&&Object.keys(e.filteringTags).length&&(Object.keys(a.filteringTags).length?(Sn(e.filteringTags,a.filteringTags),e.indexBase=a.indexBase||e.indexBase,e[this.idProperty]=a[this.idProperty]):(e[this.idProperty]=o,i=e.__sourceDesc||a.__sourceDesc),Sn(a,e)),a.__sourceDesc=i,i&&(a.description=i),a.hideInDataBrowser=!!r}else{if(a=e,a[this.idProperty]=o,r.variables[s]=a,a.hideInDataBrowser&&e.hideInDataBrowser&&this._hideGlobalHiddenVariables())return;this._data.push(a)}this._registerVariable(a,o),o=a[this.idProperty];const l=o.toUpperCase();t.hasVariable(a)||(t.hash[a.id]=!!n,t.data.push(a)),n&&t.categories.forEach((e=>{if(e.hash[l]||(e.hash[l]=a,e.data.push(a)),i){let t=e.popularityHash[l];t?t.popularity<i&&(t.popularity=i):(t={id:o,popularity:i},e.popularityHash[l]=t)}}))}_isDataCollectionDisallowed(e){return!e.metadata||!e.metadata.categories}_isVariableDisallowed(e){return!e.fieldCategory}_createUniqueVariableId(e){return e.id+"."+e.alias}_isVariableAllowedInCategories(e,t){return!0}_prepareVariable(e){const t=e;var r;t.id=e.id.toUpperCase(),t.units="string"==typeof(r=e.units)?r.toUpperCase():null,t.filteringTags=this._arrayToObject(e.filteringTags,"id"),t.percentBase=e.percentBase||null,t.percentBaseAlias=e.percentBaseAlias||null,t.averageBase=e.averageBase||null,t.averageBaseAlias=e.averageBaseAlias||null,t.indexBase=e.indexBase||null,t.__sourceDesc=e.description,t.description||(t.description=t.alias)}_registerVariable(e,t){this._variables[t]=e}_trimArray(e){for(let t=0;t<e.length;t++)e[t]=e[t].trim();return e}_objectToArray(e){const t=[];for(const r in e)t.push(e[r]);return t}_arrayToObject(e,t,r){const i={};return e.forEach((e=>{const s=t?e[t]:e;i[s]=r?r(e):e})),i}_hideGlobalHiddenVariables(){return!this.displayAllGlobalVariables}}class tS extends eS{constructor(e){super(e),this.globalCountryID="_",this.countries=new uc({resolver:this._getCountries.bind(this)}),this.categories.resolver=this.dataCollections.resolver=this._resolveCountryID.bind(this)}synchronize(e){return void 0===e?this._resolveCountryIDPromise:this._resolveCountryID({countryID:e})}getCurrentCountryID(){return this._currentCountryID}_getCountries(e){return this._getCountriesPromise||(this._getCountriesPromise=this._getGeoenrichmentTask().getAvailableCountries().then((e=>{this.countries.setData(e)}))),this._getCountriesPromise}_resolveCountryID(e){if("object"!=typeof(e=e||{}))return null;const t=e.countryID||this.globalCountryID;return t!==this._currentCountryID&&(this._currentCountryID=t,this._clearAllStores(),this._resolveCountryIDPromise=this._getDataCollections(t===this.globalCountryID?null:t).then((e=>{this._processDataCollections(e)})),this.favorites&&this.favorites.synchronize&&(this._resolveCountryIDPromise=Promise.all([this._resolveCountryIDPromise,this.favorites.synchronize(t)]))),this._resolveCountryIDPromise}_getDataCollections(e){return this._getGeoenrichmentTask().getDataCollections(e,null,this.variableFields||"*")}_getGeoenrichmentTask(){return new Jx(i.j.server,i.j.token)}_hideGlobalHiddenVariables(){return!this.displayAllGlobalVariables||this._currentCountryID!==this.globalCountryID}}let rS=class extends El{postCreate(){this._set("variables",this.variables||new tS({derivativeVariables:this.allowDerivativeVariables,displayAllGlobalVariables:this.displayAllGlobalVariables})),this._contentFactory=this._contentFactory||new cc,super.postCreate()}};rS=s([St()],rS);const iS=Object.freeze({__proto__:null,get DataBrowser(){return rS}})}}]);