/*! For license information please see f687268644375650403b237a0759970c.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[47598],{47598:(t,e,a)=>{a.r(e),a.d(e,{arcgis_new_item_pages_data_store_browser:()=>c});var i=a(28384),r=a(65508),s=a(72074),n=a(58892),o=a(54871);a(27010),a(41171),a(66716),a(76134),a(62381),a(83397),a(16665),a(83129),a(24552),a(85142),a(72022),a(96729),a(58728),a(86739),a(31546),a(18869),a(46220),a(82463),a(48507),a(48333),a(86274);const c=class{constructor(t){(0,i.r)(this,t),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.dataStoreContentType="tile-layer",this.selectedDataset=null,this.datastoreContents=void 0,this.originalDatasets=void 0,this.sortedDatasets=void 0,this.displayDatasets=void 0,this.pathHistories=[],this.cachedData={},this.error=null,this.loading=void 0,this.sortCriteria={direction:null,criteria:null},this.userTileLayerTypeSelection=void 0,this.itemsPerPage=void 0,this.totalItems=void 0,this.paginationData=void 0}async componentWillLoad(){this.dataStoreContentType="tileLayer"===n.a.newItemMode?"tile-layer":"scene-layer",this.dataStoreName=n.a.dataStoreName,this.i18n=o.u.i18n.dataStore,this.pathHistories=["/"],this.datastoreContents=n.a.datastoreContents,this.originalDatasets=[...n.a.datastoreContents.children],this.sortedDatasets=[...this.originalDatasets],this.selectedDataset=n.a.dataset,this.cachedData=n.a.dataStoreCachedData,this.selectedDataset=n.a.dataset,this.serverId=n.a.serverId}toggleSort(t){const{sortCriteria:e}=this,a=null==t?null:e.criteria!==t?"desc":"desc"===e.direction?"asc":null;if(null===t||null===a)return this.sortCriteria={criteria:null,direction:null},void(this.sortedDatasets=this.originalDatasets);this.sortCriteria={criteria:t,direction:a};const i="asc"===a?1:-1;this.sortedDatasets=[...this.sortedDatasets].sort((function(e,a){const r=e[t].toLowerCase(),s=a[t].toLowerCase();return r.localeCompare(s)*i}))}async exploreFolder(t,e){var a;if(this.loading=!0,null==this.cachedData[t]){const i=await(0,s.g)(n.a.dataStoreId,t,e,this.serverId);if("failToListDataStoreContents"===(null===(a=i.error)||void 0===a?void 0:a.code))return this.loading=!1,void(this.error="failToListDataStoreContents");this.cachedData=Object.assign(Object.assign({},this.cachedData),{[t]:i.result})}const i=this.cachedData[t];this.pathHistories="/"===t?["/"]:t.split("/"),this.datastoreContents=this.filterContentsByUserSelection(i),this.originalDatasets=[...this.datastoreContents.children],this.loading=!1}filterContentsByUserSelection(t){const e=this.dataStoreContentType,a=n.a.tileLayerPublishType;return t.children?Object.assign(Object.assign({},t),{children:t.children.filter((t=>{const i=t.type;let r="folder"===i;return"tile-layer"===e?r||(r="tiles"===a&&"cacheDataset"===i||"vectorTiles"===a&&"vectorCacheDataset"===i):"scene-layer"===e&&(r||(r="extractedScenePackage"===i||"i3sRestCache"===i)),r}))}):Object.assign(Object.assign({},t),{children:[]})}renderErrorItem(){const{i18n:t,error:e,loading:a}=this;let r="",s="";if(e){const a=t.error;"failToListDataStoreContents"===e?(r=a.listing.heading,s=a.listing.description):(r=a.noDatasetErrorHeading,s=a.noDatasetErrorDescription)}return(0,i.h)("arcgis-new-item-alert",{heading:r,description:s,active:null!==e&&!a,onAlertDismiss:()=>{this.error=null}})}renderHeaderItem(t){const{i18n:e,sortCriteria:a}=this,{criteria:r,direction:s}=a;return(0,i.h)("div",{onClick:()=>this.toggleSort(t),class:{"data-set__header":!0,"data-set__header--selected":r===t&&null!=s}},"name"===t&&(0,i.h)("calcite-icon",{scale:"s",icon:"circle",class:"hidden-icon header-icon"}),"name"===t?e.fileName:e.fileType,(0,i.h)("calcite-icon",{class:{"blue-calcite-icon sort-icon":!0,"hidden-icon":r!==t||!s},scale:"s",icon:"asc"===s?"caret-up":"caret-down"}))}onDatastoreContentsChange(){this.toggleSort(null)}onSortedDataSetsChange(){this.calculatePagination(1)}calculatePagination(t){const{sortedDatasets:e}=this,a=e.length;this.totalItems=a;const i=Math.min(a,5),r=t-1,s=Math.min(r+i,a)-1;this.itemsPerPage=i,this.displayDatasets=e.slice(r,s+1),this.paginationData={startIndex:r,endIndex:s}}handleNext(){const t=this.selectedDataset;if(!t)return void(this.error="noDataSetSelected");let e;switch(n.a.dataset=t,n.a.dataStoreCachedId=n.a.dataStoreId,n.a.serverId=this.serverId,n.a.datastoreContents=this.datastoreContents,n.a.dataStoreCachedData=this.cachedData,r.i.title=t.name.split(".")[0],t.type){case"vectorCacheDataset":e="Vector Tile Service";break;case"i3sRestCache":case"extractedScenePackage":e="Scene Service";break;case"cacheDataset":e="Map Service"}n.a.type=e,this.newItemUpdatePage.emit("serverList")}render(){const{i18n:t,loading:e,displayDatasets:a,originalDatasets:r,pathHistories:s,paginationData:n,dataStoreName:o}=this;return(0,i.h)(i.H,null,(0,i.h)("div",{class:"inner-container"},e?(0,i.h)("calcite-loader",{label:"datastore-loader",text:t.processing}):(0,i.h)(i.F,null,(0,i.h)("div",{class:"content-wrapper"},(0,i.h)("div",{class:"header-text"},t.header),(0,i.h)("div",{class:"breadcrumb-container"},s.map(((t,e)=>{const a=e===s.length-1,r=0===e,n=r?"/":s.slice(0,e+1).join("/");return(0,i.h)("div",{class:"breadcrumb__item",key:`${t}_${e}`},(0,i.h)("span",{onClick:a?void 0:()=>this.exploreFolder(n,"folder")},(0,i.h)("span",{class:{"breadcrumb--inactive":!a}},r?o:t)),!a&&(0,i.h)("calcite-icon",{icon:"chevron-right",scale:"s"}))}))),(0,i.h)("div",{class:"pagination-text"},a.length>0&&t.paginationRange.replace("${start}",`${n.startIndex+1}`).replace("${end}",`${n.endIndex+1}`).replace("${total}",`${r.length}`)),(0,i.h)("div",{class:"data-set-container"},(0,i.h)("div",{class:"data-set__item"},this.renderHeaderItem("name"),this.renderHeaderItem("type")),(0,i.h)("calcite-radio-button-group",{name:"file-group",onCalciteRadioButtonGroupChange:t=>{this.selectedDataset=t.target.selectedItem.value},layout:"vertical"},(0,i.h)("ul",{class:"item-list"},a.length>0?a.map((t=>{var e;const{name:a,path:r,type:s}=t,n="folder"===s;return(0,i.h)("li",{key:`dataSet--item__${r}`,class:"data-set__item",onClick:()=>{n&&this.exploreFolder(t.path,"folder")}},(0,i.h)("calcite-label",{layout:"inline",class:"description"},n?(0,i.h)("calcite-icon",{icon:"folder",scale:"s",class:"blue-calcite-icon"}):(0,i.h)("calcite-radio-button",{value:t,checked:r===(null===(e=this.selectedDataset)||void 0===e?void 0:e.path)}),a),(0,i.h)("p",{class:"item--title"},s))})):(0,i.h)("li",{class:"data-set__item"},(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),t.emptyFolder)))))),this.itemsPerPage>0&&(0,i.h)("div",{class:"pagination-wrapper"},(0,i.h)("calcite-pagination",{startItem:n.startIndex+1,totalItems:this.totalItems,pageSize:this.itemsPerPage,onCalcitePaginationChange:t=>{const e=t.target;this.calculatePagination(e.startItem)}})))),this.renderErrorItem())}get el(){return(0,i.d)(this)}static get watchers(){return{originalDatasets:["onDatastoreContentsChange"],sortedDatasets:["onSortedDataSetsChange"]}}};c.style=":host{background-color:var(--calcite-ui-foreground-2);padding:0}.inner-container{display:flex;flex-direction:column;padding:1.5rem;height:calc(100% - 65px)}.content-wrapper{flex-grow:1}.breadcrumb-container{font-weight:500;margin-top:1rem;margin-bottom:1rem;display:flex}.breadcrumb__item{display:flex;align-items:center;font-size:0.875rem;color:var(--calcite-ui-text-2);margin-right:0.5rem}.breadcrumb--inactive{cursor:pointer;margin-right:0.5rem;color:#00619b}.pagination-text{font-size:0.75rem;font-weight:500;margin-top:1rem;margin-bottom:1rem;color:#757575}.data-set-container{background-color:var(--calcite-ui-foreground-1)}.data-set__header{border-width:0;border-bottom-width:2px;border-style:solid;font-size:0.875rem;padding:0;border-color:transparent;width:-moz-fit-content;width:fit-content}.data-set__header:hover{cursor:pointer}.data-set__header--selected{border-color:#0079c1}.header-icon{margin-right:0.5rem}.item-list{margin-left:0;-webkit-margin-start:0;margin-inline-start:0;-webkit-padding-start:0;padding-inline-start:0}.data-set__item{display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));padding-left:0.75rem;padding-right:0.75rem;padding-top:0.5rem;padding-bottom:0.5rem}.data-set__item:hover{cursor:pointer}.data-set__item>.item--title{font-size:0.875rem;margin-top:0;margin-bottom:0}.blue-calcite-icon{--calcite-ui-icon-color:var(--calcite-ui-brand)}.sort-icon{margin-left:6rem}.hidden-icon{visibility:hidden}.pagination-wrapper{display:flex;justify-content:center;margin-top:auto;padding-left:0.5rem;padding-right:0.5rem}.header-text{font-size:1rem;color:var(--calcite-ui-text-1);font-weight:500}"}}]);