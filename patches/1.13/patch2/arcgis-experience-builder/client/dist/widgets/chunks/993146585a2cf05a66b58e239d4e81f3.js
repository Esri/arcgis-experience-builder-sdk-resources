/*! For license information please see 993146585a2cf05a66b58e239d4e81f3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[29075],{29075:(e,t,i)=>{i.r(t),i.d(t,{arcgis_aggregation:()=>S,arcgis_aggregation_binning:()=>P,arcgis_aggregation_clustering:()=>A,arcgis_aggregation_field:()=>x,arcgis_aggregation_fields:()=>T,arcgis_aggregation_info_popover:()=>E,arcgis_aggregation_symbol_styler_popover:()=>L,arcgis_aggregation_tile:()=>N});var s,n=i(28384),o=i(81068),l=i(62727),a=i(66716),r=i(34077),c=i(72637),d=i(26426);function g(e,t,i){if(t&&(null==e?void 0:e.tagName)===t.toUpperCase()||i&&(null==e?void 0:e.classList.contains(i)))return e;{let s=null==e?void 0:e.parentElement;for(;s;){if(t&&s.tagName===t.toUpperCase()||i&&s.classList.contains(i))return s;if("BODY"===s.tagName)break;s=s.parentElement}}}function p(e,t){switch(e){case"sum":return t.fields.sum;case"avg":return t.fields.mean;case"min":return t.fields.min;case"max":return t.fields.max;case"stddev":return t.fields.stdDev;case"mode":return t.fields.mode;case"var":return t.fields.var;case"count":return t.fields.count;default:return""}}function h(e){const t=e.featureReduction;if(t)return"binning"===t.type?"binning":"cluster"===t.type?function(e){var t,i;const s=e.featureReduction;return s.renderer&&"pie-chart"===s.renderer.type&&!(null===(i=null===(t=null==s?void 0:s.renderer)||void 0===t?void 0:t.authoringInfo)||void 0===i?void 0:i.isAutoGenerated)}(e)?"pie-chart":"cluster":void 0}function u(e){const{SimpleLineSymbol:t,SimpleMarkerSymbol:i,Color:s}=e;return new i({style:"circle",size:6.75,outline:new t({style:"solid",color:new s([92,92,92,64]),width:1}),color:new s([227,139,79,255])})}function m(e,t){return"picture-marker"===e.type||"cim"===e.type&&!function(e,t){const{cimSymbolUtils:i}=t;return!!i.getCIMSymbolColor(e)}(e,t)}function f(e,t){var i,s;const{cimSymbolUtils:n,Color:o}=t;return"cim"===(null==e?void 0:e.type)?o.fromJSON(null===(i=n.getCIMSymbolColor(e))||void 0===i?void 0:i.toJSON()):"simple-marker"===(null==e?void 0:e.type)&&["x","cross"].indexOf(null==e?void 0:e.style)>-1?null===(s=null==e?void 0:e.outline)||void 0===s?void 0:s.color:null==e?void 0:e.color}function v(e,t){const{cimSymbolUtils:i}=t;return"cim"===e.type?i.getCIMSymbolSize(e):e.size?e.size:e.width}function b(e,t){return t&&e.fields.find((e=>e.name===t))}function y(e,t,i){var s;return!!(null===(s=e.featureReduction.fields)||void 0===s?void 0:s.find((e=>e.onStatisticField===t&&e.statisticType===i)))}function C(e){return"string"===e.type?["mode"]:["sum","avg","min","max","mode"]}function w(e,t,i){const{FieldInfo:s}=i,n=t.featureReduction,{popupTemplate:o}=n;o.fieldInfos=o.fieldInfos||[],o.fieldInfos.find((t=>t.fieldName===e.name))||o.fieldInfos.push(new s({fieldName:e.name,label:e.alias,isEditable:!1,visible:!0,format:k(e,t)}))}function F(e,t){return e.featureReduction.popupTemplate.fieldInfos.find((e=>e.fieldName===t))}function k(e,t){const i=e.onStatisticField,s=e.onStatisticExpression,n="sum"===e.statisticType,o="count"===e.statisticType,l=b(t,i),a=o||s&&n||l&&["small-integer","big-integer","integer","long","number"].indexOf(l.type)>-1;return l&&["single","double"].indexOf(l.type)>-1?{digitSeparator:!0,places:1}:a?{digitSeparator:!0}:void 0}i(18869),function(e){e.CLUSTERING="clustering",e.CHART_CLUSTERING="chartClustering",e.BINNING="binning"}(s||(s={}));const S=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationStyleClick=(0,n.c)(this,"arcgisAggregationStyleClick",7),this.arcgisAggregationClose=(0,n.c)(this,"arcgisAggregationClose",7),this.arcgisAggregationChanged=(0,n.c)(this,"arcgisAggregationChanged",7),this.arcgisAggregationError=(0,n.c)(this,"arcgisAggregationError",7),this.tileNodes=[],this.lastFeatureReduction=[],this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.hideLayerTitle=!1,this.options=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){const[e,t]=await(0,l.g)(this.hostElement);this.strings=e,this.locale=t;const[i,s,n,o,r,c,d,g,p,h]=await(0,a.l)(["esri/smartMapping/popup/clusters","esri/support/popupUtils","esri/smartMapping/heuristics/binLevel","esri/smartMapping/labels/clusters","esri/smartMapping/labels/bins","esri/layers/support/AggregateField","esri/popup/FieldInfo","esri/smartMapping/renderers/pieChart","esri/smartMapping/renderers/color","esri/renderers/SimpleRenderer"]);this.modules={popupClusters:i,popupUtils:s,binLevel:n,clusterLabelCreator:o,binLabelCreator:r,AggregateField:c,FieldInfo:d,pieChartCreator:g,colorCreator:p,SimpleRenderer:h};const{view:u,layer:m}=this;this.props={view:u,layer:m}}componentDidLoad(){var e;const{props:t,modules:i}=this,{layer:s}=t,{AggregateField:n}=i,o=s.featureReduction;if(o&&!(null===(e=o.fields)||void 0===e?void 0:e.length)){const e=new n({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0});s.featureReduction.fields=[e]}requestAnimationFrame((()=>this.flowItemNode.setFocus()))}render(){const{layer:e,options:t}=this;return(0,n.h)(n.H,{class:"calcite-match-height"},(0,n.h)("calcite-flow",{class:"flow",dir:(0,o.g)(this.hostElement),ref:e=>this.flowNode=e},e.featureEffect?this.renderMsg():this.renderContent(),(t===s.CLUSTERING||t===s.CHART_CLUSTERING)&&this.renderClusteringOptions(),t===s.BINNING&&this.renderBinningOptions()))}renderContent(){var e,t,i;const{props:l,hideLayerTitle:a,config:r,flowItemNode:c,tileNodes:d,strings:g}=this,{layer:p}=l,u=p.featureReduction,m="rtl"===(0,o.g)(this.hostElement),f={flowItemNode:c,strings:g,config:r},{renderer:v}=p,b="unique-value"===v.type,y=b&&!!v.field2,C="heatmap"===v.type,w=!!v.valueExpression,F="class-breaks"===v.type&&"class-breaks-color"===(null===(e=v.authoringInfo)||void 0===e?void 0:e.type),k=b?null===(t=v.uniqueValueInfos)||void 0===t?void 0:t.length:F?null===(i=v.classBreakInfos)||void 0===i?void 0:i.length:0,S=!C&&!y,P=(b||F)&&k<=10&&!y&&!w,A=h(p);return(0,n.h)("calcite-flow-item",{heading:g.aggregation,description:a?void 0:p.title,class:{panel:!0,[o.C.rtl]:m},closable:!0,onCalciteFlowItemClose:()=>{this.arcgisAggregationClose.emit()},ref:e=>{this.flowItemNode=e}},(0,n.h)("div",{class:"toggle"},(0,n.h)("calcite-label",{layout:"inline-space-between"},g.enableAggregation,(0,n.h)("calcite-switch",{scale:"s",checked:!!u,label:g.enableAggregation,onCalciteSwitchChange:e=>this.handleToggleClustering(e),ref:e=>this.switchNode=e}))),(0,n.h)("div",null,S&&(0,n.h)("arcgis-aggregation-tile",{props:Object.assign({title:g.clustering,imagePath:(0,n.a)("./assets/arcgis-aggregation-thumbnails/clustering.jpg"),moreInfo:g.info.clustering,helpId:"120003927"},f),selected:"cluster"===A,ref:e=>d.cluster=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("cluster"),(0,n.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=s.CLUSTERING,(0,n.f)(this.hostElement)}}),P&&(0,n.h)("arcgis-aggregation-tile",{props:Object.assign({title:g.chartClustering,imagePath:(0,n.a)("./assets/arcgis-aggregation-thumbnails/chartClustering.jpg"),moreInfo:g.info.chartClustering,helpId:"120003927"},f),selected:"pie-chart"===A,ref:e=>d["pie-chart"]=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("pie-chart"),(0,n.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=s.CHART_CLUSTERING,(0,n.f)(this.hostElement)}}),(0,n.h)("arcgis-aggregation-tile",{props:Object.assign({title:g.binning,imagePath:(0,n.a)("./assets/arcgis-aggregation-thumbnails/binning.jpg"),moreInfo:g.info.binning,helpId:"120003926"},f),selected:"binning"===A,ref:e=>d.binning=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("binning"),(0,n.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=s.BINNING,(0,n.f)(this.hostElement)}})))}renderMsg(){const{layer:e,hideLayerTitle:t,strings:i}=this,s="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("calcite-flow-item",{heading:i.aggregation,description:t?void 0:e.title,class:{panel:!0,[o.C.rtl]:s},closable:!0,onCalciteFlowItemClose:()=>{this.arcgisAggregationClose.emit()},ref:e=>{this.flowItemNode=e}},(0,n.h)("calcite-tip",{"non-dismissible":!0},i.cluster.leNotSupportedMessage))}renderClusteringOptions(){const{props:e,hideLayerTitle:t,portal:i,config:s,flowNode:o,strings:l,locale:a}=this,{layer:r,view:c}=e;return(0,n.h)("arcgis-aggregation-clustering",{view:c,layer:r,portal:i,config:s,flowNode:o,hideLayerTitle:t,strings:l,currentLanguage:a,onArcgisAggregationClusteringChange:()=>{this.arcgisAggregationChanged.emit()},onArcgisAggregationClusteringDismissedChange:()=>{},onCalcitePanelBackClick:()=>{this.options=void 0}})}renderBinningOptions(){const{props:e,hideLayerTitle:t,portal:i,config:s,flowNode:o,strings:l,locale:a}=this,{layer:r,view:c}=e;return(0,n.h)("arcgis-aggregation-binning",{view:c,layer:r,portal:i,config:s,flowNode:o,hideLayerTitle:t,strings:l,currentLanguage:a,onArcgisAggregationBinningChange:()=>this.arcgisAggregationChanged.emit(),onArcgisAggregationBinningStyleClick:()=>this.arcgisAggregationStyleClick.emit(),onArcgisAggregationBinningDismissedChange:()=>{},onCalcitePanelBackClick:()=>{this.options=void 0}})}async handleToggleClustering(e){e.currentTarget.checked?await this.enableAggregation("default"):this.disableAggregation(),(0,n.f)(this.hostElement)}async enableAggregation(e){const{props:t,flowItemNode:i}=this,{layer:s}=t,{renderer:o}=s,l="unique-value"===o.type&&!!o.field2,a="heatmap"===o.type;if("default"===e&&this.lastFeatureReductionType&&this.lastFeatureReduction[this.lastFeatureReductionType])s.featureReduction=this.lastFeatureReduction[this.lastFeatureReductionType],s.featureReduction=s.featureReduction.clone(),this.arcgisAggregationChanged.emit();else{"default"===e&&(e=a||l?"binning":"cluster");const t=h(s);if(t&&(this.lastFeatureReduction[t]=s.featureReduction),this.lastFeatureReduction[e])s.featureReduction=this.lastFeatureReduction[e],s.featureReduction=s.featureReduction.clone(),this.arcgisAggregationChanged.emit();else try{i.loading=!0,"binning"===e?await this.createBinning():await this.createCluster(e),i.loading=!1,s.featureReduction=s.featureReduction.clone(),this.arcgisAggregationChanged.emit()}catch(e){i.loading=!1,this.arcgisAggregationError.emit({message:"Aggregation style could not be changed.",type:"warning"}),(0,n.f)(this.hostElement)}}}async createCluster(e){var t,i;const{props:s,switchNode:n,tileNodes:o,modules:l}=this,{layer:a,view:r}=s,{popupClusters:c,clusterLabelCreator:d,pieChartCreator:g}=l,p=a.featureReduction;try{const s="cluster"===e&&await d.getLabelSchemes({layer:a,renderer:a.renderer,view:r});let n;a.featureReduction={type:"cluster",clusterMinSize:(null===(t=null==s?void 0:s.primaryScheme)||void 0===t?void 0:t.clusterMinSize)||9,clusterMaxSize:37.5,clusterRadius:37.5,labelsVisible:"cluster"===e,labelingInfo:null===(i=null==s?void 0:s.primaryScheme)||void 0===i?void 0:i.labelingInfo},"pie-chart"===e&&(n=await g.createRendererForClustering({layer:a}),a.featureReduction.renderer=n.renderer,a.featureReduction.fields=a.featureReduction.fields.concat(n.fields));const o=await c.getTemplates({renderer:a.renderer,layer:a});if("cluster"===e){const e=o.primaryTemplate.value;a.featureReduction.popupTemplate=e}else{const e=o.secondaryTemplates[0].value;a.featureReduction.popupTemplate=e,n.fields.forEach((e=>w(e,a,l)))}return Promise.resolve()}catch(e){return a.featureReduction=p,a.featureReduction?o[h(a)].setFocus():n.setFocus(),Promise.reject()}}async createBinning(){var e,t;const{props:i,switchNode:s,tileNodes:n,modules:o}=this,{layer:l,view:a}=i,{popupUtils:r,binLevel:c,binLabelCreator:d,AggregateField:g,colorCreator:p}=o,u=l.featureReduction;try{const i=c,s=await i({view:a});if(l.featureReduction={type:"binning",fixedBinLevel:s||1},!(null===(e=l.featureReduction.fields)||void 0===e?void 0:e.length)){const e=new g({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0});l.featureReduction.fields=[e]}const n=await p.createContinuousRenderer({layer:l,view:a,field:"aggregateCount",outlineOptimizationEnabled:!0,sizeOptimizationEnabled:!0,defaultSymbolEnabled:!1,forBinning:!0});l.featureReduction.renderer=n.renderer;const o=await d.getLabelSchemes({layer:l});l.featureReduction.labelingInfo=null===(t=null==o?void 0:o.primaryScheme)||void 0===t?void 0:t.labelingInfo,l.featureReduction.labelsVisible=!0;const h=l.featureReduction.fields.map((e=>e.onStatisticField)),u=r.createPopupTemplateForFeatureReduction({featureReduction:l.featureReduction,fields:l.fields.filter((e=>h.indexOf(e.name)>-1))});return l.featureReduction.popupTemplate=u,Promise.resolve()}catch(e){return l.featureReduction=u,l.featureReduction?n[h(l)].setFocus():s.setFocus(),Promise.reject()}}disableAggregation(){const{props:e}=this,{layer:t}=e,i=h(t);this.lastFeatureReduction[i]=t.featureReduction,this.lastFeatureReductionType=i,t.featureReduction=null,this.arcgisAggregationChanged.emit()}static get assetsDirs(){return["assets"]}get hostElement(){return(0,n.d)(this)}};S.style=":host{height:100%}.flow{height:100%}.panel{height:100%}.toggle{background-color:white;padding:15px 10px 5px 10px}";const P=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationBinningChange=(0,n.c)(this,"arcgisAggregationBinningChange",7),this.arcgisAggregationBinningDismissedChange=(0,n.c)(this,"arcgisAggregationBinningDismissedChange",7),this.arcgisAggregationBinningStyleClick=(0,n.c)(this,"arcgisAggregationBinningStyleClick",7),this.calcitePanelBackClick=(0,n.c)(this,"calcitePanelBackClick",7),this.internalChange=(0,n.c)(this,"internalChange",7),this.closeLabelPopovers=(0,n.c)(this,"closeLabelPopovers",7),this.closePopupPopovers=(0,n.c)(this,"closePopupPopovers",7),this.closeAttributePopovers=(0,n.c)(this,"closeAttributePopovers",7),this.disableSizeSlider=!1,this.onBinSizeChange=(0,d.d)((async e=>{const{layer:t,view:i,modules:s}=this,{colorCreator:n,AggregateField:o}=s;t.featureReduction.fixedBinLevel=e;let l=t.featureReduction.fields.find((e=>"count"===e.statisticType));l||(l=new o({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0}),t.featureReduction.fields.push(l));const a=await n.createContinuousRenderer({layer:t,view:i,field:l.name,outlineOptimizationEnabled:!0,sizeOptimizationEnabled:!0,defaultSymbolEnabled:!1,forBinning:!0});t.featureReduction.renderer=a.renderer,this.internalChange.emit()}),300),this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1}internalChangeHandler(){const{layer:e}=this,t=e.featureReduction;e.featureReduction=t.clone(),this.arcgisAggregationBinningChange.emit()}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){this.layerGeometryType=await(0,r.h)(this.layer);const[e,t]=await(0,a.l)(["esri/layers/support/AggregateField","esri/smartMapping/renderers/color"]);this.modules={AggregateField:e,colorCreator:t}}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.flowItemNode.setFocus()))),200)}componentDidUpdate(){}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,strings:t,hideLayerTitle:i}=this;return(0,n.h)(n.H,{class:"calcite-match-height"},(0,n.h)("calcite-flow-item",{heading:t.binning,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.calcitePanelBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderBinSize(),this.renderFieldsBtn(),this.renderLabelBtn(),this.renderPopupBtn(),this.renderGoToStyle()))}renderBinSize(){var e;const{layer:t,strings:i}=this,s="rtl"===(0,o.g)(this.hostElement),l=t.featureReduction;return(0,n.h)("div",{class:"slider-title-wrapper"},(0,n.h)("label",{class:"slider-heading"},i.bin.binSizeTitle),(0,n.h)("div",{class:"slider-div"},(0,n.h)("label",{class:"slider-label"},s?i.bin.large:i.bin.small),(0,n.h)("calcite-slider",{class:"slider-slider",min:1,max:9,value:10-(null!==(e=l.fixedBinLevel)&&void 0!==e?e:3),step:1,minLabel:i.bin.binSizeTitle,onCalciteSliderInput:e=>{const t=e.target;this.onBinSizeChange(10-t.value)}}),(0,n.h)("label",{class:"slider-label"},s?i.bin.small:i.bin.large)))}renderFieldsBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"btn-section"},(0,n.h)("button",{class:"btn",onClick:e=>this.addFieldsPanel(e)},(0,n.h)("span",{class:"btn-text"},e.bin.editAttributes),(0,n.h)("span",{class:"btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderLabelBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"btn-section"},(0,n.h)("button",{class:"btn",onClick:e=>this.addLabelPanel(e)},(0,n.h)("span",{class:"btn-text"},e.bin.editLabel),(0,n.h)("span",{class:"btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderPopupBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"btn-section"},(0,n.h)("button",{class:"btn",onClick:e=>this.addPopupPanel(e)},(0,n.h)("span",{class:"btn-text"},e.bin.editPopups),(0,n.h)("span",{class:"btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderGoToStyle(){const{strings:e}=this;return(0,n.h)("div",{class:"style-button-div"},(0,n.h)("calcite-button",{alignment:"center",appearance:"transparent",scale:"m",width:"full",class:"style-button",onClick:()=>this.arcgisAggregationBinningStyleClick.emit()},e.bin.editBinStyle))}closePopovers(){this.closeAttributePopovers.emit(),this.closeLabelPopovers.emit(),this.closePopupPopovers.emit()}addFieldsPanel(e){e.stopPropagation(),this.closePopovers();const{layer:t,view:i,currentLanguage:s,strings:o,flowNode:l,hideLayerTitle:a}=this,r=document.createElement("arcgis-aggregation-fields");r.lang=s,r.layer=t,r.mapView=i,r.strings=o,r.currentLanguage=s,r.hideLayerTitle=a,r.flowNode=l,r.addEventListener("arcgisAggregationFieldsChange",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),l.appendChild(r)}addLabelPanel(e){const{layer:t,view:i,portal:s,config:o,currentLanguage:l,strings:a,flowNode:r,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=a.bin.labelFeaturesHeading,g.description=d?void 0:t.title;const p=document.createElement("calcite-fab");p.icon="plus",p.slot="fab",p.scale="s",p.appearance="outline-fill",p.kind="neutral",p.label=a.bin.labelFab,p.text=a.bin.labelFab,p.textEnabled=!0,g.appendChild(p);const h=document.createElement("arcgis-label");h.lang=l,h.layer=t,h.mapView=i,h.portal=s,h.config=o,h.layerDisplayType=c.l.cluster,h.calciteFlowProps={calciteFlowItem:g,calciteFab:p},h.addEventListener("labelUpdated",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),g.appendChild(h),r.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}addPopupPanel(e){const{layer:t,view:i,portal:s,config:o,currentLanguage:l,strings:a,flowNode:r,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=a.bin.popupsHeading,g.description=d?void 0:t.title;const p=document.createElement("calcite-fab");p.icon="plus",p.slot="fab",p.scale="s",p.appearance="outline-fill",p.kind="neutral",p.label=a.bin.popupFab,p.text=a.bin.popupFab,p.textEnabled=!0,g.appendChild(p);const h=document.createElement("arcgis-popup");h.lang=l,h.layer=t,h.mapView=i,h.portal=s,h.config=o,h.layerDisplayType=c.l.cluster,h.calciteFlowProps={flow:r,calciteFab:p,calciteFlowItem:g},h.addEventListener("popupUpdated",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),g.appendChild(h),r.appendChild(g),g.setFocus(),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}get hostElement(){return(0,n.d)(this)}};P.style=".block-section.sc-arcgis-aggregation-binning{padding:0 10px}.block-content.sc-arcgis-aggregation-binning{padding-top:10px}.slider-title-wrapper.sc-arcgis-aggregation-binning{background-color:var(--arcgis-app-background);border-bottom:1px solid var(--arcgis-app-border);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing)}.slider-div.sc-arcgis-aggregation-binning{display:flex;align-items:center;justify-content:space-between;flex-flow:row wrap}.slider-heading.sc-arcgis-aggregation-binning{display:inline-block;padding:var(--arcgis-app-cap-spacing-half) 0;font-size:var(--arcgis-app-font-size-0)}.slider-label.sc-arcgis-aggregation-binning{display:inline-block;padding:var(--arcgis-app-cap-spacing-eighth) 0;font-size:var(--arcgis-app-font-size--1);order:2}.slider-slider.sc-arcgis-aggregation-binning{display:inline-block;width:100%;order:1}.btn-section.sc-arcgis-aggregation-binning{background-color:var(--arcgis-app-background)}.btn.sc-arcgis-aggregation-binning{background:var(--arcgis-app-background-clear);border:none;border-bottom:solid 1px var(--arcgis-app-border);color:var(--arcgis-app-font-color);display:flex;align-items:center;justify-content:space-between;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing);cursor:pointer;width:100%;transition:background-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function), border-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function)}.btn.sc-arcgis-aggregation-binning:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.btn-text.sc-arcgis-aggregation-binning{font-family:var(--arcgis-app-font-family);font-size:var(--arcgis-app-font-size-0)}.style-button-div.sc-arcgis-aggregation-binning{background-color:white;padding:10px}";const A=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationClusteringChange=(0,n.c)(this,"arcgisAggregationClusteringChange",7),this.arcgisAggregationClusteringDismissedChange=(0,n.c)(this,"arcgisAggregationClusteringDismissedChange",7),this.calcitePanelBackClick=(0,n.c)(this,"calcitePanelBackClick",7),this.internalChange=(0,n.c)(this,"internalChange",7),this.closeLabelPopovers=(0,n.c)(this,"closeLabelPopovers",7),this.closePopupPopovers=(0,n.c)(this,"closePopupPopovers",7),this.closeAttributePopovers=(0,n.c)(this,"closeAttributePopovers",7),this.disableSizeSlider=!1,this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1,this.symbolSelected=!1}internalChangeHandler(){const{layer:e}=this,t=e.featureReduction;e.featureReduction=t.clone(),this.arcgisAggregationClusteringChange.emit()}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){this.layerGeometryType=await(0,r.h)(this.layer);const[e,t,i,s,n,o]=await(0,a.l)(["esri/smartMapping/popup/support/utils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/Color","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"]);this.modules={symbolUtils:t,cimSymbolUtils:i,Color:s,SimpleMarkerSymbol:n,SimpleLineSymbol:o};const l=e.getPrimaryVisualVariables(this.layer.renderer);this.disableSizeSlider=l.some((e=>"size"===(null==e?void 0:e.type)))}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.flowItemNode.setFocus()))),200)}componentDidUpdate(){}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,strings:t,hideLayerTitle:i}=this,s=function(e){var t,i;const s=e.featureReduction;return!(null==s?void 0:s.renderer)||(null===(i=null===(t=null==s?void 0:s.renderer)||void 0===t?void 0:t.authoringInfo)||void 0===i?void 0:i.isAutoGenerated)}(e),o=h(e);return(0,n.h)(n.H,{class:"calcite-match-height"},(0,n.h)("calcite-flow-item",{heading:t.clustering,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.calcitePanelBackClick.emit()},ref:e=>this.flowItemNode=e},s&&this.renderSymbol(),"pie-chart"===o&&this.renderShape(),this.renderClusterRadius(),this.renderClusterSize(),this.renderFieldsBtn(),this.renderLabelBtn(),this.renderPopupBtn()))}renderSymbol(){const{layer:e,strings:t}=this,i=!!e.featureReduction.symbol;return(0,n.h)("calcite-block-section",{text:t.cluster.overrideSymbol,open:i,"toggle-display":"switch",class:"block-section",onCalciteBlockSectionToggle:e=>{this.handleToggleSymbol(e)}},this.renderSymbolContent())}renderSymbolContent(){const{layer:e,symbolSelected:t,strings:i}=this;if(e.featureReduction.symbol)return(0,n.h)("div",{class:"block-content"},(0,n.h)("calcite-label",null,i.symbolStyle,(0,n.h)("div",{class:"symbol-button "+(t?"selected":""),tabindex:"0",role:"button","aria-label":i.symbolStyle,onClick:e=>this.openSymbolStylerPopover(e)},(0,n.h)("div",{class:"symbol",ref:e=>this.createSymbolPreview(e)}),(0,n.h)("calcite-icon",{scale:"s",icon:"pencil",class:"symbol-icon"}))))}renderShape(){var e;const{layer:t,strings:i}=this,s="rtl"===(0,o.g)(this.hostElement),l=t.featureReduction;return(0,n.h)("div",{class:"slider-title-wrapper"}," ",(0,n.h)("calcite-label",null,i.cluster.shape,(0,n.h)("div",{class:"slider-div"},(0,n.h)("label",{class:"slider-label"},s?i.cluster.donut:i.cluster.pie),(0,n.h)("calcite-slider",{class:"slider-slider",min:0,max:Math.max(.9,l.renderer.holePercentage),value:null!==(e=l.renderer.holePercentage)&&void 0!==e?e:0,step:.1,minLabel:i.cluster.shape,onCalciteSliderInput:e=>{const i=t.featureReduction,s=e.target;i.renderer.holePercentage=s.value,this.internalChange.emit()}}),(0,n.h)("label",{class:"slider-label"},s?i.cluster.pie:i.cluster.donut))))}renderClusterRadius(){var e;const{layer:t,strings:i}=this,s="rtl"===(0,o.g)(this.hostElement),l=t.featureReduction;return(0,n.h)("div",{class:"slider-title-wrapper"},(0,n.h)("label",{class:"slider-heading"},i.cluster.radiusTitle),(0,n.h)("div",{class:"slider-div"},(0,n.h)("label",{class:"slider-label"},s?i.cluster.high:i.cluster.low),(0,n.h)("calcite-slider",{class:"slider-slider",min:9,max:90,value:null!==(e=l.clusterRadius)&&void 0!==e?e:37.5,step:1,minLabel:i.cluster.radiusTitle,onCalciteSliderInput:e=>{const i=t.featureReduction,s=e.target;i.clusterRadius=s.value,this.internalChange.emit()}}),(0,n.h)("label",{class:"slider-label"},s?i.cluster.low:i.cluster.high)))}renderClusterSize(){var e,t;const{layer:i,strings:s,disableSizeSlider:l}=this,a="rtl"===(0,o.g)(this.hostElement),r=i.featureReduction;return(0,n.h)("div",{class:"slider-title-wrapper"},(0,n.h)("label",{class:"slider-heading"},s.cluster.sizeTitle),(0,n.h)("div",{class:"slider-div"},(0,n.h)("label",{class:"slider-label"},a?s.cluster.max:s.cluster.min),(0,n.h)("calcite-slider",{class:"slider-slider",min:9,max:90,minValue:null!==(e=r.clusterMinSize)&&void 0!==e?e:9,maxValue:null!==(t=r.clusterMaxSize)&&void 0!==t?t:90,step:1,disabled:l,minLabel:`${s.cluster.min} ${s.cluster.sizeTitle}`,maxLabel:`${s.cluster.max} ${s.cluster.sizeTitle}`,onCalciteSliderInput:e=>{const t=i.featureReduction,s=e.target;t.clusterMinSize=s.minValue,t.clusterMaxSize=s.maxValue,this.internalChange.emit()}}),(0,n.h)("label",{class:"slider-label"},a?s.cluster.min:s.cluster.max)))}renderFieldsBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"cluster-btn-section"},(0,n.h)("button",{class:"cluster-btn",onClick:e=>this.addFieldsPanel(e),ref:e=>this.fieldsButtonNode=e},(0,n.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterAttributes),(0,n.h)("span",{class:"cluster-btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderLabelBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"cluster-btn-section"},(0,n.h)("button",{class:"cluster-btn",onClick:e=>this.addLabelPanel(e),ref:e=>this.labelsButtonNode=e},(0,n.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterLabel),(0,n.h)("span",{class:"cluster-btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderPopupBtn(){const{strings:e}=this,t="rtl"===(0,o.g)(this.hostElement);return(0,n.h)("div",{class:"cluster-btn-section"},(0,n.h)("button",{class:"cluster-btn",onClick:e=>this.addPopupPanel(e),ref:e=>this.popupButtonNode=e},(0,n.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterPopups),(0,n.h)("span",{class:"cluster-btn-icon"},(0,n.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}closePopovers(){var e,t;this.closeAttributePopovers.emit(),this.closeLabelPopovers.emit(),this.closePopupPopovers.emit(),null===(t=null===(e=this.stylerPopoverNode)||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(this.stylerPopoverNode),this.stylerPopoverNode=null}handleToggleSymbol(e){const{layer:t,modules:i}=this,s=t.featureReduction;e.currentTarget.open?this.lastSymbol?(s.symbol=this.lastSymbol,this.lastSymbol=void 0):s.symbol=u(i):(this.lastSymbol=s.symbol,s.symbol=void 0),this.internalChange.emit(),(0,n.f)(this.hostElement)}createSymbolPreview(e){const{layer:t,modules:i}=this,{symbolUtils:s}=i,n=t.featureReduction;if(!n.symbol)return;const o=n.symbol,l="cim"===o.type?20:14;s.renderPreviewHTML(o,{size:l,symbolConfig:void 0}).then((t=>{e.childNodes.forEach((t=>e.removeChild(t))),e.appendChild(t)}))}async openSymbolStylerPopover(e){const{layer:t,portal:i,strings:s}=this,o=g(e.target,null,"symbol-button");this.stylerPopoverNode?(this.symbolSelected=!1,this.closePopovers(),this.stylerPopoverNode=null):(this.closePopovers(),this.symbolSelected=!0,this.stylerPopoverNode=document.createElement("arcgis-aggregation-symbol-styler-popover"),this.stylerPopoverNode.props={layer:t,portal:i,strings:s},this.stylerPopoverNode.referenceElement=this.flowItemNode,this.stylerPopoverNode.addEventListener("arcgisAggregationSymbolStylerPopoverClose",(()=>{this.closePopovers(),this.symbolSelected=!1,setTimeout((()=>o.focus()),300)})),this.stylerPopoverNode.addEventListener("arcgisAggregationSymbolStylerChange",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),document.body.appendChild(this.stylerPopoverNode),this.stylerPopoverNode.setOpen(!0))}addFieldsPanel(e){e.stopPropagation(),this.closePopovers();const{layer:t,view:i,currentLanguage:s,strings:o,flowNode:l,hideLayerTitle:a}=this,r=document.createElement("arcgis-aggregation-fields");r.lang=s,r.layer=t,r.mapView=i,r.strings=o,r.currentLanguage=s,r.hideLayerTitle=a,r.flowNode=l,r.addEventListener("arcgisAggregationFieldsChange",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),r.addEventListener("arcgisAggregationFieldsBackClick",(()=>{l.removeChild(r),setTimeout((()=>this.fieldsButtonNode.focus()),300)})),l.appendChild(r)}addLabelPanel(e){const{layer:t,view:i,portal:s,config:o,currentLanguage:l,strings:a,flowNode:r,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=a.cluster.labelFeaturesHeading,g.description=d?void 0:t.title;const p=document.createElement("calcite-fab");p.icon="plus",p.slot="fab",p.scale="s",p.appearance="outline-fill",p.kind="neutral",p.label=a.cluster.labelFab,p.text=a.cluster.labelFab,p.textEnabled=!0,g.appendChild(p);const h=document.createElement("arcgis-label");h.lang=l,h.layer=t,h.mapView=i,h.portal=s,h.config=o,h.layerDisplayType=c.l.cluster,h.calciteFlowProps={calciteFlowItem:g,calciteFab:p},h.addEventListener("labelUpdated",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),g.appendChild(h),g.addEventListener("calciteFlowItemBack",(()=>{setTimeout((()=>this.labelsButtonNode.focus()),300)})),r.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}addPopupPanel(e){const{layer:t,view:i,portal:s,config:o,currentLanguage:l,strings:a,flowNode:r,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=a.cluster.popupsHeading,g.description=d?void 0:t.title;const p=document.createElement("calcite-fab");p.icon="plus",p.slot="fab",p.scale="s",p.appearance="outline-fill",p.kind="neutral",p.label=a.cluster.popupFab,p.text=a.cluster.popupFab,p.textEnabled=!0,g.appendChild(p);const h=document.createElement("arcgis-popup");h.lang=l,h.layer=t,h.mapView=i,h.portal=s,h.config=o,h.layerDisplayType=c.l.cluster,h.calciteFlowProps={flow:r,calciteFab:p,calciteFlowItem:g},h.addEventListener("popupUpdated",(()=>{this.internalChange.emit(),(0,n.f)(this.hostElement)})),g.appendChild(h),g.addEventListener("calciteFlowItemBack",(()=>{setTimeout((()=>this.popupButtonNode.focus()),300)})),r.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}get hostElement(){return(0,n.d)(this)}};A.style=".block-section.sc-arcgis-aggregation-clustering{padding:0 10px}.block-content.sc-arcgis-aggregation-clustering{padding-top:10px}.symbol-button.sc-arcgis-aggregation-clustering{border:solid 1px var(--arcgis-app-border);display:flex;justify-content:space-between}.symbol-button.selected.sc-arcgis-aggregation-clustering{border-color:var(--calcite-ui-brand);border-width:1px}.symbol-button.sc-arcgis-aggregation-clustering:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.symbol-button.sc-arcgis-aggregation-clustering:focus{border-color:var(--calcite-ui-brand);border-width:2px}.symbol.sc-arcgis-aggregation-clustering{padding:5px}.symbol-icon.sc-arcgis-aggregation-clustering{padding:6px}.slider-title-wrapper.sc-arcgis-aggregation-clustering{background-color:var(--arcgis-app-background);border-bottom:1px solid var(--arcgis-app-border);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing)}.slider-div.sc-arcgis-aggregation-clustering{display:flex;align-items:center;justify-content:space-between;flex-flow:row wrap}.slider-heading.sc-arcgis-aggregation-clustering{display:inline-block;padding:var(--arcgis-app-cap-spacing-half) 0;font-size:var(--arcgis-app-font-size-0)}.slider-label.sc-arcgis-aggregation-clustering{display:inline-block;padding:var(--arcgis-app-cap-spacing-eighth) 0;font-size:var(--arcgis-app-font-size--1);order:2}.slider-slider.sc-arcgis-aggregation-clustering{display:inline-block;width:100%;order:1}.cluster-btn-section.sc-arcgis-aggregation-clustering{background-color:var(--arcgis-app-background)}.cluster-btn.sc-arcgis-aggregation-clustering{background:var(--arcgis-app-background-clear);border:none;border-bottom:solid 1px var(--arcgis-app-border);color:var(--arcgis-app-font-color);display:flex;align-items:center;justify-content:space-between;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing);cursor:pointer;width:100%;transition:background-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function), border-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function)}.cluster-btn.sc-arcgis-aggregation-clustering:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.cluster-btn.sc-arcgis-aggregation-clustering:focus{border:2px solid var(--calcite-ui-brand)}.cluster-btn-text.sc-arcgis-aggregation-clustering{font-family:var(--arcgis-app-font-family);font-size:var(--arcgis-app-font-size-0)}";const x=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationFieldChange=(0,n.c)(this,"arcgisAggregationFieldChange",7),this.onFieldSelect=()=>{const{layer:e,mapView:t,aggregateField:i,fieldPickListSortBy:s,strings:n}=this,o=g(this.hostElement,"calcite-flow-item"),l=o.getBoundingClientRect().width||215;this.arcgisFieldPickList=document.createElement("arcgis-field-pick-list"),this.arcgisFieldPickList.popoverProps={placement:"auto",offsetDistance:-1*(l+10),offsetSkidding:0,pointerDisabled:!0,popoverWidth:l+30,refElement:o},this.arcgisFieldPickList.fields=this.createPickListFields(),this.arcgisFieldPickList.layer=e,this.arcgisFieldPickList.mapView=t,this.arcgisFieldPickList.showFieldInfo=!0,this.arcgisFieldPickList.showFieldName=!1,this.arcgisFieldPickList.selectedFields=[i.onStatisticField],this.arcgisFieldPickList.sortBy=s,this.arcgisFieldPickList.addEventListener("arcgisFieldPickListDismissed",(t=>{var i,s;t.stopPropagation();const l=null===(s=null===(i=t.detail)||void 0===i?void 0:i.selectedFields)||void 0===s?void 0:s[0];if(o.disabled=!1,this.arcgisFieldPickList&&(document.body.removeChild(this.arcgisFieldPickList),this.arcgisFieldPickList=null,setTimeout((()=>{this.fieldNode.setFocus()}),1)),l){const{aggregateField:t}=this,i=b(e,l),s=C(i);let o=0,a=y(e,i.name,s[o]);for(;o<s.length&&a;)o++,s[o]===t.statisticType&&o++,o<s.length&&(a=y(e,i.name,s[o]));if(a)return;const r=t.name,c=s[o];t.name=`${i.name}_${c}`,t.onStatisticField=i.name,t.alias=`${i.alias||i.name} ${p(c,n).toLowerCase()}`,t.statisticType=c,this.replacePopupField(r),this.arcgisAggregationFieldChange.emit()}})),this.arcgisFieldPickList.addEventListener("arcgisFieldPickListSortByChange",(e=>this.fieldPickListSortBy=e.detail)),document.body.appendChild(this.arcgisFieldPickList),o.disabled=!0},this.mapView=void 0,this.layer=void 0,this.aggregateField=void 0,this.open=!1,this.strings=void 0,this.currentLanguage=void 0}async done(){this.closePopovers()}async setFocus(){this.panelNode.setFocus()}async componentWillLoad(){const[e,t]=await(0,a.l)(["esri/popup/FieldInfo","esri/popup/support/FieldInfoFormat"]);this.modules={FieldInfo:e,FieldInfoFormat:t};const{layer:i,aggregateField:s,modules:n}=this;F(i,s.name)||w(s,i,n)}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,aggregateField:t,open:i}=this,s=(0,o.g)(this.hostElement),l=F(e,t.name),a=(t.isAutoGenerated?l.label:t.alias)||t.name;return(0,n.h)(n.H,{dir:s},(0,n.h)("calcite-block",{heading:a,open:i,collapsible:!0,ref:e=>this.blockNode=e,onCalciteBlockToggle:e=>{const t=e.target;this.open=t.open}},this.renderDropdown(),this.renderFieldSelection(),this.renderTypeSelection(),this.renderResultFieldName(),this.renderFieldAlias(),this.renderFormatting()))}renderDropdown(){const{layer:e,aggregateField:t,strings:i}=this,s=b(e,t.onStatisticField);if(t.isAutoGenerated||!s)return null;const l=(0,o.g)(this.hostElement);return(0,n.h)("div",{slot:"control"},(0,n.h)("calcite-dropdown",{dir:l,placement:"bottom-end",scale:"s",overlayPositioning:"fixed"},(0,n.h)("calcite-action",{ref:e=>this.dropdownActionNode=e,slot:"trigger",scale:"m",text:i.delete},(0,n.h)("calcite-icon",{scale:"s",icon:"ellipsis"})),(0,n.h)("calcite-dropdown-group",null,(0,n.h)("calcite-dropdown-item",{onClick:e=>{e.stopPropagation(),this.removeField()},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||this.removeField()}},i.delete))))}renderFieldSelection(){const{aggregateField:e,strings:t}=this;return e.onStatisticField?(0,n.h)(n.F,null,(0,n.h)("calcite-label",null,t.fields.field),(0,n.h)("calcite-button",{appearance:"outline-fill",kind:"neutral",width:"full",scale:"m",alignment:"icon-end-space-between",iconEnd:"chevron-down",disabled:e.isAutoGenerated,onClick:()=>this.onFieldSelect(),ref:e=>this.fieldNode=e},e.onStatisticField)):null}renderTypeSelection(){const{layer:e,aggregateField:t,strings:i}=this,s=b(e,t.onStatisticField),o="string"===(null==s?void 0:s.type);return(0,n.h)("div",{class:"section"},(0,n.h)("calcite-label",null,i.fields.statsType),(0,n.h)("calcite-select",{width:"full",scale:"m",label:i.fields.statsType,disabled:t.isAutoGenerated||!s,onCalciteSelectChange:e=>{const n=(null==e?void 0:e.target).selectedOption.value,o=t.name;t.name=`${s.name}_${n}`,t.onStatisticField=s.name,t.alias=`${s.alias||s.name} ${p(n,i).toLowerCase()}`,t.statisticType=n,this.replacePopupField(o),this.arcgisAggregationFieldChange.emit()}},!o&&this.renderTypeOption("sum"),!o&&this.renderTypeOption("avg"),!o&&this.renderTypeOption("min"),!o&&this.renderTypeOption("max"),this.renderTypeOption("mode"),"count"===t.statisticType&&this.renderTypeOption("count")))}renderTypeOption(e){const{layer:t,aggregateField:i,strings:s}=this;return(0,n.h)("calcite-option",{value:e,label:p(e,s),disabled:i.statisticType!==e&&y(t,i.onStatisticField,e),selected:i.statisticType===e})}renderResultFieldName(){const{aggregateField:e,strings:t}=this;return(0,n.h)("div",{class:"section"},(0,n.h)("calcite-label",null,t.fields.resultFieldName),(0,n.h)("calcite-input",{type:"text",disabled:!0,value:e.name,scale:"m",label:t.fields.resultFieldName}))}renderFieldAlias(){const{layer:e,aggregateField:t,strings:i}=this,s=F(e,t.name),o=(t.isAutoGenerated?s.label:t.alias)||t.name;return(0,n.h)("div",{class:"section"},(0,n.h)("calcite-label",null,i.fields.fieldAlias),(0,n.h)("calcite-input",{type:"text",value:o,scale:"m",label:i.fields.fieldAlias,onCalciteInputInput:s=>{const n=s.target;let o=n.value;this.blockNode.heading=o,o?this.updateAlias(o):setTimeout((()=>{const s=F(e,t.name);if(!(t.isAutoGenerated?s.label:t.alias)){const s=b(e,t.onStatisticField);o=`${s.alias||s.name} ${p(t.statisticType,i).toLocaleLowerCase()}`,this.blockNode.heading=o,n.value=o}this.updateAlias(o)}),2e3)}}))}renderFormatting(){const{layer:e,aggregateField:t,modules:i,strings:s}=this,{FieldInfoFormat:o}=i,l=e.featureReduction.popupTemplate,a=b(e,t.onStatisticField);if(!a&&"count"!==t.statisticType||"string"===(null==a?void 0:a.type))return null;let r=l.fieldInfos.find((e=>e.fieldName===t.name));r.format=r.format||new o({dijitSeparator:!0,places:0});const c=!a||["integer","small-integer","big-integer"].indexOf(a.type)>-1;return(0,n.h)("div",{class:"format"},(0,n.h)("calcite-label",{scale:"l"},s.fields.formatting),!c&&this.renderSignificantDigits(r.format),this.renderThousandSeperator(r.format))}renderThousandSeperator(e){const{strings:t}=this;return(0,n.h)("section",null,(0,n.h)("calcite-label",{layout:"inline-space-between"},t.fields.show1000Separator,(0,n.h)("calcite-switch",{scale:"s",checked:e.digitSeparator,onCalciteSwitchChange:t=>{const i=null==t?void 0:t.target;e.digitSeparator=i.checked,this.arcgisAggregationFieldChange.emit()}})))}renderSignificantDigits(e){const{strings:t}=this;return(0,n.h)("section",null,(0,n.h)("calcite-label",null,t.fields.significantDigits,(0,n.h)("calcite-select",{label:t.fields.significantDigits,onCalciteSelectChange:t=>{const i=t.target;e.places=Number(i.selectedOption.value)||0,this.arcgisAggregationFieldChange.emit()}},(0,n.h)("calcite-option",{value:"0",selected:0===e.places},t.fields.decimalPlaces0),(0,n.h)("calcite-option",{value:"1",selected:1===e.places},t.fields.decimalPlaces1),[2,3,4,5,6,7,8].map((i=>(0,n.h)("calcite-option",{value:i.toString(),selected:e.places===i},t.fields.decimalPlacesN.replace("${num}",`${i}`)))))))}closePopovers(){this.arcgisFieldPickList&&(document.body.removeChild(this.arcgisFieldPickList),this.arcgisFieldPickList=null)}removeField(){const{layer:e,aggregateField:t}=this,i=e.featureReduction,s=i.popupTemplate;let n=s.fieldInfos.findIndex((e=>e.fieldName===t.name));n>=0&&s.fieldInfos.splice(n,1),n=i.fields.findIndex((e=>e.name===t.name)),i.fields.splice(n,1),this.arcgisAggregationFieldChange.emit()}createPickListFields(){const{layer:e,aggregateField:t}=this,{fields:i}=e;return i.filter((e=>["small-integer","big-integer","integer","single","double","long","number","string"].indexOf(e.type)>-1)).filter((i=>t.onStatisticField===i.name||!function(e,t){return!C(b(e,t)).find((i=>!y(e,t,i)))}(e,i.name))).map((e=>({name:e.name,alias:e.alias,type:e.type})))}replacePopupField(e){const{layer:t,aggregateField:i,modules:s}=this,{FieldInfo:n}=s,o=t.featureReduction,{popupTemplate:l}=o;l.fieldInfos=l.fieldInfos||[];const a=l.fieldInfos.findIndex((t=>t.fieldName===e)),r=b(t,i.onStatisticField);l.fieldInfos.splice(a,1,new n({fieldName:i.name,label:i.alias,isEditable:!1,visible:!0,format:"string"===r.type?void 0:["small-integer","big-integer","integer","long","number"].indexOf(r.type)>-1?{digitSeparator:!0}:{digitSeparator:!0,places:1}}))}updateAlias(e){const{layer:t,aggregateField:i}=this,s=F(t,i.name);i.isAutoGenerated?s.label=e:i.alias=e,this.updatePopupAlias(),this.arcgisAggregationFieldChange.emit()}updatePopupAlias(){const{layer:e,aggregateField:t}=this,i=e.featureReduction,s=F(e,t.name),n=t.isAutoGenerated?s.label:t.alias;t.isAutoGenerated||(s.label=n),Array.isArray(i.popupTemplate.content)&&i.popupTemplate.content.length&&i.popupTemplate.content.forEach((e=>{if("fields"===e.type&&e.fieldInfos){const i=e.fieldInfos.find((e=>e.fieldName===t.name));i&&(i.label=n)}}))}get hostElement(){return(0,n.d)(this)}};x.style=".section.sc-arcgis-aggregation-field{padding-top:15px}.format.sc-arcgis-aggregation-field{padding-top:20px}";const T=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationFieldsChange=(0,n.c)(this,"arcgisAggregationFieldsChange",7),this.arcgisAggregationFieldsClose=(0,n.c)(this,"arcgisAggregationFieldsClose",7),this.arcgisAggregationFieldsBackClick=(0,n.c)(this,"arcgisAggregationFieldsBackClick",7),this.allFieldsAdded=!1,this.mapView=void 0,this.layer=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){const[e,t]=await(0,a.l)(["esri/layers/support/AggregateField","esri/popup/FieldInfo"]);this.modules={AggregateField:e,FieldInfo:t}}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.flowItemNode.setFocus()))),200)}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,strings:t,hideLayerTitle:i}=this,s=e.featureReduction.fields;return(0,n.h)(n.H,{class:"calcite-match-height"},(0,n.h)("calcite-flow-item",{heading:t.fields.fields,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.arcgisAggregationFieldsBackClick.emit(),this.closePopovers()},ref:e=>this.flowItemNode=e},this.renderTip(s),(0,n.h)("div",{class:"fields"},null==s?void 0:s.map((e=>this.renderStatsField(e)))),this.renderAddField()))}renderTip(e){const{strings:t}=this;return(null==e?void 0:e.length)?null:(0,n.h)("calcite-tip",{heading:t.fields.msgTitle,closeDisabled:!0},t.fields.msg)}renderStatsField(e){const{layer:t,mapView:i,selectedFieldName:s,modules:o,strings:l}=this;return w(e,t,o),(0,n.h)("arcgis-aggregation-field",{layer:t,mapView:i,strings:l,aggregateField:e,open:s===e.name,onArcgisAggregationFieldChange:()=>{this.selectedFieldName=e.name,this.arcgisAggregationFieldsChange.emit(),(0,n.f)(this.hostElement)}})}renderAddField(){const{allFieldsAdded:e,strings:t}=this;return e?null:(0,n.h)("calcite-fab",{slot:"fab",appearance:"outline-fill",kind:"neutral",scale:"s",icon:"plus",textEnabled:!0,text:t.fields.addField,onClick:()=>this.addStatsField(),ref:e=>this.fabNode=e})}closePopovers(){this.attributeFormatter&&(document.body.removeChild(this.attributeFormatter),this.attributeFormatter=null)}addStatsField(){const{layer:e,strings:t,modules:i}=this,{AggregateField:s}=i,o=function(e){return e.fields.filter((e=>["small-integer","big-integer","integer","single","double","long","number","string"].indexOf(e.type)>-1))}(e);let l=0,a=C(o[l]),r=0,c=y(e,o[l].name,a[r]);for(;l<o.length&&c;){for(;r<a.length&&c;)r++,r<a.length&&(c=y(e,o[l].name,a[r]));c&&(l++,l<o.length&&(a=C(o[l]),r=0,c=y(e,o[l].name,a[r])))}if(c)this.allFieldsAdded=!0;else{const n=o[l],c=a[r],d=new s({name:`${n.name}_${c}`,onStatisticField:n.name,alias:`${n.alias||n.name} ${p(c,t).toLocaleLowerCase()}`,statisticType:c,visible:!0}),g=e.featureReduction;g.fields=g.fields||[],g.fields.push(d),w(d,e,i),this.selectedFieldName=d.name}(0,n.f)(this.hostElement)}get hostElement(){return(0,n.d)(this)}};T.style=".fields.sc-arcgis-aggregation-fields{background-color:white}.field-icon.sc-arcgis-aggregation-fields{padding:0 var(--arcgis-app-cap-spacing);display:flex;align-items:center}";const E=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationInfoPopoverClose=(0,n.c)(this,"arcgisAggregationInfoPopoverClose",7),this.arcgisAggregationInfoPopoverDisconnected=(0,n.c)(this,"arcgisAggregationInfoPopoverDisconnected",7),this.documentTabHandler=void 0,this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.onOpen=()=>{setTimeout((()=>requestAnimationFrame((()=>{var e;return null===(e=this.panelNode)||void 0===e?void 0:e.setFocus()}))),1)},this.props=void 0,this.referenceElement=void 0,this.open=!1}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async setFocus(){var e;null===(e=this.panelNode)||void 0===e||e.setFocus()}async setOpen(e){var t;this.popoverNode&&(this.popoverNode.open=e,e&&(null===(t=this.panelNode)||void 0===t||t.setFocus(),this.popoverNode.reposition()))}disconnectedCallback(){this.arcgisAggregationInfoPopoverDisconnected.emit()}render(){const{props:e,referenceElement:t,open:i}=this,{config:s,title:o,moreInfo:l,helpId:a,strings:r}=e,{helpBase:c,helpMap:d}=s,g=r.tile.info.title.replace("${title}",o);return(0,n.h)(n.H,{class:"js-app-flyout arcgis-aggregation-popover"},(0,n.h)("calcite-popover",{open:i,placement:"auto",offsetSkidding:5,label:"",referenceElement:t,class:"info-popover",onCalcitePopoverOpen:this.onOpen,ref:e=>this.popoverNode=e},(0,n.h)("calcite-panel",{heading:g,closable:!0,ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisAggregationInfoPopoverClose.emit(),setTimeout((()=>t.parentElement.focus()),300)}},(0,n.h)("div",{class:"info"},(0,n.h)("div",null,l),a&&d?(0,n.h)("div",{class:"info-help"},(0,n.h)("calcite-button",{appearance:"solid",label:r.tile.info.learnMore,class:"info-help-button",slot:"footer",onClick:()=>{window.open(`${c}${d[a]}`,"_blank")}},r.tile.info.learnMore)):null))))}get hostElement(){return(0,n.d)(this)}};E.style=".info{padding:10px;background-color:white}.info-popover{max-width:320px}.info-help{padding-top:10px;justify-content:flex-end;display:flex}.info-help-button{display:flex;flex-flow:row-reverse}";const L=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationSymbolStylerChange=(0,n.c)(this,"arcgisAggregationSymbolStylerChange",7),this.arcgisAggregationSymbolStylerPopoverClose=(0,n.c)(this,"arcgisAggregationSymbolStylerPopoverClose",7),this.arcgisAggregationSymbolStylerPopoverDisconnected=(0,n.c)(this,"arcgisAggregationSymbolStylerPopoverDisconnected",7),this.documentTabHandler=void 0,this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.props=void 0,this.referenceElement=void 0}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async setFocus(){var e;null===(e=this.closeActionNode)||void 0===e||e.setFocus()}async setOpen(e){this.popoverNode&&(this.popoverNode.open=e,e&&setTimeout((()=>this.closeActionNode.setFocus()),100))}async componentWillLoad(){const[e,t,i,s,n]=await(0,a.l)(["esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/Color","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"]);this.modules={symbolUtils:e,cimSymbolUtils:t,Color:i,SimpleMarkerSymbol:s,SimpleLineSymbol:n}}disconnectedCallback(){this.arcgisAggregationSymbolStylerPopoverDisconnected.emit()}render(){const{props:e,referenceElement:t}=this,{strings:i}=e;return(0,n.h)(n.H,{class:"js-app-flyout arcgis-aggregation-popover"},(0,n.h)("calcite-popover",{placement:"leading-start",offsetDistance:0,offsetSkidding:45,pointerDisabled:!0,label:i.symbolStyle,referenceElement:t,triggerDisabled:!0,class:"popover",open:!1,ref:e=>this.popoverNode=e},(0,n.h)("calcite-panel",{heading:i.symbolStyle,closable:!1},(0,n.h)("div",{slot:"header-content"},i.symbolStyle),(0,n.h)("calcite-action",{slot:"header-actions-end",scale:"s",icon:"x",text:"",onClick:()=>this.arcgisAggregationSymbolStylerPopoverClose.emit(),ref:e=>this.closeActionNode=e}),(0,n.h)("div",{class:"symbol-styler-div",ref:e=>this.buildSymbolStyler(e)}))))}async buildSymbolStyler(e){const{props:t,modules:i}=this,{layer:s,portal:n}=t,{Color:l}=i;let a=s.featureReduction.symbol;["simple-fill","simple-marker","simple-line","picture-marker","cim"].indexOf(a.type)>-1||(a=u(i));const r="picture-marker"!==a.type&&!!a.color,c="picture-marker"!==(p=a).type&&"cim"!==p.type&&!!(null===(h=p.outline)||void 0===h?void 0:h.color),d="cim"===a.type&&"CIMPointSymbol"===a.data.symbol.type,g="rtl"===(0,o.g)(this.hostElement);var p,h;let b;if("simple-marker"===a.type){const e=a;b=e.outline?{color:e.outline.color?e.outline.color:new l([0,0,0,.5]),size:e.outline.width}:{color:new l([0,0,0,.5]),size:1}}else b="cim"===a.type?void 0:{color:new l([255,255,255,.5]),size:1};const y=document.createElement("arcgis-symbol-styler");y.popoverProps={placement:"bottom-end",offsetDistance:10,offsetSkidding:g?3:-3,pointerDisabled:"true",popoverWidth:315,refElement:this.closeActionNode};const C=y.edit(a.clone(),{portal:n,symbolFilter:void 0,sections:{marker:d||["simple-marker","picture-marker"].indexOf(a.type)>-1?{open:!0,symbolsOpen:!0,sizeOpen:!0,parts:{size:!1},markerType:"all"}:void 0,fill:{type:"color",optional:!0,open:!0,suggestedColorsOpen:!0,transparencyOpen:m(a,i)},stroke:{type:"color",optional:!0,extraParts:{style:-1===["simple-marker","picture-marker","cim"].indexOf(a.type),width:!0}}},fill:{color:f(a,i)||(w=new l("#ff8200"),.85,w.a=.85,w)},marker:{size:v(a,i)},stroke:b,fillEnabled:r,strokeEnabled:c});var w;y.addEventListener("arcgisSymbolStylerEdit",(e=>this.onChangeSymbol(e))),e.appendChild(y),await C}onChangeSymbol({detail:{symbol:e}}){const{props:t}=this,{layer:i}=t;i.featureReduction.symbol=e,this.arcgisAggregationSymbolStylerChange.emit()}get hostElement(){return(0,n.d)(this)}};L.style=".popover{z-index:100}.symbol-styler-div{width:328px;height:100%;overflow-y:auto;overflow-x:hidden}arcgis-symbol-styler{max-height:calc(90vh - 100px);}";const N=class{constructor(e){(0,n.r)(this,e),this.arcgisAggregationTileSelect=(0,n.c)(this,"arcgisAggregationTileSelect",7),this.arcgisAggregationTileOptions=(0,n.c)(this,"arcgisAggregationTileOptions",7),this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.keyupEventHandler=e=>{const{selected:t}=this;" "!==e.key&&"Enter"!==e.key||(e.stopPropagation(),this.removeInfoPopover(),t?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit(),e.preventDefault())},this.keydownEventHandler=e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())},this.clickEventHandler=e=>{var t;const{selected:i}=this;"CALCITE-CHECKBOX"!==(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.nodeName)&&(e.stopPropagation(),this.removeInfoPopover(),i?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit(),e.preventDefault())},this.checkboxChangeHandler=e=>{const{selected:t}=this;e.preventDefault();const i=e.target;i.checked?(this.removeInfoPopover(),t?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit()):i.checked=!0},this.props=void 0,this.selected=void 0}async setFocus(){var e;null===(e=this.tileNode)||void 0===e||e.focus()}disconnectedCallback(){this.removeInfoPopover()}render(){const{props:e,selected:t}=this,{title:i,imagePath:s,strings:l}=e,a={tile:!0,"tile-selected":t},r={"tile-image":!0,"tile-image-selected":t},c={"tile-check":!0,rtl:"rtl"===(0,o.g)(this.hostElement)};return(0,n.h)(n.H,null,(0,n.h)("div",{class:a,role:"button",tabindex:"0","aria-label":`${i} ${l.tile.options}`,"aria-selected":t,ref:e=>{this.tileNode=e,this.addTileListeners(e)}},(0,n.h)("div",{class:r,style:{backgroundImage:`url(${s})`},"aria-hidden":"true"}),(0,n.h)("div",{class:c,"aria-label":"","aria-hidden":"true"},(0,n.h)("calcite-checkbox",{name:"style-tile-check-name",checked:t,tabindex:"-1",ref:e=>this.addCheckboxListener(e)})),this.renderTileLink()))}renderTileLink(){const{props:e,selected:t}=this,{strings:i}=e,s={"style-link-text":!0,rtl:"rtl"===(0,o.g)(this.hostElement)};return(0,n.h)("div",{class:"style-link","aria-label":e.title},(0,n.h)("div",{class:"style-link-title"},(0,n.h)("div",{class:s,"aria-hidden":"true"},e.title),(0,n.h)("calcite-action",{class:"style-link-info",tabindex:"0",scale:"s",icon:"information",compact:!0,onClick:e=>this.handleInfoClick(e),text:i.tile.moreInfo,ref:e=>{this.infoIconNode=e,e.addEventListener("keyup",(e=>{e.stopPropagation(),(" "===e.key||!this.infoPopoverNode&&"Enter"===e.key)&&this.handleInfoClick(e)})),e.addEventListener("keydown",(e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())}))}})),t&&this.renderStyleOptions())}renderStyleOptions(){const{props:e}=this,{strings:t}=e;return(0,n.h)("calcite-button",{appearance:"outline-fill",width:"full",scale:"s",label:t.tile.options},t.tile.options)}handleInfoClick(e){e.stopPropagation();const{props:t}=this,{config:i,title:s,moreInfo:n,helpId:o,flowItemNode:l,strings:a}=t;this.removeInfoPopover(),this.infoPopoverNode=document.createElement("arcgis-aggregation-info-popover"),this.infoPopoverNode.props={title:s,moreInfo:n,helpId:o,config:i,flowItemNode:l,strings:a},this.infoPopoverNode.referenceElement=this.infoIconNode,this.infoPopoverNode.addEventListener("arcgisAggregationInfoPopoverClose",(e=>{e.stopPropagation(),this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200)})),this.infoPopoverNode.addEventListener("arcgisAggregationInfoPopoverDisconnected",(e=>{e.stopPropagation(),this.removeInfoPopover()})),document.body.appendChild(this.infoPopoverNode),this.infoPopoverNode.setOpen(!0),setTimeout((()=>this.infoPopoverNode.setFocus()),100),setTimeout((()=>{this.documentClickHandler=e=>{this.isInsideInfoPopoverNode(e.target)||(this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200))},document.addEventListener("click",this.documentClickHandler),this.panelScrollHandler=()=>{this.removeInfoPopover()},null==l||l.addEventListener("calciteFlowItemScroll",this.panelScrollHandler)}),100)}removeInfoPopover(){const{props:e}=this,{flowItemNode:t}=e;document.body.querySelectorAll(".arcgis-aggregation-popover").forEach((e=>document.body.removeChild(e))),this.infoPopoverNode=null,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0),this.panelScrollHandler&&(null==t||t.removeEventListener("calciteFlowItemScroll",this.panelScrollHandler),this.panelScrollHandler=void 0)}isInsideInfoPopoverNode(e){if("ARCGIS-AGGREGATION-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let t=null==e?void 0:e.parentElement;for(;t;){if("ARCGIS-AGGREGATION-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}addTileListeners(e){e.addEventListener("keyup",this.keyupEventHandler),e.addEventListener("keydown",this.keydownEventHandler),e.addEventListener("click",this.clickEventHandler)}addCheckboxListener(e){e.addEventListener("calciteCheckboxChange",this.checkboxChangeHandler)}get hostElement(){return(0,n.d)(this)}};N.style=".tile{background-color:white;position:relative;margin:6px;cursor:pointer;box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0;transition:box-shadow 125ms ease-in-out}.tile:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0}.tile:focus{outline:2px solid var(--calcite-ui-brand)}.tile-selected{box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-ui-brand)}.tile-selected:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-ui-brand)}.tile-check{position:absolute;top:10px;right:10px}.tile-check.rtl{right:auto;left:10px}.style-link{padding:9px 9px}.style-link-icon{margin-top:-1px}.style-link-text{margin-right:10px}.style-link-text.rtl{margin-right:0;margin-left:10px}.style-link-title{display:flex;font-weight:bold;padding-bottom:5px}.style-link-options{color:#0079c1;display:flex;flex-direction:row nowrap}.style-link-options svg{fill:#0079c1}.tile-image{height:100px;width:100%;background-size:cover;display:flex;align-items:center;justify-content:center}.tile-image-selected{height:68px;background-size:auto 100px}.style-sub-text{font-size:80%;padding:0 0 6px 0}.style-link-info{height:18px}"},26426:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>p,c:()=>n,d:()=>s,e:()=>o,f:()=>d,g:()=>h,i:()=>l,m:()=>a,t:()=>r,u:()=>g});const s=(e,t)=>{let i,s="idle";const n=(...n)=>new Promise((o=>{switch(s){case"flushed":s="idle",i?(clearTimeout(i),o(e(...n))):o(null);break;case"invoked":clearTimeout(i),s="idle",o(e(...n));break;case"cancelled":clearTimeout(i),s="idle",o(null);break;default:i&&clearTimeout(i),s="pending",i=setTimeout((()=>(s="idle",o(e(...n)))),t)}}));return n.flush=function(...e){return s="flushed",n(...e)},n.invoke=function(...e){return s="invoked",n(...e)},n.cancel=function(...e){return s="cancelled",n(...e)},n.getStatus=function(){return s},n},n=(e,t)=>{let i;return(...s)=>new Promise((n=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,n(e(...s))}),t))}))};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e){return null!=e}async function a(e,t){return await Promise.all([e,r(t)]),e}function r(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:s}=t(e);return[i,s]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function g(e,t){const i=[],s={};return e.forEach((e=>{const n=t(e);null==s[n]&&(s[n]=e,i.push(e))})),i}function p(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const h=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,s)=>e.slice(t*s,t+t*s)))},62727:(e,t,i)=>{i.d(t,{a:()=>l,g:()=>c});var s=i(18869),n=i(81068),o=i(28384);function l(e){var t,i,o;const l=null!==(t=(0,s.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===o?void 0:o.documentElement,a=((null==l?void 0:l.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return n.l.has(a)?n.l.get(a):n.l.has(a.slice(0,2))?n.l.get(a.slice(0,2)):"en"}const a={};function r(e,t){const i=`${e}${t}`;return a[i]||(a[i]=function(e,t){return new Promise(((i,s)=>{fetch((0,o.a)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then((e=>{e.ok?i(e.json()):s()}),(()=>s()))}))}(e,t)),a[i]}async function c(e,t){const i=t||e.tagName.toLowerCase(),o=l(e),a=function(e){var t,i,o;const l=null!==(t=(0,s.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===o?void 0:o.documentElement,a=((null==l?void 0:l.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return n.l.has(a)?n.l.get(a):n.l.has(a.slice(0,2))?a:"en"}(e);let c;try{c=await r(i,o)}catch(e){console.warn(`no locale for ${i} (${o}) loading default locale en.`),c=await r(i,"en")}return[c,o,a]}}}]);