/*! For license information please see 5aea444b10b61dd3355d803d991a8466.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[40389],{40389:(e,t,r)=>{r.r(t),r.d(t,{arcgis_new_item_pages_data_store_list:()=>d});var a=r(28384),i=r(76134),s=r(72074),o=r(72796),n=r(58892),l=r(54871),c=r(27099);r(27010),r(41171),r(66716),r(62381),r(83397),r(16665),r(83129),r(65508),r(24552),r(85142),r(72022),r(96729),r(58728),r(86739),r(31546),r(18869),r(46220),r(82463),r(48507),r(48333),r(86274),r(99274);const d=class{constructor(e){(0,a.r)(this,e),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.selected=void 0,this.items=void 0,this.pagination=void 0,this.loading=!1,this.error=null}async componentWillLoad(){this.selected={id:n.a.dataStoreId,name:n.a.dataStoreName},this.i18n=l.u.i18n.tileLayerFromStore}isValidDataStoreType(e){return e.typeKeywords.some((e=>{const t=e.toLowerCase();return t.startsWith("cloudstore")||t.startsWith("folder")}))}renderErrorItem(){var e,t;const{i18n:r,error:i,loading:s}=this;let o,n;return"failToListDataStoreContents"===i?(o="Unable to list content of the data store",n="An error occurred while listing the data store's contents."):(o=null===(e=r.error[i])||void 0===e?void 0:e.heading,n=null===(t=r.error[i])||void 0===t?void 0:t.description),(0,a.h)("arcgis-new-item-alert",{heading:o,description:n,active:null!==i&&!s,onAlertDismiss:()=>{this.error=null}})}async handleNext(){var e;if(!this.selected||!this.selected.id||!this.selected.name)return void(this.error="noDataStoreSelected");const t=this.selected;this.loading=!0;const r=(await(0,o.g)(t.id)).result;if(0===r.length)return this.error="noRegisteredServersForDataStore",void(this.loading=!1);n.a.serverList=r,n.a.serverId=r[0].id,n.a.dataStoreId=t.id,n.a.dataStoreName=t.name;const a=await(0,s.g)(n.a.dataStoreId,"/","datastore",n.a.serverId);if("failToListDataStoreContents"===(null===(e=a.error)||void 0===e?void 0:e.code))return this.loading=!1,void(this.error="failToListDataStoreContents");const i=a.result,l=this.filterContentsByUserSelection(i);if(!i.children||0===l.children.length)return this.error="noContentInDataStore",void(this.loading=!1);n.a.datastoreContents=l,n.a.dataStoreCachedData=Object.assign(Object.assign({},n.a.dataStoreCachedData),{"/":n.a.datastoreContents}),(0,c.b)(),this.newItemUpdatePage.emit("dataStoreBrowser")}filterContentsByUserSelection(e){var t;const r="tileLayer"===n.a.newItemMode?"tile-layer":"scene-layer",a=n.a.tileLayerPublishType;return Object.assign(Object.assign({},e),{children:null===(t=e.children)||void 0===t?void 0:t.filter((e=>{const t=e.type;let i="folder"===t;return"tile-layer"===r?i||(i="tiles"===a&&"cacheDataset"===t||"vectorTiles"===a&&"vectorCacheDataset"===t):"scene-layer"===r&&(i||(i="extractedScenePackage"===t||"i3sRestCache"===t)),i}))})}render(){const{selected:e,pagination:t,i18n:r,loading:s}=this,{portal:o,user:n,api:l}=i.c;return(0,a.h)(a.H,null,(0,a.h)("arcgis-item-browser",{onArcgisItemBrowserUpdate:e=>{const{results:t,num:r,start:a,total:i}=e.detail;this.items=t,this.pagination={start:a,num:r,total:i}},onArcgisItemBrowserSelect:e=>{const t=e.detail[0];this.selected={id:t.id,name:t.title}},q:'type:"Data Store"',portal:o,user:n,api:l,selection:"single"},(0,a.h)("arcgis-item-browser-top-bar",{slot:"top-bar"},(0,a.h)("arcgis-item-browser-search",{slot:"search",term:"",placeholder:r.search})),(0,a.h)("arcgis-new-item-description",{header:r.heading,content:r.subHeading,slot:"content-start",class:"header"}),(0,a.h)("arcgis-item-browser-sort",{options:["modified","title","relevance"],slot:"sort"}),(0,a.h)("arcgis-item-browser-content",{slot:"content"},this.items&&(0,a.h)("calcite-radio-button-group",{layout:"vertical",class:"tile-select",name:"data-store-selection-group"},(this.items||[]).map((t=>this.isValidDataStoreType(t)&&(0,a.h)("arcgis-new-item-pages-data-store-browser-card",{dataStoreItem:t,selected:e.id===t.id,key:t.id}))))),(0,a.h)("arcgis-item-browser-pagination",{total:null==t?void 0:t.total,start:null==t?void 0:t.start,num:null==t?void 0:t.num,slot:"pagination"})),this.renderErrorItem(),(0,a.h)("arcgis-new-item-loader",{active:s,text:r.processing}))}get el(){return(0,a.d)(this)}};d.style=".header{margin-top:2rem;margin-left:1.5rem;margin-right:1.5rem}.tile-select{margin-top:1.25rem}.no-items{margin-bottom:8rem}"},27099:(e,t,r)=>{r.d(t,{a:()=>h,b:()=>d,l:()=>c});var a=r(76134),i=r(58892);const s="create tile layer",o="my content",n=e=>{switch(e){case"store":return"data store";case"existing":return"fs";case"upload":return"upload"}},l=e=>{switch(e){case"tiles":return"raster";case"vectorTiles":return"vector"}},c=()=>{var e;null===(e=a.c.telemetry)||void 0===e||e.startWorkflow(s,{category:"create tile layer",pageName:"my content"})},d=()=>{const e=a.c.telemetry;null==e||e.stepWorkflow(s,"from option",{category:s,attribute:n(i.a.addTileLayerOption),details:l(i.a.tileLayerPublishType),pageName:o})},h=()=>{const e=a.c.telemetry;null==e||e.endWorkflow(s,{category:s,attribute:n(i.a.addTileLayerOption),details:l(i.a.tileLayerPublishType),pageName:o})}}}]);