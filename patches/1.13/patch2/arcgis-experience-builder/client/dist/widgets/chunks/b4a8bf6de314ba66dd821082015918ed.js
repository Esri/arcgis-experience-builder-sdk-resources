/*! For license information please see b4a8bf6de314ba66dd821082015918ed.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[10755],{10755:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_locator_select:()=>v});var r=i(28384),o=i(76134),s=i(65508),l=i(59004),n=i(83129),a=i(58892),c=i(54871),u=i(62381),d=i(48507);i(27010),i(41171),i(66716),i(24552),i(85142),i(72022),i(96729),i(58728),i(86739),i(31546),i(83397),i(18869),i(46220),i(82463),i(48333),i(86274);const h=["locator-view","locator"],v=class{constructor(e){(0,r.r)(this,e),this.newItemUpdatePage=(0,r.c)(this,"newItemUpdatePage",7),this.handleAuthSwitchChange=e=>{this.storeAuth=e.detail},this.handleNewUrl=async e=>{const{type:t,url:i}=e;this.type=t,this.locatorUrl=i,this.isSecured=null,this.error=null,i&&(this.allowStoredAuth=!1,this.storeAuth=!1,this.loading=!0,await this.getServiceInfo(!1),this.loading=!1)},this.selectedLocatorType="locator-view",this.locatorUrl="",this.type=void 0,this.loading=!1,this.error=null,this.canPublishLocatorView=!0,this.allowStoredAuth=!1,this.storeAuth=!1,this.isSecured=null,this.serviceInfo=null,this.itemType=void 0}async componentWillLoad(){var e;const t=c.u.i18n;this.i18n=t.locatorSelect,this.urlTypeI18n=t.urlType,this.urlI18n=t.url,this.allowStoredAuth=a.a.allowStoredAuth,this.storeAuth=a.a.storeAuth,this.isSecured=a.a.isSecured,this.itemType=a.a.type;const{user:i,portal:r}=o.c;this.canPublishLocatorView=(0,l.i)(i,r),this.selectedLocatorType=null!==(e=a.a.locatorType)&&void 0!==e?e:"locator-view",this.canPublishLocatorView||(this.selectedLocatorType="locator"),"locator"===this.selectedLocatorType&&(this.locatorUrl=a.a.url)}async handleNext(){const{selectedLocatorType:e,urlI18n:t,locatorUrl:i,allowStoredAuth:r}=this;if(a.a.locatorType=e,"locator-view"===e){const e=await(0,l.q)();a.a.newItemMode="create",a.a.type="Geocoding Service",a.a.typeKeywords=["Geocoding filter"],a.a.thumbnailURL="https://static.arcgis.com/images/desktopapp.png",a.a.createAsServiceProxy=!0,a.a.url=e}else{if(!i)return this.inputRef.focusMainInput(),void(this.error=t.invalidUrl);const{portal:e}=o.c,{error:s,result:l}=(0,d.g)((0,d.f)(i,e.allSSL),e.isPortal);if(s)return void(this.error=t[s.code]);if("Geocoding Service"!==l)return void(this.error=t.invalidUrl);if(a.a.url=i,a.a.type="Geocoding Service",a.a.newItemMode="url",a.a.allowStoredAuth=r,a.a.storeAuth=this.storeAuth,a.a.isSecured=this.isSecured,a.a.serviceInfo=this.serviceInfo,this.storeAuth&&(a.a.checkAuth=!0),this.allowStoredAuth&&!this.storeAuth){this.loading=!0;const e=await this.getServiceInfo(!0);if(this.loading=!1,!e)return}}this.allowStoredAuth&&this.storeAuth?this.newItemUpdatePage.emit("auth"):this.newItemUpdatePage.emit("itemProperties")}async getServiceInfo(e=!1){const{urlTypeI18n:t,locatorUrl:i,type:r}=this,{error:o,result:l}=await(0,n.o)({url:i,customParameters:a.a.customParameters,type:r,checkAuth:e,storeAuth:a.a.storeAuth});if(o||!l)return"does not point to a GIS server"===(null==o?void 0:o.message)?this.error=t.serviceNotGIS:"serviceNotExist"===(null==o?void 0:o.code)?this.error=t.serviceNotExist:"unsupportedWFSVersion"===(null==o?void 0:o.code)?this.error=t.unsupportedWFSVersion:this.error=t[null==o?void 0:o.code]||t.serviceNotExist,!1;const{tags:c,title:d,isSecured:h,allowStoredAuth:v,serviceInfo:p}=l;return this.allowStoredAuth=v,this.isSecured=h,this.serviceInfo=p,c&&(s.i.tags=c),s.i.title=(null==d?void 0:d.replace(u.s,""))||"",!0}render(){const{error:e,i18n:t,urlTypeI18n:i,loading:s,selectedLocatorType:l,locatorUrl:n,canPublishLocatorView:c,isSecured:u,allowStoredAuth:d,itemType:v}=this,{config:{helpBase:p,helpMap:g}}=o.c;return(0,r.h)("div",null,c&&(0,r.h)(r.F,null,(0,r.h)("arcgis-new-item-description",{header:t.heading}),(0,r.h)("calcite-tile-select-group",{layout:"vertical",class:"tile-select"},h.map((e=>(0,r.h)("calcite-tile-select",{checked:l===e,heading:t.options[e].title,description:t.options[e].description,name:"tile-layer-type","input-enabled":!0,width:"full",type:"radio",value:e,onCalciteTileSelectChange:()=>this.selectedLocatorType=e}))))),"locator"===l&&(0,r.h)(r.F,null,(0,r.h)("arcgis-new-item-description",{header:t.url.heading,content:t.url.description}),(0,r.h)("arcgis-new-item-url",{url:n,inputTitle:" ",placeholder:"https://myserver.com/arcgis/rest/services/folder/service/GeocodeServer",onNewItemUrlChange:e=>this.handleNewUrl(e.detail),ref:e=>this.inputRef=e}),(0,r.h)("div",{class:"custom-parameter-container"},(0,r.h)("arcgis-new-item-custom-parameters",{itemType:v})),d&&!!u&&(0,r.h)("arcgis-new-item-switch-card",{onSwitchChange:this.handleAuthSwitchChange,header:i.storeAuth,headerLink:{text:i.learnMore,href:`${p}${g[120000597]}`},defaultChecked:a.a.storeAuth})),(0,r.h)("arcgis-new-item-loader",{active:s,text:i.getServiceInfo}),(0,r.h)("arcgis-new-item-alert",{active:!!e,description:e,onAlertDismiss:()=>this.error=null}))}get el(){return(0,r.d)(this)}};v.style=".tile-select:not(:last-child){margin-bottom:1.5rem}.custom-parameter-container{margin-top:1.5rem}"},59004:(e,t,i)=>{i.d(t,{a:()=>T,b:()=>u,c:()=>b,d:()=>p,e:()=>g,f:()=>f,g:()=>d,h:()=>v,i:()=>w,j:()=>S,k:()=>A,l:()=>a,m:()=>P,n:()=>c,o:()=>L,p:()=>U,q:()=>l,r:()=>I,s:()=>y,t:()=>k,u:()=>x});var r=i(62381),o=i(76134),s=i(41171);async function l(){return new Promise((async e=>{const{portal:t}=o.c;if(null==t?void 0:t.isPortal){const i=t.helperServices.geocode,r=await function(e){const{config:t,portal:i}=o.c;return new Promise((async(r,o)=>{const l=e.filter((e=>n(e.url,i))).filter((e=>e.isEsriBatchGeocoder))[0];if(l){const e=l.url.split("/servers/")[1].split("/rest/services/")[0],i=`${t.restBaseUrl}/content/items/${e}`;try{r((await(0,s.r)(i)).url)}catch(e){o(e)}}else o("No world geocoder configured")}))}(i);e(r)}else{const i=function(e){const t=null==e?void 0:e.portalHostname;return-1!==t.indexOf("dev")?"dev":-1!==t.indexOf("qa")?"qa":""}(t);e(`https://geocode${i}.arcgis.com/arcgis/rest/services/World/GeocodeServer`)}}))}function n(e="",t){var i;const r=t.isPortal,o=e.toLowerCase(),s=o.indexOf("/geocodeserver")>-1&&o.indexOf("/rest/services/")>-1,l=r&&o.indexOf(null===(i=t.portalHostname)||void 0===i?void 0:i.toLowerCase())>-1,n=!r&&o.indexOf("utility")&&o.indexOf(".arcgis.com")>-1;return s&&(l||n)}function a(e){return(0,r.n)(e)||(null==e?void 0:e.privileges.includes("portal:user:createItem"))}function c(e){return(0,r.n)(e)||(null==e?void 0:e.privileges.includes("portal:user:receiveItems"))}function u(e,t){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("portal:publisher:publishFeatures"))&&(!t.isPortal||t.isBackedBySDS)}function d(e,t){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("portal:publisher:publishTiles"))&&(!t.isPortal||t.isBackedBySDS)}function h(e){return!(0,r.n)(e)&&!0}function v(e){var t;return!(0,r.n)(e)&&(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:publisher:publishScenes"))}const p=e=>!(0,r.n)(e);function g(e,t,i){var r,o;const s=!!(null===(o=null===(r=t.helperServices)||void 0===r?void 0:r.rasterAnalytics)||void 0===o?void 0:o.url),l=function(e,t,i){var r;return(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:publisher:publishDynamicImagery"))&&(t.isPortal||m(i))}(e,t,i),n=t.isPortal?l:l||function(e,t,i){var r;return(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:publisher:publishTiledImagery"))&&!t.isPortal&&m(i)}(e,t,i);return s&&n}function m(e){return null==e?void 0:e.some((e=>{var t;return null===(t=e.entitlements)||void 0===t?void 0:t.some((e=>"image"===e.toLowerCase()))}))}async function f(e){var t;const{userLicensedItems:i}=await(0,s.r)(`${null!==(t=e.restUrl)&&void 0!==t?t:e.portalUrl}/community/self?returnUserLicensedItems=true`);return i}function w(e,t){var i,o;const s=null===(i=t.helperServices)||void 0===i?void 0:i.geocode.some((({url:e})=>n(e,t))),l=null!==(o=null==e?void 0:e.privileges)&&void 0!==o?o:[];return!(0,r.n)(e)&&s&&(!t.isPortal||!t.isWebTierAuth&&l.includes("portal:user:viewOrgItems")&&l.includes("portal:user:createItem"))}const S=e=>!(0,r.n)(e);function y(e){return null==e?void 0:e.privileges.includes("premium:publisher:createAdvancedNotebooks")}function I(e){return null==e?void 0:e.privileges.includes("premium:publisher:createNotebooks")}function A(e,t){var i;return!!t.isPortal&&!!(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:publisher:registerDataStores"))}function P(e){return!(0,r.n)(e)&&(null==e?void 0:e.privileges.includes("premium:user:geocode"))}function b(e,t,i){return!t.isPortal&&u(e,t)&&function(e,t,i){return!(0,r.n)(e)&&!!t.supportsHostedServices&&a(e)&&(d(e,t)||u(e,t)||v(e)||h(e)||g(e,t,i))}(e,t,i)}function T(e,t,i){switch(t){case"CSV":case"GeoJson":case"Microsoft Excel":case"Shapefile":case"File Geodatabase":case"Photos with Locations":return u(e,i);case"Tile Package":return d(e,i);case"Vector Tile Package":return h(e);case"Scene Package":return v(e);case"Service Definition":return function(e,t){return u(e,t)&&d(e,t)}(e,i);default:return!0}}function L(e,t){var i;return(0,r.e)(e)||function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageCredits"))}(e)||!!((null==e?void 0:e.assignedCredits)>-1&&(null===(i=null==t?void 0:t.portalProperties)||void 0===i?void 0:i.showCreditsOnProfile))}const U=e=>!1;function k(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewGroups"))}function x(e){return(0,r.e)(e)||function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewUsers"))}(e)&&function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewItems"))}(e)&&(function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItems"))}(e)||function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))}(e)||function(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:reassignItems"))}(e))}}}]);